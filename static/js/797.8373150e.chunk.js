/*! For license information please see 797.8373150e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkkana=self.webpackChunkkana||[]).push([[797,463],{8109:function(e,t,n){n.d(t,{FB:function(){return F}});var r=n(4165),a=n(5671),i=n(3144);function s(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{u(r.next(e))}catch(t){i(t)}}function o(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}u((r=r.apply(e,t||[])).next())}))}var o,u=function(){function e(){(0,a.Z)(this,e),this.mutex=Promise.resolve()}return(0,i.Z)(e,[{key:"lock",value:function(){var e=function(){};return this.mutex=this.mutex.then((function(){return new Promise(e)})),new Promise((function(t){e=t}))}},{key:"dispatch",value:function(e){return s(this,void 0,void 0,(0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lock();case 2:return n=t.sent,t.prev=3,t.next=6,Promise.resolve(e());case 6:return t.abrupt("return",t.sent);case 7:return t.prev=7,n(),t.finish(7);case 10:case"end":return t.stop()}}),t,this,[[3,,7,10]])})))}}]),e}();var l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:n.g,c=null!==(o=l.Buffer)&&void 0!==o?o:null,f=l.TextEncoder?new l.TextEncoder:null;function h(e,t){return(15&e)+(e>>6|e>>3&8)<<4|(15&t)+(t>>6|t>>3&8)}function d(e,t){for(var n=t.length>>1,r=0;r<n;r++){var a=r<<1;e[r]=h(t.charCodeAt(a),t.charCodeAt(a+1))}}function p(e,t){if(e.length!==2*t.length)return!1;for(var n=0;n<t.length;n++){var r=n<<1;if(t[n]!==h(e.charCodeAt(r),e.charCodeAt(r+1)))return!1}return!0}var v="a".charCodeAt(0)-10,_="0".charCodeAt(0);function m(e,t,n){for(var r=0,a=0;a<n;a++){var i=t[a]>>>4;e[r++]=i>9?i+v:i+_,i=15&t[a],e[r++]=i>9?i+v:i+_}return String.fromCharCode.apply(null,e)}for(var w=null!==c?function(e){if("string"===typeof e){var t=c.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(c.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:function(e){if("string"===typeof e)return f.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=new Uint8Array(256),b=0;b<g.length;b++)y[g.charCodeAt(b)]=b;function Z(e){var t=Math.floor(.75*e.length),n=e.length;return"="===e[n-1]&&(t-=1,"="===e[n-2]&&(t-=1)),t}function A(e){for(var t=Z(e),n=e.length,r=new Uint8Array(t),a=0,i=0;i<n;i+=4){var s=y[e.charCodeAt(i)],o=y[e.charCodeAt(i+1)],u=y[e.charCodeAt(i+2)],l=y[e.charCodeAt(i+3)];r[a]=s<<2|o>>4,r[a+=1]=(15&o)<<4|u>>2,r[a+=1]=(3&u)<<6|63&l,a+=1}return r}var k=16384,x=4,E=new u,I=new Map;function S(e,t){return s(this,void 0,void 0,(0,r.Z)().mark((function n(){var a,i,o,u,l,c,f,h,v,_,g,y,b,Z,S,B,C,z,R,F,D=this;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=null,i=null,o=!1,"undefined"!==typeof WebAssembly){n.next=5;break}throw new Error("WebAssembly is not supported in this environment!");case 5:u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i.set(e,t)},l=function(){return i},c=function(){return a.exports},f=function(e){a.exports.Hash_SetMemorySize(e);var t=a.exports.Hash_GetBuffer(),n=a.exports.memory.buffer;i=new Uint8Array(n,t,e)},h=function(){return new DataView(a.exports.memory.buffer).getUint32(a.exports.STATE_SIZE,!0)},v=E.dispatch((function(){return s(D,void 0,void 0,(0,r.Z)().mark((function t(){var n,i,s;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return I.has(e.name)||(n=A(e.data),i=WebAssembly.compile(n),I.set(e.name,i)),t.next=3,I.get(e.name);case 3:return s=t.sent,t.next=6,WebAssembly.instantiate(s,{});case 6:a=t.sent;case 7:case"end":return t.stop()}}),t)})))})),_=function(){return s(D,void 0,void 0,(0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return e.next=3,v;case 3:t=a.exports.Hash_GetBuffer(),n=a.exports.memory.buffer,i=new Uint8Array(n,t,k);case 6:case"end":return e.stop()}}),e)})))},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o=!0,a.exports.Hash_Init(e)},y=function(e){for(var t=0;t<e.length;){var n=e.subarray(t,t+k);t+=n.length,i.set(n),a.exports.Hash_Update(n.length)}},b=function(e){if(!o)throw new Error("update() called before init()");var t=w(e);y(t)},Z=new Uint8Array(2*t),S=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!o)throw new Error("digest() called before init()");return o=!1,a.exports.Hash_Final(n),"binary"===e?i.slice(0,t):m(Z,i,t)},B=function(){if(!o)throw new Error("save() can only be called after init() and before digest()");var t=a.exports.Hash_GetState(),n=h(),r=a.exports.memory.buffer,i=new Uint8Array(r,t,n),s=new Uint8Array(x+n);return d(s,e.hash),s.set(i,x),s},C=function(t){if(!(t instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");var n=a.exports.Hash_GetState(),r=h(),i=x+r,s=a.exports.memory.buffer;if(t.length!==i)throw new Error("Bad state length (expected ".concat(i," bytes, got ").concat(t.length,")"));if(!p(e.hash,t.subarray(0,x)))throw new Error("This state was written by an incompatible hash implementation");var u=t.subarray(x);new Uint8Array(s,n,r).set(u),o=!0},z=function(e){return"string"===typeof e?e.length<k/4:e.byteLength<k},R=z,n.t0=e.name,n.next="argon2"===n.t0||"scrypt"===n.t0?24:"blake2b"===n.t0||"blake2s"===n.t0?26:"blake3"===n.t0?28:"xxhash64"===n.t0||"xxhash3"===n.t0||"xxhash128"===n.t0?30:32;break;case 24:return R=function(){return!0},n.abrupt("break",32);case 26:return R=function(e,t){return t<=512&&z(e)},n.abrupt("break",32);case 28:return R=function(e,t){return 0===t&&z(e)},n.abrupt("break",32);case 30:return R=function(){return!1},n.abrupt("break",32);case 32:return F=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!R(e,n))return g(n),b(e),S("hex",r);var s=w(e);return i.set(s),a.exports.Hash_Calculate(s.length,n,r),m(Z,i,t)},n.next=35,_();case 35:return n.abrupt("return",{getMemory:l,writeMemory:u,getExports:c,setMemorySize:f,init:g,update:b,digest:S,save:B,load:C,calculate:F,hashLength:t});case 36:case"end":return n.stop()}}),n)})))}function B(e,t,n){return s(this,void 0,void 0,(0,r.Z)().mark((function a(){var i,s;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.lock();case 2:return i=r.sent,r.next=5,S(t,n);case 5:return s=r.sent,i(),r.abrupt("return",s);case 8:case"end":return r.stop()}}),a)})))}new u;new u;new DataView(new ArrayBuffer(4));new u;new u;new u;new u;new u;var C={name:"md5",data:"AGFzbQEAAAABEgRgAAF/YAAAYAF/AGACf38BfwMIBwABAgMBAAIEBQFwAQEBBQQBAQICBg4CfwFBoIoFC38AQYAICwdwCAZtZW1vcnkCAA5IYXNoX0dldEJ1ZmZlcgAACUhhc2hfSW5pdAABC0hhc2hfVXBkYXRlAAIKSGFzaF9GaW5hbAAEDUhhc2hfR2V0U3RhdGUABQ5IYXNoX0NhbGN1bGF0ZQAGClNUQVRFX1NJWkUDAQqzFgcFAEGACQstAEEAQv6568XpjpWZEDcCkIkBQQBCgcaUupbx6uZvNwKIiQFBAEIANwKAiQEL6AIBA39BAEEAKAKAiQEiASAAakH/////AXEiAjYCgIkBQQAoAoSJASEDAkAgAiABTw0AQQAgA0EBaiIDNgKEiQELQQAgAyAAQR12ajYChIkBAkACQAJAAkACQAJAIAFBP3EiAw0AQYAJIQIMAQtBwAAgA2siAiAASw0BIANBGGohA0EAIQEDQCADIAFqQYCJAWogAUGACWotAAA6AAAgAyABQQFqIgFqQdgARw0AC0GYiQFBwAAQAxogACACayEAIAJBgAlqIQILIABBwABPDQEgACEDDAILIABFDQJBACEBIANBmIkBakEALQCACToAACAAQQFGDQIgA0GZiQFqIQMgAEF/aiECA0AgAyABaiABQYEJai0AADoAACACIAFBAWoiAUcNAAwDCwsgAEE/cSEDIAIgAEFAcRADIQILIANFDQBBACEBA0AgAUGYiQFqIAIgAWotAAA6AAAgAyABQQFqIgFHDQALCwu0EAEZf0EAKAKUiQEhAkEAKAKQiQEhA0EAKAKMiQEhBEEAKAKIiQEhBQNAIABBCGooAgAiBiAAQRhqKAIAIgcgAEEoaigCACIIIABBOGooAgAiCSAAQTxqKAIAIgogAEEMaigCACILIABBHGooAgAiDCAAQSxqKAIAIg0gDCALIAogDSAJIAggByADIAZqIAIgAEEEaigCACIOaiAFIAQgAiADc3EgAnNqIAAoAgAiD2pB+Miqu31qQQd3IARqIhAgBCADc3EgA3NqQdbunsZ+akEMdyAQaiIRIBAgBHNxIARzakHb4YGhAmpBEXcgEWoiEmogAEEUaigCACITIBFqIABBEGooAgAiFCAQaiAEIAtqIBIgESAQc3EgEHNqQe6d9418akEWdyASaiIQIBIgEXNxIBFzakGvn/Crf2pBB3cgEGoiESAQIBJzcSASc2pBqoyfvARqQQx3IBFqIhIgESAQc3EgEHNqQZOMwcF6akERdyASaiIVaiAAQSRqKAIAIhYgEmogAEEgaigCACIXIBFqIAwgEGogFSASIBFzcSARc2pBgaqaampBFncgFWoiECAVIBJzcSASc2pB2LGCzAZqQQd3IBBqIhEgECAVc3EgFXNqQa/vk9p4akEMdyARaiISIBEgEHNxIBBzakGxt31qQRF3IBJqIhVqIABBNGooAgAiGCASaiAAQTBqKAIAIhkgEWogDSAQaiAVIBIgEXNxIBFzakG+r/PKeGpBFncgFWoiECAVIBJzcSASc2pBoqLA3AZqQQd3IBBqIhEgECAVc3EgFXNqQZPj4WxqQQx3IBFqIhUgESAQc3EgEHNqQY6H5bN6akERdyAVaiISaiAHIBVqIA4gEWogCiAQaiASIBUgEXNxIBFzakGhkNDNBGpBFncgEmoiECAScyAVcSASc2pB4sr4sH9qQQV3IBBqIhEgEHMgEnEgEHNqQcDmgoJ8akEJdyARaiISIBFzIBBxIBFzakHRtPmyAmpBDncgEmoiFWogCCASaiATIBFqIA8gEGogFSAScyARcSASc2pBqo/bzX5qQRR3IBVqIhAgFXMgEnEgFXNqQd2gvLF9akEFdyAQaiIRIBBzIBVxIBBzakHTqJASakEJdyARaiISIBFzIBBxIBFzakGBzYfFfWpBDncgEmoiFWogCSASaiAWIBFqIBQgEGogFSAScyARcSASc2pByPfPvn5qQRR3IBVqIhAgFXMgEnEgFXNqQeabh48CakEFdyAQaiIRIBBzIBVxIBBzakHWj9yZfGpBCXcgEWoiEiARcyAQcSARc2pBh5vUpn9qQQ53IBJqIhVqIAYgEmogGCARaiAXIBBqIBUgEnMgEXEgEnNqQe2p6KoEakEUdyAVaiIQIBVzIBJxIBVzakGF0o/PempBBXcgEGoiESAQcyAVcSAQc2pB+Me+Z2pBCXcgEWoiEiARcyAQcSARc2pB2YW8uwZqQQ53IBJqIhVqIBcgEmogEyARaiAZIBBqIBUgEnMgEXEgEnNqQYqZqel4akEUdyAVaiIQIBVzIhUgEnNqQcLyaGpBBHcgEGoiESAVc2pBge3Hu3hqQQt3IBFqIhIgEXMiGiAQc2pBosL17AZqQRB3IBJqIhVqIBQgEmogDiARaiAJIBBqIBUgGnNqQYzwlG9qQRd3IBVqIhAgFXMiFSASc2pBxNT7pXpqQQR3IBBqIhEgFXNqQamf+94EakELdyARaiISIBFzIgkgEHNqQeCW7bV/akEQdyASaiIVaiAPIBJqIBggEWogCCAQaiAVIAlzakHw+P71e2pBF3cgFWoiECAVcyIVIBJzakHG/e3EAmpBBHcgEGoiESAVc2pB+s+E1X5qQQt3IBFqIhIgEXMiCCAQc2pBheG8p31qQRB3IBJqIhVqIBkgEmogFiARaiAHIBBqIBUgCHNqQYW6oCRqQRd3IBVqIhEgFXMiECASc2pBuaDTzn1qQQR3IBFqIhIgEHNqQeWz7rZ+akELdyASaiIVIBJzIgcgEXNqQfj5if0BakEQdyAVaiIQaiAMIBVqIA8gEmogBiARaiAQIAdzakHlrLGlfGpBF3cgEGoiESAVQX9zciAQc2pBxMSkoX9qQQZ3IBFqIhIgEEF/c3IgEXNqQZf/q5kEakEKdyASaiIQIBFBf3NyIBJzakGnx9DcempBD3cgEGoiFWogCyAQaiAZIBJqIBMgEWogFSASQX9zciAQc2pBucDOZGpBFXcgFWoiESAQQX9zciAVc2pBw7PtqgZqQQZ3IBFqIhAgFUF/c3IgEXNqQZKZs/h4akEKdyAQaiISIBFBf3NyIBBzakH96L9/akEPdyASaiIVaiAKIBJqIBcgEGogDiARaiAVIBBBf3NyIBJzakHRu5GseGpBFXcgFWoiECASQX9zciAVc2pBz/yh/QZqQQZ3IBBqIhEgFUF/c3IgEHNqQeDNs3FqQQp3IBFqIhIgEEF/c3IgEXNqQZSGhZh6akEPdyASaiIVaiANIBJqIBQgEWogGCAQaiAVIBFBf3NyIBJzakGho6DwBGpBFXcgFWoiECASQX9zciAVc2pBgv3Nun9qQQZ3IBBqIhEgFUF/c3IgEHNqQbXk6+l7akEKdyARaiISIBBBf3NyIBFzakG7pd/WAmpBD3cgEmoiFSAEaiAWIBBqIBUgEUF/c3IgEnNqQZGnm9x+akEVd2ohBCAVIANqIQMgEiACaiECIBEgBWohBSAAQcAAaiEAIAFBQGoiAQ0AC0EAIAI2ApSJAUEAIAM2ApCJAUEAIAQ2AoyJAUEAIAU2AoiJASAAC6ECAQN/QQAoAoCJASIAQT9xIgFBmIkBakGAAToAAAJAAkACQCABQT9zIgJBB0sNAAJAIAJFDQAgAUGZiQFqIQADQCAAQQA6AAAgAEEBaiEAIAJBf2oiAg0ACwtBwAAhAkGYiQFBwAAQAxpBACEADAELIAJBCEYNASABQQFqIQALIABBj4kBaiEBA0AgASACakEAOgAAIAJBd2ohACACQX9qIQIgAEEASg0AC0EAKAKAiQEhAAtBACAAQRV2OgDTiQFBACAAQQ12OgDSiQFBACAAQQV2OgDRiQFBACAAQQN0IgI6ANCJAUEAIAI2AoCJAUEAQQAoAoSJATYC1IkBQZiJAUHAABADGkEAQQApAoiJATcDgAlBAEEAKQKQiQE3A4gJCwYAQYCJAQszAEEAQv6568XpjpWZEDcCkIkBQQBCgcaUupbx6uZvNwKIiQFBAEIANwKAiQEgABACEAQLCwsBAEGACAsEmAAAAA==",hash:"9b0fac7d"},z=new u,R=null;function F(e){if(null===R)return B(z,C,16).then((function(t){return(R=t).calculate(e)}));try{var t=R.calculate(e);return Promise.resolve(t)}catch(n){return Promise.reject(n)}}new u;new u;new u;new u;new u;new u;new u;new u;new u,new ArrayBuffer(8);new u,new ArrayBuffer(8);new u,new ArrayBuffer(8);new u;new u;new u},7931:function(e,t,n){n.d(t,{ED:function(){return s.ED},G8:function(){return se},TN:function(){return te},x6:function(){return ae}});var r=n(4165),a=n(3324),i=n(5861),s=(n(5831),n(6546)),o=n(652),u=n(9873),l=n(9751),c=n(2269),f=n(7317),h=n(8366),d=n(2615),p=n(8391),v=n(384),_=n(7188),m=n(6849),w=n(8580),g=n(1944),y=n(7625),b=n(7139),Z=n(8849),A=n(4414),k=n(3060),x=n(7270),E=n(8334),I=n(4),S=n(2603),B=n(2990),C=(n(6207),s.Cy),z=o.Cy,R=u.Cy,F=l.Cy,D=c.Cy,N=f.Cy,Q=h.Cy,O=d.Cy,q="feature_selection",M=v.Cy,U=_.Cy,W=m.Cy,T="combine_embeddings",j="batch_correction",G=y.Cy,L="tsne",H="umap",Y="kmeans_cluster",J=A.Cy,P="choose_clustering",V=E.Cy,X="cell_labelling",K=S.Cy,$=B.Cy,ee="_loaded";function te(){return ne.apply(this,arguments)}function ne(){return(ne=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",re(new s.tq));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){var t={};t[C]=e,t[z]=new o.E4(t[C]),t[R]=new u.fA(t[C]),t[F]=new l.IW(t[C]);var n={RNA:t[z],ADT:t[R],CRISPR:t[F]};t[D]=new c.H0(t[C],n),t[N]=new f.ue(t[z],t[D]),t[Q]=new h.m5(t[R],t[D]),t[O]=new d.$M(t[F],t[D]),t[q]=new p.$(t[D],t[N]),t[M]=new v.rR(t[D],t[N],t[q]),t[U]=new _.Ru(t[D],t[Q]),t[W]=new m.zR(t[D],t[O]);var r={RNA:t[M],ADT:t[U],CRISPR:t[W]};t[T]=new w.BE(r),t[j]=new g.N_(t[D],t[T]),t[G]=new y.Xr(t[j]),t[L]=new k.T(t[G]),t[H]=new x.D(t[G]),t[Y]=new Z.d(t[j]),t[J]=new A.Xs(t[G]),t[P]=new b.c(t[J],t[Y]);var a={RNA:t[N],ADT:t[Q],CRISPR:t[O]};return t[V]=new E.UL(t[D],a,t[P]),t[X]=new I.ES(t[C]),t[$]=new B.ii(t[C],t[D],t[N]),t[K]=new S.kd(t[D],a),Promise.all([t[L].ready(),t[H].ready()]).then((function(e){return t}))}function ae(e,t,n){return ie.apply(this,arguments)}function ie(){return ie=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var s,o,u,l,c,f,h,d,p,v,_,m,w,g,y,b,Z,A,k,x,E=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(s=E.length>3&&void 0!==E[3]?E[3]:{}).startFun,u=void 0===o?null:o,l=s.finishFun,c=void 0===l?null:l,f=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===u){e.next=3;break}return e.next=3,u(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===c){e.next=3;break}return e.next=3,c(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=[],p=function(e,n){null!==c&&(n=t[e].changed?n.then((function(n){return c(e,t[e])})):n.then((function(t){return c(e)}))),d.push(n)},e.next=7,f(C);case 7:return e.next=9,t[C].compute(n,a[C]);case 9:return e.next=11,h(C);case 11:ee in t&&(t[C].changed=!0,delete t[ee]),v=0,_=[z,R,F,D,N,Q,O,q,M,U,W,T,j,G];case 14:if(!(v<_.length)){e.next=25;break}return m=_[v],e.next=18,f(m);case 18:return e.next=20,t[m].compute(a[m]);case 20:return e.next=22,h(m);case 22:v++,e.next=14;break;case 25:w=0,g=[L,H];case 26:if(!(w<g.length)){e.next=35;break}return y=g[w],e.next=30,f(y);case 30:b=t[y].compute(a[y]),p(y,b);case 32:w++,e.next=26;break;case 35:return Z=a[P].method,e.next=38,f(Y);case 38:return t[Y].compute("kmeans"==Z,a[Y]),e.next=41,h(Y);case 41:return e.next=43,f(J);case 43:return t[J].compute("snn_graph"==Z,a[J]),e.next=46,h(J);case 46:return e.next=48,f(P);case 48:return t[P].compute(a[P]),e.next=51,h(P);case 51:A=0,k=[V,X,K,$];case 53:if(!(A<k.length)){e.next=64;break}return x=k[A],e.next=57,f(x);case 57:return e.next=59,t[x].compute(a[x]);case 59:return e.next=61,h(x);case 61:A++,e.next=53;break;case 64:return e.next=66,Promise.all(d);case 66:return e.abrupt("return",null);case 67:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function se(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var i=(0,a.Z)(r[n],2),s=i[0],o=i[1];s!=ee&&(t[s]=o.fetchParameters())}return t}},298:function(e,t,n){n.d(t,{TD:function(){return f},bN:function(){return d}});var r=n(7762),a=(n(6546),n(652),n(9873),n(9751),n(2269),n(7317),n(8366),n(2615),n(384)),i=n(7188),s=n(6849),o=n(8580),u=n(1944),l=n(7625);n(4414),n(8334),n(2603),n(2990),n(4);var c=[a.Cy,i.Cy,s.Cy];function f(e,t){var n,a;if("mnn"==t)n=t,a="weight";else if("regress"==t)n="none",a=t;else{if("none"!=t)throw new Error("unknown correction method '"+t+"'");n=t,a=t}e[u.Cy].method=n;var i,s=(0,r.Z)(c);try{for(s.s();!(i=s.n()).done;){e[i.value].block_method=a}}catch(o){s.e(o)}finally{s.f()}return e}var h=[u.Cy,o.Cy,l.Cy];function d(e,t){var n,a=(0,r.Z)(h);try{for(a.s();!(n=a.n()).done;){e[n.value].approximate=t}}catch(i){a.e(i)}finally{a.f()}return e}},8408:function(e,t,n){n.d(t,{e:function(){return o}});var r=n(7762),a=n(5831),i=n(6650),s=n(6474);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=n.group,l=void 0===u?"data":u,c=n.forceBuffer,f=void 0!==c&&c,h={path:t+"/simple.h5",$schema:"hdf5_data_frame/v1.json",data_frame:{dimensions:[e.numberOfRows(),e.numberOfColumns()],columns:[],row_names:!1},hdf5_data_frame:{group:l}},d=a._u({extension:".h5"}),p=d,v=[],_=a.ll(d);try{var m=_.createGroup(l);m.writeDataSet("column_names","String",null,e.columnNames());var w=e.rowNames();null!==w&&(h.data_frame.row_names=!0,m.writeDataSet("row_names","String",null,w));for(var g=m.createGroup("data"),y=h.data_frame.columns,b=0;b<e.numberOfColumns();b++){var Z=e.column(b),A=e.columnNames()[b];if(Z instanceof Array){var k,x=new Set,E=!1,I=(0,r.Z)(Z);try{for(I.s();!(k=I.n()).done;){var S=k.value;null===S?E=!0:x.add(typeof S)}}catch(U){I.e(U)}finally{I.f()}if(x.size>1)throw new Error("column '"+A+"' has multiple types");if(x.has("string"))if(y.push({name:A,type:"string"}),E){for(var B=new Set(Z),C="NA";B.has(C);)C+="_";var z=Z.slice();for(b=0;b<z.length;b++)null===z[b]&&(z[b]=C);g.writeDataSet(String(b),"String",null,z).writeAttribute("missing-value-placeholder","String",null,C)}else g.writeDataSet(String(b),"String",null,Z);else if(x.has("number")){y.push({name:A,type:"number"});var R=a.RJ(Z.length);try{if(E){var F=R.array();for(b=0;b<Z.length;b++)null===Z[b]?F[b]=Number.NaN:F[b]=Z[b]}else R.set(Z);g.writeDataSet(String(b),"Float64",null,R)}finally{R.free()}}else{if(0!=x.size&&!x.has("boolean"))throw new Error("unknown type '"+Array.from(x)[0]+"' for column '"+A+"'");if(y.push({name:A,type:"boolean"}),E){var D=a.Wf(Z.length);try{for(b=0;b<Z.length;b++)null===Z[b]?temparr[b]=-2147483648:temparr[b]=Z[b];g.writeDataSet(String(b),"Int32",null,D)}finally{D.free()}}else{var N=a.TS(Z.length);try{N.fill(Z),g.writeDataSet(String(b),"Uint8",null,N)}finally{N.free()}}}}else if(Z instanceof Uint8Array||Z instanceof i.yh)y.push({name:A,type:"boolean"}),g.writeDataSet(String(b),"Uint8",null,Z);else if(Z instanceof Int32Array||Z instanceof i.do)y.push({name:A,type:"integer"}),g.writeDataSet(String(b),"Int32",null,Z);else if(Z instanceof Float64Array||Z instanceof i.lt)y.push({name:A,type:"number"}),g.writeDataSet(String(b),"Float64",null,Z);else{if(!(Z instanceof s.NE))throw new Error("unknown type for column '"+A+"'");var Q=o(Z,t+"/column"+String(b),{group:l,forceBuffer:f});y.push({name:A,type:"other",resource:{type:"local",path:Q.self.metadata.path}}),Q.self.metadata.is_child=!0,v.push(Q.self);var O,q=(0,r.Z)(Q.children);try{for(q.s();!(O=q.n()).done;){var M=O.value;v.push(M)}}catch(U){q.e(U)}finally{q.f()}}}f&&(p=a.pJ(d),a.Yd(d))}catch(W){throw a.Yd(d),W}return{self:{metadata:h,contents:p},children:v}}i.yh.prototype._bioconductor_LENGTH=function(){return this.length},i.do.prototype._bioconductor_LENGTH=function(){return this.length},i.lt.prototype._bioconductor_LENGTH=function(){return this.length}},7154:function(e,t,n){n.d(t,{I:function(){return u}});var r=n(3324),a=n(7762),i=n(714),s=n(6650);function o(e){var t;if(e instanceof Array){if(t={type:"list",values:[]},e.length){var n,i=!0,u=!0,l=!0,c=(0,a.Z)(e);try{for(c.s();!(n=c.n()).done;){var f=n.value;null!==f&&("string"!==typeof f&&(i=!1),"boolean"!==typeof f&&(u=!1),"number"!==typeof f&&(l=!1))}}catch(y){c.e(y)}finally{c.f()}if(i)t.type="string",t.values=e;else if(u)t.type="boolean",t.values=e;else if(l)t.type="number",t.values=e;else{var h,d=(0,a.Z)(e);try{for(d.s();!(h=d.n()).done;){var p=h.value;t.values.push(o(p))}}catch(y){d.e(y)}finally{d.f()}}}}else if(e.constructor===Object){t={type:"list",values:[],names:[]};for(var v=0,_=Object.entries(e);v<_.length;v++){var m=(0,r.Z)(_[v],2),w=m[0],g=m[1];t.names.push(w),t.values.push(o(g))}}else if(e instanceof Int32Array)t={type:"integer",values:Array.from(e)};else if(e instanceof s.do)t={type:"integer",values:Array.from(e.array())};else if(e instanceof Float64Array)t={type:"number",values:Array.from(e)};else if(e instanceof s.lt)t={type:"number",values:Array.from(e.array())};else if("number"==typeof e)t={type:"number",values:e};else if("string"==typeof e)t={type:"string",values:e};else{if("boolean"!=typeof e)throw new Error("don't know how to save entry of type '"+typeof e+"'");t={type:"boolean",values:e}}return t}function u(e,t){var n=o(e),r=JSON.stringify(n,null,2)+"\n";return{metadata:{$schema:"json_simple_list/v1.json",path:t+"/simple.json.gz",simple_list:{children:[]},json_simple_list:{compression:"gzip"}},contents:i.iv(r)}}},2320:function(e,t,n){n.d(t,{D:function(){return d}});var r=n(4165),a=n(5861),i=n(7762),s=n(3324),o=n(6474),u=n(8408),l=n(9800),c=n(4343),f=n(7154);function h(e,t,n,r,a,l,c,f){var h=e.cell_filtering.fetchDiscards(),d=[];null!==h&&h.forEach((function(e,t){e||d.push(t)}));var p={},v=e.inputs.fetchCellAnnotations();p[n]=null===h?v:o.Nd(v,d);for(var _=p[n].numberOfRows(),m=0,w=Object.keys(t);m<w.length;m++){var g=w[m];g!==n&&(p[g]=new o.NE({},{numberOfRows:_}))}if(e.rna_quality_control.valid()){var y=f?"kana::quality_control":"kana::RNA::quality_control",b=f?"RNA":n,Z=p[b];Z=(Z=(Z=Z.setColumn(y+"::sums",e.cell_filtering.applyFilter(e.rna_quality_control.fetchMetrics().sums({copy:!1})))).setColumn(y+"::detected",e.cell_filtering.applyFilter(e.rna_quality_control.fetchMetrics().detected({copy:!1})))).setColumn(y+"::proportions",e.cell_filtering.applyFilter(e.rna_quality_control.fetchMetrics().subsetProportions(0,{copy:!1}))),p[b]=Z,a[b][y]={filters:{sums:e.rna_quality_control.fetchFilters().thresholdsSums(),detected:e.rna_quality_control.fetchFilters().thresholdsDetected(),proportions:e.rna_quality_control.fetchFilters().thresholdsSubsetProportions(0)}}}if(e.adt_quality_control.valid()){var A=f?"kana::quality_control":"kana::ADT::quality_control",k=f?"ADT":n,x=p[k];x=(x=(x=x.setColumn(A+"::sums",e.cell_filtering.applyFilter(e.adt_quality_control.fetchMetrics().sums({copy:!1})))).setColumn(A+"::detected",e.cell_filtering.applyFilter(e.adt_quality_control.fetchMetrics().detected({copy:!1})))).setColumn(A+"::igg_totals",e.cell_filtering.applyFilter(e.adt_quality_control.fetchMetrics().subsetTotals(0,{copy:!1}))),p[k]=x,a[k][A]={filters:{detected:e.adt_quality_control.fetchFilters().thresholdsDetected(),igg_totals:e.adt_quality_control.fetchFilters().thresholdsSubsetTotals(0)}}}if(e.crispr_quality_control.valid()){var E=f?"kana::quality_control":"kana::CRISPR::quality_control",I=f?"CRISPR":n,S=p[I];S=(S=(S=(S=S.setColumn(E+"::sums",e.cell_filtering.applyFilter(e.crispr_quality_control.fetchMetrics().sums({copy:!1})))).setColumn(E+"::detected",e.cell_filtering.applyFilter(e.crispr_quality_control.fetchMetrics().detected({copy:!1})))).setColumn(E+"::max_proportion",e.cell_filtering.applyFilter(e.crispr_quality_control.fetchMetrics().maxProportions({copy:!1})))).setColumn(E+"::max_index",e.cell_filtering.applyFilter(e.crispr_quality_control.fetchMetrics().maxIndex({copy:!1}))),p[I]=S,a[I][E]={filters:{max_count:e.crispr_quality_control.fetchFilters().thresholdsMaxCount()}}}if(null!==h&&(p[n]=p[n].setColumn("kana::quality_control::retained_indices",d)),e.rna_normalization.valid()){var B=f?"kana::size_factors":"kana::RNA::size_factors",C=f?"RNA":n;p[C]=p[C].setColumn(B,e.rna_normalization.fetchSizeFactors())}if(e.adt_normalization.valid()){var z=f?"kana::size_factors":"kana::ADT::size_factors",R=f?"ADT":n;p[R]=p[R].setColumn(z,e.adt_normalization.fetchSizeFactors())}if(e.crispr_normalization.valid()){var F=f?"kana::size_factors":"kana::CRISPR::size_factors",D=f?"CRISPR":n;p[D]=p[D].setColumn(F,e.crispr_normalization.fetchSizeFactors())}var N=e.choose_clustering.fetchClusters().map((function(e){return e+1}));p[n]=p[n].setColumn("kana::clusters",N);var Q=e.cell_filtering.fetchFilteredBlock();if(null!==Q){var O=new Array(Q.length),q=e.inputs.fetchBlockLevels();Q.forEach((function(e,t){O[t]=q[e]})),p[n]=p[n].setColumn("kana::block",O)}for(var M=e.custom_selections.fetchSelections({copy:!1}),U=p[n].numberOfRows(),W=function(){var e=(0,s.Z)(j[T],2),t=e[0],r=e[1],a=new Uint8Array(U);a.fill(0),r.forEach((function(e){a[e]=1})),p[n]=p[n].setColumn("kana::custom_selections::"+t,a)},T=0,j=Object.entries(M);T<j.length;T++)W();for(var G=0,L=Object.entries(t);G<L.length;G++){var H=(0,s.Z)(L[G],2),Y=H[0],J=H[1],P=u.e(p[Y],J+"coldata",{forceBuffer:c});P.self.metadata.is_child=!0,r[Y].summarized_experiment.column_data.resource.path=P.self.metadata.path,l.push(P.self);var V,X=(0,i.Z)(P.children);try{for(X.s();!(V=X.n()).done;){var K=V.value;l.push(K)}}catch($){X.e($)}finally{X.f()}}}function d(e,t){return p.apply(this,arguments)}function p(){return p=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a,o,d,p,v,_,m,w,g,y,b,Z,A,k,x,E,I,S,B,C,z,R,F,D,N,Q,O,q,M,U,W,T,j,G,L,H,Y,J,P,V,X,K,$,ee,te,ne,re,ae,ie,se,oe,ue,le,ce,fe,he,de,pe,ve,_e,me,we,ge,ye,be,Ze,Ae,ke,xe,Ee,Ie,Se=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(a=Se.length>2&&void 0!==Se[2]?Se[2]:{}).reportOneIndex,d=void 0!==o&&o,p=a.storeModalityColumnData,v=void 0!==p&&p,_=a.forceBuffer,m=void 0!==_&&_,w=t.inputs.fetchFeatureAnnotations(),g=Object.keys(w),(y="RNA")in w){b=[y],Z=(0,i.Z)(g);try{for(Z.s();!(A=Z.n()).done;)(k=A.value)!==y&&b.push(k)}catch(Be){Z.e(Be)}finally{Z.f()}}else y=g[0];for(x=[],E={},I={},S={},B=0,C=g;B<C.length;B++)z=C[B],R=n+"/",z!=y&&(R+="altexp-"+z+"/"),I[z]=R,F=R+"experiment.json",E[z]={$schema:"single_cell_experiment/v1.json",path:F,summarized_experiment:{row_data:{resource:{type:"local",path:null}},column_data:{resource:{type:"local",path:null}},assays:[],other_data:{resource:{type:"local",path:null}}},single_cell_experiment:{alternative_experiments:[],reduced_dimensions:[]}},D=t.cell_filtering.fetchFilteredMatrix().get(z),E[z].summarized_experiment.dimensions=[D.numberOfRows(),D.numberOfColumns()],z==y?E[z].single_cell_experiment.main_experiment_name=z:E[y].single_cell_experiment.alternative_experiments.push({name:z,resource:{type:"local",path:F}}),S[z]={};for(h(t,I,y,E,S,x,m,v),N=t.inputs.fetchFeatureAnnotations(),Q=0,O=Object.entries(I);Q<O.length;Q++){q=(0,s.Z)(O[Q],2),M=q[0],U=q[1],(W=u.e(N[M],U+"rowdata",{forceBuffer:m})).self.metadata.is_child=!0,E[M].summarized_experiment.row_data.resource.path=W.self.metadata.path,x.push(W.self),T=(0,i.Z)(W.children);try{for(T.s();!(j=T.n()).done;)G=j.value,x.push(G)}catch(Be){T.e(Be)}finally{T.f()}}for(L=0,H=Object.entries(I);L<H.length;L++)Y=(0,s.Z)(H[L],2),J=Y[0],P=Y[1],V=t.cell_filtering.fetchFilteredMatrix().get(J),(X=l.C(V,P+"assay-counts",m)).metadata.is_child=!0,E[J].summarized_experiment.assays.push({name:"counts",resource:{type:"local",path:X.metadata.path}}),x.push(X);K=0,$=Object.entries(I);case 15:if(!(K<$.length)){e.next=38;break}ee=(0,s.Z)($[K],2),te=ee[0],ne=ee[1],re=null,e.t0=te,e.next="RNA"===e.t0?21:"ADT"===e.t0?23:"CRISPR"===e.t0?25:27;break;case 21:return re=t.rna_normalization,e.abrupt("break",27);case 23:return re=t.adt_normalization,e.abrupt("break",27);case 25:return re=t.crispr_normalization,e.abrupt("break",27);case 27:if(null!=re){e.next=29;break}return e.abrupt("continue",35);case 29:ae=re.fetchNormalizedMatrix(),ie=re.fetchSizeFactors(),(se=l.h(ae,ie,ne+"assay-logcounts",E[te].summarized_experiment.assays[0].resource.path,m)).metadata.is_child=!0,E[te].summarized_experiment.assays.push({name:"logcounts",resource:{type:"local",path:se.metadata.path}}),x.push(se);case 35:K++,e.next=15;break;case 38:oe=(0,r.Z)().mark((function e(){var n,a,i,o,u,l,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,s.Z)(le[ue],2),a=n[0],i=n[1],o=null,e.t0=a,e.next="RNA"===e.t0?5:"ADT"===e.t0?7:"CRISPR"===e.t0?9:11;break;case 5:return o=t.rna_pca,e.abrupt("break",11);case 7:return o=t.adt_pca,e.abrupt("break",11);case 9:return o=t.crispr_pca,e.abrupt("break",11);case 11:if(null!=o){e.next=13;break}return e.abrupt("return","continue");case 13:u=o.fetchPCs(),(l=c.e(u,i+"reddim-pca",m)).metadata.is_child=!0,x.push(l),f=u.totalVariance(),S[a].pca={variance_explained:u.varianceExplained({copy:"view"}).map((function(e){return e/f}))},E[a].single_cell_experiment.reduced_dimensions.push({name:"PCA",resource:{type:"local",path:l.metadata.path}});case 20:case"end":return e.stop()}}),e)})),ue=0,le=Object.entries(I);case 40:if(!(ue<le.length)){e.next=48;break}return e.delegateYield(oe(),"t1",42);case 42:if("continue"!==e.t1){e.next=45;break}return e.abrupt("continue",45);case 45:ue++,e.next=40;break;case 48:ce=0,fe=["tsne","umap"];case 49:if(!(ce<fe.length)){e.next=61;break}return he=fe[ce],e.next=53,t[he].fetchResults({copy:!1});case 53:de=e.sent,(pe=c.P([de.x,de.y],I[y]+"reddim-"+he,m)).metadata.is_child=!0,E[y].single_cell_experiment.reduced_dimensions.push({name:he.toUpperCase(),resource:{type:"local",path:pe.metadata.path}}),x.push(pe);case 58:ce++,e.next=49;break;case 61:if(ve=t.custom_selections.fetchSelections({copy:!0,force:"Int32Array"}),!d){e.next=70;break}_e=(0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,s.Z)(we[me],2),t[0],(n=t[1]).forEach((function(e,t){n[t]=e+1}));case 2:case"end":return e.stop()}}),e)})),me=0,we=Object.entries(ve);case 65:if(!(me<we.length)){e.next=70;break}return e.delegateYield(_e(),"t2",67);case 67:me++,e.next=65;break;case 70:for(S[y].custom_selections=ve,ge=0,ye=Object.entries(I);ge<ye.length;ge++)be=(0,s.Z)(ye[ge],2),Ze=be[0],Ae=be[1],ke=f.I(S[Ze],Ae+"other"),E[Ze].summarized_experiment.other_data.resource.path=ke.metadata.path,ke.metadata.is_child=!0,x.push(ke);for(xe=0,Ee=g;xe<Ee.length;xe++)(Ie=Ee[xe])!==y&&x.push({metadata:E[Ie]});return e.abrupt("return",{metadata:E[y],files:x});case 74:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}},3842:function(e,t,n){n.d(t,{Jn:function(){return f},io:function(){return c},ok:function(){return u}});var r=n(4165),a=n(7762),i=n(5861),s=n(8109),o=n(5831);function u(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,a.Z)(t),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=12;break}if("contents"in(o=i.value)){e.next=7;break}return e.abrupt("continue",10);case 7:return e.next=9,(0,s.FB)(o.contents);case 9:o.metadata.md5sum=e.sent;case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})))).apply(this,arguments)}function c(e,t){throw new Error("cannot realize files into a directory in a web context")}function f(e){return o.pJ(e)}},9800:function(e,t,n){n.d(t,{C:function(){return a},h:function(){return i}});var r=n(5831);function a(e,t,n){var a=r._u({extension:".h5"}),i=a;try{r.f(e,a,"matrix",{format:"tenx_matrix"}),n&&(i=r.pJ(a),r.Yd(a))}catch(s){throw r.Yd(a),s}return{metadata:{$schema:"hdf5_sparse_matrix/v1.json",path:t+"/matrix.h5",array:{dimensions:[e.numberOfRows(),e.numberOfColumns()],type:"integer"},hdf5_sparse_matrix:{group:"matrix",format:"tenx_matrix"}},contents:i}}function i(e,t,n,a,i){var s=r._u({extension:".h5"}),o=s;try{var u=r.ll(s).createGroup("logcounts");u.writeAttribute("delayed_type","String",null,"operation"),u.writeAttribute("delayed_operation","String",null,"unary arithmetic"),u.writeDataSet("value","Float64",null,Math.log(2)),u.writeDataSet("method","String",null,"/"),u.writeDataSet("side","String",null,"right");var l=u.createGroup("seed");l.writeAttribute("delayed_type","String",null,"operation"),l.writeAttribute("delayed_operation","String",null,"unary math"),l.writeDataSet("method","String",null,"log1p");var c=l.createGroup("seed");c.writeAttribute("delayed_type","String",null,"operation"),c.writeAttribute("delayed_operation","String",null,"unary arithmetic"),c.writeDataSet("value","Float64",null,t),c.writeDataSet("method","String",null,"/"),c.writeDataSet("side","String",null,"right"),c.writeDataSet("along","Int32",null,1);var f=c.createGroup("seed");f.writeAttribute("delayed_type","String",null,"array"),f.writeAttribute("delayed_array","String",null,"custom alabaster local array"),f.writeDataSet("dimensions","Int32",null,[e.numberOfRows(),e.numberOfColumns()]),f.writeDataSet("type","String",null,"FLOAT"),f.writeDataSet("path","String",null,a),i&&(o=r.pJ(s),r.Yd(s))}catch(h){throw r.Yd(s),h}return{metadata:{$schema:"hdf5_delayed_array/v1.json",path:n+"/array.h5",array:{dimensions:[e.numberOfRows(),e.numberOfColumns()],type:"number"},hdf5_delayed_array:{group:"logcounts"}},contents:o}}},9566:function(e,t,n){n.d(t,{bL:function(){return d},lC:function(){return f},o2:function(){return v}});var r=n(3324),a=n(4165),i=n(7762),s=n(5861),o=n(2320),u=n(5148),l=n(3842),c=n(5587);function f(e,t){return h.apply(this,arguments)}function h(){return h=(0,s.Z)((0,a.Z)().mark((function e(t,n){var r,i,s,u,c,f,h,d,p,v,_,m,w=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(r=w.length>2&&void 0!==w[2]?w[2]:{}).reportOneIndex,s=void 0!==i&&i,u=r.storeModalityColumnData,c=void 0!==u&&u,f=r.forceBuffer,h=void 0===f||f,d=r.directory,null!==(p=void 0===d?null:d)&&(h=!1),e.next=4,o.D(t,n,{forceBuffer:h,reportOneIndex:s,storeModalityColumnData:c});case 4:return v=e.sent,_=v.metadata,(m=v.files).push({metadata:_}),m.push({metadata:{$schema:"redirection/v1.json",path:n,redirection:{targets:[{type:"local",location:_.path}]}}}),e.next=11,l.ok(m);case 11:if(h||null===p){e.next=14;break}return e.next=14,l.io(m,p,n);case 14:return e.abrupt("return",m);case 15:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=(0,s.Z)((0,a.Z)().mark((function e(t,n){var i,s,o,c,f,h,d,p,v,_,m,w,g,y,b,Z,A,k,x,E,I=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=(i=I.length>2&&void 0!==I[2]?I[2]:{}).includeMarkerDetection,o=void 0===s||s,c=i.includeCustomSelections,f=void 0===c||c,h=i.includeFeatureSelection,d=void 0===h||h,p=i.forceBuffer,v=void 0===p||p,_=i.directory,m=void 0===_?null:_,w={},g=t.inputs.fetchFeatureAnnotations(),y=0,b=Object.entries(g);y<b.length;y++)Z=(0,r.Z)(b[y],2),A=Z[0],k=Z[1],null===(x=k.rowNames())&&k.numberOfColumns()>0&&(x=k.column(0)),w[A]=x;return null===n?n="":n.endsWith("/")?n=n.replace(/\/+$/,"/"):n+="/",E=[],null!==m&&(v=!1),o&&u.wV(t,w,n,E,v),f&&u.Tx(t,w,n,E,v),t.feature_selection.valid()&&d&&u.oZ(t,w.RNA,n,E,v),e.next=12,l.ok(E);case 12:if(v||null===m){e.next=15;break}return e.next=15,l.io(E,m,n);case 15:return e.abrupt("return",E);case 16:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function v(e){var t,n=new c,r=(0,i.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,s=void 0;"contents"in a?(s=".json",a.contents instanceof Uint8Array?n.file(a.metadata.path,a.contents):n.file(a.metadata.path,l.Jn(a.contents))):s=a.metadata.$schema.startsWith("redirection/")?".json":"",n.file(a.metadata.path+s,JSON.stringify(a.metadata,null,2)+"\n")}}catch(o){r.e(o)}finally{r.f()}return n.generateAsync({type:"uint8array"})}},5148:function(e,t,n){n.d(t,{Tx:function(){return u},oZ:function(){return l},wV:function(){return o}});var r=n(3324),a=n(6474),i=n(8408),s={lfc:"lfc",delta_detected:"deltaDetected",auc:"auc",cohen:"cohen"};function o(e,t,n,o,u){for(var l={min:0,mean:1,min_rank:4},c=e.marker_detection.fetchParameters().compute_auc,f=e.inputs.fetchFeatureAnnotations(),h=0,d=Object.entries(t);h<d.length;h++)for(var p=(0,r.Z)(d[h],2),v=p[0],_=p[1],m=e.marker_detection.fetchResults()[v],w=m.numberOfGroups(),g=f[v].numberOfRows(),y=0;y<w;y++){for(var b=new a.NE({},{numberOfRows:g,rowNames:_}),Z=0,A=["means","detected"];Z<A.length;Z++){var k=A[Z];b.$setColumn(k,m[k](y,{copy:"view"}))}for(var x=0,E=Object.entries(s);x<E.length;x++){var I=(0,r.Z)(E[x],2),S=I[0],B=I[1];if("auc"!=S||c)for(var C=0,z=Object.entries(l);C<z.length;C++){var R=(0,r.Z)(z[C],2),F=R[0],D=R[1];b.$setColumn(S+"-"+F,m[B](y,{summary:D}))}}var N=y+1,Q=i.e(b,n+"marker_detection/"+v+"/"+String(N),{forceBuffer:u});o.push(Q.self)}}function u(e,t,n,o,u){for(var l=e.custom_selections.fetchParameters().compute_auc,c=e.custom_selections.fetchSelections(),f=e.inputs.fetchFeatureAnnotations(),h=0,d=Object.entries(t);h<d.length;h++)for(var p=(0,r.Z)(d[h],2),v=p[0],_=p[1],m=f[v].numberOfRows(),w=0,g=Object.keys(c);w<g.length;w++){for(var y=g[w],b=e.custom_selections.fetchResults(y)[v],Z=new a.NE({},{numberOfRows:m,rowNames:_}),A=0,k=["means","detected"];A<k.length;A++){var x=k[A];Z.$setColumn(x,b[x](1,{copy:"view"}))}for(var E=0,I=Object.entries(s);E<I.length;E++){var S=(0,r.Z)(I[E],2),B=S[0],C=S[1];("auc"!=B||l)&&Z.$setColumn(B,b[C](1,{copy:"view"}))}var z=i.e(Z,n+"custom_selections/"+v+"/"+y,{forceBuffer:u});o.push(z.self)}}function l(e,t,n,r,s){var o=e.feature_selection.fetchResults(),u=new a.NE({mean:o.means({copy:"view"}),variance:o.variances({copy:"view"}),fitted:o.fitted({copy:"view"}),residual:o.residuals({copy:"view"})},{columnOrder:["mean","variance","fitted","residual"],rowNames:t}),l=i.e(u,n+"feature_selection",{forceBuffer:s});r.push(l.self)}},4343:function(e,t,n){n.d(t,{P:function(){return i},e:function(){return a}});var r=n(5831);function a(e,t,n){var a,i=e.numberOfCells(),s=e.numberOfPCs(),o=r._u({extension:".h5"}),u=o,l=r.ll(o);try{a=r.RJ(i*s);for(var c=e.principalComponents({copy:!1}),f=a.array(),h=0;h<i;h++)for(var d=0;d<s;d++)f[h+d*i]=c[d+h*s];l.writeDataSet("data","Float64",[s,i],a),n&&(u=r.pJ(o),r.Yd(o))}catch(p){throw r.Yd(o),p}finally{r.gd(a)}return{metadata:{$schema:"hdf5_dense_array/v1.json",path:t+"/matrix.h5",array:{dimensions:[i,s]},hdf5_dense_array:{dataset:"data"}},contents:u}}function i(e,t,n){var a,i=e[0].length,s=e.length,o=r._u({extension:".h5"}),u=o,l=r.ll(o);try{a=r.RJ(i*s);for(var c=0;c<s;c++){if(e[c].length!==i)throw new Error("all dimensions must have the same length");a.set(e[c],i*c)}l.writeDataSet("data","Float64",[s,i],a),n&&(u=r.pJ(o),r.Yd(o))}catch(f){throw r.Yd(o),f}finally{r.gd(a)}return{metadata:{$schema:"hdf5_dense_array/v1.json",path:t+"/matrix.h5",array:{dimensions:[i,s]},hdf5_dense_array:{dataset:"data"}},contents:u}}},797:function(e,t,n){n.d(t,{$p:function(){return u.$p},By:function(){return s.By},E4:function(){return c.E4},ED:function(){return a.ED},ES:function(){return f.ES},Fl:function(){return s.Fl},H$:function(){return s.H$},J6:function(){return h.J6},JZ:function(){return i.JZ},Qr:function(){return s.Qr},TD:function(){return r.TD},TN:function(){return a.TN},bL:function(){return o.bL},bN:function(){return r.bN},cO:function(){return s.cO},cj:function(){return s.cj},en:function(){return s.en},j2:function(){return p},j5:function(){return i.j5},jJ:function(){return l.jJ},lC:function(){return o.lC},o2:function(){return o.o2},x6:function(){return a.x6}});var r=n(298),a=n(7931),i=n(2453),s=n(4833),o=n(9566),u=n(4071),l=n(818),c=n(652),f=n(4),h=(n(2990),n(8334)),d=(n(2603),n(5831));function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.numberOfThreads,n=void 0===t?1:t,r=e.localFile,a=void 0!==r&&r,i=d.j2({numberOfThreads:n,localFile:a});return u.yc.localFile=a,i.then((function(e){return null}))}},2121:function(e,t,n){n.d(t,{cj:function(){return k}});var r=n(7326),a=n(136),i=n(9388),s=n(101),o=n(3889),u=n(4165),l=n(5861),c=n(5671),f=n(3144),h=n(2346),d=n(8916),p=n(2793),v=n(5173),_=n(5587),m=n(6016),w=new WeakMap,g=new WeakMap,y=function(){function e(t,n){(0,c.Z)(this,e),(0,h.Z)(this,w,{writable:!0,value:void 0}),(0,h.Z)(this,g,{writable:!0,value:void 0}),(0,p.Z)(this,w,t),(0,p.Z)(this,g,null)}return(0,f.Z)(e,[{key:"file",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(0,d.Z)(this,g)){e.next=8;break}return e.t0=p.Z,e.t1=this,e.t2=g,e.next=6,_.loadAsync((0,d.Z)(this,w).buffer());case 6:e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3);case 8:return e.next=10,(0,d.Z)(this,g).file(t).async("uint8array");case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"metadata",value:function(){var e=(0,l.Z)((0,u.Z)().mark((function e(t){var n,r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(0,d.Z)(this,g)){e.next=8;break}return e.t0=p.Z,e.t1=this,e.t2=g,e.next=6,_.loadAsync((0,d.Z)(this,w).buffer());case 6:e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3);case 8:return t.endsWith(".json")||(t+=".json"),e.next=12,(0,d.Z)(this,g).file(t).async("string");case 12:if(n=e.sent,!(r=JSON.parse(n)).$schema.startsWith("redirection/")){e.next=18;break}t=r.redirection.targets[0].location,e.next=19;break;case 18:return e.abrupt("return",r);case 19:e.next=8;break;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clear",value:function(){(0,p.Z)(this,g,null)}}]),e}();var b=new WeakMap,Z=new WeakMap,A=new WeakSet,k=function(e){(0,a.Z)(n,e);var t=(0,i.Z)(n);function n(e,a){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,c.Z)(this,n);var u=null;"existingHandle"in o?(u=o.existingHandle,delete o.existingHandle):a instanceof m.z||(a=new m.z(a));var l=new y(a,u);return i=t.call(this,e,l),(0,s.Z)((0,r.Z)(i),A),(0,h.Z)((0,r.Z)(i),b,{writable:!0,value:void 0}),(0,h.Z)((0,r.Z)(i),Z,{writable:!0,value:void 0}),(0,p.Z)((0,r.Z)(i),b,a),(0,p.Z)((0,r.Z)(i),Z,e),i}return(0,f.Z)(n,[{key:"abbreviate",value:function(){return(0,o.Z)(this,A,x).call(this,(function(e){return{size:e.size(),name:e.name()}}))}},{key:"serialize",value:function(){return(0,o.Z)(this,A,x).call(this,(function(e){return e}))}}],[{key:"format",value:function(){return"ArtifactDB-zipped"}},{key:"unserialize",value:function(e,t){if(1!=e.length||"zip"!=e[0].type)throw new Error("expected exactly one file of type 'zip' for Zipped ArtifactDB unserialization");var r=t.datasetName;delete t.datasetName;var a=new n(r,e[0].file);return a.setOptions(a),a}}]),n}(v.GY);function x(e){var t=[{type:"zip",file:e((0,d.Z)(this,b))}],n=this.options();return n.datasetName=(0,d.Z)(this,Z),{files:t,options:n}}v.Ne},9791:function(e,t,n){n.d(t,{F:function(){return q}});var r=n(4165),a=n(5861),i=n(1413),s=n(5671),o=n(3144),u=n(101),l=n(2346),c=n(3889),f=n(2793),h=n(8916),d=n(3324),p=n(5831),v=n(6474),_=n(6180),m=n(3121),w=n(6016);function g(e,t){var n=[];if("X"in e.children&&n.push("X"),"layers"in e.children){var r=e.open("layers");if(!(r instanceof p.Fv))throw new Error("expected a 'layers' group in a H5AD file");for(var a=0,i=Object.keys(r.children);a<i.length;a++){var s=i[a];n.push("layers/"+s)}}if(0==n.length)throw new Error("failed to find any assay in the H5AD file");var o=p.N6(t,n[0]);return{names:n,rows:o.rows,columns:o.columns}}function y(e){for(var t={},n=function(){var n=(0,d.Z)(a[r],2),i=n[0],s=n[1];if("DataSet"==s){var o=e.open(i,{load:!0});if("Enum"===o.type){var u=o.values,l=new Array(u.length),c=o.levels;u.forEach((function(e,t){l[t]=c[e]})),t[i]=l}else"Other"!==o.type&&(t[i]=o.values)}else if("Group"==s){var f=e.open(i);if("categories"in f.children&&"codes"in f.children){var h=_.vp(f,"categories"),p=f.open("codes",{load:!0}).values;t[i]=v.Nd(h,p)}}},r=0,a=Object.entries(e.children);r<a.length;r++)n();if("__categories"in e.children&&"Group"==e.children.__categories)for(var i=e.open("__categories"),s=0,o=Object.entries(i.children);s<o.length;s++){var u=(0,d.Z)(o[s],2),l=u[0];u[1];if(l in t){var c=_.vp(i,l);t[l]=v.Nd(c,t[l])}}if(0==Object.keys(t).length)return null;var f=null;return"_index"in t&&(f=t._index,delete t._index),new v.NE(t,{rowNames:f})}function b(e){return"var"in e.children&&"Group"==e.children.var?y(e.open("var")):null}function Z(e){return"obs"in e.children&&"Group"==e.children.obs?y(e.open("obs")):null}var A=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakMap,I=new WeakMap,S=new WeakMap,B=new WeakMap,C=new WeakMap,z=new WeakSet,R=new WeakSet,F=new WeakSet,D=new WeakSet,N=new WeakSet,Q=new WeakSet,O=new WeakSet,q=function(){function e(t){(0,s.Z)(this,e),(0,u.Z)(this,O),(0,u.Z)(this,Q),(0,u.Z)(this,N),(0,u.Z)(this,D),(0,u.Z)(this,F),(0,u.Z)(this,R),(0,u.Z)(this,z),(0,l.Z)(this,A,{writable:!0,value:void 0}),(0,l.Z)(this,k,{writable:!0,value:void 0}),(0,l.Z)(this,x,{writable:!0,value:void 0}),(0,l.Z)(this,E,{writable:!0,value:void 0}),(0,l.Z)(this,I,{writable:!0,value:void 0}),(0,l.Z)(this,S,{writable:!0,value:void 0}),(0,l.Z)(this,B,{writable:!0,value:void 0}),(0,l.Z)(this,C,{writable:!0,value:void 0}),t instanceof w.z?(0,f.Z)(this,A,t):(0,f.Z)(this,A,new w.z(t)),(0,f.Z)(this,C,e.defaults()),this.clear()}return(0,o.Z)(e,[{key:"options",value:function(){return(0,i.Z)({},(0,h.Z)(this,C))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,d.Z)(n[t],2),a=r[0],i=r[1];(0,h.Z)(this,C)[a]=i}}},{key:"clear",value:function(){"function"==typeof(0,h.Z)(this,x)&&(0,h.Z)(this,x).call(this),(0,f.Z)(this,x,null),(0,f.Z)(this,k,null),(0,f.Z)(this,E,null),(0,f.Z)(this,I,null),(0,f.Z)(this,S,null),(0,f.Z)(this,B,null)}},{key:"abbreviate",value:function(){return(0,c.Z)(this,z,M).call(this,(function(e){return{name:e.name(),size:e.size()}}))}},{key:"summary",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,D,T).call(this),(0,c.Z)(this,N,j).call(this),(0,c.Z)(this,F,W).call(this);var n={all_features:(0,h.Z)(this,I),cells:(0,h.Z)(this,S),all_assay_names:(0,h.Z)(this,B).names};return t||this.clear(),n}},{key:"previewPrimaryIds",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,D,T).call(this);var n=m.h8((0,h.Z)(this,I),(0,h.Z)(this,C).featureTypeColumnName,(0,c.Z)(this,Q,G).call(this),"RNA",(0,c.Z)(this,O,L).call(this));return t||this.clear(),n}},{key:"load",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,D,T).call(this),(0,c.Z)(this,N,j).call(this),(0,c.Z)(this,F,W).call(this);var n=(0,h.Z)(this,C).countMatrixName;null==n&&(n=(0,h.Z)(this,B).names[0]);var r=p.EF((0,h.Z)(this,k),n),a=m.Bs(r,(0,h.Z)(this,I),(0,h.Z)(this,C).featureTypeColumnName,(0,c.Z)(this,Q,G).call(this),"RNA");return a.cells=(0,h.Z)(this,S),a.primary_ids=m.P2(a.features,(0,c.Z)(this,O,L).call(this)),t||this.clear(),a}},{key:"serialize",value:function(){return(0,c.Z)(this,z,M).call(this,(function(e){return e}))}}],[{key:"defaults",value:function(){return{countMatrixName:null,featureTypeColumnName:null,featureTypeRnaName:"Gene Expression",featureTypeAdtName:"Antibody Capture",featureTypeCrisprName:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:null,primaryAdtFeatureIdColumn:null,primaryCrisprFeatureIdColumn:null}}},{key:"format",value:function(){return"H5AD"}},{key:"unserialize",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n,a){var i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==n.length&&"h5"==n[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'h5' for H5AD unserialization");case 2:return(i=new e(n[0].file)).setOptions(a),t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function M(e){return{files:[{type:"h5",file:e((0,h.Z)(this,A))}],options:this.options()}}function U(){if(null==(0,h.Z)(this,k)){var e=p.$H((0,h.Z)(this,A).content());(0,f.Z)(this,k,e.path),(0,f.Z)(this,x,e.flush),(0,f.Z)(this,E,new p.pT((0,h.Z)(this,k)))}}function W(){null===(0,h.Z)(this,B)&&((0,c.Z)(this,R,U).call(this),(0,f.Z)(this,B,g((0,h.Z)(this,E),(0,h.Z)(this,k))))}function T(){if(null===(0,h.Z)(this,I)){(0,c.Z)(this,R,U).call(this);var e=b((0,h.Z)(this,E));null==e&&((0,c.Z)(this,F,W).call(this),e=new v.NE({},{numberOfRows:(0,h.Z)(this,B).rows})),(0,f.Z)(this,I,e)}}function j(){if(null===(0,h.Z)(this,S)){(0,c.Z)(this,R,U).call(this);var e=Z((0,h.Z)(this,E));null===e&&((0,c.Z)(this,F,W).call(this),e=new v.NE({},{numberOfRows:(0,h.Z)(this,B).columns})),(0,f.Z)(this,S,e)}}function G(){return{RNA:(0,h.Z)(this,C).featureTypeRnaName,ADT:(0,h.Z)(this,C).featureTypeAdtName,CRISPR:(0,h.Z)(this,C).featureTypeCrisprName}}function L(){return{RNA:(0,h.Z)(this,C).primaryRnaFeatureIdColumn,ADT:(0,h.Z)(this,C).primaryAdtFeatureIdColumn,CRISPR:(0,h.Z)(this,C).primaryCrisprFeatureIdColumn}}},4833:function(e,t,n){n.d(t,{By:function(){return r.B},Fl:function(){return a.F},H$:function(){return s.H},Qr:function(){return u.Qr},bw:function(){return u.bw},cO:function(){return c},cj:function(){return o.cj},en:function(){return i.e},zD:function(){return l.z}});var r=n(2152),a=n(9791),i=n(7355),s=n(9380),o=(n(5173),n(2121)),u=n(6180),l=n(6016),c={"10X":r.B,MatrixMarket:i.e,H5AD:a.F,SummarizedExperiment:s.H,"ArtifactDB-zipped":o.cj}},9380:function(e,t,n){n.d(t,{H:function(){return T}});var r=n(4165),a=n(5861),i=n(1413),s=n(5671),o=n(3144),u=n(101),l=n(2346),c=n(3889),f=n(2793),h=n(8916),d=n(3324),p=n(5831),v=n(6474),_=n(6016),m=(n(6180),n(3121));function w(e){var t,n,r=e.findAttribute("names");if(r<0)return null;try{n=(t=e.attribute(r)).values()}catch(a){throw new Error("failed to load listData names; "+a.message)}finally{p.gd(t)}if(n.length!=e.length())throw new Error("expected names to have same length as listData");return n}var g={DFrame:"S4Vectors"};function y(e){Z(e,g,"DFrame");var t,n,r={},a=[];try{if(!((t=e.attribute("listData"))instanceof p.SV))throw new Error("listData slot should be a generic list");if(null==(a=w(t)))throw new Error("expected the listData list to be named");for(var i=function(){var e;try{if((e=t.load(s))instanceof p.qu&&!(e instanceof p.SV)){var n,i,o=e.values();if(e.findAttribute("class")>=0)try{if((n=e.attribute("class")).values().indexOf("factor")>=0&&e.findAttribute("levels")>=0){i=e.attribute("levels");var u=o.slice();u.forEach((function(e,t){u[t]=e-1})),o=v.Nd(i.values(),u)}}finally{p.gd(n),p.gd(i)}r[a[s]]=o}else e instanceof p.BA&&b(e,g)&&(r[a[s]]=y(e))}finally{p.gd(e)}},s=0;s<t.length();s++)i()}catch(f){throw new Error("failed to retrieve data from DataFrame's listData; "+f.message)}finally{p.gd(t)}var o=null;try{(n=e.attribute("rownames"))instanceof p.II&&(o=n.values())}catch(f){throw new Error("failed to retrieve row names from DataFrame; "+f.message)}finally{p.gd(n)}var u,l=null;if(0==a.length&&null==o)try{if(!((u=e.attribute("nrows"))instanceof p.D6))throw new Error("expected an integer vector as the 'nrows' slot");var c=u.values();if(1!=c.length)throw new Error("expected an integer vector of length 1 as the 'nrows' slot");l=c[0]}catch(f){throw new Error("failed to retrieve nrows from DataFrame; "+f.message)}finally{p.gd(u)}return new v.NE(r,{columnOrder:a,rowNames:o,numberOfRows:l})}function b(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var a=(0,d.Z)(r[n],2),i=a[0],s=a[1];if(e.className()==i&&e.packageName()==s)return!0}return!1}function Z(e,t,n){if(!(e instanceof p.BA))throw new Error("expected an S4 object as the data frame");if(!b(e,t))throw new Error("object is not a "+n+" or one of its recognized subclasses")}function A(e){var t,n=e.findAttribute("NAMES");if(n<0)return null;var r=null;try{(t=e.attribute(n))instanceof p.II&&(r=t.values())}catch(a){throw new Error("failed to extract NAMES; "+a.message)}finally{p.gd(t)}return r}function k(e){var t,n=null,r=e.findAttribute("rowRanges");if(r<0){var a;try{t=y(a=e.attribute("elementMetadata"))}catch(c){throw new Error("failed to extract features from the rowData; "+c.message)}finally{p.gd(a)}n=A(e)}else{var i;try{var s=(i=e.attribute(r)).attribute("elementMetadata");try{t=y(s)}catch(c){throw new Error("failed to extract mcols from the rowRanges; "+c.message)}finally{p.gd(s)}var o,u,l=i.findAttribute("partitioning");if(l<0)try{n=A(o=i.attribute("ranges"))}catch(c){throw new Error("failed to extract names from the rowRanges; "+c.message)}finally{p.gd(o)}else try{n=A(u=i.attribute(l))}catch(c){throw new Error("failed to extract names from the rowRanges; "+c.message)}finally{p.gd(u)}}catch(c){throw new Error("failed to extract features from the rowRanges; "+c.message)}finally{p.gd(i)}}return null!==n&&t.$setRowNames(n),t}function x(e){var t,n,r,a;try{null==(t=w(a=(r=(n=e.attribute("assays")).attribute("data")).attribute("listData")))&&(t=new Array(a.length())).fill(null)}catch(i){throw new Error("failed to extract assay data; "+i.message)}finally{p.gd(n),p.gd(a),p.gd(r)}return t}function E(e,t,n){var r,a,i,s;try{s=(i=(a=e.attribute("assays")).attribute("data")).attribute("listData");var o,u=null;if("string"==typeof t){var l=w(s);if(null!==t&&null!=l)for(var c=0;c<l.length;c++)if(l[c]==t){u=c;break}if(null==u)throw new Error("no assay named '"+t+"'")}else{if(t>=s.length())throw new Error("assay index "+String(t)+" out of range");u=t}try{o=s.load(u),r=p.Bp(o,{forceInteger:n})}catch(f){throw new Error("failed to initialize sparse matrix from assay; "+f.message)}finally{p.gd(o)}}catch(f){throw new Error("failed to extract assay data; "+f.message)}finally{p.gd(a),p.gd(s),p.gd(i)}return r}function I(e){var t,n,r,a,i,s,o={handles:{},order:[]},u=e.findAttribute("int_colData");if(u<0)return o;try{var l=(t=e.attribute(u)).findAttribute("listData");if(l<0)return o;var c=(n=t.attribute(l)).findAttribute("names");if(c<0)return o;var f=(r=n.attribute(c)).values().indexOf("altExps");if(f<0)return o;var h=(a=n.load(f)).findAttribute("listData");if(h<0)return o;var d=(i=a.attribute(h)).findAttribute("names");if(d<0)return o;for(var v=(s=i.attribute(d)).values(),_=0;_<v.length;_++){var m=void 0;try{var w=(m=i.load(_)).attribute("se");o.handles[v[_]]=w,o.order.push(v[_]),S(w)}catch(Z){throw new Error("failed to load alternative Experiment '"+v[_]+"'; "+Z.message)}finally{p.gd(m)}}}catch(Z){for(var g=0,y=Object.values(o.handles);g<y.length;g++){var b=y[g];p.gd(b)}throw Z}finally{p.gd(s),p.gd(i),p.gd(r),p.gd(n),p.gd(t)}return o}function S(e){Z(e,{SummarizedExperiment:"SummarizedExperiment",RangedSummarizedExperiment:"SummarizedExperiment",SingleCellExperiment:"SingleCellExperiment",SpatialExperiment:"SpatialExperiment"},"SummarizedExperiment")}var B=new WeakMap,C=new WeakMap,z=new WeakMap,R=new WeakMap,F=new WeakMap,D=new WeakMap,N=new WeakMap,Q=new WeakMap,O=new WeakSet,q=new WeakSet,M=new WeakSet,U=new WeakSet,W=new WeakSet,T=function(){function e(t){(0,s.Z)(this,e),(0,u.Z)(this,W),(0,u.Z)(this,U),(0,u.Z)(this,M),(0,u.Z)(this,q),(0,u.Z)(this,O),(0,l.Z)(this,B,{writable:!0,value:void 0}),(0,l.Z)(this,C,{writable:!0,value:void 0}),(0,l.Z)(this,z,{writable:!0,value:void 0}),(0,l.Z)(this,R,{writable:!0,value:void 0}),(0,l.Z)(this,F,{writable:!0,value:void 0}),(0,l.Z)(this,D,{writable:!0,value:void 0}),(0,l.Z)(this,N,{writable:!0,value:void 0}),(0,l.Z)(this,Q,{writable:!0,value:void 0}),t instanceof _.z?(0,f.Z)(this,B,t):(0,f.Z)(this,B,new _.z(t)),(0,f.Z)(this,Q,e.defaults()),this.clear()}return(0,o.Z)(e,[{key:"options",value:function(){return(0,i.Z)({},(0,h.Z)(this,Q))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,d.Z)(n[t],2),a=r[0],i=r[1];(0,h.Z)(this,Q)[a]=i}}},{key:"clear",value:function(){if(p.gd((0,h.Z)(this,z)),"undefined"!=typeof(0,h.Z)(this,R)&&null!==(0,h.Z)(this,R))for(var e=0,t=Object.values((0,h.Z)(this,R));e<t.length;e++){var n=t[e];p.gd(n)}p.gd((0,h.Z)(this,C)),(0,f.Z)(this,z,null),(0,f.Z)(this,R,null),(0,f.Z)(this,C,null),(0,f.Z)(this,D,null),(0,f.Z)(this,N,null)}},{key:"abbreviate",value:function(){return(0,c.Z)(this,O,j).call(this,(function(e){return{name:e.name(),size:e.size()}}))}},{key:"summary",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,q,G).call(this),(0,c.Z)(this,M,L).call(this),(0,c.Z)(this,U,H).call(this);var n={};n[""]=x((0,h.Z)(this,z));for(var r=0,a=Object.entries((0,h.Z)(this,R));r<a.length;r++){var i=(0,d.Z)(a[r],2),s=i[0],o=i[1];try{n[s]=x(o)}catch(l){console.warn("failed to extract features for alternative Experiment '"+s+"'; "+l.message)}}var u={modality_features:(0,h.Z)(this,D),cells:(0,h.Z)(this,N),modality_assay_names:n};return t||this.clear(),u}},{key:"previewPrimaryIds",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,M,L).call(this);var n={RNA:(0,h.Z)(this,Q).rnaExperiment,ADT:(0,h.Z)(this,Q).adtExperiment,CRISPR:(0,h.Z)(this,Q).crisprExperiment},r=m.it((0,h.Z)(this,D),n,(0,c.Z)(this,W,Y).call(this));return t||this.clear(),r}},{key:"load",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,c.Z)(this,q,G).call(this),(0,c.Z)(this,M,L).call(this),(0,c.Z)(this,U,H).call(this);var n={matrix:new p.VU,row_ids:{},features:{},cells:(0,h.Z)(this,N)},r={RNA:{exp:(0,h.Z)(this,Q).rnaExperiment,assay:(0,h.Z)(this,Q).rnaCountAssay},ADT:{exp:(0,h.Z)(this,Q).adtExperiment,assay:(0,h.Z)(this,Q).adtCountAssay},CRISPR:{exp:(0,h.Z)(this,Q).crisprExperiment,assay:(0,h.Z)(this,Q).crisprCountAssay}};try{for(var a=0,i=Object.entries(r);a<i.length;a++){var s=(0,d.Z)(i[a],2),o=s[0],u=s[1];if(null!==u.exp){var l=void 0,f=u.exp;if("string"==typeof u.exp)if(""===u.exp)l=(0,h.Z)(this,z);else{if(!(u.exp in(0,h.Z)(this,R)))continue;l=(0,h.Z)(this,R)[u.exp]}else{if(u.exp>=(0,h.Z)(this,F).length)continue;f=(0,h.Z)(this,F)[u.exp],l=(0,h.Z)(this,R)[f]}var _=E(l,u.assay,!0);n.matrix.add(o,_.matrix);var w=_.row_ids;n.row_ids[o]=w,n.features[o]=v.Nd((0,h.Z)(this,D)[f],w)}}n.primary_ids=m.P2(n.features,(0,c.Z)(this,W,Y).call(this))}catch(g){throw p.gd(n.matrix),g}return t||this.clear(),n}},{key:"serialize",value:function(){return(0,c.Z)(this,O,j).call(this,(function(e){return e}))}}],[{key:"defaults",value:function(){return{rnaCountAssay:0,adtCountAssay:0,crisprCountAssay:0,rnaExperiment:"",adtExperiment:"Antibody Capture",crisprExperiment:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:null,primaryAdtFeatureIdColumn:null,primaryCrisprFeatureIdColumn:null}}},{key:"format",value:function(){return"SummarizedExperiment"}},{key:"unserialize",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(n,a){var i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==n.length&&"rds"==n[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'rds' for SummarizedExperiment unserialization");case 2:return(i=new e(n[0].file)).setOptions(i),t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function j(e){return{files:[{type:"rds",file:e((0,h.Z)(this,B))}],options:this.options()}}function G(){if(null===(0,h.Z)(this,C)){(0,f.Z)(this,C,p.p$((0,h.Z)(this,B).content())),(0,f.Z)(this,z,(0,h.Z)(this,C).value());try{S((0,h.Z)(this,z));var e=I((0,h.Z)(this,z)),t=e.handles,n=e.order;(0,f.Z)(this,R,t),(0,f.Z)(this,F,n)}catch(r){throw(0,h.Z)(this,z).free(),(0,h.Z)(this,C).free(),r}}}function L(){if(null===(0,h.Z)(this,D)){(0,c.Z)(this,q,G).call(this),(0,f.Z)(this,D,{}),(0,h.Z)(this,D)[""]=k((0,h.Z)(this,z));for(var e=0,t=Object.entries((0,h.Z)(this,R));e<t.length;e++){var n=(0,d.Z)(t[e],2),r=n[0],a=n[1];try{(0,h.Z)(this,D)[r]=k(a)}catch(i){console.warn("failed to extract features for alternative Experiment '"+r+"'; "+i.message)}}}}function H(){if(null===(0,h.Z)(this,N)){(0,c.Z)(this,q,G).call(this);var e=(0,h.Z)(this,z).attribute("colData");try{(0,f.Z)(this,N,y(e))}catch(t){throw new Error("failed to extract colData from a SummarizedExperiment; "+t.message)}finally{p.gd(e)}}}function Y(){return{RNA:(0,h.Z)(this,Q).primaryRnaFeatureIdColumn,ADT:(0,h.Z)(this,Q).primaryAdtFeatureIdColumn,CRISPR:(0,h.Z)(this,Q).primaryCrisprFeatureIdColumn}}},2453:function(e,t,n){n.d(t,{JZ:function(){return p},j5:function(){return _}});var r=n(4165),a=n(7762),i=n(3324),s=n(5861),o=(n(1408),n(4833)),u=n(7931),l=n(8795);function c(e,t){return f.apply(this,arguments)}function f(){return(f=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s,o,u,l,c,f,h,d,p,v,_,m,w,g;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s={},o=0,u=Object.entries(t);case 2:if(!(o<u.length)){e.next=38;break}return l=(0,i.Z)(u[o],2),c=l[0],f=l[1],h=f.constructor.format(),e.next=7,f.serialize();case 7:d=e.sent,p=d.files,v=d.options,_={format:h,options:v,files:[]},m=(0,a.Z)(p),e.prev=12,m.s();case 14:if((w=m.n()).done){e.next=26;break}return g=w.value,e.t0=_.files,e.t1=g.type,e.t2=g.file.name(),e.next=21,n(c,h,g.file);case 21:e.t3=e.sent,e.t4={type:e.t1,name:e.t2,id:e.t3},e.t0.push.call(e.t0,e.t4);case 24:e.next=14;break;case 26:e.next=31;break;case 28:e.prev=28,e.t5=e.catch(12),m.e(e.t5);case 31:return e.prev=31,m.f(),e.finish(31);case 34:s[c]=_;case 35:o++,e.next=2;break;case 38:return e.abrupt("return",s);case 39:case"end":return e.stop()}}),e,null,[[12,28,31,34]])})))).apply(this,arguments)}function h(e,t){return d.apply(this,arguments)}function d(){return(d=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s,u,l,c,f,h,d,p,v,_,m,w,g,y;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s={},u=o.cO,l=0,c=Object.entries(t);case 3:if(!(l<c.length)){e.next=35;break}if(f=(0,i.Z)(c[l],2),h=f[0],(d=f[1]).format in u){e.next=7;break}throw new Error("unknown dataset format '"+d.format+"'");case 7:p=o.cO[d.format],v=[],_=(0,a.Z)(d.files),e.prev=10,_.s();case 12:if((m=_.n()).done){e.next=21;break}return w=m.value,e.next=16,n(w.id);case 16:g=e.sent,y=new o.zD(g,{name:w.name}),v.push({type:w.type,file:y});case 19:e.next=12;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(10),_.e(e.t0);case 26:return e.prev=26,_.f(),e.finish(26);case 29:return e.next=31,p.unserialize(v,d.options);case 31:s[h]=e.sent;case 32:l++,e.next=3;break;case 35:return e.abrupt("return",s);case 36:case"end":return e.stop()}}),e,null,[[10,23,26,29]])})))).apply(this,arguments)}function p(e,t){return v.apply(this,arguments)}function v(){return(v=(0,s.Z)((0,r.Z)().mark((function e(t,n){var a,i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.G8(t),e.next=3,c(t.inputs.fetchDatasets(),n);case 3:return i=e.sent,null!==(s=t.inputs.fetchDirectSubset({copy:!1}))&&(s=Array.from(s)),e.abrupt("return",{version:l.i,parameters:a,datasets:i,other:{inputs:{direct_subset:s},custom_selections:{selections:t.custom_selections.fetchSelections({force:"Array"})}}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return m.apply(this,arguments)}function m(){return m=(0,s.Z)((0,r.Z)().mark((function e(t,n){var a,s,o,l,c,f,d,p,v,_,m,w,g,y=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(a=y.length>2&&void 0!==y[2]?y[2]:{}).state,o=void 0===s?null:s,l=a.startFun,c=void 0===l?null:l,f=a.finishFun,d=void 0===f?null:f,null!==o){e.next=5;break}return e.next=4,u.TN();case 4:o=e.sent;case 5:return"other"in t&&"inputs"in t.other&&"direct_subset"in t.other.inputs&&null!==t.other.inputs.direct_subset&&o.inputs.setDirectSubset(new Int32Array(t.other.inputs.direct_subset)),e.next=8,h(t.datasets,n);case 8:return p=e.sent,e.next=11,u.x6(o,p,t.parameters,{startFun:c,finishFun:d});case 11:if("other"in t&&"custom_selections"in t.other&&"selections"in t.other.custom_selections)for(v=0,_=Object.entries(t.other.custom_selections.selections);v<_.length;v++)m=(0,i.Z)(_[v],2),w=m[0],g=m[1],o.custom_selections.addSelection(w,new Int32Array(g),{copy:!1});return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}},4:function(e,t,n){n.d(t,{ES:function(){return L}});var r=n(101),a=n(3889),i=n(4165),s=n(5671),o=n(3144),u=n(4942),l=n(2346),c=n(8916),f=n(2793),h=n(7762),d=n(1413),p=n(3324),v=n(5861),_=n(5831),m=n(6474),w=n(7891),g=n(4833),y=n(6546),b=(n(7317),"https://github.com/kanaverse/singlepp-references/releases/download/2023-04-28"),Z=w.we;function A(e){var t=Z;return Z=e,t}function k(e,t){return x.apply(this,arguments)}function x(){return(x=(0,v.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t+"_"+n,e.next=3,Z(b+"/"+r);case 3:return a=e.sent,e.abrupt("return",new g.zD(a,{name:r}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E={};function I(e){if("prepared"in e){for(var t=0,n=Object.values(e.prepared);t<n.length;t++){n[t].built.raw.free()}delete e.prepared}}function S(e){return B.apply(this,arguments)}function B(){return(B=(0,v.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.bw(t.content(),{compression:"gz"});case 2:n=e.sent,r=[],a=(0,h.Z)(n);try{for(a.s();!(s=a.n()).done;)o=s.value,u=null,""!==o&&1==(u=o.split("\t")).length&&(u=u[0]),r.push(u)}catch(i){a.e(i)}finally{a.f()}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return z.apply(this,arguments)}function z(){return(z=(0,v.Z)((0,i.Z)().mark((function e(t,n){var r,a,s,o,u,l,c,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="genes_"+n.toLowerCase()+".csv.gz",!(t in E)){e.next=13;break}if(a=E[t],s=a.genes,n in s){e.next=12;break}return e.t0=S,e.next=8,k(t,r);case 8:return e.t1=e.sent,e.next=11,(0,e.t0)(e.t1);case 11:s[n]=e.sent;case 12:return e.abrupt("return",a);case 13:return o=["labels_fine.csv.gz","label_names_fine.csv.gz","markers_fine.gmt.gz","matrix.csv.gz",r],e.next=16,Promise.all(o.map((function(e){return k(t,e)})));case 16:return u=e.sent,e.prev=17,l=_.tY(u[3].buffer(),u[2].buffer(),u[0].buffer()),e.next=21,g.bw(u[1].content(),{compression:"gz"});case 21:return f=e.sent,c={raw:l,labels:f,genes:{}},e.next=25,S(u[4]);case 25:c.genes[n]=e.sent,E[t]=c,e.next=33;break;case 29:throw e.prev=29,e.t2=e.catch(17),w.Yl(l),e.t2;case 33:return e.abrupt("return",c);case 34:case"end":return e.stop()}}),e,null,[[17,29]])})))).apply(this,arguments)}function R(){for(var e=0,t=Object.entries(E);e<t.length;e++){var n=(0,p.Z)(t[e],2),r=n[0];n[1].raw.free(),delete E[r]}}var F={9606:["BlueprintEncode","DatabaseImmuneCellExpression","HumanPrimaryCellAtlas","MonacoImmune","NovershternHematopoietic"],10090:["ImmGen","MouseRNAseq"]};function D(e,t,n){var r,a;try{var i=E[e],s=i.raw;if(!(n in i.genes))throw new Error("unknown gene type '"+n+"'");var o=i.genes[n];a={loaded:i,built:{features:o,raw:r=_.St(t,s,o)}}}catch(u){throw w.Yl(r),u}return a}function N(e,t,n,r,a,i,s,o,u){return Q.apply(this,arguments)}function Q(){return(Q=(0,v.Z)((0,i.Z)().mark((function e(t,n,r,a,s,o,u,l,c){var f,d,p,v,m,g,y,b,Z,A,k,x,E,S,B,z,R,N,Q;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r===u.automatic&&!w.xi(n,u.references)&&(r||a===u.species&&s===u.gene_id_column&&o===u.gene_id_type)){e.next=39;break}f=a,d=s,p=o,r&&(v=L.configureFeatureParameters(c()),f=v.species,d=v.gene_id_column,p=v.gene_id_type),m=new Set,g=(0,h.Z)(f);try{for(g.s();!(y=g.n()).done;)(b=y.value)in F&&F[b].forEach((function(e){m.add(e)}))}catch(i){g.e(i)}finally{g.f()}if(Z=l(),A=null==d?Z.rowNames():Z.column(d),t.gene_ids=A,k={},null===A){e.next=33;break}null==n&&(n=Array.from(m)),x=(0,h.Z)(n),e.prev=15,x.s();case 17:if((E=x.n()).done){e.next=25;break}if(S=E.value,!m.has(S)){e.next=23;break}return e.next=22,C(S,p);case 22:k[S]=D(S,A,p);case 23:e.next=17;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(15),x.e(e.t0);case 30:return e.prev=30,x.f(),e.finish(30);case 33:return I(t),t.prepared=k,(B=Object.keys(k)).length>1?(z=Object.values(k),R=z.map((function(e){return e.loaded.raw})),N=z.map((function(e){return e.built.features})),Q=z.map((function(e){return e.built.raw})),w.Yl(t.integrated),t.integrated=_.Qj(A,R,N,Q)):(w.Yl(t.integrated),delete t.integrated),t.used_refs=B,e.abrupt("return",!0);case 39:return e.abrupt("return",!1);case 40:case"end":return e.stop()}}),e,null,[[15,27,30,33]])})))).apply(this,arguments)}function O(e,t,n,r,a,i){i.references=m.bl(e),i.automatic=t,i.species=m.bl(n),i.gene_id_column=r,i.gene_id_type=a}function q(e){var t=(0,d.Z)({},e);return t.references=m.bl(t.references),t.species=m.bl(t.species),t}function M(e,t,n){for(var r=t.numberOfCells(),a=e.length,i=new Array(r),s=0;s<r;s++){for(var o={},u=t.scoresForCell(s),l=0;l<a;l++)o[e[l]]=u[l];i[s]={best:e[n[s]],all:o}}return i}function U(e,t){var n,r,a=e;if(e instanceof _.OV){var i=e.numberOfGroups();if(null===t.gene_ids)a=null;else{var s=t.gene_ids.length;n=_.RJ(i*s);for(var o=0;o<i;o++){var u=e.means(o,{copy:!1});if(u.length!==s)throw new Error("unexpected number of genes in marker results");n.array().set(u,o*s)}a=r=_.o1.createDenseMatrix(s,i,n,{columnMajor:!0,copy:!1})}}else if(null!==t.gene_ids&&e.numberOfRows()!==t.gene_ids.length)throw new Error("unexpected number of genes in the input matrix");for(var l=t.prepared,c={per_reference:{}},f={},d=0,v=Object.entries(l);d<v.length;d++){var m=(0,p.Z)(v[d],2),g=m[0],y=m[1],b=_.pG(a,y.built.raw);f[g]=b,c.per_reference[g]=M(y.loaded.labels,b,b.predictedLabels({copy:!1}))}if("integrated"in t){var Z,A=[],k=(0,h.Z)(t.used_refs);try{for(k.s();!(Z=k.n()).done;){var x=Z.value;A.push(f[x])}}catch(B){k.e(B)}finally{k.f()}var E=_.Os(a,A,t.integrated);c.integrated=M(t.used_refs,E,E.predictedReferences({copy:!1})),E.free()}for(var I=0,S=Object.values(f);I<S.length;I++){S[I].free()}return w.Yl(r),w.Yl(n),c}function W(e,t,n){if(null===t)return U(e,n);var r,a=[];try{var i=w.XZ([t]);a.push(i.arrays[0].ids);var s=e;if(null!==i.retain){var o=_.ZW(e,i.retain);a.push(o),s=o}var u=_.p4(s,i.arrays[0].ids,{average:!0});a.push(u);var l=_.o1.createDenseMatrix(s.numberOfRows(),u.numberOfGroups(),u.sums(null,{copy:"view"}),{columnMajor:!0,copy:!1});a.push(l),(r=U(l,n)).groups=i.arrays[0].levels}finally{a.forEach(w.Yl)}return r}var T=new WeakMap,j=new WeakMap,G=new WeakMap,L=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,s.Z)(this,e),(0,l.Z)(this,T,{writable:!0,value:void 0}),(0,l.Z)(this,j,{writable:!0,value:void 0}),(0,l.Z)(this,G,{writable:!0,value:void 0}),!(t instanceof y.tq))throw new Error("'inputs' should be a State object from './inputs.js'");(0,f.Z)(this,T,t),(0,f.Z)(this,j,null===n?{}:n),(0,f.Z)(this,G,null===r?{}:r),this.changed=!1}return(0,o.Z)(e,[{key:"free",value:function(){I((0,c.Z)(this,G))}},{key:"valid",value:function(){return(0,c.Z)(this,T).fetchCountMatrix().has("RNA")}},{key:"fetchParameters",value:function(){return q((0,c.Z)(this,j))}},{key:"fetchNumberOfSharedFeatures",value:function(){var e,t={},n=(0,h.Z)((0,c.Z)(this,G).used_refs);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=(0,c.Z)(this,G).prepared[r].built.raw.sharedFeatures()}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"compute",value:function(){var t=(0,v.Z)((0,i.Z)().mark((function t(n){var r,a,s,o,u,l,f=this;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("references"in n?(r=n.references,a=n.automatic,s=n.species,o=n.gene_id_column,u=n.gene_id_type):(r=null,a=!0,l=e.defaults(),s=l.species,o=l.gene_id_column,u=l.gene_id_type),this.changed=!1,!this.valid()){t.next=6;break}return t.next=5,N((0,c.Z)(this,G),r,a,s,o,u,(0,c.Z)(this,j),(function(){return(0,c.Z)(f,T).fetchFeatureAnnotations().RNA}),(function(){return(0,c.Z)(f,T).guessRnaFeatureTypes()}));case 5:this.changed=t.sent;case 6:O(r,a,s,o,u,(0,c.Z)(this,j));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"computeLabels",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).group;return W(e,void 0===t?null:t,(0,c.Z)(this,G))}}],[{key:"defaults",value:function(){return{references:null,automatic:!0,species:[],gene_id_column:null,gene_id_type:"ENSEMBL"}}},{key:"configureFeatureParameters",value:function(e){var t=null,n={type:"symbol",species:"human",confidence:0};if("row_names"in e){var r=e.row_names;r.confidence>n.confidence&&(n=r)}for(var a=0,i=Object.entries(e.columns);a<i.length;a++){var s=(0,p.Z)(i[a],2),o=s[0],u=s[1];u.confidence>n.confidence&&(n=u,t=o)}return{gene_id_column:t,species:[n.species],gene_id_type:n.type.toUpperCase()}}},{key:"flush",value:function(){R()}},{key:"setDownload",value:function(e){return A(e)}}]),e}();(0,u.Z)(L,"availableReferences",F);var H=new WeakMap,Y=new WeakMap,J=new WeakMap,P=new WeakMap,V=new WeakMap,X=new WeakSet,K=function(){function e(t){(0,s.Z)(this,e),(0,r.Z)(this,X),(0,l.Z)(this,H,{writable:!0,value:void 0}),(0,l.Z)(this,Y,{writable:!0,value:void 0}),(0,l.Z)(this,J,{writable:!0,value:void 0}),(0,l.Z)(this,P,{writable:!0,value:void 0}),(0,l.Z)(this,V,{writable:!0,value:void 0}),(0,f.Z)(this,H,{}),(0,f.Z)(this,V,e.defaults()),(0,f.Z)(this,J,t),(0,f.Z)(this,Y,{}),(0,f.Z)(this,P,null)}return(0,o.Z)(e,[{key:"free",value:function(){I((0,c.Z)(this,Y))}},{key:"fetchParameters",value:function(){return q((0,c.Z)(this,V))}},{key:"setParameters",value:function(){var e=(0,v.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.references,r=t.automatic,a=t.species,s=t.gene_id_column,o=t.gene_id_type,O(n,r,a,s,o,(0,c.Z)(this,V));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"ready",value:function(){var e=(0,v.Z)((0,i.Z)().mark((function e(){var t,n,r,s,o,u,l=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.Z)(this,V),n=t.references,r=t.automatic,s=t.species,o=t.gene_id_column,u=t.gene_id_type,e.next=3,N((0,c.Z)(this,Y),n,r,s,o,u,(0,c.Z)(this,H),(function(){return(0,c.Z)(l,J)}),(function(){return(0,a.Z)(l,X,$).call(l)}));case 3:(0,f.Z)(this,H,(0,c.Z)(this,V));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"computeLabels",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).group;return W(e,void 0===t?null:t,(0,c.Z)(this,Y))}}],[{key:"defaults",value:function(){return{references:null,automatic:!0,species:[],gene_id_column:null,gene_id_type:"ENSEMBL"}}},{key:"flush",value:function(){R()}},{key:"setDownload",value:function(e){return A(e)}}]),e}();function $(){return null==(0,c.Z)(this,P)&&(0,f.Z)(this,P,w.zS((0,c.Z)(this,J))),(0,c.Z)(this,P)}(0,u.Z)(K,"availableReferences",F)},2603:function(e,t,n){n.d(t,{Cy:function(){return g},kd:function(){return S}});var r=n(2346),a=n(8916),i=n(2793),s=n(3324),o=n(7762),u=n(5671),l=n(3144),c=n(101),f=n(3889),h=n(5831),d=n(7891),p=n(818),v=n(2269),_=n(7317),m=n(8366),w=n(2615),g="custom_selections",y=new WeakSet,b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,u.Z)(this,e),(0,c.Z)(this,y),this._selections=null==t?{}:t,this._cache=null==n?{results:{}}:n}return(0,l.Z)(e,[{key:"free",value:function(){d.Yl(this._cache.buffer),delete this._cache.buffer;for(var e=0,t=Object.keys(this._cache.results);e<t.length;e++){var n=t[e];(0,f.Z)(this,y,Z).call(this,n)}this._cache.results={},p.eo(this._cache.versus),delete this._cache.versus}},{key:"addSelection",value:function(e,t,n,r,a,i,s,u){var l=r(n[0]).numberOfColumns();d.N2(t,l);var c=d.rS(l,"Int32Array",this._cache);c.fill(0);var p=c.array();t.forEach((function(e){p[e]=1}));var v,_={},m=(0,o.Z)(n);try{for(m.s();!(v=m.n()).done;){var w=v.value,g=r(w);_[w]=h.y5(g,c,{block:a,lfcThreshold:s,computeAuc:u})}}catch(b){m.e(b)}finally{m.f()}e in this._cache.results&&(0,f.Z)(this,y,Z).call(this,e),this._cache.results[e]={raw:_},i&&(t=t.slice()),this._selections[e]=t}},{key:"removeSelection",value:function(e){(0,f.Z)(this,y,Z).call(this,e),delete this._cache.results[e],delete this._selections[e]}},{key:"fetchResults",value:function(e){return this._cache.results[e].raw}},{key:"fetchSelectionIndices",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).copy,n=void 0===t||t,r=this._selections[e];return n&&(r=r.slice()),r}},{key:"fetchSelections",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,n=void 0===t||t,r=e.force,a=void 0===r?null:r,i={},o=0,u=Object.entries(this._selections);o<u.length;o++){var l=(0,s.Z)(u[o],2),c=l[0],f=l[1],h=f,d=n;null!==a&&("Array"==a?f instanceof Array||(h=Array.from(f),d=!1):"Int32Array"==a&&(f instanceof Int32Array||(h=new Int32Array(f),d=!1))),d&&(h=h.slice()),i[c]=h}return i}},{key:"computeVersus",value:function(e,t,n,r,a,i,s){"versus"in this._cache||(this._cache.versus={});var u=this._cache.versus,l=p.Bh(e,t,u),c=l.left_small?0:1,f=l.left_small?1:0;if(l.run){var d,v=new h.VU,_=(0,o.Z)(n);try{for(_.s();!(d=_.n()).done;){var m=d.value;v.add(m,r(m))}}catch(k){_.e(k)}finally{_.f()}var w=this._selections;if(!(e in w)||!(t in w))throw new Error("invalid selection ID requested in versus mode");var g=w[e],y=w[t];if(0==g.length||0==y.length)throw new Error("non-zero entries should be present for both requested selections in versus mode");var b=[];g.forEach((function(e){b.push({index:e,cluster:c})})),y.forEach((function(e){b.push({index:e,cluster:f})})),b.sort((function(e,t){return e.index-t.index}));var Z=b.map((function(e){return e.index})),A=b.map((function(e){return e.cluster}));p.c9(v,A,a,Z,l.cached,i,s)}return{results:l.cached,left:c,right:f}}}]),e}();function Z(e){for(var t=0,n=Object.entries(this._cache.results[e].raw);t<n.length;t++){var r=(0,s.Z)(n[t],2);r[0];r[1].free()}}var A=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakMap,I=new WeakSet,S=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,u.Z)(this,e),(0,c.Z)(this,I),(0,r.Z)(this,A,{writable:!0,value:void 0}),(0,r.Z)(this,k,{writable:!0,value:void 0}),(0,r.Z)(this,x,{writable:!0,value:void 0}),(0,r.Z)(this,E,{writable:!0,value:void 0}),!(t instanceof v.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,i.Z)(this,A,t),!(n.RNA instanceof _.ue))throw new Error("'norm_states.RNA' should be an RnaNormalizationState object");if(!(n.ADT instanceof m.m5))throw new Error("'norm_states.ADT' should be an AdtNormalizationState object");if(!(n.CRISPR instanceof w.$M))throw new Error("'norm_states.CRISPR' should be an CrisprNormalizationState object");(0,i.Z)(this,k,n);var o=null;null!==a&&"selections"in a&&(o=a.selections),(0,i.Z)(this,x,new b(o,s)),(0,i.Z)(this,E,{}),this.changed=!1}return(0,l.Z)(e,[{key:"free",value:function(){(0,a.Z)(this,x).free()}},{key:"fetchParameters",value:function(){return{lfc_threshold:(0,a.Z)(this,E).lfc_threshold,compute_auc:(0,a.Z)(this,E).compute_auc}}},{key:"addSelection",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).copy,r=void 0===n||n;(0,f.Z)(this,I,B).call(this,e,t,r,(0,a.Z)(this,E).lfc_threshold,(0,a.Z)(this,E).compute_auc)}},{key:"removeSelection",value:function(e){(0,a.Z)(this,x).removeSelection(e)}},{key:"fetchResults",value:function(e){return(0,a.Z)(this,x).fetchResults(e)}},{key:"fetchSelectionIndices",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).copy,n=void 0===t||t;return(0,a.Z)(this,x).fetchSelectionIndices(e,{copy:n})}},{key:"fetchSelections",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copy,n=void 0===t||t,r=e.force,i=void 0===r?null:r;return(0,a.Z)(this,x).fetchSelections({copy:n,force:i})}},{key:"compute",value:function(e){var t=e.lfc_threshold,n=e.compute_auc;if(this.changed=!1,(0,a.Z)(this,A).changed&&((0,a.Z)(this,x).free(),(0,i.Z)(this,x,new b),this.changed=!0),t!==(0,a.Z)(this,E).lfc_threshold||n!=(0,a.Z)(this,E).compute_auc){for(var r=0,o=Object.entries((0,a.Z)(this,x)._selections);r<o.length;r++){var u=(0,s.Z)(o[r],2),l=u[0],c=u[1];(0,f.Z)(this,I,B).call(this,l,c,!1,t,n)}(0,a.Z)(this,E).lfc_threshold=t,(0,a.Z)(this,E).compute_auc=n,this.changed=!0}}},{key:"computeVersus",value:function(e,t){var n=this,r=d.Mc((0,a.Z)(this,k));return(0,a.Z)(this,x).computeVersus(e,t,r,(function(e){return(0,a.Z)(n,k)[e].fetchNormalizedMatrix()}),(0,a.Z)(this,A).fetchFilteredBlock(),(0,a.Z)(this,E).lfc_threshold,(0,a.Z)(this,E).compute_auc)}}],[{key:"defaults",value:function(){return{lfc_threshold:0,compute_auc:!0}}}]),e}();function B(e,t,n,r,i){var s=this,o=d.Mc((0,a.Z)(this,k));(0,a.Z)(this,x).addSelection(e,t,o,(function(e){return(0,a.Z)(s,k)[e].fetchNormalizedMatrix()}),(0,a.Z)(this,A).fetchFilteredBlock(),n,r,i)}},2990:function(e,t,n){n.d(t,{Cy:function(){return A},ii:function(){return O}});var r=n(7762),a=n(1413),i=n(3324),s=n(4165),o=n(5861),u=n(5671),l=n(3144),c=n(101),f=n(2346),h=n(3889),d=n(8916),p=n(2793),v=n(5831),_=n(6474),m=n(7325),w=n(7891),g=n(818),y=(n(4833),n(6546)),b=n(2269),Z=n(7317),A=(n(8334),"feature_set_enrichment"),k=new WeakMap,x=new WeakSet,E=function(){function e(){(0,u.Z)(this,e),(0,c.Z)(this,x),(0,f.Z)(this,k,{writable:!0,value:void 0}),(0,p.Z)(this,k,{})}return(0,l.Z)(e,[{key:"free",value:function(){w.Yl((0,d.Z)(this,k).set_buffer),(0,p.Z)(this,k,{})}},{key:"buildCollections",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t,n,r,a,i,o,u){var l,c,f,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===t.automatic&&(n||t.gene_id_column===a&&t.gene_id_type===i&&!w.xi(t.species,r))){e.next=8;break}return l=a,c=i,f=r,n&&(d=B(u()),l=d.gene_id_column,c=d.gene_id_type,f=d.species),e.next=7,(0,h.Z)(this,x,I).call(this,o(),f,l,c);case 7:return e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,s,o){return e.apply(this,arguments)}}()},{key:"fetchCollectionDetails",value:function(){return(0,d.Z)(this,k).collections}},{key:"fetchSetDetails",value:function(){return{names:(0,d.Z)(this,k).sets.names,descriptions:(0,d.Z)(this,k).sets.descriptions,sizes:(0,d.Z)(this,k).sets.sizes,collections:(0,d.Z)(this,k).sets.collections}}},{key:"fetchUniverseSize",value:function(){return(0,d.Z)(this,k).universe.length}},{key:"computeEnrichment",value:function(e,t,n,r,a){var i=this;"delta_detected"==t&&(t="deltaDetected");var s="auc"==t?.5:0,o="min_rank"!==t,u=g.iG[n],l=r[t](e,{summary:u,copy:!1}),c=_.Nd(l,(0,d.Z)(this,k).universe),f=v.Y8(c,a,{largest:o}),h=[],p=function(e){var t=(0,d.Z)(i,k).universe[e];h.push((0,d.Z)(i,k).mapping_to_sets[t])};o?(f<s&&(f=s),c.forEach((function(e,t){e>=f&&p(t)}))):c.forEach((function(e,t){e<=f&&p(t)}));for(var w=m.or(h),y=new Int32Array(w.length),b=new Int32Array(w.length),Z=new Int32Array(w.length),A=new Int32Array(w.length),x=0;x<w.length;x++){A[x]=x;var E=w[x];y[x]=E.id,b[x]=E.count,Z[x]=(0,d.Z)(this,k).sets.sizes[E.id]}var I=h.length,S=v.xw(b,I,Z,(0,d.Z)(this,k).universe.length);return A.sort((function(e,t){return S[e]-S[t]})),{set_ids:_.Nd(y,A),counts:_.Nd(b,A),pvalues:_.Nd(S,A),num_markers:I}}},{key:"fetchFeatureSetIndices",value:function(e){return(0,d.Z)(this,k).sets.sets[e]}},{key:"computePerCellScores",value:function(e,t,n){var r=this.fetchFeatureSetIndices(e),a=w.rS(t.numberOfRows(),"Uint8Array",(0,d.Z)(this,k),"set_buffer");a.fill(0);var i=a.array();return r.forEach((function(e){i[e]=1})),v.Bs(t,a,{block:n})}}],[{key:"flush",value:function(){}},{key:"setDownload",value:function(e){console.warn("'FeatureSetState.setDownload' is a no-op, uses 'gesel.setReferenceDownload' and 'gesel.setGeneDownload' instead")}}]),e}();function I(e,t,n,r){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)((0,s.Z)().mark((function e(t,n,a,i){var o,u,l,c,f,h,p,v,w,g,y,b,Z,A,x,E,I,S,B,C,z,R,F,D,N,Q,O,q,M,U,W,T,j,G,L,H,Y,J;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(null==a?null==(o=t.rowNames())&&(n=[]):o=t.column(a),u={types:[i.toLowerCase()]},l=0,c=[[]],f=[[]],h=[[]],p=0,v=[[]],w=[[]],g=[[]],y=[new Int32Array],b=[new Int32Array],Z=new Set,A=new Array(t.numberOfRows()),x=0;x<A.length;x++)A[x]=[];E=(0,r.Z)(n),e.prev=16,E.s();case 18:if((I=E.n()).done){e.next=62;break}return S=I.value,e.next=22,m.XW(S,o,u);case 22:for(B=e.sent,C=0;C<B.length;C++)B[C].length>0&&Z.add(C);return e.next=26,m.Uy(S);case 26:return z=e.sent,R=m.$g(B,z),e.next=30,m.bj(S);case 30:for(F=e.sent,D=F.length,N=new Array(D),Q=new Array(D),O=new Int32Array(D),q=new Int32Array(D),C=0;C<D;C++)M=F[C],N[C]=M.name,Q[C]=M.description,q[C]=M.collection+l,O[C]=R[C].length;return v.push(N),w.push(Q),g.push(R),y.push(O),b.push(q),e.next=44,m.RR(S);case 44:for(U=e.sent,W=m.wy(B,U),C=0;C<B.length;C++){for(T=W[C],j=0;j<T.length;j++)T[j]+=p;A[C].push(T)}return e.next=49,m.is(S);case 49:for(G=e.sent,L=G.length,H=new Array(L),Y=new Array(L),J=new Array(L),C=0;C<L;C++)H[C]=G[C].title,Y[C]=G[C].description,J[C]=S;c.push(H),f.push(Y),h.push(J),p+=D,l+=L;case 60:e.next=18;break;case 62:e.next=67;break;case 64:e.prev=64,e.t0=e.catch(16),E.e(e.t0);case 67:return e.prev=67,E.f(),e.finish(67);case 70:if((0,d.Z)(this,k).universe=new Int32Array(Z).sort(),(0,d.Z)(this,k).sets={names:_.NR(v),descriptions:_.NR(w),sets:_.NR(g),sizes:_.NR(y),collections:_.NR(b)},(0,d.Z)(this,k).collections={names:_.NR(c),descriptions:_.NR(f),species:_.NR(h)},n.length>0)for(x=0;x<A.length;x++)A[x]=_.NR(A[x]);else for(x=0;x<A.length;x++)A[x]=new Uint32Array;return(0,d.Z)(this,k).mapping_to_sets=A,e.abrupt("return");case 76:case"end":return e.stop()}}),e,this,[[16,64,67,70]])})))).apply(this,arguments)}function B(e){var t=null,n={type:"symbol",species:"human",confidence:0};if("row_names"in e){var r=e.row_names;r.confidence>n.confidence&&(n=r)}for(var a=0,s=Object.entries(e.columns);a<s.length;a++){var o=(0,i.Z)(s[a],2),u=o[0],l=o[1];l.confidence>n.confidence&&(n=l,t=u)}return{gene_id_column:t,gene_id_type:n.type.toUpperCase(),species:[n.species]}}function C(e,t,n,r,a,i){e.automatic=t,e.species=_.bl(n),e.gene_id_column=r,e.gene_id_type=a,e.top_markers=i}function z(e){var t=(0,a.Z)({},e);return t.species=_.bl(t.species),t}var R=new WeakMap,F=new WeakMap,D=new WeakMap,N=new WeakMap,Q=new WeakMap,O=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,u.Z)(this,e),(0,f.Z)(this,R,{writable:!0,value:void 0}),(0,f.Z)(this,F,{writable:!0,value:void 0}),(0,f.Z)(this,D,{writable:!0,value:void 0}),(0,f.Z)(this,N,{writable:!0,value:void 0}),(0,f.Z)(this,Q,{writable:!0,value:void 0}),!(t instanceof y.tq))throw new Error("'inputs' should be a State object from './inputs.js'");if((0,p.Z)(this,R,t),!(n instanceof b.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,p.Z)(this,F,n),!(r instanceof Z.ue))throw new Error("'normalized' should be a RnaNormalizationState object from './rna_normalization.js'");(0,p.Z)(this,D,r),(0,p.Z)(this,N,null===i?{}:i),(0,p.Z)(this,Q,new E),this.changed=!1}return(0,l.Z)(e,[{key:"free",value:function(){(0,d.Z)(this,Q).free()}},{key:"valid",value:function(){return(0,d.Z)(this,R).fetchCountMatrix().has("RNA")}},{key:"fetchCollectionDetails",value:function(){return(0,d.Z)(this,Q).fetchCollectionDetails()}},{key:"fetchSetDetails",value:function(){return(0,d.Z)(this,Q).fetchSetDetails()}},{key:"fetchUniverseSize",value:function(){return(0,d.Z)(this,Q).fetchUniverseSize()}},{key:"computeEnrichment",value:function(e,t,n,r){return(0,d.Z)(this,Q).computeEnrichment(t,n,r,e,(0,d.Z)(this,N).top_markers)}},{key:"fetchFeatureSetIndices",value:function(e){return(0,d.Z)(this,Q).fetchFeatureSetIndices(e)}},{key:"computePerCellScores",value:function(e){return(0,d.Z)(this,Q).computePerCellScores(e,(0,d.Z)(this,D).fetchNormalizedMatrix(),(0,d.Z)(this,F).fetchFilteredBlock())}},{key:"fetchPerCellScores",value:function(e,t){return this.computePerCellScores(e,t)}},{key:"fetchParameters",value:function(){return z((0,d.Z)(this,N))}},{key:"compute",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var n,r,a,i,o,u,l=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.changed=!1,(0,d.Z)(this,R).changed&&(this.changed=!0),n=t.skip,r=t.automatic,a=t.species,i=t.gene_id_column,o=t.gene_id_type,u=t.top_markers,n!==(0,d.Z)(this,N).skip&&(this.changed=!0),!this.valid()||n){e.next=11;break}return this.changed&&(0,p.Z)(this,N,{}),e.next=8,(0,d.Z)(this,Q).buildCollections((0,d.Z)(this,N),r,a,i,o,(function(){return(0,d.Z)(l,R).fetchFeatureAnnotations().RNA}),(function(){return(0,d.Z)(l,R).guessRnaFeatureTypes()}));case 8:e.sent&&(this.changed=!0),u!==(0,d.Z)(this,N).top_markers&&(this.changed=!0);case 11:return C((0,d.Z)(this,N),r,a,i,o,u),(0,d.Z)(this,N).skip=n,e.abrupt("return");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{skip:!1,automatic:!0,species:[],gene_id_column:null,gene_id_type:"ENSEMBL",top_markers:100}}},{key:"flush",value:function(){}},{key:"setDownload",value:function(e){return E.setDownload(e)}}]),e}()},6546:function(e,t,n){n.d(t,{Cy:function(){return g},ED:function(){return T},tq:function(){return E}});var r=n(7762),a=n(4165),i=n(3324),s=n(5861),o=n(1413),u=n(5671),l=n(3144),c=n(101),f=n(2346),h=n(3889),d=n(2415),p=n(8916),v=n(2793),_=n(5831),m=n(6474),w=n(7891),g=(n(4833),"inputs"),y="raw_subset_indices",b=new WeakMap,Z=new WeakMap,A=new WeakMap,k=new WeakMap,x=new WeakSet,E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,u.Z)(this,e),(0,c.Z)(this,x),(0,f.Z)(this,b,{writable:!0,value:void 0}),(0,f.Z)(this,Z,{writable:!0,value:void 0}),(0,f.Z)(this,A,{writable:!0,value:void 0}),(0,f.Z)(this,k,{writable:!0,value:void 0}),(0,v.Z)(this,b,null===t?{}:t),(0,v.Z)(this,Z,null===n?{}:n),(0,v.Z)(this,A,null===r?{}:r),(0,v.Z)(this,k,!1),this.changed=!1}return(0,l.Z)(e,[{key:"free",value:function(){w.Yl((0,p.Z)(this,Z).matrix),w.Yl((0,p.Z)(this,Z).raw_matrix),w.Yl((0,p.Z)(this,Z).block_ids),w.Yl((0,p.Z)(this,Z).raw_block_ids),w.Yl((0,p.Z)(this,Z).multi_block_ids)}},{key:"fetchCountMatrix",value:function(){return(0,p.Z)(this,Z).matrix}},{key:"fetchFeatureAnnotations",value:function(){return(0,p.Z)(this,Z).genes}},{key:"fetchRowIds",value:function(){return(0,p.Z)(this,Z).row_ids}},{key:"fetchCellAnnotations",value:function(){return(0,p.Z)(this,Z).annotations}},{key:"fetchBlock",value:function(){return(0,p.Z)(this,Z).block_ids}},{key:"fetchBlockLevels",value:function(){return(0,p.Z)(this,Z).block_levels}},{key:"fetchParameters",value:function(){var t,n=(0,o.Z)({},(0,p.Z)(this,b));return n.subset=(0,d.Z)(t=this.constructor,e,I).call(t,n.subset),n}},{key:"fetchDatasets",value:function(){return(0,p.Z)(this,Z).datasets}},{key:"fetchDirectSubset",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;if(y in(0,p.Z)(this,Z)){var n=(0,p.Z)(this,Z)[y];return t?n.slice():n}return null}},{key:"guessRnaFeatureTypes",value:function(){return"RNA"in(0,p.Z)(this,Z).genes?("inferred_rna_types"in(0,p.Z)(this,Z)||((0,p.Z)(this,Z).inferred_rna_types=w.zS((0,p.Z)(this,Z).genes.RNA)),(0,p.Z)(this,Z).inferred_rna_types):null}},{key:"enableDatasetCache",value:function(e){(0,v.Z)(this,k,e)}},{key:"compute",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(n,r){var s,u,l,c,f,h,_,m,g;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=r.block_factor,u=r.subset,this.changed=!1,null===n){t.next=12;break}for(l={},c=0,f=Object.entries(n);c<f.length;c++)h=(0,i.Z)(f[c],2),_=h[0],m=h[1],l[_]={format:m.constructor.format(),details:m.abbreviate()};if(!w.xi(l,(0,p.Z)(this,A))){t.next=12;break}return t.next=8,O(n,(0,p.Z)(this,Z),(0,p.Z)(this,k));case 8:(0,v.Z)(this,A,l),(0,p.Z)(this,Z).datasets=(0,o.Z)({},n),delete(0,p.Z)(this,Z).inferred_rna_types,this.changed=!0;case 12:return(this.changed||(0,p.Z)(this,b).block_factor!==s)&&(M(s,(0,p.Z)(this,Z)),(0,p.Z)(this,b).block_factor=s,this.changed=!0),(this.changed||!(y in(0,p.Z)(this,Z))&&w.xi(u,(0,p.Z)(this,b).subset)||!("matrix"in(0,p.Z)(this,Z)))&&(U(u,(0,p.Z)(this,Z)),(0,p.Z)(this,b).subset=(0,d.Z)(g=this.constructor,e,I).call(g,u),this.changed=!0),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"undoSubset",value:function(e){if("matrix"in(0,p.Z)(this,Z)){var t,n=this.fetchCountMatrix().numberOfColumns(),a=(0,r.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i<0||i>=n)throw new Error("entries of 'indices' should be less than the number of cells in the dataset")}}catch(u){a.e(u)}finally{a.f()}}var s=null;"subset"in(0,p.Z)(this,b)&&(s=(0,p.Z)(this,b).subset);var o=Q(s,(0,p.Z)(this,Z));null!==o&&e.forEach((function(t,n){e[n]=o[t]}))}},{key:"setDirectSubset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.copy,r=void 0===n||n,a=t.onOriginal,i=void 0!==a&&a;null!==e?(0,p.Z)(this,Z)[y]=(0,h.Z)(this,x,S).call(this,e,r,i):delete(0,p.Z)(this,Z)[y],_.gd((0,p.Z)(this,Z).matrix),delete(0,p.Z)(this,Z).matrix}},{key:"createDirectSubset",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copy,a=void 0===r||r,i=n.onOriginal,s=void 0!==i&&i,o={};o[y]=(0,h.Z)(this,x,S).call(this,t,a,s),o.raw_matrix=(0,p.Z)(this,Z).raw_matrix.clone();for(var u=0,l=["multi_block_ids","raw_block_ids"];u<l.length;u++){var c=l[u];c in(0,p.Z)(this,Z)&&(null===(0,p.Z)(this,Z)[c]?o[c]=null:o[c]=(0,p.Z)(this,Z)[c].clone())}for(var f=0,d=["row_ids","raw_annotations","genes","multi_block_levels","raw_block_levels"];f<d.length;f++){var v=d[f];v in(0,p.Z)(this,Z)&&(o[v]=(0,p.Z)(this,Z)[v])}U(null,o);var _=this.fetchParameters();return _.subset=null,new e(_,o,(0,p.Z)(this,A))}}],[{key:"defaults",value:function(){return{block_factor:null,subset:null}}}]),e}();function I(e){if(null==e)return e;var t=(0,o.Z)({},e);return"values"in t&&(t.values=t.values.slice()),"ranges"in t&&(t.ranges=t.ranges.map((function(e){return e.slice()}))),t}function S(e,t,n){return w.N2(e,null),t&&(e=e.slice()),n||this.undoSubset(e),e}var B=["RNA","ADT","CRISPR"];function C(e,t){var n={};try{for(var r=[],a=[],i=0;i<t.length;i++){a.push(t[i].matrix.get(e));var s=t[i].primary_ids[e];if(null==s)throw new Error("modality '"+e+"' lacks a primary identifier for dataset "+String(i));r.push(s)}var o=_.KV(a,r);n.matrix=o.matrix,n.features=m.Nd(t[0].features[e],o.indices),n.row_ids=m.Nd(t[0].row_ids[e],o.indices)}catch(u){throw w.Yl(n.matrix),u}return n}function z(e,t){var n,a,i=[],s=(0,r.Z)(B);try{for(s.s();!(n=s.n()).done;){var o,u=n.value,l=!0,c=(0,r.Z)(t);try{for(c.s();!(o=c.n()).done;){if(!o.value.matrix.has(u)){l=!1;break}}}catch(Z){c.e(Z)}finally{c.f()}l&&i.push(u)}}catch(Z){s.e(Z)}finally{s.f()}if(0==i.length)throw new Error("failed to find common modalities across all datasets");var f={matrix:new _.VU,features:{},row_ids:{}};try{for(var h=0,d=i;h<d.length;h++){var p=d[h],v=C(p,t);f.matrix.add(p,v.matrix),f.features[p]=v.features,f.row_ids[p]=v.row_ids}var g=t.map((function(e){return e.cells}));f.cells=m.sj(g);var y=new Array(t.length);t.forEach((function(e,t){y[t]=e.matrix.numberOfColumns()})),a=_.j4(y),f.block_ids=a,f.block_levels=e;var b=new Array(a.length);a.forEach((function(t,n){b[n]=e[t]})),f.cells.$setColumn("__batch__",b)}catch(A){throw w.Yl(a),w.Yl(f.matrix),A}return f}function R(e){if(0==e.matrix.available().length)throw new Error("");var t={matrix:new _.VU,features:{},row_ids:{}};try{var n,a=(0,r.Z)(B);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.matrix.has(i)&&(t.matrix.add(i,e.matrix.get(i)),t.features[i]=e.features[i],t.row_ids[i]=e.row_ids[i])}}catch(s){a.e(s)}finally{a.f()}}catch(o){throw _.gd(t.matrix),o}return t.cells=e.cells,t.block_ids=null,t.block_levels=null,t}function F(e,t){return D.apply(this,arguments)}function D(){return(D=(0,s.Z)((0,a.Z)().mark((function e(t,n){var i,s,o,u,l,c,f,h,d,p,v,m;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=Object.keys(t)).sort(),s=[],e.prev=3,o=0,u=i;case 5:if(!(o<u.length)){e.next=15;break}return l=u[o],e.t0=s,e.next=10,t[l].load({cache:n});case 10:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 12:o++,e.next=5;break;case 15:e.next=22;break;case 17:e.prev=17,e.t2=e.catch(3),c=(0,r.Z)(s);try{for(c.s();!(f=c.n()).done;)h=f.value,_.gd(h.matrix)}catch(a){c.e(a)}finally{c.f()}throw e.t2;case 22:if(1!=i.length){e.next=33;break}e.prev=23,d=R(s[0]),e.next=31;break;case 27:throw e.prev=27,e.t3=e.catch(23),_.gd(s[0].matrix),e.t3;case 31:e.next=34;break;case 33:try{d=z(i,s)}finally{p=(0,r.Z)(s);try{for(p.s();!(v=p.n()).done;)m=v.value,_.gd(m.matrix)}catch(a){p.e(a)}finally{p.f()}}case 34:return e.abrupt("return",d);case 35:case"end":return e.stop()}}),e,null,[[3,17],[23,27]])})))).apply(this,arguments)}var N=-1;function Q(e,t){var n;if(y in t)n=t[y];else if(null==e)n=null;else{if(!t.raw_annotations.hasColumn(e.field))throw new Error("failed to find '"+e.field+"' in the column annotations");var a=t.raw_annotations.column(e.field);if(n=[],"values"in e){var i=new Set(e.values);a.forEach((function(e,t){i.has(e)&&n.push(t)}))}else a.forEach((function(t,a){var i,s=(0,r.Z)(e.ranges);try{for(s.s();!(i=s.n()).done;){var o=i.value;if(t>=o[0]&&t<=o[1])return void n.push(a)}}catch(u){s.e(u)}finally{s.f()}}))}if("raw_block_ids"in t&&null!==t.raw_block_ids){var s=t.raw_block_ids.array(),o=[];if(null!==n){var u,l=(0,r.Z)(n);try{for(l.s();!(u=l.n()).done;){var c=u.value;s[c]!==N&&o.push(c)}}catch(h){l.e(h)}finally{l.f()}}else for(var f=0;f<s.length;f++)s[f]!==N&&o.push(f);n=o}return n}function O(e,t,n){return q.apply(this,arguments)}function q(){return(q=(0,s.Z)((0,a.Z)().mark((function e(t,n,r){var i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.Yl(n.raw_matrix),w.Yl(n.matrix),w.Yl(n.multi_block_ids),e.next=5,F(t,r);case 5:i=e.sent,n.raw_matrix=i.matrix,n.row_ids=i.row_ids,n.raw_annotations=i.cells,n.multi_block_ids=i.block_ids,n.multi_block_levels=i.block_levels,n.genes=i.features;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t){w.Yl(t.raw_block_ids);var n=null,r=null;if(null!==e)try{var a=t.raw_annotations.column(e);if(a.length!=t.raw_matrix.numberOfColumns())throw new Error("length of blocking factor '"+e+"' should be equal to the number of cells");var i=_.Yh(a,{action:"none",placeholder:N});n=i.ids,r=i.levels}catch(s){throw w.Yl(n),s}else n=null!==t.multi_block_ids?t.multi_block_ids.view():null,r=t.multi_block_levels;t.raw_block_ids=n,t.raw_block_levels=r}function U(e,t){w.Yl(t.matrix),w.Yl(t.block_ids);var n,a,i,s,o=Q(e,t);try{if(null===o)n=t.raw_annotations,a=t.raw_matrix.clone(),null!==t.raw_block_ids?(i=t.raw_block_ids.view(),s=t.raw_block_levels):(i=null,s=null);else{if(n=m.Nd(t.raw_annotations,o),null!==t.raw_block_ids)i=_.DS(t.raw_block_ids,o),s=_.D4(i).map((function(e){return t.raw_block_levels[e]}));else i=null,s=null;a=new _.VU;var u,l=(0,r.Z)(t.raw_matrix.available());try{for(l.s();!(u=l.n()).done;){var c=u.value,f=t.raw_matrix.get(c);a.add(c,_.ZW(f,o))}}catch(h){l.e(h)}finally{l.f()}}}catch(d){throw w.Yl(a),w.Yl(i),d}t.annotations=n,t.block_levels=s,t.block_ids=i,t.matrix=a}var W=null;function T(e){var t=W;return W=e,t}},4071:function(e,t,n){n.d(t,{$p:function(){return u},AB:function(){return c},Ig:function(){return _},Vi:function(){return g},cE:function(){return v},qM:function(){return m},yc:function(){return l}});var r=n(4165),a=n(5861),i=n(5831),s=(n(7891),n(8794)),o=function(e,t,n){return null};function u(e){var t=o;return o=e,t}var l={numberOfThreads:1};function c(e,t){var n=e.fetchIndex(),r={num_obs:n.numberOfCells()},a=null,s=null,o=null,u=null;try{a=i.wf(n,t),s=i.Wf(a.numberOfCells()),o=i.Wf(a.size()),u=i.RJ(a.size()),a.serialize({runs:s,indices:o,distances:u}),r.size=a.size(),r.runs=s.array().slice(),r.indices=o.array().slice(),r.distances=u.array().slice()}finally{null!==a&&a.free(),null!==s&&s.free(),null!==o&&o.free(),null!==u&&u.free()}return r}var f=[],h=[];function d(e){return e.type}function p(e,t){"error"==d(t)?e.reject(t.error):e.resolve(t.data)}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=f[e],a=h[e],i=a.counter,o=new Promise((function(e,t){var n={resolve:e,reject:t};i in a.promises?(p(n,a.promises[i]),delete a.promises[i]):a.promises[i]=n}));return a.counter++,t.id=i,s.bG(r,t,n),o}function _(e,t){var n=f.length;f.push(e);var r={counter:0,promises:{}};return h.push(r),s.jC(e,(function(e){var t=d(e.data);if(t.endsWith("_iter"))o(t.slice(0,-5),e.data.x,e.data.y,e.data.iteration);else{var n=e.data.id;n in r.promises?(p(r.promises[n],e.data),delete r.promises[n]):r.promises[n]=e.data}})),{worker_id:n,ready:v(n,{cmd:"INIT",scranOptions:t})}}function m(e){return w.apply(this,arguments)}function w(){return(w=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t,{cmd:"KILL"});case 2:return n=f[t],f[t]=null,e.abrupt("return",s.Ae(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,n){var r={cmd:"RUN",params:t},a=[];return null!==n&&(a=[n.runs.buffer,n.indices.buffer,n.distances.buffer],r.neighbors=n),v(e,r,a)}},8795:function(e,t,n){n.d(t,{i:function(){return r}});var r="2.0.19"},1126:function(e,t,n){n.d(t,{o:function(){return i}});var r=n(3324),a=n(7762);n(4127),n(320);function i(e){var t,n=new Map,i=(0,a.Z)(e);try{for(i.s();!(t=i.n()).done;){var s,o=t.value,u=(0,a.Z)(o);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=n.get(l);"undefined"==typeof c?n.set(l,1):n.set(l,c+1)}}catch(w){u.e(w)}finally{u.f()}}}catch(w){i.e(w)}finally{i.f()}var f,h=[],d=(0,a.Z)(n);try{for(d.s();!(f=d.n()).done;){var p=(0,r.Z)(f.value,2),v=p[0],_=p[1],m={id:Number(v),count:_};h.push(m)}}catch(w){d.e(w)}finally{d.f()}return h}},7325:function(e,t,n){n.d(t,{$g:function(){return c.$},Kk:function(){return r.geneBaseUrl},RR:function(){return u.R},Uy:function(){return o.U},XW:function(){return a.X},XZ:function(){return r.referenceBaseUrl},ao:function(){return r.referenceDownload},b5:function(){return r.setGeneDownload},bj:function(){return i.b},d9:function(){return r.geneDownload},is:function(){return s.i},or:function(){return l.o},wf:function(){return r.intersect},wy:function(){return f.w}});var r=n(8137),a=(n(4147),n(7078),n(194)),i=n(7899),s=(n(4127),n(3192)),o=(n(6331),n(4479),n(7855)),u=(n(320),n(2666)),l=(n(5719),n(1126)),c=n(7101),f=n(5479)},194:function(e,t,n){n.d(t,{X:function(){return o}});var r=n(4165),a=n(7762),i=n(5861),s=(n(4147),n(7078));function o(e,t){return u.apply(this,arguments)}function u(){return u=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,o,u,l,c,f,h,d,p,v,_,m,w,g,y,b,Z,A,k,x=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(i=x.length>2&&void 0!==x[2]?x[2]:{}).types,u=void 0===o?null:o,l=i.ignoreCase,c=void 0===l||l,null===u&&(u=["entrez","ensembl","symbol"]),f=[],h=(0,a.Z)(u);try{for(h.s();!(d=h.n()).done;)p=d.value,f.push((0,s.B)(t,p,{lowerCase:c}))}catch(r){h.e(r)}finally{h.f()}return e.next=7,Promise.all(f);case 7:v=e.sent,_=[],m=0;case 10:if(!(m<n.length)){e.next=22;break}if(0!=(w=n[m]).length){e.next=15;break}return _.push([]),e.abrupt("continue",19);case 15:for(c&&(w=w.toLowerCase()),g=[],y=0;y<u.length;y++)if("undefined"!==typeof(b=v[y].get(w))){Z=(0,a.Z)(b);try{for(Z.s();!(A=Z.n()).done;)k=A.value,g.push(k)}catch(r){Z.e(r)}finally{Z.f()}}_.push(g);case 19:m++,e.next=10;break;case 22:return e.abrupt("return",_);case 23:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}},8137:function(e,t,n){n.r(t),n.d(t,{convertToUint32Array:function(){return S},decompressLines:function(){return w},default_download:function(){return o},fetchNumber:function(){return F},fetchSizes:function(){return R},geneBaseUrl:function(){return p},geneDownload:function(){return _},gene_download:function(){return v},intersect:function(){return B},referenceBaseUrl:function(){return l},referenceDownload:function(){return f},reference_download:function(){return c},retrieveBytes:function(){return E},retrieveBytesByIndex:function(){return x},retrieveNamedRanges:function(){return b},retrieveRanges:function(){return g},retrieveRangesWithExtras:function(){return A},setGeneDownload:function(){return m},setReferenceDownload:function(){return h}});var r=n(4165),a=n(7762),i=n(5861),s=n(714),o=function(e,t,n,r){var a=e+"/"+t;return null==n||null==r?fetch(a):fetch(a,{headers:{Range:"bytes="+String(n)+"-"+String(r)}})},u="https://github.com/LTLA/gesel-feedstock/releases/download/indices-v0.2.1";function l(e){return u}var c=function(e){return o(u,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)};function f(e){var t=c;return"undefined"!==typeof e&&(c=e),t}function h(e){return f(e)}var d="https://github.com/LTLA/gesel-feedstock/releases/download/genes-v1.0.0";function p(e){return d}var v=function(e){return o(d,e,null,null)};function _(e){var t=v;return"undefined"!==typeof e&&(v=e),t}function m(e){return _(e)}function w(e){var t=s.rr(new Uint8Array(e)),n=(new TextDecoder).decode(t).split("\n");return""==n[n.length-1]?n.slice(0,n.length-1):n}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)((0,r.Z)().mark((function e(t){var n,a,i,s,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t+".ranges.gz");case 2:if((n=e.sent).ok){e.next=5;break}throw"failed to fetch ranges for '"+t+"'";case 5:return e.next=7,n.arrayBuffer();case 7:for(a=e.sent,i=w(a),s=[0],o=0;o<i.length;o++)s.push(s[o]+Number(i[o])+1);return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,i.Z)((0,r.Z)().mark((function e(t){var n,a,i,s,o,u,l,f,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t+".ranges.gz");case 2:if((n=e.sent).ok){e.next=5;break}throw"failed to fetch ranges for '"+t+"'";case 5:return e.next=7,n.arrayBuffer();case 7:for(a=e.sent,i=w(a),s=0,o=new Map,u=[],l=0;l<i.length;l++)f=i[l].split("\t"),h=s+Number(f[1])+1,o.set(f[0],[s,h]),u.push(f[0]),s=h;return e.abrupt("return",{ranges:o,order:u});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)((0,r.Z)().mark((function e(t){var n,a,i,s,o,u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(t+".ranges.gz");case 2:if((n=e.sent).ok){e.next=5;break}throw"failed to fetch ranges for '"+t+"'";case 5:return e.next=7,n.arrayBuffer();case 7:for(a=e.sent,i=w(a),s=[0],o=[],u=0;u<i.length;u++)l=i[u].split("\t"),s.push(s[u]+Number(l[0])+1),o.push(Number(l[1]));return e.abrupt("return",{ranges:s,extra:o});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t,n){return E(e,t[n],t[n+1])}function E(e,t,n){return I.apply(this,arguments)}function I(){return(I=(0,i.Z)((0,r.Z)().mark((function e(t,n,a){var i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a--,e.next=3,c(t,n,a);case 3:if((i=e.sent).ok){e.next=6;break}throw"failed to fetch ranges for '"+t+"'";case 6:return e.next=8,i.text();case 8:return s=e.sent,e.abrupt("return",s.slice(0,a-n));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=[];if(""!==e){var n=0;e.split("\t").forEach((function(e){var r=Number(e)+n;t.push(r),n=r}))}return new Uint32Array(t)}function B(e){if(0==e.length)return[];if(1==e.length)return e[0];for(var t=new Set(e[0]),n=1;n<e.length;n++){var r,i=new Set,s=(0,a.Z)(e[n]);try{for(s.s();!(r=s.n()).done;){var o=r.value;t.has(o)&&i.add(o)}}catch(u){s.e(u)}finally{s.f()}t=i}return Array.from(t)}function C(e,t,n,r,a,i){return z.apply(this,arguments)}function z(){return(z=(0,i.Z)((0,r.Z)().mark((function e(t,n,a,i,s,o){var u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof(u=n.get(t))){e.next=10;break}return e.next=4,a(t,{download:!1});case 4:if(null===(l=e.sent)){e.next=7;break}return e.abrupt("return",o(l));case 7:return e.next=9,i(t);case 9:u=n.get(t);case 10:return e.abrupt("return",s(u));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,n,r){return C(e,t,n,r,(function(e){return e}),(function(n){var r,i=[],s=(0,a.Z)(n);try{for(s.s();!(r=s.n()).done;){var o=r.value;i.push(o.size)}}catch(u){s.e(u)}finally{s.f()}return t.set(e,i),i}))}function F(e,t,n,r){return C(e,t,n,r,(function(e){return e.length}),(function(e){return e.length}))}},714:function(e,t,n){n.d(t,{T_:function(){return vn},ec:function(){return mn},iv:function(){return pn},rr:function(){return _n}});function r(e){for(var t=e.length;--t>=0;)e[t]=0}var a=256,i=286,s=30,o=15,u=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),l=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),f=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=new Array(576);r(h);var d=new Array(60);r(d);var p=new Array(512);r(p);var v=new Array(256);r(v);var _=new Array(29);r(_);var m,w,g,y=new Array(s);function b(e,t,n,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function Z(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}r(y);var A=function(e){return e<256?p[e]:p[256+(e>>>7)]},k=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},x=function(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,k(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},E=function(e,t,n){x(e,n[2*t],n[2*t+1])},I=function(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},S=function(e,t,n){var r,a,i=new Array(16),s=0;for(r=1;r<=o;r++)s=s+n[r-1]<<1,i[r]=s;for(a=0;a<=t;a++){var u=e[2*a+1];0!==u&&(e[2*a]=I(i[u]++,u))}},B=function(e){var t;for(t=0;t<i;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},C=function(e){e.bi_valid>8?k(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},z=function(e,t,n,r){var a=2*t,i=2*n;return e[a]<e[i]||e[a]===e[i]&&r[t]<=r[n]},R=function(e,t,n){for(var r=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&z(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!z(t,r,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=r},F=function(e,t,n){var r,i,s,o,c=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+c++],r+=(255&e.pending_buf[e.sym_buf+c++])<<8,i=e.pending_buf[e.sym_buf+c++],0===r?E(e,i,t):(s=v[i],E(e,s+a+1,t),0!==(o=u[s])&&(i-=_[s],x(e,i,o)),r--,s=A(r),E(e,s,n),0!==(o=l[s])&&(r-=y[s],x(e,r,o)))}while(c<e.sym_next);E(e,256,t)},D=function(e,t){var n,r,a,i=t.dyn_tree,s=t.stat_desc.static_tree,u=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,u&&(e.static_len-=s[2*a+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)R(e,i,n);a=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,i[2*a]=i[2*n]+i[2*r],e.depth[a]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,i[2*n+1]=i[2*r+1]=a,e.heap[1]=a++,R(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,a,i,s,u,l=t.dyn_tree,c=t.max_code,f=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,v=t.stat_desc.max_length,_=0;for(i=0;i<=o;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(i=l[2*l[2*(r=e.heap[n])+1]+1]+1)>v&&(i=v,_++),l[2*r+1]=i,r>c||(e.bl_count[i]++,s=0,r>=p&&(s=d[r-p]),u=l[2*r],e.opt_len+=u*(i+s),h&&(e.static_len+=u*(f[2*r+1]+s)));if(0!==_){do{for(i=v-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[v]--,_-=2}while(_>0);for(i=v;0!==i;i--)for(r=e.bl_count[i];0!==r;)(a=e.heap[--n])>c||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),r--)}}(e,t),S(i,c,e.bl_count)},N=function(e,t,n){var r,a,i=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)a=s,s=t[2*(r+1)+1],++o<u&&a===s||(o<l?e.bl_tree[2*a]+=o:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,i=a,0===s?(u=138,l=3):a===s?(u=6,l=3):(u=7,l=4))},Q=function(e,t,n){var r,a,i=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),r=0;r<=n;r++)if(a=s,s=t[2*(r+1)+1],!(++o<u&&a===s)){if(o<l)do{E(e,a,e.bl_tree)}while(0!==--o);else 0!==a?(a!==i&&(E(e,a,e.bl_tree),o--),E(e,16,e.bl_tree),x(e,o-3,2)):o<=10?(E(e,17,e.bl_tree),x(e,o-3,3)):(E(e,18,e.bl_tree),x(e,o-11,7));o=0,i=a,0===s?(u=138,l=3):a===s?(u=6,l=3):(u=7,l=4)}},O=!1,q=function(e,t,n,r){x(e,0+(r?1:0),3),C(e),k(e,n),k(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},M=function(e,t,n,r){var i,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),D(e,e.l_desc),D(e,e.d_desc),o=function(e){var t;for(N(e,e.dyn_ltree,e.l_desc.max_code),N(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*f[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?q(e,t,n,r):4===e.strategy||s===i?(x(e,2+(r?1:0),3),F(e,h,d)):(x(e,4+(r?1:0),3),function(e,t,n,r){var a;for(x(e,t-257,5),x(e,n-1,5),x(e,r-4,4),a=0;a<r;a++)x(e,e.bl_tree[2*f[a]+1],3);Q(e,e.dyn_ltree,t-1),Q(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),F(e,e.dyn_ltree,e.dyn_dtree)),B(e),r&&C(e)},U={_tr_init:function(e){O||(!function(){var e,t,n,r,a,f=new Array(16);for(n=0,r=0;r<28;r++)for(_[r]=n,e=0;e<1<<u[r];e++)v[n++]=r;for(v[n-1]=r,a=0,r=0;r<16;r++)for(y[r]=a,e=0;e<1<<l[r];e++)p[a++]=r;for(a>>=7;r<s;r++)for(y[r]=a<<7,e=0;e<1<<l[r]-7;e++)p[256+a++]=r;for(t=0;t<=o;t++)f[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,f[8]++;for(;e<=255;)h[2*e+1]=9,e++,f[9]++;for(;e<=279;)h[2*e+1]=7,e++,f[7]++;for(;e<=287;)h[2*e+1]=8,e++,f[8]++;for(S(h,287,f),e=0;e<s;e++)d[2*e+1]=5,d[2*e]=I(e,5);m=new b(h,u,257,i,o),w=new b(d,l,0,s,o),g=new b(new Array(0),c,0,19,7)}(),O=!0),e.l_desc=new Z(e.dyn_ltree,m),e.d_desc=new Z(e.dyn_dtree,w),e.bl_desc=new Z(e.bl_tree,g),e.bi_buf=0,e.bi_valid=0,B(e)},_tr_stored_block:q,_tr_flush_block:M,_tr_tally:function(e,t,n){return e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(v[n]+a+1)]++,e.dyn_dtree[2*A(t)]++),e.sym_next===e.sym_end},_tr_align:function(e){x(e,2,3),E(e,256,h),function(e){16===e.bi_valid?(k(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},W=function(e,t,n,r){for(var a=65535&e|0,i=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{i=i+(a=a+t[r++]|0)|0}while(--s);a%=65521,i%=65521}return a|i<<16|0},T=new Uint32Array(function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}()),j=function(e,t,n,r){var a=T,i=r+n;e^=-1;for(var s=r;s<i;s++)e=e>>>8^a[255&(e^t[s])];return-1^e},G={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},L={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},H=U._tr_init,Y=U._tr_stored_block,J=U._tr_flush_block,P=U._tr_tally,V=U._tr_align,X=L.Z_NO_FLUSH,K=L.Z_PARTIAL_FLUSH,$=L.Z_FULL_FLUSH,ee=L.Z_FINISH,te=L.Z_BLOCK,ne=L.Z_OK,re=L.Z_STREAM_END,ae=L.Z_STREAM_ERROR,ie=L.Z_DATA_ERROR,se=L.Z_BUF_ERROR,oe=L.Z_DEFAULT_COMPRESSION,ue=L.Z_FILTERED,le=L.Z_HUFFMAN_ONLY,ce=L.Z_RLE,fe=L.Z_FIXED,he=L.Z_DEFAULT_STRATEGY,de=L.Z_UNKNOWN,pe=L.Z_DEFLATED,ve=258,_e=262,me=42,we=113,ge=666,ye=function(e,t){return e.msg=G[t],t},be=function(e){return 2*e-(e>4?9:0)},Ze=function(e){for(var t=e.length;--t>=0;)e[t]=0},Ae=function(e){var t,n,r,a=e.w_size;r=t=e.hash_size;do{n=e.head[--r],e.head[r]=n>=a?n-a:0}while(--t);r=t=a;do{n=e.prev[--r],e.prev[r]=n>=a?n-a:0}while(--t)},ke=function(e,t,n){return(t<<e.hash_shift^n)&e.hash_mask},xe=function(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Ee=function(e,t){J(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,xe(e.strm)},Ie=function(e,t){e.pending_buf[e.pending++]=t},Se=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Be=function(e,t,n,r){var a=e.avail_in;return a>r&&(a=r),0===a?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),n),1===e.state.wrap?e.adler=W(e.adler,t,a,n):2===e.state.wrap&&(e.adler=j(e.adler,t,a,n)),e.next_in+=a,e.total_in+=a,a)},Ce=function(e,t){var n,r,a=e.max_chain_length,i=e.strstart,s=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-_e?e.strstart-(e.w_size-_e):0,l=e.window,c=e.w_mask,f=e.prev,h=e.strstart+ve,d=l[i+s-1],p=l[i+s];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(n=t)+s]===p&&l[n+s-1]===d&&l[n]===l[i]&&l[++n]===l[i+1]){i+=2,n++;do{}while(l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&i<h);if(r=ve-(h-i),i=h-ve,r>s){if(e.match_start=t,s=r,r>=o)break;d=l[i+s-1],p=l[i+s]}}}while((t=f[t&c])>u&&0!==--a);return s<=e.lookahead?s:e.lookahead},ze=function(e){var t,n,r,a=e.w_size;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-_e)&&(e.window.set(e.window.subarray(a,a+a-n),0),e.match_start-=a,e.strstart-=a,e.block_start-=a,e.insert>e.strstart&&(e.insert=e.strstart),Ae(e),n+=a),0===e.strm.avail_in)break;if(t=Be(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=t,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=ke(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=ke(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<_e&&0!==e.strm.avail_in)},Re=function(e,t){var n,r,a,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,o=e.strm.avail_in;do{if(n=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a)break;if(a=e.strm.avail_out-a,n>(r=e.strstart-e.block_start)+e.strm.avail_in&&(n=r+e.strm.avail_in),n>a&&(n=a),n<i&&(0===n&&t!==ee||t===X||n!==r+e.strm.avail_in))break;s=t===ee&&n===r+e.strm.avail_in?1:0,Y(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,xe(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Be(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return(o-=e.strm.avail_in)&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==X&&t!==ee&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(Be(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,i=(a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a)>e.w_size?e.w_size:a,((r=e.strstart-e.block_start)>=i||(r||t===ee)&&t!==X&&0===e.strm.avail_in&&r<=a)&&(n=r>a?a:r,s=t===ee&&0===e.strm.avail_in&&n===r?1:0,Y(e,e.block_start,n,s),e.block_start+=n,xe(e.strm)),s?3:1)},Fe=function(e,t){for(var n,r;;){if(e.lookahead<_e){if(ze(e),e.lookahead<_e&&t===X)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-_e&&(e.match_length=Ce(e,n)),e.match_length>=3)if(r=P(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=ke(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ke(e,e.ins_h,e.window[e.strstart+1]);else r=P(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ee?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2},De=function(e,t){for(var n,r,a;;){if(e.lookahead<_e){if(ze(e),e.lookahead<_e&&t===X)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-_e&&(e.match_length=Ce(e,n),e.match_length<=5&&(e.strategy===ue||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,r=P(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Ee(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=P(e,0,e.window[e.strstart-1]))&&Ee(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=P(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ee?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2};function Ne(e,t,n,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=a}var Qe=[new Ne(0,0,0,0,Re),new Ne(4,4,8,4,Fe),new Ne(4,5,16,8,Fe),new Ne(4,6,32,32,Fe),new Ne(4,4,16,16,De),new Ne(8,16,32,32,De),new Ne(8,16,128,128,De),new Ne(8,32,128,256,De),new Ne(32,128,258,1024,De),new Ne(32,258,258,4096,De)];function Oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ze(this.dyn_ltree),Ze(this.dyn_dtree),Ze(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ze(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ze(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var qe=function(e){if(!e)return 1;var t=e.state;return!t||t.strm!==e||t.status!==me&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==we&&t.status!==ge?1:0},Me=function(e){if(qe(e))return ye(e,ae);e.total_in=e.total_out=0,e.data_type=de;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?me:we,e.adler=2===t.wrap?0:1,t.last_flush=-2,H(t),ne},Ue=function(e){var t,n=Me(e);return n===ne&&((t=e.state).window_size=2*t.w_size,Ze(t.head),t.max_lazy_match=Qe[t.level].max_lazy,t.good_match=Qe[t.level].good_length,t.nice_match=Qe[t.level].nice_length,t.max_chain_length=Qe[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n},We=function(e,t,n,r,a,i){if(!e)return ae;var s=1;if(t===oe&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>9||n!==pe||r<8||r>15||t<0||t>9||i<0||i>fe||8===r&&1!==s)return ye(e,ae);8===r&&(r=9);var o=new Oe;return e.state=o,o.strm=e,o.status=me,o.wrap=s,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=i,o.method=n,Ue(e)},Te={deflateInit:function(e,t){return We(e,t,pe,15,8,he)},deflateInit2:We,deflateReset:Ue,deflateResetKeep:Me,deflateSetHeader:function(e,t){return qe(e)||2!==e.state.wrap?ae:(e.state.gzhead=t,ne)},deflate:function(e,t){if(qe(e)||t>te||t<0)return e?ye(e,ae):ae;var n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===ge&&t!==ee)return ye(e,0===e.avail_out?se:ae);var r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(xe(e),0===e.avail_out)return n.last_flush=-1,ne}else if(0===e.avail_in&&be(t)<=be(r)&&t!==ee)return ye(e,se);if(n.status===ge&&0!==e.avail_in)return ye(e,se);if(n.status===me&&0===n.wrap&&(n.status=we),n.status===me){var a=pe+(n.w_bits-8<<4)<<8;if(a|=(n.strategy>=le||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),Se(n,a+=31-a%31),0!==n.strstart&&(Se(n,e.adler>>>16),Se(n,65535&e.adler)),e.adler=1,n.status=we,xe(e),0!==n.pending)return n.last_flush=-1,ne}if(57===n.status)if(e.adler=0,Ie(n,31),Ie(n,139),Ie(n,8),n.gzhead)Ie(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ie(n,255&n.gzhead.time),Ie(n,n.gzhead.time>>8&255),Ie(n,n.gzhead.time>>16&255),Ie(n,n.gzhead.time>>24&255),Ie(n,9===n.level?2:n.strategy>=le||n.level<2?4:0),Ie(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Ie(n,255&n.gzhead.extra.length),Ie(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=j(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Ie(n,0),Ie(n,0),Ie(n,0),Ie(n,0),Ie(n,0),Ie(n,9===n.level?2:n.strategy>=le||n.level<2?4:0),Ie(n,3),n.status=we,xe(e),0!==n.pending)return n.last_flush=-1,ne;if(69===n.status){if(n.gzhead.extra){for(var i=n.pending,s=(65535&n.gzhead.extra.length)-n.gzindex;n.pending+s>n.pending_buf_size;){var o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>i&&(e.adler=j(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex+=o,xe(e),0!==n.pending)return n.last_flush=-1,ne;i=0,s-=o}var u=new Uint8Array(n.gzhead.extra);n.pending_buf.set(u.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending+=s,n.gzhead.hcrc&&n.pending>i&&(e.adler=j(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){var l,c=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>c&&(e.adler=j(e.adler,n.pending_buf,n.pending-c,c)),xe(e),0!==n.pending)return n.last_flush=-1,ne;c=0}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Ie(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>c&&(e.adler=j(e.adler,n.pending_buf,n.pending-c,c)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){var f,h=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>h&&(e.adler=j(e.adler,n.pending_buf,n.pending-h,h)),xe(e),0!==n.pending)return n.last_flush=-1,ne;h=0}f=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Ie(n,f)}while(0!==f);n.gzhead.hcrc&&n.pending>h&&(e.adler=j(e.adler,n.pending_buf,n.pending-h,h))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(xe(e),0!==n.pending))return n.last_flush=-1,ne;Ie(n,255&e.adler),Ie(n,e.adler>>8&255),e.adler=0}if(n.status=we,xe(e),0!==n.pending)return n.last_flush=-1,ne}if(0!==e.avail_in||0!==n.lookahead||t!==X&&n.status!==ge){var d=0===n.level?Re(n,t):n.strategy===le?function(e,t){for(var n;;){if(0===e.lookahead&&(ze(e),0===e.lookahead)){if(t===X)return 1;break}if(e.match_length=0,n=P(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2}(n,t):n.strategy===ce?function(e,t){for(var n,r,a,i,s=e.window;;){if(e.lookahead<=ve){if(ze(e),e.lookahead<=ve&&t===X)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=s[a=e.strstart-1])===s[++a]&&r===s[++a]&&r===s[++a]){i=e.strstart+ve;do{}while(r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&a<i);e.match_length=ve-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=P(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=P(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ee(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ee?(Ee(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ee(e,!1),0===e.strm.avail_out)?1:2}(n,t):Qe[n.level].func(n,t);if(3!==d&&4!==d||(n.status=ge),1===d||3===d)return 0===e.avail_out&&(n.last_flush=-1),ne;if(2===d&&(t===K?V(n):t!==te&&(Y(n,0,0,!1),t===$&&(Ze(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),xe(e),0===e.avail_out))return n.last_flush=-1,ne}return t!==ee?ne:n.wrap<=0?re:(2===n.wrap?(Ie(n,255&e.adler),Ie(n,e.adler>>8&255),Ie(n,e.adler>>16&255),Ie(n,e.adler>>24&255),Ie(n,255&e.total_in),Ie(n,e.total_in>>8&255),Ie(n,e.total_in>>16&255),Ie(n,e.total_in>>24&255)):(Se(n,e.adler>>>16),Se(n,65535&e.adler)),xe(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?ne:re)},deflateEnd:function(e){if(qe(e))return ae;var t=e.state.status;return e.state=null,t===we?ye(e,ie):ne},deflateSetDictionary:function(e,t){var n=t.length;if(qe(e))return ae;var r=e.state,a=r.wrap;if(2===a||1===a&&r.status!==me||r.lookahead)return ae;if(1===a&&(e.adler=W(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===a&&(Ze(r.head),r.strstart=0,r.block_start=0,r.insert=0);var i=new Uint8Array(r.w_size);i.set(t.subarray(n-r.w_size,n),0),t=i,n=r.w_size}var s=e.avail_in,o=e.next_in,u=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,ze(r);r.lookahead>=3;){var l=r.strstart,c=r.lookahead-2;do{r.ins_h=ke(r,r.ins_h,r.window[l+3-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++}while(--c);r.strstart=l,r.lookahead=2,ze(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=o,e.input=u,e.avail_in=s,r.wrap=a,ne},deflateInfo:"pako deflate (from Nodeca project)"},je=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Ge={assign:function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(var r in n)je(n,r)&&(e[r]=n[r])}}return e},flattenChunks:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].length;for(var a=new Uint8Array(t),i=0,s=0,o=e.length;i<o;i++){var u=e[i];a.set(u,s),s+=u.length}return a}},Le=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(wn){Le=!1}for(var He=new Uint8Array(256),Ye=0;Ye<256;Ye++)He[Ye]=Ye>=252?6:Ye>=248?5:Ye>=240?4:Ye>=224?3:Ye>=192?2:1;He[254]=He[254]=1;var Je={string2buf:function(e){if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,n,r,a,i,s=e.length,o=0;for(a=0;a<s;a++)55296===(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320===(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),i=0,a=0;i<o;a++)55296===(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320===(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t},buf2string:function(e,t){var n,r,a=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var i=new Array(2*a);for(r=0,n=0;n<a;){var s=e[n++];if(s<128)i[r++]=s;else{var o=He[s];if(o>4)i[r++]=65533,n+=o-1;else{for(s&=2===o?31:3===o?15:7;o>1&&n<a;)s=s<<6|63&e[n++],o--;o>1?i[r++]=65533:s<65536?i[r++]=s:(s-=65536,i[r++]=55296|s>>10&1023,i[r++]=56320|1023&s)}}}return function(e,t){if(t<65534&&e.subarray&&Le)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}(i,r)},utf8border:function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var n=t-1;n>=0&&128===(192&e[n]);)n--;return n<0||0===n?t:n+He[e[n]]>t?n:t}};var Pe=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Ve=Object.prototype.toString,Xe=L.Z_NO_FLUSH,Ke=L.Z_SYNC_FLUSH,$e=L.Z_FULL_FLUSH,et=L.Z_FINISH,tt=L.Z_OK,nt=L.Z_STREAM_END,rt=L.Z_DEFAULT_COMPRESSION,at=L.Z_DEFAULT_STRATEGY,it=L.Z_DEFLATED;function st(e){this.options=Ge.assign({level:rt,method:it,chunkSize:16384,windowBits:15,memLevel:8,strategy:at},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Pe,this.strm.avail_out=0;var n=Te.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==tt)throw new Error(G[n]);if(t.header&&Te.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"===typeof t.dictionary?Je.string2buf(t.dictionary):"[object ArrayBuffer]"===Ve.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=Te.deflateSetDictionary(this.strm,r))!==tt)throw new Error(G[n]);this._dict_set=!0}}function ot(e,t){var n=new st(t);if(n.push(e,!0),n.err)throw n.msg||G[n.err];return n.result}st.prototype.push=function(e,t){var n,r,a=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(r=t===~~t?t:!0===t?et:Xe,"string"===typeof e?a.input=Je.string2buf(e):"[object ArrayBuffer]"===Ve.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(r===Ke||r===$e)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if((n=Te.deflate(a,r))===nt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),n=Te.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===tt;if(0!==a.avail_out){if(r>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},st.prototype.onData=function(e){this.chunks.push(e)},st.prototype.onEnd=function(e){e===tt&&(this.result=Ge.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ut={Deflate:st,deflate:ot,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ot(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ot(e,t)},constants:L},lt=16209,ct=function(e,t){var n,r,a,i,s,o,u,l,c,f,h,d,p,v,_,m,w,g,y,b,Z,A,k,x,E=e.state;n=e.next_in,k=e.input,r=n+(e.avail_in-5),a=e.next_out,x=e.output,i=a-(t-e.avail_out),s=a+(e.avail_out-257),o=E.dmax,u=E.wsize,l=E.whave,c=E.wnext,f=E.window,h=E.hold,d=E.bits,p=E.lencode,v=E.distcode,_=(1<<E.lenbits)-1,m=(1<<E.distbits)-1;e:do{d<15&&(h+=k[n++]<<d,d+=8,h+=k[n++]<<d,d+=8),w=p[h&_];t:for(;;){if(h>>>=g=w>>>24,d-=g,0===(g=w>>>16&255))x[a++]=65535&w;else{if(!(16&g)){if(0===(64&g)){w=p[(65535&w)+(h&(1<<g)-1)];continue t}if(32&g){E.mode=16191;break e}e.msg="invalid literal/length code",E.mode=lt;break e}y=65535&w,(g&=15)&&(d<g&&(h+=k[n++]<<d,d+=8),y+=h&(1<<g)-1,h>>>=g,d-=g),d<15&&(h+=k[n++]<<d,d+=8,h+=k[n++]<<d,d+=8),w=v[h&m];n:for(;;){if(h>>>=g=w>>>24,d-=g,!(16&(g=w>>>16&255))){if(0===(64&g)){w=v[(65535&w)+(h&(1<<g)-1)];continue n}e.msg="invalid distance code",E.mode=lt;break e}if(b=65535&w,d<(g&=15)&&(h+=k[n++]<<d,(d+=8)<g&&(h+=k[n++]<<d,d+=8)),(b+=h&(1<<g)-1)>o){e.msg="invalid distance too far back",E.mode=lt;break e}if(h>>>=g,d-=g,b>(g=a-i)){if((g=b-g)>l&&E.sane){e.msg="invalid distance too far back",E.mode=lt;break e}if(Z=0,A=f,0===c){if(Z+=u-g,g<y){y-=g;do{x[a++]=f[Z++]}while(--g);Z=a-b,A=x}}else if(c<g){if(Z+=u+c-g,(g-=c)<y){y-=g;do{x[a++]=f[Z++]}while(--g);if(Z=0,c<y){y-=g=c;do{x[a++]=f[Z++]}while(--g);Z=a-b,A=x}}}else if(Z+=c-g,g<y){y-=g;do{x[a++]=f[Z++]}while(--g);Z=a-b,A=x}for(;y>2;)x[a++]=A[Z++],x[a++]=A[Z++],x[a++]=A[Z++],y-=3;y&&(x[a++]=A[Z++],y>1&&(x[a++]=A[Z++]))}else{Z=a-b;do{x[a++]=x[Z++],x[a++]=x[Z++],x[a++]=x[Z++],y-=3}while(y>2);y&&(x[a++]=x[Z++],y>1&&(x[a++]=x[Z++]))}break}}break}}while(n<r&&a<s);n-=y=d>>3,h&=(1<<(d-=y<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=a<s?s-a+257:257-(a-s),E.hold=h,E.bits=d},ft=15,ht=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),pt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),vt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),_t=function(e,t,n,r,a,i,s,o){var u,l,c,f,h,d,p,v,_,m=o.bits,w=0,g=0,y=0,b=0,Z=0,A=0,k=0,x=0,E=0,I=0,S=null,B=new Uint16Array(16),C=new Uint16Array(16),z=null;for(w=0;w<=ft;w++)B[w]=0;for(g=0;g<r;g++)B[t[n+g]]++;for(Z=m,b=ft;b>=1&&0===B[b];b--);if(Z>b&&(Z=b),0===b)return a[i++]=20971520,a[i++]=20971520,o.bits=1,0;for(y=1;y<b&&0===B[y];y++);for(Z<y&&(Z=y),x=1,w=1;w<=ft;w++)if(x<<=1,(x-=B[w])<0)return-1;if(x>0&&(0===e||1!==b))return-1;for(C[1]=0,w=1;w<ft;w++)C[w+1]=C[w]+B[w];for(g=0;g<r;g++)0!==t[n+g]&&(s[C[t[n+g]]++]=g);if(0===e?(S=z=s,d=20):1===e?(S=ht,z=dt,d=257):(S=pt,z=vt,d=0),I=0,g=0,w=y,h=i,A=Z,k=0,c=-1,f=(E=1<<Z)-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){p=w-k,s[g]+1<d?(v=0,_=s[g]):s[g]>=d?(v=z[s[g]-d],_=S[s[g]-d]):(v=96,_=0),u=1<<w-k,y=l=1<<A;do{a[h+(I>>k)+(l-=u)]=p<<24|v<<16|_|0}while(0!==l);for(u=1<<w-1;I&u;)u>>=1;if(0!==u?(I&=u-1,I+=u):I=0,g++,0===--B[w]){if(w===b)break;w=t[n+s[g]]}if(w>Z&&(I&f)!==c){for(0===k&&(k=Z),h+=y,x=1<<(A=w-k);A+k<b&&!((x-=B[A+k])<=0);)A++,x<<=1;if(E+=1<<A,1===e&&E>852||2===e&&E>592)return 1;a[c=I&f]=Z<<24|A<<16|h-i|0}}return 0!==I&&(a[h+I]=w-k<<24|64<<16|0),o.bits=Z,0},mt=L.Z_FINISH,wt=L.Z_BLOCK,gt=L.Z_TREES,yt=L.Z_OK,bt=L.Z_STREAM_END,Zt=L.Z_NEED_DICT,At=L.Z_STREAM_ERROR,kt=L.Z_DATA_ERROR,xt=L.Z_MEM_ERROR,Et=L.Z_BUF_ERROR,It=L.Z_DEFLATED,St=16180,Bt=16190,Ct=16191,zt=16192,Rt=16194,Ft=16199,Dt=16200,Nt=16206,Qt=16209,Ot=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function qt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Mt,Ut,Wt=function(e){if(!e)return 1;var t=e.state;return!t||t.strm!==e||t.mode<St||t.mode>16211?1:0},Tt=function(e){if(Wt(e))return At;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=St,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,yt},jt=function(e){if(Wt(e))return At;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Tt(e)},Gt=function(e,t){var n;if(Wt(e))return At;var r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?At:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,jt(e))},Lt=function(e,t){if(!e)return At;var n=new qt;e.state=n,n.strm=e,n.window=null,n.mode=St;var r=Gt(e,t);return r!==yt&&(e.state=null),r},Ht=!0,Yt=function(e){if(Ht){Mt=new Int32Array(512),Ut=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_t(1,e.lens,0,288,Mt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_t(2,e.lens,0,32,Ut,0,e.work,{bits:5}),Ht=!1}e.lencode=Mt,e.lenbits=9,e.distcode=Ut,e.distbits=5},Jt=function(e,t,n,r){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):((a=i.wsize-i.wnext)>r&&(a=r),i.window.set(t.subarray(n-r,n-r+a),i.wnext),(r-=a)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},Pt={inflateReset:jt,inflateReset2:Gt,inflateResetKeep:Tt,inflateInit:function(e){return Lt(e,15)},inflateInit2:Lt,inflate:function(e,t){var n,r,a,i,s,o,u,l,c,f,h,d,p,v,_,m,w,g,y,b,Z,A,k,x,E=0,I=new Uint8Array(4),S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Wt(e)||!e.output||!e.input&&0!==e.avail_in)return At;(n=e.state).mode===Ct&&(n.mode=zt),s=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,f=o,h=u,A=yt;e:for(;;)switch(n.mode){case St:if(0===n.wrap){n.mode=zt;break}for(;c<16;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&l,I[1]=l>>>8&255,n.check=j(n.check,I,2,0),l=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=Qt;break}if((15&l)!==It){e.msg="unknown compression method",n.mode=Qt;break}if(c-=4,Z=8+(15&(l>>>=4)),0===n.wbits&&(n.wbits=Z),Z>15||Z>n.wbits){e.msg="invalid window size",n.mode=Qt;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:Ct,l=0,c=0;break;case 16181:for(;c<16;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(n.flags=l,(255&n.flags)!==It){e.msg="unknown compression method",n.mode=Qt;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Qt;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=j(n.check,I,2,0)),l=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,n.check=j(n.check,I,4,0)),l=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=j(n.check,I,2,0)),l=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=j(n.check,I,2,0)),l=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((d=n.length)>o&&(d=o),d&&(n.head&&(Z=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+d),Z)),512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,d,i)),o-=d,i+=d,n.length-=d),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;d=0;do{Z=r[i+d++],n.head&&Z&&n.length<65536&&(n.head.name+=String.fromCharCode(Z))}while(Z&&d<o);if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,d,i)),o-=d,i+=d,Z)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;d=0;do{Z=r[i+d++],n.head&&Z&&n.length<65536&&(n.head.comment+=String.fromCharCode(Z))}while(Z&&d<o);if(512&n.flags&&4&n.wrap&&(n.check=j(n.check,r,d,i)),o-=d,i+=d,Z)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Qt;break}l=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Ct;break;case 16189:for(;c<32;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}e.adler=n.check=Ot(l),l=0,c=0,n.mode=Bt;case Bt:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,n.hold=l,n.bits=c,Zt;e.adler=n.check=1,n.mode=Ct;case Ct:if(t===wt||t===gt)break e;case zt:if(n.last){l>>>=7&c,c-=7&c,n.mode=Nt;break}for(;c<3;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}switch(n.last=1&l,c-=1,3&(l>>>=1)){case 0:n.mode=16193;break;case 1:if(Yt(n),n.mode=Ft,t===gt){l>>>=2,c-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Qt}l>>>=2,c-=2;break;case 16193:for(l>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if((65535&l)!==(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Qt;break}if(n.length=65535&l,l=0,c=0,n.mode=Rt,t===gt)break e;case Rt:n.mode=16195;case 16195:if(d=n.length){if(d>o&&(d=o),d>u&&(d=u),0===d)break e;a.set(r.subarray(i,i+d),s),o-=d,i+=d,u-=d,s+=d,n.length-=d;break}n.mode=Ct;break;case 16196:for(;c<14;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(n.nlen=257+(31&l),l>>>=5,c-=5,n.ndist=1+(31&l),l>>>=5,c-=5,n.ncode=4+(15&l),l>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Qt;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.lens[S[n.have++]]=7&l,l>>>=3,c-=3}for(;n.have<19;)n.lens[S[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},A=_t(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,A){e.msg="invalid code lengths set",n.mode=Qt;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;m=(E=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,w=65535&E,!((_=E>>>24)<=c);){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(w<16)l>>>=_,c-=_,n.lens[n.have++]=w;else{if(16===w){for(x=_+2;c<x;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(l>>>=_,c-=_,0===n.have){e.msg="invalid bit length repeat",n.mode=Qt;break}Z=n.lens[n.have-1],d=3+(3&l),l>>>=2,c-=2}else if(17===w){for(x=_+3;c<x;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}c-=_,Z=0,d=3+(7&(l>>>=_)),l>>>=3,c-=3}else{for(x=_+7;c<x;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}c-=_,Z=0,d=11+(127&(l>>>=_)),l>>>=7,c-=7}if(n.have+d>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Qt;break}for(;d--;)n.lens[n.have++]=Z}}if(n.mode===Qt)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Qt;break}if(n.lenbits=9,k={bits:n.lenbits},A=_t(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,A){e.msg="invalid literal/lengths set",n.mode=Qt;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},A=_t(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,A){e.msg="invalid distances set",n.mode=Qt;break}if(n.mode=Ft,t===gt)break e;case Ft:n.mode=Dt;case Dt:if(o>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,n.hold=l,n.bits=c,ct(e,h),s=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,n.mode===Ct&&(n.back=-1);break}for(n.back=0;m=(E=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,w=65535&E,!((_=E>>>24)<=c);){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(m&&0===(240&m)){for(g=_,y=m,b=w;m=(E=n.lencode[b+((l&(1<<g+y)-1)>>g)])>>>16&255,w=65535&E,!(g+(_=E>>>24)<=c);){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}l>>>=g,c-=g,n.back+=g}if(l>>>=_,c-=_,n.back+=_,n.length=w,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=Ct;break}if(64&m){e.msg="invalid literal/length code",n.mode=Qt;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(x=n.extra;c<x;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;m=(E=n.distcode[l&(1<<n.distbits)-1])>>>16&255,w=65535&E,!((_=E>>>24)<=c);){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(0===(240&m)){for(g=_,y=m,b=w;m=(E=n.distcode[b+((l&(1<<g+y)-1)>>g)])>>>16&255,w=65535&E,!(g+(_=E>>>24)<=c);){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}l>>>=g,c-=g,n.back+=g}if(l>>>=_,c-=_,n.back+=_,64&m){e.msg="invalid distance code",n.mode=Qt;break}n.offset=w,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(x=n.extra;c<x;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Qt;break}n.mode=16204;case 16204:if(0===u)break e;if(d=h-u,n.offset>d){if((d=n.offset-d)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Qt;break}d>n.wnext?(d-=n.wnext,p=n.wsize-d):p=n.wnext-d,d>n.length&&(d=n.length),v=n.window}else v=a,p=s-n.offset,d=n.length;d>u&&(d=u),u-=d,n.length-=d;do{a[s++]=v[p++]}while(--d);0===n.length&&(n.mode=Dt);break;case 16205:if(0===u)break e;a[s++]=n.length,u--,n.mode=Dt;break;case Nt:if(n.wrap){for(;c<32;){if(0===o)break e;o--,l|=r[i++]<<c,c+=8}if(h-=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?j(n.check,a,h,s-h):W(n.check,a,h,s-h)),h=u,4&n.wrap&&(n.flags?l:Ot(l))!==n.check){e.msg="incorrect data check",n.mode=Qt;break}l=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===o)break e;o--,l+=r[i++]<<c,c+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Qt;break}l=0,c=0}n.mode=16208;case 16208:A=bt;break e;case Qt:A=kt;break e;case 16210:return xt;default:return At}return e.next_out=s,e.avail_out=u,e.next_in=i,e.avail_in=o,n.hold=l,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<Qt&&(n.mode<Nt||t!==mt))&&Jt(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?j(n.check,a,h,e.next_out-h):W(n.check,a,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Ct?128:0)+(n.mode===Ft||n.mode===Rt?256:0),(0===f&&0===h||t===mt)&&A===yt&&(A=Et),A},inflateEnd:function(e){if(Wt(e))return At;var t=e.state;return t.window&&(t.window=null),e.state=null,yt},inflateGetHeader:function(e,t){if(Wt(e))return At;var n=e.state;return 0===(2&n.wrap)?At:(n.head=t,t.done=!1,yt)},inflateSetDictionary:function(e,t){var n,r=t.length;return Wt(e)||0!==(n=e.state).wrap&&n.mode!==Bt?At:n.mode===Bt&&W(1,t,r,0)!==n.check?kt:Jt(e,t,r,r)?(n.mode=16210,xt):(n.havedict=1,yt)},inflateInfo:"pako inflate (from Nodeca project)"};var Vt=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Xt=Object.prototype.toString,Kt=L.Z_NO_FLUSH,$t=L.Z_FINISH,en=L.Z_OK,tn=L.Z_STREAM_END,nn=L.Z_NEED_DICT,rn=L.Z_STREAM_ERROR,an=L.Z_DATA_ERROR,sn=L.Z_MEM_ERROR;function on(e){this.options=Ge.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Pe,this.strm.avail_out=0;var n=Pt.inflateInit2(this.strm,t.windowBits);if(n!==en)throw new Error(G[n]);if(this.header=new Vt,Pt.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=Je.string2buf(t.dictionary):"[object ArrayBuffer]"===Xt.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Pt.inflateSetDictionary(this.strm,t.dictionary))!==en))throw new Error(G[n])}function un(e,t){var n=new on(t);if(n.push(e),n.err)throw n.msg||G[n.err];return n.result}on.prototype.push=function(e,t){var n,r,a,i=this.strm,s=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?$t:Kt,"[object ArrayBuffer]"===Xt.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(s),i.next_out=0,i.avail_out=s),(n=Pt.inflate(i,r))===nn&&o&&((n=Pt.inflateSetDictionary(i,o))===en?n=Pt.inflate(i,r):n===an&&(n=nn));i.avail_in>0&&n===tn&&i.state.wrap>0&&0!==e[i.next_in];)Pt.inflateReset(i),n=Pt.inflate(i,r);switch(n){case rn:case an:case nn:case sn:return this.onEnd(n),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||n===tn))if("string"===this.options.to){var u=Je.utf8border(i.output,i.next_out),l=i.next_out-u,c=Je.buf2string(i.output,u);i.next_out=l,i.avail_out=s-l,l&&i.output.set(i.output.subarray(u,u+l),0),this.onData(c)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(n!==en||0!==a){if(n===tn)return n=Pt.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},on.prototype.onData=function(e){this.chunks.push(e)},on.prototype.onEnd=function(e){e===en&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ge.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ln={Inflate:on,inflate:un,inflateRaw:function(e,t){return(t=t||{}).raw=!0,un(e,t)},ungzip:un,constants:L},cn=ut.gzip,fn=ln.Inflate,hn=ln.inflate,dn=ln.ungzip,pn=cn,vn=fn,_n=hn,mn=dn},5941:function(e,t,n){n.d(t,{NC:function(){return a},Yd:function(){return s},pJ:function(){return i},xW:function(){return o}});var r=n(8782);function a(e,t){r.RE((function(n){return n.FS.writeFile(e,t)}))}function i(e){return r.RE((function(t){return t.FS.readFile(e,{encoding:"binary"})}))}function s(e){r.RE((function(t){return t.FS.unlink(e)}))}function o(e){return r.RE((function(t){return t.FS.analyzePath(e).exists}))}},489:function(e,t,n){n.d(t,{NC:function(){return a},Yd:function(){return s},pJ:function(){return i},xW:function(){return o}});var r=n(5941);function a(e,t){r.NC(e,t)}function i(e){return r.pJ(e)}function s(e){o(e)&&r.Yd(e)}function o(e){return r.xW(e)}},6126:function(e,t,n){n.d(t,{Fv:function(){return D},ll:function(){return O},pT:function(){return Q}});var r=n(2415),a=n(7326),i=n(136),s=n(9388),o=n(3324),u=n(5671),l=n(3144),c=n(101),f=n(2346),h=n(3889),d=n(8916),p=n(2793),v=n(7762),_=n(6635),m=n(8782),w=n(6774),g=n(4292);function y(e,t){if(t.length>0){var n=t.reduce((function(e,t){return e*t}));if(e.length!=n)throw new Error("length of 'x' must be equal to the product of 'shape'")}else if(e instanceof Array||ArrayBuffer.isView(e)){if(1!=e.length)throw new Error("length of 'x' should be 1 for a scalar dataset")}else e=[e];return e}function b(e,t){return null===t?"string"==typeof e||"number"==typeof e?(e=[e],t=[]):t=[e.length]:e=y(e,t),{x:e,shape:t}}function Z(e){if(Array.isArray(e)){var t,n=(0,v.Z)(e);try{for(n.s();!(t=n.n()).done;){if("string"===typeof t.value)throw new Error("'x' should not contain any strings for a non-string HDF5 dataset")}}catch(r){n.e(r)}finally{n.f()}}}function A(e){var t=0;return e.array().forEach((function(e){t<e&&(t=e)})),t}function k(e,t,n){if(null!==t){var r,a=(0,v.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!Number.isInteger(i)||i<0||i>=t.length)throw new Error("'"+n+"' must contain non-negative integers less than 'levels.length' for 'type = \"Enum\"'")}}catch(l){a.e(l)}finally{a.f()}}else{var s=g.KB(e,{asWasmArray:!1});e=s.ids,t=s.levels;var o,u=(0,v.Z)(t);try{for(u.s();!(o=u.n()).done;){if("string"!==typeof o.value)throw new Error("'"+n+"' should only contain string levels for 'type = \"Enum\"'")}}catch(l){u.e(l)}finally{u.f()}}return{values:e,levels:t}}var x=new WeakMap,E=new WeakMap,I=new WeakMap,S=new WeakSet,B=function(){function e(t,n){(0,u.Z)(this,e),(0,c.Z)(this,S),(0,f.Z)(this,x,{writable:!0,value:void 0}),(0,f.Z)(this,E,{writable:!0,value:void 0}),(0,f.Z)(this,I,{writable:!0,value:void 0}),(0,p.Z)(this,x,t),(0,p.Z)(this,E,n)}return(0,l.Z)(e,[{key:"file",get:function(){return(0,d.Z)(this,x)}},{key:"name",get:function(){return(0,d.Z)(this,E)}},{key:"attributes",get:function(){return(0,d.Z)(this,I)}},{key:"set_attributes",value:function(e){(0,p.Z)(this,I,e)}},{key:"readAttribute",value:function(e){var t=this,n={values:null,shape:null},r=m.RE((function(n){return new n.LoadedH5Attr(t.file,t.name,e)}));try{n.shape=Array.from(r.shape());var a=r.type();if("other"==a)throw new Error("cannot load dataset for an unsupported type");"String"==a?n.values=w.b(r.string_buffer(),r.string_lengths()):"Enum"==a?(n.values=r.numeric_values().slice(),n.levels=w.b(r.string_buffer(),r.string_lengths())):n.values=r.numeric_values().slice()}finally{r.delete()}return n}},{key:"writeAttribute",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=i.maxStringLength,u=void 0===s?null:s,l=i.levels,c=void 0===l?null:l;if(null===r)throw new Error("cannot write 'null' to HDF5");var f=b(r,n);if(r=f.x,n=f.shape,"String"==t){var d=w.C(r),p=(0,o.Z)(d,2),v=p[0],g=p[1];try{null==u&&(u=A(v)),(0,h.Z)(this,S,C).call(this,e,t,n,{maxStringLength:u}),m.RE((function(t){return t.write_string_hdf5_attribute(a.file,a.name,e,v.length,v.offset,g.offset)}))}finally{_.gd(g),_.gd(v)}}else if("Enum"==t){var y=k(r,c,"x"),x=_.de(y.values,"Int32WasmArray");try{(0,h.Z)(this,S,C).call(this,e,t,n,{levels:y.levels}),m.RE((function(t){return t.write_enum_hdf5_attribute(a.file,a.name,e,x.offset)}))}finally{x.free()}}else{Z(r);var E=_.de(r,null);try{(0,h.Z)(this,S,C).call(this,e,t,n),m.RE((function(t){return t.write_numeric_hdf5_attribute(a.file,a.name,e,E.constructor.className,E.offset)}))}finally{E.free()}}}}]),e}();function C(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=a.maxStringLength,s=void 0===i?null:i,u=a.levels,l=void 0===u?null:u,c=_.de(n,"Int32WasmArray");try{if("String"==t)m.RE((function(t){return t.create_string_hdf5_attribute(r.file,r.name,e,c.length,c.offset,s)}));else if("Enum"==t){if(null==l)throw new Error("levels must be supplied if 'type = \"Enum\"'");var f=w.C(l),h=(0,o.Z)(f,2),p=h[0],v=h[1];m.RE((function(t){return t.create_enum_hdf5_attribute(r.file,r.name,e,c.length,c.offset,p.length,p.offset,v.offset)}))}else m.RE((function(n){return n.create_numeric_hdf5_attribute(r.file,r.name,e,c.length,c.offset,t)}));(0,d.Z)(this,I).push(e)}finally{c.free()}}var z=new WeakMap,R=new WeakMap,F=new WeakSet,D=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var i,s=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).newlyCreated,o=void 0!==s&&s;if((0,u.Z)(this,n),i=t.call(this,e,r),(0,c.Z)((0,a.Z)(i),F),(0,f.Z)((0,a.Z)(i),z,{writable:!0,value:void 0}),(0,f.Z)((0,a.Z)(i),R,{writable:!0,value:void 0}),o)(0,p.Z)((0,a.Z)(i),z,{}),i.set_attributes([]);else{var l=m.RE((function(t){return new t.H5GroupDetails(e,r)}));try{var h=w.b(l.child_buffer(),l.child_lengths()),v=l.child_types(),_=["Group","DataSet","Other"];(0,p.Z)((0,a.Z)(i),z,{});for(var g=0;g<h.length;g++)(0,d.Z)((0,a.Z)(i),z)[h[g]]=_[v[g]];var y=w.b(l.attr_buffer(),l.attr_lengths());i.set_attributes(y)}finally{l.delete()}}return i}return(0,l.Z)(n,[{key:"children",get:function(){return(0,d.Z)(this,z)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,h.Z)(this,F,N).call(this,e);if(e in(0,d.Z)(this,z)){if("Group"==(0,d.Z)(this,z)[e])return new n(this.file,r,t);if("DataSet"==(0,d.Z)(this,z)[e])return new j(this.file,r,t);throw new Error("don't know how to open '"+e+"'")}throw new Error("no '"+e+"' child in this HDF5 Group")}},{key:"createGroup",value:function(e){var t=this,r=(0,h.Z)(this,F,N).call(this,e);if(e in this.children){if("Group"==this.children[e])return new n(this.file,r);throw new Error("existing child '"+r+"' is not a HDF5 group")}return m.RE((function(e){return e.create_hdf5_group(t.file,r)})),this.children[e]="Group",new n(this.file,r,{newlyCreated:!0})}},{key:"createDataSet",value:function(e,t,n){var r,a,i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=s.maxStringLength,l=void 0===u?10:u,c=s.levels,f=void 0===c?null:c,d=s.compression,p=void 0===d?6:d,v=s.chunks,g=void 0===v?null:v,y=(0,h.Z)(this,F,N).call(this,e);try{var b=(r=_.de(n,"Int32WasmArray")).offset;if(null!==g){if((a=_.de(g,"Int32WasmArray")).length!=r.length)throw new Error("'chunks' and 'shape' should have the same dimensions");b=a.offset}if("String"==t)m.RE((function(e){return e.create_string_hdf5_dataset(i.file,y,r.length,r.offset,p,b,l)}));else if("Enum"==t){if(null==f)throw new Error("levels must be supplied if 'type = \"Enum\"'");var Z=w.C(f),A=(0,o.Z)(Z,2),k=A[0],x=A[1];m.RE((function(e){return e.create_enum_hdf5_dataset(i.file,y,r.length,r.offset,p,b,k.length,k.offset,x.offset)}))}else m.RE((function(e){return e.create_numeric_hdf5_dataset(i.file,y,r.length,r.offset,p,b,t)}))}finally{r.free()}return this.children[e]="DataSet",new j(this.file,y,{newlyCreated:!0,type:t,shape:n})}},{key:"writeDataSet",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=a.levels,s=void 0===i?null:i,u=a.compression,l=void 0===u?6:u,c=a.chunks,f=void 0===c?null:c,h=a.cache,d=void 0!==h&&h;if(null===r)throw new Error("cannot write 'null' to HDF5");var p,v=b(r,n);if(r=v.x,n=v.shape,"String"==t){var g=w.C(r),y=(0,o.Z)(g,2),Z=y[0],x=y[1];try{var E=A(Z);p=this.createDataSet(e,"String",n,{maxStringLength:E,compression:l,chunks:f}),m.RE((function(e){return e.write_string_hdf5_dataset(p.file,p.name,Z.length,Z.offset,x.offset)}))}finally{_.gd(Z),_.gd(x)}p.cache_loaded(r,d)}else if("Enum"==t){var I=k(r,s,"x");(p=this.createDataSet(e,t,n,{levels:I.levels,compression:l,chunks:f})).write(I.values,{cache:d})}else(p=this.createDataSet(e,t,n,{compression:l,chunks:f})).write(r,{cache:d});return p}}]),n}(B);function N(e){var t=this.name;return"/"!=t&&(t+="/"),t+=e}var Q=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,u.Z)(this,n),t.call(this,e,"/",r)}return(0,l.Z)(n)}(D);function O(e){return m.RE((function(t){return t.create_hdf5_file(e)})),new Q(e,{newlyCreated:!0})}var q=new WeakMap,M=new WeakMap,U=new WeakMap,W=new WeakMap,T=new WeakMap,j=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e,i){var s,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=o.load,c=void 0!==l&&l,h=o.newlyCreated,d=void 0!==h&&h,v=o.shape,_=void 0===v?null:v,g=o.type,y=void 0===g?null:g,b=o.values,Z=void 0===b?null:b;if((0,u.Z)(this,n),s=t.call(this,e,i),(0,f.Z)((0,a.Z)(s),q,{writable:!0,value:void 0}),(0,f.Z)((0,a.Z)(s),M,{writable:!0,value:void 0}),(0,f.Z)((0,a.Z)(s),U,{writable:!0,value:void 0}),(0,f.Z)((0,a.Z)(s),W,{writable:!0,value:void 0}),(0,f.Z)((0,a.Z)(s),T,{writable:!0,value:void 0}),d){if(null===_||null===y)throw new Error("need to pass 'shape' and 'type' if 'newlyCreated = true'");(0,p.Z)((0,a.Z)(s),q,_),(0,p.Z)((0,a.Z)(s),M,y),(0,p.Z)((0,a.Z)(s),U,Z),(0,p.Z)((0,a.Z)(s),T,null!==Z),s.set_attributes([])}else{if(c){var A=(0,r.Z)(n,n,G).call(n,e,i);(0,p.Z)((0,a.Z)(s),M,A.type),(0,p.Z)((0,a.Z)(s),q,A.shape),(0,p.Z)((0,a.Z)(s),U,A.values),(0,p.Z)((0,a.Z)(s),W,A.levels),s.set_attributes(A.attributes)}else{var k=m.RE((function(t){return new t.H5DataSetDetails(e,i)}));try{(0,p.Z)((0,a.Z)(s),M,k.type()),(0,p.Z)((0,a.Z)(s),q,Array.from(k.shape())),(0,p.Z)((0,a.Z)(s),U,null),s.set_attributes(w.b(k.attr_buffer(),k.attr_lengths()))}finally{k.delete()}}(0,p.Z)((0,a.Z)(s),T,c)}return s}return(0,l.Z)(n,[{key:"type",get:function(){return(0,d.Z)(this,M)}},{key:"shape",get:function(){return(0,d.Z)(this,q)}},{key:"loaded",get:function(){return(0,d.Z)(this,T)}},{key:"values",get:function(){return(0,d.Z)(this,U)}},{key:"levels",get:function(){return(0,d.Z)(this,W)}},{key:"load",value:function(){if(!(0,d.Z)(this,T)){var e=(0,r.Z)(n,n,G).call(n,this.file,this.name);(0,p.Z)(this,U,e.values),(0,p.Z)(this,T,!0)}return(0,d.Z)(this,U)}},{key:"cache_loaded",value:function(e,t){t?((0,p.Z)(this,U,e.slice()),(0,p.Z)(this,T,!0)):((0,p.Z)(this,T,!1),(0,p.Z)(this,U,null))}},{key:"write",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cache,r=void 0!==n&&n;if(null===e)throw new Error("cannot write 'null' to HDF5");if(e=y(e,this.shape),"String"==this.type){var a=w.C(e),i=(0,o.Z)(a,2),s=i[0],u=i[1];try{m.RE((function(e){return e.write_string_hdf5_dataset(t.file,t.name,s.length,s.offset,u.offset)}))}finally{_.gd(u),_.gd(s)}this.cache_loaded(e,r)}else if("Enum"==this.type){var l=_.de(e,"Int32WasmArray");try{m.RE((function(e){return e.write_enum_hdf5_dataset(t.file,t.name,l.offset)}))}finally{l.free()}}else{Z(e);var c=_.de(e,null);try{m.RE((function(e){return e.write_numeric_hdf5_dataset(t.file,t.name,c.constructor.className,c.offset)})),this.cache_loaded(c,r)}finally{c.free()}}}}]),n}(B);function G(e,t){var n,r,a,i,s=null,o=m.RE((function(n){return new n.LoadedH5DataSet(e,t)}));try{if("other"==(r=o.type()))throw new Error("cannot load dataset for an unsupported type");"String"==r?n=w.b(o.string_buffer(),o.string_lengths()):"Enum"==r?(n=o.numeric_values().slice(),s=w.b(o.string_buffer(),o.string_lengths())):n=o.numeric_values().slice(),a=Array.from(o.shape()),i=w.b(o.attr_buffer(),o.attr_lengths())}finally{o.delete()}return{values:n,type:r,shape:a,levels:s,attributes:i}}},5831:function(e,t,n){n.d(t,{$H:function(){return U.$},BA:function(){return s.BA},Bp:function(){return i.Bp},Bs:function(){return N.B},Cb:function(){return Z.C},D4:function(){return f.D4},D6:function(){return s.D6},DS:function(){return f.DS},EF:function(){return i.EF},F5:function(){return z.F},Fu:function(){return I.Fu},Fv:function(){return u.Fv},II:function(){return s.II},J4:function(){return m.J4},KV:function(){return d.KV},Lw:function(){return w.Lw},N6:function(){return i.N6},OV:function(){return F.OV},Os:function(){return D.Os},Qj:function(){return D.Qj},RJ:function(){return a.RJ},SV:function(){return s.SV},St:function(){return D.St},TS:function(){return a.TS},Tk:function(){return B.Tk},VU:function(){return M.V},Wf:function(){return a.Wf},XU:function(){return y.XU},Y8:function(){return x.Y},Yd:function(){return o.Yd},Yh:function(){return h.Yh},ZI:function(){return S.ZI},ZW:function(){return p.ZW},_3:function(){return i._3},_u:function(){return U._},aG:function(){return E.dO},bD:function(){return S.bD},b_:function(){return b.b},eu:function(){return C.eu},f:function(){return l.f},fw:function(){return f.fw},gd:function(){return a.gd},gk:function(){return A.g},gn:function(){return c.g},j2:function(){return r.j2},j4:function(){return f.j4},jX:function(){return R.j},ll:function(){return u.ll},nO:function(){return g.nO},o1:function(){return q.p},p$:function(){return s.p$},p4:function(){return O.p},pG:function(){return D.pG},pJ:function(){return o.pJ},pT:function(){return u.pT},qu:function(){return s.qu},rY:function(){return k.rY},tY:function(){return D.tY},us:function(){return i.us},v_:function(){return A.v},vc:function(){return p.vc},vy:function(){return _.dH},wf:function(){return I.wf},wj:function(){return v.wj},xw:function(){return Q.x},y5:function(){return F.y5}});var r=n(8782),a=n(6635),i=n(8311),s=n(6663),o=n(489),u=n(6126),l=n(118),c=n(2284),f=n(5644),h=n(4292),d=n(5470),p=n(1196),v=(n(5219),n(5448)),_=n(9206),m=n(2945),w=n(7339),g=n(6757),y=n(4609),b=n(8420),Z=(n(845),n(9283),n(6974)),A=n(1184),k=n(4812),x=n(6199),E=n(5159),I=n(7067),S=n(9273),B=n(4181),C=(n(5319),n(2494)),z=n(5696),R=n(2732),F=n(9249),D=n(3779),N=n(7039),Q=n(5538),O=(n(7644),n(6961)),q=n(2306),M=n(4021),U=n(4755)},4755:function(e,t,n){n.d(t,{$:function(){return s},_:function(){return i}});var r=n(489),a=n(3102);function i(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).extension,t=void 0===e?"":e;return a.E("temp_",t)}function s(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).extension,n=void 0===t?"":t;if("string"==typeof e)return a.z(e);var s=i({extension:n});return r.NC(s,e),{path:s,flush:function(){return r.Yd(s)}}}},118:function(e,t,n){n.d(t,{f:function(){return i}});var r=n(6126),a=n(8782);function i(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=i.format,o=void 0===s?null:s,u=i.forceInteger,l=void 0!==u&&u;null==o&&(o="automatic"),o=a.RE((function(r){return r.write_sparse_matrix_to_hdf5(e.matrix,t,n,o,l)}));var c=new r.Fv(t,n),f=[e.numberOfRows(),e.numberOfColumns()];if("tenx_matrix"==o)c.writeDataSet("shape","Int32",null,f);else if("csr_matrix"==o)c.writeAttribute("encoding-type","String",null,"csr_matrix"),c.writeAttribute("shape","Int32",null,f.reverse());else{if("csc_matrix"!=o)throw new Error("unknown format '"+o+"'");c.writeAttribute("encoding-type","String",null,"csc_matrix"),c.writeAttribute("shape","Int32",null,f.reverse())}}}}]);
//# sourceMappingURL=797.8373150e.chunk.js.map