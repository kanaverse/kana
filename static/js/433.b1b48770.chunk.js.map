{"version":3,"file":"static/js/433.b1b48770.chunk.js","mappings":"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","sources":["../node_modules/bakana/browser/steps/tsne.worker.js","../node_modules/scran.js/browser/runTSNE.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import * as scran from \"scran.js\";\nimport * as utils from \"./utils/general.js\";\nimport * as vizutils from \"./utils/viz_child.js\";\nimport * as aworkers from \"./abstract/worker_child.js\";\n\nvar cache = {};\nvar init_changed = false;\nvar init_parameters = {};\nvar run_parameters = {};\nvar dead = false;\n\nfunction rerun(animate, iterations) {\n    var num_obs = cache.init.numberOfCells(); \n    var delay = vizutils.chooseDelay(animate);\n    var current_status = cache.init.clone();\n\n    try {\n        for (; current_status.iterations() < iterations; ) {\n            scran.runTSNE(current_status, { runTime: delay, maxIterations: iterations }); \n  \n            if (animate) {\n                let xy = current_status.extractCoordinates();\n                aworkers.sendMessage({\n                    \"type\": \"tsne_iter\",\n                    \"x\": xy.x,\n                    \"y\": xy.y,\n                    \"iteration\": current_status.iterations()\n                }, [xy.x.buffer, xy.y.buffer]);\n            }\n        }\n        cache.final = current_status.extractCoordinates();\n\n    } finally {\n        current_status.free();\n    }\n}\n\nvar loaded;\naworkers.registerCallback(msg => {\n    var id = msg.data.id;\n    if (dead) {\n        aworkers.sendMessage({\n            \"id\": id,\n            \"type\": \"error\",\n            \"error\": \"t-SNE worker is dead and cannot process messages\"\n        });\n        return;\n    }\n\n    if (msg.data.cmd == \"INIT\") {\n        loaded = scran.initialize(msg.data.scranOptions); \n        loaded\n            .then(x => {\n                aworkers.sendMessage({\n                    \"id\": id,\n                    \"type\": \"init_worker\",\n                    \"data\": { \"status\": \"SUCCESS\" }\n                });\n            })\n            .catch(error => {\n                aworkers.sendMessage({ \n                    \"id\": id,\n                    \"type\": \"error\",\n                    \"error\": error\n                });\n            });\n  \n    } else if (msg.data.cmd == \"RUN\") {\n        loaded\n            .then(x => {\n                var new_neighbors;\n                if (\"neighbors\" in msg.data) {\n                    utils.freeCache(cache.neighbors);\n                    cache.neighbors = vizutils.recreateNeighbors(msg.data.neighbors);\n                    new_neighbors = true;\n                } else {\n                    new_neighbors = false;\n                }\n\n                var init_args = { \"perplexity\": msg.data.params.perplexity };\n                if (!new_neighbors && !utils.changedParameters(init_args, init_parameters)) {\n                    init_changed = false;\n                } else {\n                    utils.freeCache(cache.init);\n                    cache.init = scran.initializeTSNE(cache.neighbors, { perplexity: init_args.perplexity });\n                    init_parameters = init_args;\n                    init_changed = true;\n                }\n\n                // Nothing downstream depends on the run results, so we don't set any changed flag.\n                var run_args = { \"iterations\": msg.data.params.iterations };\n                if (init_changed || utils.changedParameters(run_args, run_parameters)) {\n                    rerun(msg.data.params.animate, run_args.iterations);\n                    run_parameters = run_args;\n                }\n          \n                aworkers.sendMessage({\n                    \"id\": id,\n                    \"type\": \"tsne_run\",\n                    \"data\": { \"status\": \"SUCCESS\" }\n                });\n            })\n            .catch(error => {\n                aworkers.sendMessage({ \n                    \"id\": id,\n                    \"type\": \"error\",\n                    \"error\": error\n                });\n            });\n  \n    } else if (msg.data.cmd == \"RERUN\") {\n        loaded\n            .then(x => {\n                rerun(true, run_parameters.iterations);\n                aworkers.sendMessage({\n                    \"id\": id,\n                    \"type\": \"tsne_rerun\",\n                    \"data\": { \"status\": \"SUCCESS\" }\n                });\n            })\n            .catch(error => {\n                aworkers.sendMessage({ \n                    \"id\": id,\n                    \"type\": \"error\",\n                    \"error\": error\n                });\n            });\n\n    } else if (msg.data.cmd == \"FETCH\") {\n        loaded\n            .then(x => {\n                var info = {\n                    \"x\": cache.final.x.slice(),\n                    \"y\": cache.final.y.slice(),\n                    \"iterations\": run_parameters.iterations\n                };\n                var transfer = [info.x.buffer, info.y.buffer];\n                aworkers.sendMessage({\n                    \"id\": id,\n                    \"type\": \"tsne_fetch\",\n                    \"data\": info\n                }, transfer);\n            })\n            .catch(error => {\n                aworkers.sendMessage({ \n                    \"id\": id,\n                    \"type\": \"error\",\n                    \"error\": error\n                });\n            });\n\n    } else if (msg.data.cmd == \"KILL\") {\n        dead = true;\n        loaded\n            .then(x => {\n                scran.terminate();\n                aworkers.sendMessage({\n                    \"id\": id,\n                    \"type\": \"tsne_killed\",\n                    \"data\": null\n                });\n            })\n            .catch(error => {\n                aworkers.sendMessage({ \n                    \"id\": id,\n                    \"type\": \"error\",\n                    \"error\": error\n                });\n            });\n\n    } else {\n        aworkers.sendMessage({\n            \"id\": id,\n            \"type\": \"error\",\n            \"error\": \"unknown message type '\" + JSON.stringify(msg.data) + \"'\"\n        });\n    }\n});\n","import * as utils from \"./utils.js\";\nimport * as wasm from \"./wasm.js\";\nimport * as gc from \"./gc.js\";\nimport { BuildNeighborSearchIndexResults, findNearestNeighbors } from \"./findNearestNeighbors.js\";\n\n/**\n * Wrapper around the t-SNE status object on the Wasm heap, typically created by {@linkcode initializeTSNE}.\n * @hideconstructor\n */\nexport class InitializeTSNEResults {\n    #id;\n    #status;\n    #coordinates;\n\n    constructor(id, raw_status, raw_coordinates) {\n        this.#id = id;\n        this.#status = raw_status;\n        this.#coordinates = raw_coordinates;\n        return;\n    }\n\n    // Internal use only, not documented.\n    get status() {\n        return this.#status;\n    }\n\n    // Internal use only, not documented.\n    get coordinates() {\n        return this.#coordinates;\n    }\n\n    /**\n     * @return {InitializeTSNEResults} A deep copy of this object.\n     */\n    clone() {\n        return gc.call(\n            module => this.#status.deepcopy(), \n            InitializeTSNEResults, \n            this.#coordinates.clone()\n        );\n    }\n\n    /**\n     * @return {number} Number of cells in the dataset.\n     */\n    numberOfCells () {\n        return this.#status.num_obs();\n    }\n\n    /**\n     * @return {number} Number of iterations processed so far.\n     * This will change with repeated invocations of {@linkcode runTSNE} on this object.\n     */\n    iterations () {\n        return this.#status.iterations();\n    }\n\n    /**\n     * @return {object} Object with `x` and `y` keys.\n     * The corresponding values are Float64Array objects of length equal to the number of cells,\n     * containing the x- and  y- coordinates for each cell at the current state of the algorithm.\n     */\n    extractCoordinates() {\n        return utils.extractXY(this.numberOfCells(), this.#coordinates.array()); \n    }\n\n    /**\n     * @return Frees the memory allocated on the Wasm heap for this object.\n     * This invalidates this object and all references to it.\n     */   \n    free() {\n        if (this.#status !== null) {\n            gc.release(this.#id);\n            this.#status = null;\n        }\n        if (this.#coordinates !== null) {\n            this.#coordinates.free();\n            this.#coordinates = null;\n        }\n        return;\n    }\n}\n\n/**\n * @param {number} perplexity - Perplexity to use in the t-SNE algorithm.\n * @return {number} Appropriate number of neighbors to use in the nearest neighbor search.\n */\nexport function perplexityToNeighbors(perplexity) {\n    return wasm.call(module => module.perplexity_to_k(perplexity));\n}\n\n/**\n * @param {(BuildNeighborSearchIndexResults|FindNearestNeighborsResults)} x \n * Either a pre-built neighbor search index for the dataset (see {@linkcode buildNeighborSearchIndex}),\n * or a pre-computed set of neighbor search results for all cells (see {@linkcode findNearestNeighbors}).\n * @param {object} [options={}] - Optional parameters.\n * @param {number} [options.perplexity=30] - Perplexity to use when computing neighbor probabilities in the t-SNE.\n * @param {boolean} [options.checkMismatch=true] - Whether to check for a mismatch between the perplexity and the number of searched neighbors.\n * Only relevant if `x` is a {@linkplain FindNearestNeighborsResults} object.\n * @param {?number} [options.numberOfThreads=null] - Number of threads to use.\n * If `null`, defaults to {@linkcode maximumThreads}.\n *\n * @return {InitializeTSNEResults} Object containing the initial status of the t-SNE algorithm.\n */\nexport function initializeTSNE(x, { perplexity = 30, checkMismatch = true, numberOfThreads = null } = {}) {\n    var my_neighbors;\n    var raw_coords;\n    var output;\n    let nthreads = utils.chooseNumberOfThreads(numberOfThreads);\n\n    try {\n        let neighbors;\n\n        if (x instanceof BuildNeighborSearchIndexResults) {\n            let k = perplexityToNeighbors(perplexity);\n            my_neighbors = findNearestNeighbors(x, k, { numberOfThreads: nthreads });\n            neighbors = my_neighbors;\n\n        } else {\n            if (checkMismatch) {\n                let k = perplexityToNeighbors(perplexity);\n                if (k * x.numberOfCells() != x.size()) {\n                    throw new Error(\"number of neighbors in 'x' does not match '3 * perplexity'\");\n                }\n            }\n            neighbors = x;\n        }\n\n        raw_coords = utils.createFloat64WasmArray(2 * neighbors.numberOfCells());\n        wasm.call(module => module.randomize_tsne_start(neighbors.numberOfCells(), raw_coords.offset, 42));\n        output = gc.call(\n            module => module.initialize_tsne(neighbors.results, perplexity, nthreads),\n            InitializeTSNEResults,\n            raw_coords\n        );\n\n    } catch(e) {\n        utils.free(output);\n        utils.free(raw_coords);\n        throw e;\n\n    } finally {\n        utils.free(my_neighbors);\n    }\n\n    return output;\n}\n\n/**\n * Run the t-SNE algorithm on an initialized {@linkplain InitializeTSNEResults}.\n *\n * @param {InitializeTSNEResults} x A previously initialized status object from {@linkcode initializeTSNE}.\n * This may be passed through {@linkcode runTSNE} any number of times.\n * @param {object} [options={}] - Optional parameters.\n * @param {number} [options.maxIterations=1000] - Maximum number of iterations to perform.\n * This number includes all existing iterations that were already performed in `x` from previous calls to {@linkcode runTSNE}.\n * @param {?number} [options.runTime=null] - Number of milliseconds for which the algorithm is allowed to run before returning.\n * If `null`, no limit is imposed on the runtime.\n *\n * @return The algorithm status in `x` is advanced up to the requested number of iterations,\n * or until the requested run time is exceeded, whichever comes first.\n */\nexport function runTSNE(x, { maxIterations = 1000, runTime = null } = {}) {\n    if (runTime === null) {\n        runTime = -1;\n    }\n    wasm.call(module => module.run_tsne(x.status, runTime, maxIterations, x.coordinates.offset));\n    return;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [764,115], () => (__webpack_require__(5814)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"115\":\"c0812ed2\",\"764\":\"9d24566f\",\"814\":\"f3dd3a53\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"/kana/\";","__webpack_require__.b = self.location + \"/../../../\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t433: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkkana\"] = self[\"webpackChunkkana\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([\n\t\t__webpack_require__.e(764),\n\t\t__webpack_require__.e(115)\n\t]).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["loaded","cache","init_changed","init_parameters","run_parameters","dead","rerun","animate","iterations","init","numberOfCells","delay","vizutils","current_status","clone","scran","runTime","maxIterations","xy","extractCoordinates","aworkers","x","y","buffer","final","free","msg","id","data","cmd","scranOptions","then","catch","error","new_neighbors","utils","neighbors","init_args","params","perplexity","run_args","info","slice","transfer","JSON","stringify","_id","WeakMap","_status","_coordinates","InitializeTSNEResults","constructor","raw_status","raw_coordinates","_classPrivateFieldInitSpec","_classPrivateFieldSet","this","status","_classPrivateFieldGet","coordinates","gc","module","deepcopy","num_obs","array","perplexityToNeighbors","wasm","perplexity_to_k","initializeTSNE","checkMismatch","numberOfThreads","arguments","length","undefined","my_neighbors","raw_coords","output","nthreads","BuildNeighborSearchIndexResults","k","findNearestNeighbors","size","Error","randomize_tsne_start","offset","initialize_tsne","results","e","runTSNE","run_tsne","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","m","__webpack_exports__","O","deferred","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","b","self","location","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","push","bind","moreModules","runtime","pop","next"],"sourceRoot":""}