/*! For license information please see 830.b268cfd2.chunk.js.LICENSE.txt */
(self.webpackChunkkana=self.webpackChunkkana||[]).push([[830],{1025:function(e,t){var n,r,i;r=[],n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,r=t.IS_PAPA_WORKER||!1,i={},a=0,s={parse:function(n,r){var u=(r=r||{}).dynamicTyping||!1;if(g(u)&&(r.dynamicTypingFunction=u,u={}),r.dynamicTyping=u,r.transform=!!g(r.transform)&&r.transform,r.worker&&s.WORKERS_SUPPORTED){var o=function(){if(!s.WORKERS_SUPPORTED)return!1;var n,r,u=(n=t.URL||t.webkitURL||null,r=e.toString(),s.BLOB_URL||(s.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))),o=new t.Worker(u);return o.onmessage=p,o.id=a++,i[o.id]=o}();return o.userStep=r.step,o.userChunk=r.chunk,o.userComplete=r.complete,o.userError=r.error,r.step=g(r.step),r.chunk=g(r.chunk),r.complete=g(r.complete),r.error=g(r.error),delete r.worker,void o.postMessage({input:n,config:r,workerId:o.id})}var d=null;return s.NODE_STREAM_INPUT,"string"==typeof n?(n=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(n),d=r.download?new l(r):new f(r)):!0===n.readable&&g(n.read)&&g(n.on)?d=new h(r):(t.File&&n instanceof File||n instanceof Object)&&(d=new c(r)),d.stream(n)},unparse:function(e,t){var n=!1,r=!0,i=",",a="\r\n",u='"',o=u+u,l=!1,c=null,f=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(u=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(o=t.escapeChar+u),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(f=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(v(u),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,l);if("object"==typeof e[0])return d(c||Object.keys(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function d(e,t,n){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var u=Array.isArray(e)&&0<e.length,o=!Array.isArray(t[0]);if(u&&r){for(var l=0;l<e.length;l++)0<l&&(s+=i),s+=m(e[l],l);0<t.length&&(s+=a)}for(var c=0;c<t.length;c++){var f=u?e.length:t[c].length,h=!1,d=u?0===Object.keys(t[c]).length:0===t[c].length;if(n&&!u&&(h="greedy"===n?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===n&&u){for(var v=[],p=0;p<f;p++){var Z=o?e[p]:p;v.push(t[c][Z])}h=""===v.join("").trim()}if(!h){for(var w=0;w<f;w++){0<w&&!d&&(s+=i);var y=u&&o?e[w]:w;s+=m(t[c][y],w)}c<t.length-1&&(!n||0<f&&!d)&&(s+=a)}}return s}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=!1;f&&"string"==typeof e&&f.test(e)&&(e="'"+e,r=!0);var a=e.toString().replace(h,o);return(r=r||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(a,s.BAD_DELIMITERS)||-1<a.indexOf(i)||" "===a.charAt(0)||" "===a.charAt(a.length-1))?u+a+u:a}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=m,s.ParserHandle=d,s.NetworkStreamer=l,s.FileStreamer=c,s.StringStreamer=f,s.ReadableStreamStreamer=h,t.jQuery){var u=t.jQuery;u.fn.parse=function(e){var n=e.config||{},r=[];return this.each((function(e){if("INPUT"!==u(this).prop("tagName").toUpperCase()||"file"!==u(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:u.extend({},n)})})),i(),this;function i(){if(0!==r.length){var t,n,i,o,l=r[0];if(g(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return t="AbortError",n=l.file,i=l.inputElem,o=c.reason,void(g(e.error)&&e.error({name:t},n,i,o));if("skip"===c.action)return void a();"object"==typeof c.config&&(l.instanceConfig=u.extend(l.instanceConfig,c.config))}else if("skip"===c)return void a()}var f=l.instanceConfig.complete;l.instanceConfig.complete=function(e){g(f)&&f(e,l.file,l.inputElem),a()},s.parse(l.file,l.instanceConfig)}else g(e.complete)&&e.complete()}function a(){r.splice(0,1),i()}}}function o(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=y(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new d(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&g(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+e;this._partialLine="";var u=this._handle.parse(a,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var o=u.meta.cursor;this._finished||(this._partialLine=a.substring(o-this._baseIndex),this._baseIndex=o),u&&u.data&&(this._rowCount+=u.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:u,workerId:s.WORKER_ID,finished:l});else if(g(this._config.chunk)&&!n){if(this._config.chunk(u,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);u=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(u.data),this._completeResults.errors=this._completeResults.errors.concat(u.errors),this._completeResults.meta=u.meta),this._completed||!l||!g(this._config.complete)||u&&u.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||u&&u.meta.paused||this._nextChunk(),u}this._halted=!0},this._sendError=function(e){g(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function l(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),o.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function c(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),o.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,i)}var a=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;o.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){o.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){o.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){o.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=b((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=b((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=b((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function d(e){var t,n,r,i=Math.pow(2,53),a=-i,u=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,o=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,c=0,f=0,h=!1,d=!1,p=[],Z={data:[],errors:[],meta:{}};if(g(e.step)){var w=e.step;e.step=function(t){if(Z=t,k())_();else{if(_(),0===Z.data.length)return;c+=t.data.length,e.preview&&c>e.preview?n.abort():(Z.data=Z.data[0],w(Z,l))}}}function b(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function _(){return Z&&r&&(E("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(Z.data=Z.data.filter((function(e){return!b(e)}))),k()&&function(){if(Z)if(Array.isArray(Z.data[0])){for(var t=0;k()&&t<Z.data.length;t++)Z.data[t].forEach(n);Z.data.splice(0,1)}else Z.data.forEach(n);function n(t,n){g(e.transformHeader)&&(t=e.transformHeader(t,n)),p.push(t)}}(),function(){if(!Z||!e.header&&!e.dynamicTyping&&!e.transform)return Z;function t(t,n){var r,i=e.header?{}:[];for(r=0;r<t.length;r++){var a=r,s=t[r];e.header&&(a=r>=p.length?"__parsed_extra":p[r]),e.transform&&(s=e.transform(s,a)),s=x(a,s),"__parsed_extra"===a?(i[a]=i[a]||[],i[a].push(s)):i[a]=s}return e.header&&(r>p.length?E("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+r,f+n):r<p.length&&E("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+r,f+n)),i}var n=1;return!Z.data.length||Array.isArray(Z.data[0])?(Z.data=Z.data.map(t),n=Z.data.length):Z.data=t(Z.data,0),e.header&&Z.meta&&(Z.meta.fields=p),f+=n,Z}()}function k(){return e.header&&0===p.length}function x(t,n){return r=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[r]&&(e.dynamicTyping[r]=e.dynamicTypingFunction(r)),!0===(e.dynamicTyping[r]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(u.test(e)){var t=parseFloat(e);if(a<t&&t<i)return!0}return!1}(n)?parseFloat(n):o.test(n)?new Date(n):""===n?null:n):n;var r}function E(e,t,n,r){var i={type:e,code:t,message:n};void 0!==r&&(i.row=r),Z.errors.push(i)}this.parse=function(i,a,u){var o=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(v(t)+"([^]*?)"+v(t),"gm"),r=(e=e.replace(n,"")).split("\r"),i=e.split("\n"),a=1<i.length&&i[0].length<r[0].length;if(1===r.length||a)return"\n";for(var s=0,u=0;u<r.length;u++)"\n"===r[u][0]&&s++;return s>=r.length/2?"\r\n":"\r"}(i,o)),r=!1,e.delimiter)g(e.delimiter)&&(e.delimiter=e.delimiter(i),Z.meta.delimiter=e.delimiter);else{var l=function(t,n,r,i,a){var u,o,l,c;a=a||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var f=0;f<a.length;f++){var h=a[f],d=0,v=0,p=0;l=void 0;for(var Z=new m({comments:i,delimiter:h,newline:n,preview:10}).parse(t),w=0;w<Z.data.length;w++)if(r&&b(Z.data[w]))p++;else{var y=Z.data[w].length;v+=y,void 0!==l?0<y&&(d+=Math.abs(y-l),l=y):l=y}0<Z.data.length&&(v/=Z.data.length-p),(void 0===o||d<=o)&&(void 0===c||c<v)&&1.99<v&&(o=d,u=h,c=v)}return{successful:!!(e.delimiter=u),bestDelimiter:u}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);l.successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=s.DefaultDelimiter),Z.meta.delimiter=e.delimiter}var c=y(e);return e.preview&&e.header&&c.preview++,t=i,n=new m(c),Z=n.parse(t,a,u),_(),h?{meta:{paused:!0}}:Z||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=g(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(h=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,n.abort(),Z.meta.aborted=!0,g(e.complete)&&e.complete(Z),t=""}}function v(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,n=(e=e||{}).delimiter,r=e.newline,i=e.comments,a=e.step,u=e.preview,o=e.fastMode,l=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(l=e.escapeChar),("string"!=typeof n||-1<s.BAD_DELIMITERS.indexOf(n))&&(n=","),i===n)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var c=0,f=!1;this.parse=function(s,h,d){if("string"!=typeof s)throw new Error("Input must be a string");var m=s.length,p=n.length,Z=r.length,w=i.length,y=g(a),b=[],_=[],k=[],x=c=0;if(!s)return U();if(e.header&&!h){var E=s.split(r)[0].split(n),O=[],C={},M=!1;for(var R in E){var N=E[R];g(e.transformHeader)&&(N=e.transformHeader(N,R));var S=N,A=C[N]||0;for(0<A&&(M=!0,S=N+"_"+A),C[N]=A+1;O.includes(S);)S=S+"_"+A;O.push(S)}if(M){var W=s.split(r);W[0]=O.join(n),s=W.join(r)}}if(o||!1!==o&&-1===s.indexOf(t)){for(var j=s.split(r),I=0;I<j.length;I++){if(k=j[I],c+=k.length,I!==j.length-1)c+=r.length;else if(d)return U();if(!i||k.substring(0,w)!==i){if(y){if(b=[],B(k.split(n)),V(),f)return U()}else B(k.split(n));if(u&&u<=I)return b=b.slice(0,u),U(!0)}}return U()}for(var D=s.indexOf(n,c),F=s.indexOf(r,c),P=new RegExp(v(l)+v(t),"g"),z=s.indexOf(t,c);;)if(s[c]!==t)if(i&&0===k.length&&s.substring(c,c+w)===i){if(-1===F)return U();c=F+Z,F=s.indexOf(r,c),D=s.indexOf(n,c)}else if(-1!==D&&(D<F||-1===F))k.push(s.substring(c,D)),c=D+p,D=s.indexOf(n,c);else{if(-1===F)break;if(k.push(s.substring(c,F)),G(F+Z),y&&(V(),f))return U();if(u&&b.length>=u)return U(!0)}else for(z=c,c++;;){if(-1===(z=s.indexOf(t,z+1)))return d||_.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:c}),q();if(z===m-1)return q(s.substring(c,z).replace(P,t));if(t!==l||s[z+1]!==l){if(t===l||0===z||s[z-1]!==l){-1!==D&&D<z+1&&(D=s.indexOf(n,z+1)),-1!==F&&F<z+1&&(F=s.indexOf(r,z+1));var T=Y(-1===F?D:Math.min(D,F));if(s.substr(z+1+T,p)===n){k.push(s.substring(c,z).replace(P,t)),s[c=z+1+T+p]!==t&&(z=s.indexOf(t,c)),D=s.indexOf(n,c),F=s.indexOf(r,c);break}var L=Y(F);if(s.substring(z+1+L,z+1+L+Z)===r){if(k.push(s.substring(c,z).replace(P,t)),G(z+1+L+Z),D=s.indexOf(n,c),z=s.indexOf(t,c),y&&(V(),f))return U();if(u&&b.length>=u)return U(!0);break}_.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:c}),z++}}else z++}return q();function B(e){b.push(e),x=c}function Y(e){var t=0;if(-1!==e){var n=s.substring(z+1,e);n&&""===n.trim()&&(t=n.length)}return t}function q(e){return d||(void 0===e&&(e=s.substring(c)),k.push(e),c=m,B(k),y&&V()),U()}function G(e){c=e,B(k),k=[],F=s.indexOf(r,c)}function U(e){return{data:b,errors:_,meta:{delimiter:n,linebreak:r,aborted:f,truncated:!!e,cursor:x+(h||0)}}}function V(){a(U()),b=[],_=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return c}}function p(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var a={abort:function(){r=!0,Z(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(g(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},a),!r);s++);delete t.results}else g(n.userChunk)&&(n.userChunk(t.results,a,t.file),delete t.results)}t.finished&&!r&&Z(t.workerId,t.results)}function Z(e,t){var n=i[e];g(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function w(){throw new Error("Not implemented.")}function y(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=y(e[n]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function g(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var n=e.data;if(void 0===s.WORKER_ID&&n&&(s.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:s.WORKER_ID,results:s.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var r=s.parse(n.input,n.config);r&&t.postMessage({workerId:s.WORKER_ID,results:r,finished:!0})}}),(l.prototype=Object.create(o.prototype)).constructor=l,(c.prototype=Object.create(o.prototype)).constructor=c,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(o.prototype)).constructor=h,s},void 0===(i="function"===typeof n?n.apply(t,r):n)||(e.exports=i)},3841:function(e,t,n){e=n.nmd(e),function(n,r){var i=function(){var e=null,t={};m();var n=[],r=function t(r){if(void 0!==(r=r||{}).seed&&null!==r.seed&&r.seed===parseInt(r.seed,10))e=r.seed;else if("string"===typeof r.seed)e=y(r.seed);else{if(void 0!==r.seed&&null!==r.seed)throw new TypeError("The seed value must be an integer or string");e=null}var o,l;if(null!==r.count&&void 0!==r.count){for(var c=r.count,f=[],h=0;h<r.count;h++)n.push(!1);for(r.count=null;c>f.length;){var d=t(r);null!==e&&(r.seed=e),f.push(d)}return r.count=c,f}return u([o=i(r),l=a(o,r),s(o,l,r)],r)};function i(e){if(n.length>0){var t=h(a=b(e.hue)),r=(a[1]-a[0])/n.length,i=parseInt((t-a[0])/r);return!0===n[i]?i=(i+2)%n.length:n[i]=!0,(t=h(a=[(a[0]+i*r)%359,(a[0]+(i+1)*r)%359]))<0&&(t=360+t),t}var a;return(t=h(a=l(e.hue)))<0&&(t=360+t),t}function a(e,t){if("monochrome"===t.hue)return 0;if("random"===t.luminosity)return h([0,100]);var n=c(e),r=n[0],i=n[1];switch(t.luminosity){case"bright":r=55;break;case"dark":r=i-10;break;case"light":i=55}return h([r,i])}function s(e,t,n){var r=o(e,t),i=100;switch(n.luminosity){case"dark":i=r+20;break;case"light":r=(i+r)/2;break;case"random":r=0,i=100}return h([r,i])}function u(e,t){switch(t.format){case"hsvArray":return e;case"hslArray":return w(e);case"hsl":var n=w(e);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var r=w(e),i=t.alpha||Math.random();return"hsla("+r[0]+", "+r[1]+"%, "+r[2]+"%, "+i+")";case"rgbArray":return p(e);case"rgb":return"rgb("+p(e).join(", ")+")";case"rgba":var a=p(e);i=t.alpha||Math.random();return"rgba("+a.join(", ")+", "+i+")";default:return d(e)}}function o(e,t){for(var n=f(e).lowerBounds,r=0;r<n.length-1;r++){var i=n[r][0],a=n[r][1],s=n[r+1][0],u=n[r+1][1];if(t>=i&&t<=s){var o=(u-a)/(s-i);return o*t+(a-o*i)}}return 0}function l(e){if("number"===typeof parseInt(e)){var n=parseInt(e);if(n<360&&n>0)return[n,n]}if("string"===typeof e)if(t[e]){var r=t[e];if(r.hueRange)return r.hueRange}else if(e.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var i=Z(e)[0];return[i,i]}return[0,360]}function c(e){return f(e).saturationRange}function f(e){for(var n in e>=334&&e<=360&&(e-=360),t){var r=t[n];if(r.hueRange&&e>=r.hueRange[0]&&e<=r.hueRange[1])return t[n]}return"Color not found"}function h(t){if(null===e){var n=.618033988749895,r=Math.random();return r+=n,r%=1,Math.floor(t[0]+r*(t[1]+1-t[0]))}var i=t[1]||1,a=t[0]||0,s=(e=(9301*e+49297)%233280)/233280;return Math.floor(a+s*(i-a))}function d(e){var t=p(e);function n(e){var t=e.toString(16);return 1==t.length?"0"+t:t}return"#"+n(t[0])+n(t[1])+n(t[2])}function v(e,n,r){var i=r[0][0],a=r[r.length-1][0],s=r[r.length-1][1],u=r[0][1];t[e]={hueRange:n,lowerBounds:r,saturationRange:[i,a],brightnessRange:[s,u]}}function m(){v("monochrome",null,[[0,0],[100,0]]),v("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),v("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),v("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),v("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),v("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),v("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),v("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function p(e){var t=e[0];0===t&&(t=1),360===t&&(t=359),t/=360;var n=e[1]/100,r=e[2]/100,i=Math.floor(6*t),a=6*t-i,s=r*(1-n),u=r*(1-a*n),o=r*(1-(1-a)*n),l=256,c=256,f=256;switch(i){case 0:l=r,c=o,f=s;break;case 1:l=u,c=r,f=s;break;case 2:l=s,c=r,f=o;break;case 3:l=s,c=u,f=r;break;case 4:l=o,c=s,f=r;break;case 5:l=r,c=s,f=u}return[Math.floor(255*l),Math.floor(255*c),Math.floor(255*f)]}function Z(e){e=3===(e=e.replace(/^#/,"")).length?e.replace(/(.)/g,"$1$1"):e;var t=parseInt(e.substr(0,2),16)/255,n=parseInt(e.substr(2,2),16)/255,r=parseInt(e.substr(4,2),16)/255,i=Math.max(t,n,r),a=i-Math.min(t,n,r),s=i?a/i:0;switch(i){case t:return[(n-r)/a%6*60||0,s,i];case n:return[60*((r-t)/a+2)||0,s,i];case r:return[60*((t-n)/a+4)||0,s,i]}}function w(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=(2-n)*r;return[t,Math.round(n*r/(i<1?i:2-i)*1e4)/100,i/2*100]}function y(e){for(var t=0,n=0;n!==e.length&&!(t>=Number.MAX_SAFE_INTEGER);n++)t+=e.charCodeAt(n);return t}function b(e){if(isNaN(e)){if("string"===typeof e)if(t[e]){var n=t[e];if(n.hueRange)return n.hueRange}else if(e.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){return f(Z(e)[0]).hueRange}}else{var r=parseInt(e);if(r<360&&r>0)return f(e).hueRange}return[0,360]}return r}();e&&e.exports&&(t=e.exports=i),t.randomColor=i}()},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},5057:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);function i(e){if(Array.isArray(e))return(0,r.Z)(e)}},9730:function(e,t,n){"use strict";function r(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}n.d(t,{Z:function(){return r}})},8662:function(e,t,n){"use strict";function r(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}n.d(t,{Z:function(){return r}})},3889:function(e,t,n){"use strict";function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}n.d(t,{Z:function(){return r}})},101:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(864);function i(e,t){(0,r.Z)(e,t),t.add(e)}},9902:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(6983),i=n(9730),a=n(8662);function s(e,t,n){return(0,i.Z)(e,t),(0,a.Z)(n,"get"),(0,r.Z)(e,n)}},3966:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(6011),i=n(9730),a=n(8662);function s(e,t,n,s){return(0,i.Z)(e,t),(0,a.Z)(n,"set"),(0,r.Z)(e,n,s),s}},2415:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9730);function i(e,t,n){return(0,r.Z)(e,t),n}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(181);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,s=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw s}}}}},8301:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(8415);function i(){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=(0,r.Z)(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},i.apply(this,arguments)}},9199:function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},1902:function(e,t,n){"use strict";function r(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,s,u=[],o=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);o=!0);}catch(c){l=!0,i=c}finally{try{if(!o&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw i}}return u}}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},2786:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},6459:function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Cannot destructure "+e)}n.d(t,{Z:function(){return r}})},1413:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(4942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},3324:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(3878),i=n(1902),a=n(181),s=n(5267);function u(e,t){return(0,r.Z)(e)||(0,i.Z)(e,t)||(0,a.Z)(e,t)||(0,s.Z)()}},8415:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1120);function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}},9062:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(5057),i=n(9199),a=n(181),s=n(2786);function u(e){return(0,r.Z)(e)||(0,i.Z)(e)||(0,a.Z)(e)||(0,s.Z)()}},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);function i(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},8685:function(e,t,n){"use strict";n.d(t,{M:function(){return F}});var r=n(7762),i=n(4165),a=n(5861),s=n(1413),u=n(5671),o=n(3144),l=n(101),c=n(2346),f=n(3889),h=n(8916),d=n(2793),v=n(3966),m=n(9902),p=n(3324),Z=n(5831),w=n(6474),y=n(797);function b(e,t){return t?w.bl(e):e}var g="https://experimenthub.bioconductor.org/fetch",_={"zeisel-brain":{counts:"2596",coldata:"2598",rowdata:"2597"},"segerstolpe-pancreas":{counts:"2591",coldata:"2593",rowdata:"2592"},"nestorowa-hsc":{counts:"2710",ncol:1920},"aztekin-tail":{counts:"3124",coldata:"3125"},"wu-kidney":{counts:"3594",coldata:"3595"},"zilionis-mouse-lung":{counts:"3478",coldata:"3479"}};function k(e,t,n){if(!(e instanceof Z.BA))throw new Error("expected an S4 object");for(var r=0,i=Object.entries(t);r<i.length;r++){var a=(0,p.Z)(i[r],2),s=a[0],u=a[1];if(e.className()==s&&e.packageName()==u)return}throw new Error("object is not a "+n+" or one of its recognized subclasses")}function x(e,t){var n=function(e){var t,n,r=e.findAttribute("names");if(r<0)return null;try{n=(t=e.attribute(r)).values()}catch(i){throw new Error("failed to load listData names; "+i.message)}finally{Z.gd(t)}if(n.length!=e.length())throw new Error("expected names to have same length as listData");return n}(e);if(null==n)throw new Error("expected the listData list to be named");for(var r={},i=0;i<e.length();i++){var a=void 0;try{if((a=e.load(i))instanceof Z.qu&&!(a instanceof Z.SV)){var s=a.values();r[n[i]]=s,t.nrow=s.length}}finally{Z.gd(a)}}t.columns=r}function E(e){var t,n,r={};if("S4"==e.type()){var i;k(e,{DFrame:"S4Vectors",DataFrame:"S4Vectors"},"DFrame");try{if(!((i=e.attribute("listData"))instanceof Z.SV))throw new Error("listData slot should be a generic list");x(i,r)}catch(u){throw new Error("failed to retrieve data from DataFrame's listData; "+u.message)}finally{Z.gd(i)}}else{if("vector"!=e.type())throw new Error("expected a data.frame or DataFrame instance");x(e,r)}try{var a=e.findAttribute("rownames");a>=0&&(t=e.attribute(a))instanceof Z.II&&(r.row_names=t.values(),r.nrow=r.row_names.length)}catch(u){throw new Error("failed to retrieve row names from DataFrame; "+u.message)}finally{Z.gd(t)}if(!("nrow"in r))try{if(!((n=e.attribute("nrows"))instanceof Z.D6))throw new Error("expected an integer vector as the 'nrows' slot");var s=n.values();if(1!=s.length)throw new Error("expected an integer vector of length 1 as the 'nrows' slot");r.nrow=s[0]}catch(u){throw new Error("failed to retrieve nrows from DataFrame; "+u.message)}finally{Z.gd(n)}return r}function O(e){var t,n,r,i;if("S4"==e.type()?(k(e,{dgCMatrix:"Matrix",dgTMatrix:"Matrix"},"Matrix"),t=e.findAttribute("Dimnames")):t=e.findAttribute("dimnames"),t<0)throw new Error("count matrix does not have dimnames");try{if("vector"!=(n=e.attribute(t)).type()&&2!=n.size())throw new Error("dimnames of the count matrix should be a list of length 2");if("string"!=(r=n.load(0)).type())throw new Error("expected a character vector in the first dimnames");i=r.values()}finally{Z.gd(n),Z.gd(r)}return i}var C=new WeakMap,M=new WeakMap,R=new WeakMap,N=new WeakMap,S=new WeakMap,A=new WeakMap,W=new WeakSet,j=new WeakSet,I=new WeakSet,D=new WeakSet,F=function(){function e(t){if((0,u.Z)(this,e),(0,l.Z)(this,D),(0,l.Z)(this,I),(0,l.Z)(this,j),(0,l.Z)(this,W),(0,c.Z)(this,C,{writable:!0,value:void 0}),(0,c.Z)(this,M,{writable:!0,value:void 0}),(0,c.Z)(this,R,{writable:!0,value:void 0}),(0,c.Z)(this,N,{writable:!0,value:void 0}),(0,c.Z)(this,S,{writable:!0,value:void 0}),(0,c.Z)(this,A,{writable:!0,value:void 0}),(0,d.Z)(this,C,t),!((0,h.Z)(this,C)in _))throw new Error("unrecognized identifier '"+(0,h.Z)(this,C)+"' for ExperimentHub-based datasets");(0,d.Z)(this,A,e.defaults()),this.clear()}return(0,o.Z)(e,[{key:"options",value:function(){return(0,s.Z)({},(0,h.Z)(this,A))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,p.Z)(n[t],2),i=r[0],a=r[1];(0,h.Z)(this,A)[i]=a}}},{key:"clear",value:function(){Z.gd((0,h.Z)(this,N)),Z.gd((0,h.Z)(this,S)),(0,d.Z)(this,N,null),(0,d.Z)(this,S,null),(0,d.Z)(this,M,null),(0,d.Z)(this,R,null)}},{key:"abbreviate",value:function(){return{id:(0,h.Z)(this,C),options:this.options()}}},{key:"summary",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(s.length>0&&void 0!==s[0]?s[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,f.Z)(this,j,T).call(this);case 3:return e.next=5,(0,f.Z)(this,I,B).call(this);case 5:return r={cells:b((0,h.Z)(this,R),n)},a=b((0,h.Z)(this,M),n),r.modality_features={RNA:a},n||this.clear(),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"previewPrimaryIds",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(a.length>0&&void 0!==a[0]?a[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,f.Z)(this,j,T).call(this);case 3:return r=(0,f.Z)(this,D,q).call(this,(0,h.Z)(this,M)),n||this.clear(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s,u=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(u.length>0&&void 0!==u[0]?u[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,f.Z)(this,j,T).call(this);case 3:return e.next=5,(0,f.Z)(this,I,B).call(this);case 5:return e.next=7,(0,f.Z)(this,W,P).call(this);case 7:r={cells:b((0,h.Z)(this,R),n)},_[(0,h.Z)(this,C)],e.prev=9,r.matrix=new Z.VU,a=Z.Bp((0,h.Z)(this,N),{consume:!n}),r.matrix.add("RNA",a.matrix),r.row_ids={RNA:a.row_ids},s=w.Nd((0,h.Z)(this,M),a.row_ids),r.features={RNA:s},e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(9),Z.gd(r.matrix),e.t0;case 22:return r.primary_ids=(0,f.Z)(this,D,q).call(this,r.features.RNA),n||this.clear(),e.abrupt("return",r);case 25:case"end":return e.stop()}}),e,this,[[9,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){var e=(new TextEncoder).encode((0,h.Z)(this,C));return{files:[{type:"id",file:new y.zD(e,{name:"id"})}],options:this.options()}}}],[{key:"setDownloadFun",value:function(t){var n=(0,m.Z)(e,e,G);return(0,v.Z)(e,e,G,t),n}},{key:"availableDatasets",value:function(){return Object.keys(_)}},{key:"defaults",value:function(){return{primaryRnaFeatureIdColumn:0}}},{key:"format",value:function(){return"ExperimentHub"}},{key:"unserialize",value:function(t,n){var i,a={},s=(0,r.Z)(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,o=new TextDecoder;a[u.type]=o.decode(u.file.buffer())}}catch(l){s.e(l)}finally{s.f()}if(!("id"in a))throw new Error("expected a file of type 'id' when unserializing ExperimentHub dataset");return new e(a.id,n)}}]),e}();function P(){return z.apply(this,arguments)}function z(){return(z=(0,a.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,N)){e.next=2;break}return e.abrupt("return");case 2:return t=_[(0,h.Z)(this,C)],e.next=5,(0,m.Z)(F,F,G).call(F,g+"/"+t.counts);case 5:n=e.sent,e.prev=6,(0,d.Z)(this,S,Z.p$(n)),(0,d.Z)(this,N,(0,h.Z)(this,S).value()),e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(6),Z.gd((0,h.Z)(this,N)),Z.gd((0,h.Z)(this,S)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[6,11]])})))).apply(this,arguments)}function T(){return L.apply(this,arguments)}function L(){return(L=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s,u,o,l,c,v,y,b,k;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,M)){e.next=2;break}return e.abrupt("return");case 2:if(!("rowdata"in(t=_[(0,h.Z)(this,C)]))){e.next=23;break}return e.next=6,(0,m.Z)(F,F,G).call(F,g+"/"+t.rowdata);case 6:for(n=e.sent,e.prev=7,r=Z.p$(n),a=r.value(),s=E(a),u=s.row_names,o={},u&&(o.id=u),l=0,c=Object.entries(s.columns);l<c.length;l++)v=(0,p.Z)(c[l],2),y=v[0],b=v[1],y.match(/^sym/)&&(o[y]=b);if(0!=Object.keys(o).length){e.next=17;break}throw new Error("no acceptable feature identifiers found in the rowData DataFrame");case 17:(0,d.Z)(this,M,new w.NE(o));case 18:return e.prev=18,Z.gd(a),Z.gd(r),e.finish(18);case 22:return e.abrupt("return");case 23:return e.next=25,(0,f.Z)(this,W,P).call(this);case 25:k=O((0,h.Z)(this,N)),(0,d.Z)(this,M,new w.NE({id:k}));case 27:case"end":return e.stop()}}),e,this,[[7,,18,22]])})))).apply(this,arguments)}function B(){return Y.apply(this,arguments)}function Y(){return(Y=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,R)){e.next=2;break}return e.abrupt("return");case 2:if(!("coldata"in(t=_[(0,h.Z)(this,C)]))){e.next=11;break}return e.next=6,(0,m.Z)(F,F,G).call(F,g+"/"+t.coldata);case 6:n=e.sent;try{r=Z.p$(n),a=r.value(),s=E(a)}finally{Z.gd(a),Z.gd(r)}(0,d.Z)(this,R,new w.NE(s.columns,{numberOfRows:s.nrow})),e.next=12;break;case 11:(0,d.Z)(this,R,new w.NE({},{numberOfRows:t.ncol}));case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function q(e){var t=(0,h.Z)(this,A).primaryRnaFeatureIdColumn;return"string"==typeof t&&e.hasColumn(t)||"number"==typeof t&&t<e.numberOfColumns()?{RNA:e.column(t)}:{RNA:e.rowNames()}}var G={writable:!0,value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("failed to fetch content at "+t+" ("+n.status+")");case 5:return e.t0=Uint8Array,e.next=8,n.arrayBuffer();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},U=n(2963),V=n(7326),H=n(136),$=n(9388);function Q(e,t,n){return e+":"+t+"@"+String(n)}var J=n(1120),K=n(9611);var X=n(5647);function ee(e){var t="function"===typeof Map?new Map:void 0;return ee=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return(0,X.Z)(e,arguments,(0,J.Z)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,K.Z)(r,e)},ee(e)}var te=function(e){(0,H.Z)(n,e);var t=(0,$.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this,e)).statusCode=r,i}return(0,o.Z)(n)}(ee(Error));function ne(e,t){return re.apply(this,arguments)}function re(){return(re=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.json();case 4:if("error"!=(r=e.sent).status){e.next=7;break}throw new te(n+"; "+r.reason,t.status);case 7:throw new te(n,t.status);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie={};function ae(e){return fetch(e,{headers:ie})}function se(e,t){return ue.apply(this,arguments)}function ue(){return ue=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,s,u,o,l,c,f=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(r=f.length>2&&void 0!==f[2]?f[2]:{}).downloadFun,u=void 0===s?null:s,o=r.getFun,l=void 0===o?null:o,c=t+"/files/"+encodeURIComponent(n),null===u&&(null===l&&(l=ae),u=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:return r=e.sent,e.next=5,ne(r,"failed to retrieve file for '"+n+"'");case 5:return e.next=7,r.arrayBuffer();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,u(c);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}function oe(e,t){return le.apply(this,arguments)}function le(){return le=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,s,u,o,l,c,f=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(r=f.length>2&&void 0!==f[2]?f[2]:{}).followLink,s=void 0===a||a,u=r.getFun,o=void 0===u?null:u,l=t+"/files/"+encodeURIComponent(n)+"/metadata",s&&(l+="?follow_link=true"),null===o&&(o=ae),e.next=6,o(l);case 6:return c=e.sent,e.next=9,ne(c,"failed to retrieve metadata for '"+n+"'");case 9:return e.next=11,c.json();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}var ce="https://collaboratordb.aaron-lun.workers.dev",fe=null,he=null,de=new WeakMap,ve=new WeakMap,me=function(){function e(t,n){(0,u.Z)(this,e),(0,c.Z)(this,de,{writable:!0,value:void 0}),(0,c.Z)(this,ve,{writable:!0,value:void 0}),(0,d.Z)(this,de,t),(0,d.Z)(this,ve,n)}return(0,o.Z)(e,[{key:"file",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Q((0,h.Z)(this,de),t,(0,h.Z)(this,ve)),e.next=3,se(ce,n,{getFun:fe,downloadFun:he});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"metadata",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Q((0,h.Z)(this,de),t,(0,h.Z)(this,ve)),e.next=3,oe(ce,n,{getFun:fe});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),pe=new WeakMap,Ze=new WeakMap;y.GY},1408:function(e,t,n){"use strict";n(6207),n(5831)},5563:function(e,t,n){"use strict";n(5831)},6207:function(e,t,n){"use strict";n(5563),n(5831),n(714)},2152:function(e,t,n){"use strict";n.d(t,{B:function(){return S}});var r=n(4165),i=n(5861),a=n(3324),s=n(1413),u=n(5671),o=n(3144),l=n(101),c=n(2346),f=n(3889),h=n(2793),d=n(8916),v=n(5831),m=n(6474),p=n(6016),Z=n(6180),w=n(3121),y=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakSet,O=new WeakSet,C=new WeakSet,M=new WeakSet,R=new WeakSet,N=new WeakSet,S=function(){function e(t){(0,u.Z)(this,e),(0,l.Z)(this,N),(0,l.Z)(this,R),(0,l.Z)(this,M),(0,l.Z)(this,C),(0,l.Z)(this,O),(0,l.Z)(this,E),(0,c.Z)(this,y,{writable:!0,value:void 0}),(0,c.Z)(this,b,{writable:!0,value:void 0}),(0,c.Z)(this,g,{writable:!0,value:void 0}),(0,c.Z)(this,_,{writable:!0,value:void 0}),(0,c.Z)(this,k,{writable:!0,value:void 0}),(0,c.Z)(this,x,{writable:!0,value:void 0}),t instanceof p.z?(0,h.Z)(this,y,t):(0,h.Z)(this,y,new p.z(t)),(0,h.Z)(this,x,e.defaults()),this.clear()}return(0,o.Z)(e,[{key:"options",value:function(){return(0,s.Z)({},(0,d.Z)(this,x))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,a.Z)(n[t],2),i=r[0],s=r[1];(0,d.Z)(this,x)[i]=s}}},{key:"clear",value:function(){"function"==typeof(0,d.Z)(this,g)&&(0,d.Z)(this,g).call(this),(0,h.Z)(this,g,null),(0,h.Z)(this,b,null),(0,h.Z)(this,_,null),(0,h.Z)(this,k,null)}},{key:"abbreviate",value:function(){return(0,f.Z)(this,E,A).call(this,(function(e){return{name:e.name(),size:e.size()}}))}},{key:"summary",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,f.Z)(this,C,j).call(this),(0,f.Z)(this,M,I).call(this);var n={modality_features:w.LR((0,d.Z)(this,_),"type"),cells:(0,d.Z)(this,k)};return t||this.clear(),n}},{key:"previewPrimaryIds",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,f.Z)(this,C,j).call(this);var n=w.h8((0,d.Z)(this,_),"type",(0,f.Z)(this,R,D).call(this),"RNA",(0,f.Z)(this,N,F).call(this));return t||this.clear(),n}},{key:"load",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cache,t=void 0!==e&&e;(0,f.Z)(this,C,j).call(this),(0,f.Z)(this,M,I).call(this);var n=v.EF((0,d.Z)(this,b),"matrix"),r=w.Bs(n,(0,d.Z)(this,_),"type",(0,f.Z)(this,R,D).call(this),"RNA");return r.cells=(0,d.Z)(this,k),r.primary_ids=w.P2(r.features,(0,f.Z)(this,N,F).call(this)),t||this.clear(),r}},{key:"serialize",value:function(){return(0,f.Z)(this,E,A).call(this,(function(e){return e}))}}],[{key:"defaults",value:function(){return{featureTypeRnaName:"Gene Expression",featureTypeAdtName:"Antibody Capture",featureTypeCrisprName:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:0,primaryAdtFeatureIdColumn:0,primaryCrisprFeatureIdColumn:0}}},{key:"format",value:function(){return"10X"}},{key:"unserialize",value:function(){var t=(0,i.Z)((0,r.Z)().mark((function t(n,i){var a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==n.length&&"h5"==n[0].type){t.next=2;break}throw new Error("expected exactly one file of type 'h5' for 10X HDF5 unserialization");case 2:return(a=new e(n[0].file)).setOptions(a),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function A(e){return{files:[{type:"h5",file:e((0,d.Z)(this,y))}],options:this.options()}}function W(){if(null===(0,d.Z)(this,b)){var e=v.$H((0,d.Z)(this,y).content());(0,h.Z)(this,b,e.path),(0,h.Z)(this,g,e.flush)}}function j(){if(null===(0,d.Z)(this,_)){(0,f.Z)(this,O,W).call(this);var e=new v.pT((0,d.Z)(this,b));if(!("matrix"in e.children)||"Group"!=e.children.matrix)throw new Error("expected a 'matrix' group at the top level of the file");var t=e.open("matrix");if(!("features"in t.children)||"Group"!=t.children.features)throw new Error("expected a 'matrix/features' group containing the feature annotation");var n=t.open("features"),r=Z.vp(n,"id");if(null==r)throw new Error("expected a 'matrix/features/id' string dataset containing the feature IDs");var i=new m.NE({id:r}),a=Z.vp(n,"name");null!==a&&i.$setColumn("name",a);var s=Z.vp(n,"feature_type");null!==s&&i.$setColumn("type",s),(0,h.Z)(this,_,i)}}function I(){if(null===(0,d.Z)(this,k)){(0,f.Z)(this,O,W).call(this);var e=v.N6((0,d.Z)(this,b),"matrix");(0,h.Z)(this,k,new m.NE({},{numberOfRows:e.columns}))}}function D(){return{RNA:(0,d.Z)(this,x).featureTypeRnaName,ADT:(0,d.Z)(this,x).featureTypeAdtName,CRISPR:(0,d.Z)(this,x).featureTypeCrisprName}}function F(){return{RNA:(0,d.Z)(this,x).primaryRnaFeatureIdColumn,ADT:(0,d.Z)(this,x).primaryAdtFeatureIdColumn,CRISPR:(0,d.Z)(this,x).primaryCrisprFeatureIdColumn}}},5173:function(e,t,n){"use strict";n.d(t,{GY:function(){return H},Ne:function(){return he}});var r=n(7762),i=n(3324),a=n(1413),s=n(101),u=n(3889),o=n(4165),l=n(5671),c=n(3144),f=n(2346),h=n(8916),d=n(2793),v=n(5861),m=n(5831),p=n(6474),Z=n(6180),w=n(3121),y=n(6016);function b(e,t){return g.apply(this,arguments)}function g(){return(g=(0,v.Z)((0,o.Z)().mark((function e(t,n){var i,a,s,u,l,c,f,h,d,v,w,y,g,_,k,x,E,O,C,M,R,N,S;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=4;break}return e.next=3,n.metadata(t);case 3:t=e.sent;case 4:return e.next=6,n.file(t.path);case 6:if(i=e.sent,u=null,!t.$schema.startsWith("csv_data_frame/")){e.next=19;break}return e.next=11,Z.Lm(i,{delim:","});case 11:for(l=e.sent,a=l.shift(),s=new Array(a.length),c=0;c<s.length;c++){f=[],h=(0,r.Z)(l);try{for(h.s();!(d=h.n()).done;)v=d.value,f.push(v[c])}catch(o){h.e(o)}finally{h.f()}s[c]=f}for(t.data_frame.row_names&&(u=s.shift(),a.shift()),c=0;c<s.length;c++)"integer"==(w=t.data_frame.columns[c].type)?s[c]=new Int32Array(s[c]):"number"==w?s[c]=new Float64Array(s[c]):"boolean"==w&&(s[c]=s[c].map((function(e){return"true"==e})));e.next=47;break;case 19:if(!t.$schema.startsWith("hdf5_data_frame/")){e.next=46;break}y=m.$H(i),e.prev=21,g=new m.pT(y.path),_=g.open(t.hdf5_data_frame.group),a=_.open("column_names",{load:!0}).values,t.data_frame.row_names&&(u=_.open("row_names",{load:!0}).values),s=[],k=_.open("data"),c=0;case 29:if(!(c<a.length)){e.next=41;break}if(String(c)in k.children){e.next=33;break}return s.push(null),e.abrupt("continue",38);case 33:if(x=k.open(String(c),{load:!0}),E=x.values,"integer"==(O=t.data_frame.columns[c]))(E instanceof Float64Array||E instanceof Float32Array)&&(E=new Int32Array(E));else if("number"==O)E instanceof Float64Array||E instanceof Float32Array||(E=new Float64Array(E));else if("boolean"==O){for(C=new Array(E.length),c=0;c<E.length;c++)-2147483648==E[c]?C[c]=null:C[c]=0!=E[c];E=C}else if(("string"==O||"date"==O)&&"missing-value-placeholder"in x.attributes)for(M=x.readAttribute("missing-value-placeholder").values[0],c=0;c<E.length;c++)E[c]==M&&(E[c]=null);s.push(E);case 38:c++,e.next=29;break;case 41:return e.prev=41,y.flush(),e.finish(41);case 44:e.next=47;break;case 46:throw new Error("unknown data_frame schema type '"+t.$schema+"'");case 47:R={},N=[],c=0;case 50:if(!(c<s.length)){e.next=72;break}if("other"!==t.data_frame.columns[c].type){e.next=67;break}return e.next=54,n.metadata(t.data_frame.columns[c].resource.path);case 54:return S=e.sent,e.prev=55,e.next=58,b(S,n);case 58:R[a[c]]=e.sent,N.push(a[c]),e.next=65;break;case 62:e.prev=62,e.t0=e.catch(55),console.warn(e.t0);case 65:e.next=69;break;case 67:R[a[c]]=s[c],N.push(a[c]);case 69:c++,e.next=50;break;case 72:return e.abrupt("return",new p.NE(R,{columnOrder:N,rowNames:u,numberOfRows:t.data_frame.dimensions[0]}));case 73:case"end":return e.stop()}}),e,null,[[21,,41,44],[55,62]])})))).apply(this,arguments)}var _="";function k(e,t){return x.apply(this,arguments)}function x(){return x=(0,v.Z)((0,o.Z)().mark((function e(t,n){var i,a,s,u,l,c,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){var e=(0,v.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("row_data"in t.summarized_experiment)){e.next=7;break}return r=t.summarized_experiment.row_data.resource.path,e.next=4,b(r,n);case 4:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",new p.NE({},{numberOfRows:t.summarized_experiment.dimensions[0]}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,n.metadata(t);case 3:return a=e.sent,s={},e.next=7,i(a);case 7:if(s[_]=e.sent,!("single_cell_experiment"in a)){e.next=36;break}u=(0,r.Z)(a.single_cell_experiment.alternative_experiments),e.prev=10,u.s();case 12:if((l=u.n()).done){e.next=28;break}return c=l.value,e.prev=14,e.next=17,n.metadata(c.resource.path);case 17:return f=e.sent,e.next=20,i(f);case 20:s[c.name]=e.sent,e.next=26;break;case 23:e.prev=23,e.t0=e.catch(14),console.warn("failed to extract features for alternative Experiment '"+c.name+"'; "+e.t0.message);case 26:e.next=12;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(10),u.e(e.t1);case 33:return e.prev=33,u.f(),e.finish(33);case 36:return e.abrupt("return",s);case 37:case"end":return e.stop()}}),e,null,[[10,30,33,36],[14,23]])}))),x.apply(this,arguments)}function E(e,t){return O.apply(this,arguments)}function O(){return(O=(0,v.Z)((0,o.Z)().mark((function e(t,n){var i,a,s,u,l,c,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e){var t,n=[],i=(0,r.Z)(e.summarized_experiment.assays);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.push(a.name)}}catch(s){i.e(s)}finally{i.f()}return n},e.next=3,n.metadata(t);case 3:if(a=e.sent,(s={})[_]=i(a),!("single_cell_experiment"in a)){e.next=32;break}u=(0,r.Z)(a.single_cell_experiment.alternative_experiments),e.prev=8,u.s();case 10:if((l=u.n()).done){e.next=24;break}return c=l.value,e.prev=12,e.next=15,n.metadata(c.resource.path);case 15:f=e.sent,s[c.name]=i(f),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(12),console.warn("failed to extract features for alternative Experiment '"+c.name+"'; "+e.t0.message);case 22:e.next=10;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(8),u.e(e.t1);case 29:return e.prev=29,u.f(),e.finish(29);case 32:return e.abrupt("return",s);case 33:case"end":return e.stop()}}),e,null,[[8,26,29,32],[12,19]])})))).apply(this,arguments)}function C(e,t){return M.apply(this,arguments)}function M(){return(M=(0,v.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u,l,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("operation"===t.readAttribute("delayed_type").values[0]){e.next=2;break}return e.abrupt("return",null);case 2:if("unary arithmetic"===t.readAttribute("delayed_operation").values[0]){e.next=4;break}return e.abrupt("return",null);case 4:if(!(Math.abs(t.open("value",{load:!0}).values[0]-Math.log(2))>1e-8)){e.next=6;break}return e.abrupt("return",null);case 6:if("/"===t.open("method",{load:!0}).values[0]){e.next=8;break}return e.abrupt("return",null);case 8:if("right"===t.open("side",{load:!0}).values[0]){e.next=10;break}return e.abrupt("return",null);case 10:if("operation"===(r=t.open("seed")).readAttribute("delayed_type").values[0]){e.next=13;break}return e.abrupt("return",null);case 13:if("unary math"===r.readAttribute("delayed_operation").values[0]){e.next=15;break}return e.abrupt("return",null);case 15:if("log1p"===r.open("method",{load:!0}).values[0]){e.next=17;break}return e.abrupt("return",null);case 17:if("operation"===(i=r.open("seed")).readAttribute("delayed_type").values[0]){e.next=20;break}return e.abrupt("return",null);case 20:if("unary arithmetic"===i.readAttribute("delayed_operation").values[0]){e.next=22;break}return e.abrupt("return",null);case 22:if("/"===i.open("method",{load:!0}).values[0]){e.next=24;break}return e.abrupt("return",null);case 24:if("right"===i.open("side",{load:!0}).values[0]){e.next=26;break}return e.abrupt("return",null);case 26:if(1===i.open("along",{load:!0}).values[0]){e.next=28;break}return e.abrupt("return",null);case 28:if(a=i.open("value",{load:!0}).values,"array"===(s=i.open("seed")).readAttribute("delayed_type").values[0]){e.next=32;break}return e.abrupt("return",null);case 32:if("custom alabaster local array"===s.readAttribute("delayed_array").values[0]){e.next=34;break}return e.abrupt("return",null);case 34:return u=s.open("path",{load:!0}).values[0],c={},e.prev=36,e.next=39,S(u,n,!1);case 39:l=e.sent,c.matrix=m.gk(l.matrix,{sizeFactors:a,center:!1}),c.row_ids=l.row_ids;case 42:return e.prev=42,m.gd(l.matrix),e.finish(42);case 45:return e.abrupt("return",c);case 46:case"end":return e.stop()}}),e,null,[[36,,42,45]])})))).apply(this,arguments)}function R(e,t,n,r){return N.apply(this,arguments)}function N(){return(N=(0,v.Z)((0,o.Z)().mark((function e(t,n,i,a){var s,u,l,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof n){e.next=25;break}s=0,u=(0,r.Z)(t.summarized_experiment.assays),e.prev=3,u.s();case 5:if((l=u.n()).done){e.next=13;break}if(l.value.name!=n){e.next=10;break}return n=s,e.abrupt("break",13);case 10:s++;case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),u.e(e.t0);case 18:return e.prev=18,u.f(),e.finish(18);case 21:if(s!=t.summarized_experiment.assays.length){e.next=23;break}throw new Error("assay '"+n+"' not found");case 23:e.next=27;break;case 25:if(!(n>=t.summarized_experiment.assays.length)){e.next=27;break}throw new Error("assay "+String(n)+" out of range");case 27:return c=t.summarized_experiment.assays[n].resource.path,e.abrupt("return",S(c,i,a));case 29:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function S(e,t,n){return A.apply(this,arguments)}function A(){return(A=(0,v.Z)((0,o.Z)().mark((function e(t,n,r){var i,a,s,u,l,c,f,h,d,v,p;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.metadata(t);case 2:return i=e.sent,e.next=5,n.file(i.path);case 5:if(a=e.sent,u=i.$schema,l=u.startsWith("hdf5_dense_array/"),c=u.startsWith("hdf5_sparse_matrix/"),!l&&!c){e.next=15;break}f=c?i.hdf5_sparse_matrix.group:i.hdf5_dense_array.dataset,h=m.$H(a);try{s=m.EF(h.path,f,{forceInteger:r})}finally{h.flush()}e.next=31;break;case 15:if(!i.$schema.startsWith("hdf5_delayed_array/")){e.next=30;break}return d=m.$H(a),e.prev=17,v=new m.pT(d.path),p=v.open(i.hdf5_delayed_array.group),e.next=22,C(p,n);case 22:if(null!=(s=e.sent)){e.next=25;break}throw new Error("currently only supporting bakana-generated log-counts for delayed arrays");case 25:return e.prev=25,d.flush(),e.finish(25);case 28:e.next=31;break;case 30:throw new Error("array schema '"+i.$schema+"' is currently not supported");case 31:return e.abrupt("return",s);case 32:case"end":return e.stop()}}),e,null,[[17,,25,28]])})))).apply(this,arguments)}function W(e,t){return j.apply(this,arguments)}function j(){return(j=(0,v.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.metadata(t);case 2:if((r=e.sent).$schema.startsWith("json_simple_list/")){e.next=5;break}throw new Error("currently only support JSON-formatted lists in the 'other_data'");case 5:return e.next=7,n.file(r.path);case 7:return i=e.sent,a=new y.z(i,{name:"list.json"}),s=Z.R(a.buffer(),{compression:"gzip"==r.json_simple_list.compression?"gz":"none"}),u=JSON.parse(s),e.abrupt("return",I(u));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){if(!("type"in e))throw new Error("non-standard JSON object for 'json_simple_list' schema");if("number"==e.type){if(e.values instanceof Array){var t=new Float64Array(e.values.length);return e.values.forEach((function(e,n){t[n]=null===e?Number.NaN:e})),t}return null==e.values?Number.NaN:e.values}if("integer"==e.type){if(e.values instanceof Array){var n=new Int32Array(e.values.length);return e.values.forEach((function(e,t){n[t]=null===e?-2147483648:e})),n}return e.values}if("boolean"==e.type||"string"==e.type)return e.values;if("list"==e.type){if("names"in e){for(var r={},i=0;i<e.values.length;i++)r[e.names[i]]=I(e.values[i]);return r}var a=[];for(i=0;i<e.values.length;i++)a.push(I(e.values[i]));return a}return"nothing"==e.type||console.warn("JSON simple list containing type '"+e.type+"' is not yet supported"),null}var D=new WeakMap,F=new WeakMap,P=function(){function e(t){(0,l.Z)(this,e),(0,f.Z)(this,D,{writable:!0,value:void 0}),(0,f.Z)(this,F,{writable:!0,value:void 0}),(0,d.Z)(this,D,t),(0,d.Z)(this,F,{})}return(0,c.Z)(e,[{key:"clear",value:function(){(0,d.Z)(this,F,{}),"clear"in(0,h.Z)(this,D)&&(0,h.Z)(this,D).clear()}},{key:"metadata",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(t){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in(0,h.Z)(this,F))){e.next=4;break}return e.abrupt("return",(0,h.Z)(this,F)[t]);case 4:return e.next=6,(0,h.Z)(this,D).metadata(t);case 6:return n=e.sent,(0,h.Z)(this,F)[t]=n,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"file",value:function(e){return(0,h.Z)(this,D).file(e)}}]),e}(),z=new WeakMap,T=new WeakMap,L=new WeakMap,B=new WeakMap,Y=new WeakMap,q=new WeakSet,G=new WeakSet,U=new WeakSet,V=new WeakSet,H=function(){function e(t,n){(0,l.Z)(this,e),(0,s.Z)(this,V),(0,s.Z)(this,U),(0,s.Z)(this,G),(0,s.Z)(this,q),(0,f.Z)(this,z,{writable:!0,value:void 0}),(0,f.Z)(this,T,{writable:!0,value:void 0}),(0,f.Z)(this,L,{writable:!0,value:void 0}),(0,f.Z)(this,B,{writable:!0,value:void 0}),(0,f.Z)(this,Y,{writable:!0,value:void 0}),(0,d.Z)(this,z,t),(0,d.Z)(this,T,new P(n)),(0,d.Z)(this,Y,e.defaults()),(0,u.Z)(this,q,$).call(this)}return(0,c.Z)(e,[{key:"options",value:function(){return(0,a.Z)({},(0,h.Z)(this,Y))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,i.Z)(n[t],2),a=r[0],s=r[1];(0,h.Z)(this,Y)[a]=s}}},{key:"clear",value:function(){(0,u.Z)(this,q,$).call(this),(0,h.Z)(this,T).clear()}},{key:"summary",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(){var t,n,r,i=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(i.length>0&&void 0!==i[0]?i[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,u.Z)(this,G,Q).call(this);case 3:return e.next=5,(0,u.Z)(this,U,K).call(this);case 5:return e.t0=(0,h.Z)(this,L),e.t1=(0,h.Z)(this,B),e.next=9,E((0,h.Z)(this,z),(0,h.Z)(this,T));case 9:return e.t2=e.sent,r={modality_features:e.t0,cells:e.t1,modality_assay_names:e.t2},n||this.clear(),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"previewPrimaryIds",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(a.length>0&&void 0!==a[0]?a[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,u.Z)(this,G,Q).call(this);case 3:return r={RNA:(0,h.Z)(this,Y).rnaExperiment,ADT:(0,h.Z)(this,Y).adtExperiment,CRISPR:(0,h.Z)(this,Y).crisprExperiment},i=w.it((0,h.Z)(this,L),r,(0,u.Z)(this,V,ee).call(this)),n||this.clear(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(){var t,n,a,s,l,c,f,d,v,Z,y,b,g,_,k,x,E,O,C,M=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(M.length>0&&void 0!==M[0]?M[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,u.Z)(this,G,Q).call(this);case 3:return e.next=5,(0,u.Z)(this,U,K).call(this);case 5:return a={matrix:new m.VU,row_ids:{},features:{},cells:(0,h.Z)(this,B)},s={RNA:{exp:(0,h.Z)(this,Y).rnaExperiment,assay:(0,h.Z)(this,Y).rnaCountAssay},ADT:{exp:(0,h.Z)(this,Y).adtExperiment,assay:(0,h.Z)(this,Y).adtCountAssay},CRISPR:{exp:(0,h.Z)(this,Y).crisprExperiment,assay:(0,h.Z)(this,Y).crisprCountAssay}},e.next=9,(0,h.Z)(this,T).metadata((0,h.Z)(this,z));case 9:if(l=e.sent,c={},f=[],"single_cell_experiment"in l){f=l.single_cell_experiment.alternative_experiments,d=(0,r.Z)(f);try{for(d.s();!(v=d.n()).done;)Z=v.value,c[Z.name]=Z.resource.path}catch(o){d.e(o)}finally{d.f()}}e.prev=13,y=0,b=Object.entries(s);case 15:if(!(y<b.length)){e.next=49;break}if(g=(0,i.Z)(b[y],2),_=g[0],null!==(k=g[1]).exp){e.next=19;break}return e.abrupt("continue",46);case 19:if(x=null,E=k.exp,"string"!=typeof k.exp){e.next=33;break}if(""!==k.exp){e.next=26;break}x=l,e.next=31;break;case 26:if(k.exp in c){e.next=28;break}return e.abrupt("continue",46);case 28:return e.next=30,(0,h.Z)(this,T).metadata(c[k.exp]);case 30:x=e.sent;case 31:e.next=39;break;case 33:if(!(k.exp>=f.length)){e.next=35;break}return e.abrupt("continue",46);case 35:return E=f[k.exp].name,e.next=38,(0,h.Z)(this,T).metadata(f[k.exp].resource.path);case 38:x=e.sent;case 39:return e.next=41,R(x,k.assay,(0,h.Z)(this,T),!0);case 41:O=e.sent,a.matrix.add(_,O.matrix),C=O.row_ids,a.row_ids[_]=C,a.features[_]=p.Nd((0,h.Z)(this,L)[E],C);case 46:y++,e.next=15;break;case 49:a.primary_ids=w.P2(a.features,(0,u.Z)(this,V,ee).call(this)),e.next=56;break;case 52:throw e.prev=52,e.t0=e.catch(13),m.gd(a.matrix),e.t0;case 56:return n||this.clear(),e.abrupt("return",a);case 58:case"end":return e.stop()}}),e,this,[[13,52]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{rnaCountAssay:0,adtCountAssay:0,crisprCountAssay:0,rnaExperiment:"",adtExperiment:"Antibody Capture",crisprExperiment:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:null,primaryAdtFeatureIdColumn:null,primaryCrisprFeatureIdColumn:null}}}]),e}();function $(){(0,d.Z)(this,L,null),(0,d.Z)(this,B,null)}function Q(){return J.apply(this,arguments)}function J(){return(J=(0,v.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,L)){e.next=2;break}return e.abrupt("return");case 2:return e.t0=d.Z,e.t1=this,e.t2=L,e.next=7,k((0,h.Z)(this,z),(0,h.Z)(this,T));case 7:return e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function K(){return X.apply(this,arguments)}function X(){return(X=(0,v.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,B)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,h.Z)(this,T).metadata((0,h.Z)(this,z));case 4:return t=e.sent,n=t.summarized_experiment.column_data.resource.path,e.t0=d.Z,e.t1=this,e.t2=B,e.next=11,b(n,(0,h.Z)(this,T));case 11:return e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ee(){return{RNA:(0,h.Z)(this,Y).primaryRnaFeatureIdColumn,ADT:(0,h.Z)(this,Y).primaryAdtFeatureIdColumn,CRISPR:(0,h.Z)(this,Y).primaryCrisprFeatureIdColumn}}var te=new WeakMap,ne=new WeakMap,re=new WeakMap,ie=new WeakMap,ae=new WeakMap,se=new WeakMap,ue=new WeakSet,oe=new WeakSet,le=new WeakSet,ce=new WeakSet,fe=new WeakSet,he=function(){function e(t,n){(0,l.Z)(this,e),(0,s.Z)(this,fe),(0,s.Z)(this,ce),(0,s.Z)(this,le),(0,s.Z)(this,oe),(0,s.Z)(this,ue),(0,f.Z)(this,te,{writable:!0,value:void 0}),(0,f.Z)(this,ne,{writable:!0,value:void 0}),(0,f.Z)(this,re,{writable:!0,value:void 0}),(0,f.Z)(this,ie,{writable:!0,value:void 0}),(0,f.Z)(this,ae,{writable:!0,value:void 0}),(0,f.Z)(this,se,{writable:!0,value:void 0}),(0,d.Z)(this,te,t),(0,d.Z)(this,ne,new P(n)),(0,d.Z)(this,se,e.defaults()),(0,u.Z)(this,ue,de).call(this)}return(0,c.Z)(e,[{key:"options",value:function(){return(0,a.Z)({},(0,h.Z)(this,se))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,i.Z)(n[t],2),a=r[0],s=r[1];(0,h.Z)(this,se)[a]=p.bl(s)}}},{key:"clear",value:function(){(0,u.Z)(this,ue,de).call(this),(0,h.Z)(this,ne).clear()}},{key:"summary",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(){var t,n,r,i,a,s=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(s.length>0&&void 0!==s[0]?s[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,u.Z)(this,oe,ve).call(this);case 3:return e.next=5,(0,u.Z)(this,le,pe).call(this);case 5:return e.next=7,(0,u.Z)(this,ce,we).call(this);case 7:return e.t0=(0,h.Z)(this,re),e.t1=(0,h.Z)(this,ie),e.next=11,E((0,h.Z)(this,te),(0,h.Z)(this,ne));case 11:return e.t2=e.sent,e.t3=[],e.t4=(0,h.Z)(this,ae),r={modality_features:e.t0,cells:e.t1,modality_assay_names:e.t2,reduced_dimension_names:e.t3,other_metadata:e.t4},e.next=17,(0,h.Z)(this,ne).metadata((0,h.Z)(this,te));case 17:if(!("single_cell_experiment"in(i=e.sent))){e.next=22;break}return a=i.single_cell_experiment.reduced_dimensions,e.next=22,(0,u.Z)(this,fe,be).call(this,a,r.reduced_dimension_names);case 22:return n||this.clear(),e.abrupt("return",r);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,v.Z)((0,o.Z)().mark((function e(){var t,n,a,s,l,c,f,d,v,Z,w,y,b,g,_,k,x,E,O,C,M,N,S,A,W,j,I,D,F,P,z,T,L,B,Y,q=arguments;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(q.length>0&&void 0!==q[0]?q[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,u.Z)(this,oe,ve).call(this);case 3:return e.next=5,(0,u.Z)(this,le,pe).call(this);case 5:return e.next=7,(0,u.Z)(this,ce,we).call(this);case 7:return e.next=9,(0,h.Z)(this,ne).metadata((0,h.Z)(this,te));case 9:if(a=e.sent,s={matrix:new m.VU,features:{},cells:(0,h.Z)(this,ie),reduced_dimensions:{},other_metadata:(0,h.Z)(this,ae)},l=(0,h.Z)(this,se).reducedDimensionNames,c=a.single_cell_experiment.reduced_dimensions,null!=l){e.next=17;break}return l=[],e.next=17,(0,u.Z)(this,fe,be).call(this,c,l);case 17:if(!(l.length>0)){e.next=47;break}f={},d=(0,r.Z)(c);try{for(d.s();!(v=d.n()).done;)Z=v.value,f[Z.name]=Z.resource.path}catch(o){d.e(o)}finally{d.f()}w=(0,r.Z)(l),e.prev=22,w.s();case 24:if((y=w.n()).done){e.next=39;break}return b=y.value,e.next=28,(0,h.Z)(this,ne).metadata(f[b]);case 28:return g=e.sent,_=g.array.dimensions,e.next=32,(0,h.Z)(this,ne).file(g.path);case 32:k=e.sent,x=m.$H(k),E=[];try{for(O=new m.pT(x.path),C=O.open(g.hdf5_dense_array.dataset,{load:!0}),M=C.values,N=0;N<_[1];N++)E.push(M.slice(N*_[0],(N+1)*_[0]))}finally{x.flush()}s.reduced_dimensions[b]=E;case 37:e.next=24;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(22),w.e(e.t0);case 44:return e.prev=44,w.f(),e.finish(44);case 47:if(S={},"single_cell_experiment"in a){A=(0,r.Z)(a.single_cell_experiment.alternative_experiments);try{for(A.s();!(W=A.n()).done;)j=W.value,S[j.name]=j.resource.path}catch(o){A.e(o)}finally{A.f()}}e.prev=49,I=0,D=Object.entries((0,h.Z)(this,re));case 51:if(!(I<D.length)){e.next=79;break}if(F=(0,i.Z)(D[I],2),P=F[0],F[1],"object"!=typeof(z=(0,h.Z)(this,se).primaryAssay)){e.next=60;break}if(!(P in z)){e.next=59;break}z=z[P],e.next=60;break;case 59:return e.abrupt("continue",76);case 60:if("object"==typeof(T=(0,h.Z)(this,se).isPrimaryNormalized)&&(T=!(P in T)||T[P]),L=void 0,""!==P){e.next=67;break}L=a,e.next=70;break;case 67:return e.next=69,(0,h.Z)(this,ne).metadata(S[P]);case 69:L=e.sent;case 70:return e.next=72,R(L,z,(0,h.Z)(this,ne),!T);case 72:B=e.sent,s.matrix.add(P,B.matrix),T||(Y=m.gk(B.matrix,{allowZeros:!0}),s.matrix.add(P,Y)),null!==B.row_ids?s.features[P]=p.Nd((0,h.Z)(this,re)[P],B.row_ids):s.features[P]=(0,h.Z)(this,re)[P];case 76:I++,e.next=51;break;case 79:e.next=85;break;case 81:throw e.prev=81,e.t1=e.catch(49),m.gd(s.matrix),e.t1;case 85:return n||this.clear(),e.abrupt("return",s);case 87:case"end":return e.stop()}}),e,this,[[22,41,44,47],[49,81]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{primaryAssay:0,isPrimaryNormalized:!0,reducedDimensionNames:null}}}]),e}();function de(){(0,d.Z)(this,re,null),(0,d.Z)(this,ie,null),(0,d.Z)(this,ae,null)}function ve(){return me.apply(this,arguments)}function me(){return(me=(0,v.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,re)){e.next=2;break}return e.abrupt("return");case 2:return e.t0=d.Z,e.t1=this,e.t2=re,e.next=7,k((0,h.Z)(this,te),(0,h.Z)(this,ne));case 7:return e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function pe(){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,v.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,ie)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,h.Z)(this,ne).metadata((0,h.Z)(this,te));case 4:return t=e.sent,n=t.summarized_experiment.column_data.resource.path,e.t0=d.Z,e.t1=this,e.t2=ie,e.next=11,b(n,(0,h.Z)(this,ne));case 11:return e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function we(){return ye.apply(this,arguments)}function ye(){return(ye=(0,v.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,h.Z)(this,ae)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,h.Z)(this,ne).metadata((0,h.Z)(this,te));case 4:if(!("other_data"in(t=e.sent).summarized_experiment)){e.next=16;break}return n=t.summarized_experiment.other_data.resource.path,e.t0=d.Z,e.t1=this,e.t2=ae,e.next=12,W(n,(0,h.Z)(this,ne));case 12:e.t3=e.sent,(0,e.t0)(e.t1,e.t2,e.t3),e.next=17;break;case 16:(0,d.Z)(this,ae,{});case 17:return e.abrupt("return");case 18:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function be(e,t){return ge.apply(this,arguments)}function ge(){return(ge=(0,v.Z)((0,o.Z)().mark((function e(t,n){var i,a,s,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=(0,r.Z)(t),e.prev=1,i.s();case 3:if((a=i.n()).done){e.next=11;break}return s=a.value,e.next=7,(0,h.Z)(this,ne).metadata(s.resource.path);case 7:(u=e.sent).$schema.startsWith("hdf5_dense_array/")&&2==u.array.dimensions.length&&n.push(s.name);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),i.e(e.t0);case 16:return e.prev=16,i.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])})))).apply(this,arguments)}},6016:function(e,t,n){"use strict";n.d(t,{z:function(){return h}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap,h=function(){function e(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).name,i=void 0===n?null:n;if((0,r.Z)(this,e),(0,a.Z)(this,o,{writable:!0,value:void 0}),(0,a.Z)(this,l,{writable:!0,value:void 0}),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),t instanceof File)(0,u.Z)(this,o,"file"),(0,u.Z)(this,c,t),null===i&&(i=t.name),(0,u.Z)(this,f,i);else{if(!(t instanceof Uint8Array))throw new Error("unknown type '"+typeof t+"' for SimpleFile constructor");if((0,u.Z)(this,o,"buffer"),(0,u.Z)(this,l,t),null===i)throw new Error("'name' must be provided for Uint8Array inputs in SimpleFile constructor");(0,u.Z)(this,f,i)}}return(0,i.Z)(e,[{key:"buffer",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0!==e&&e;if("file"==(0,s.Z)(this,o)){var n=(new FileReaderSync).readAsArrayBuffer((0,s.Z)(this,c));return new Uint8Array(n)}return t?(0,s.Z)(this,l).slice():(0,s.Z)(this,l)}},{key:"size",value:function(){return"file"==(0,s.Z)(this,o)?(0,s.Z)(this,c).size:(0,s.Z)(this,l).length}},{key:"name",value:function(){return(0,s.Z)(this,f)}},{key:"content",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0!==e&&e;return this.buffer({copy:t})}}]),e}()},7355:function(e,t,n){"use strict";n.d(t,{e:function(){return W}});var r=n(7762),i=n(4165),a=n(5861),s=n(3324),u=n(1413),o=n(5671),l=n(3144),c=n(101),f=n(2346),h=n(3889),d=n(2793),v=n(8916),m=n(5831),p=n(6474),Z=n(6016),w=n(6180),y=n(3121),b=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakMap,O=new WeakMap,C=new WeakSet,M=new WeakSet,R=new WeakSet,N=new WeakSet,S=new WeakSet,A=new WeakSet,W=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i.featureTypeRnaName,i.featureTypeAdtName,i.featureTypeCrisprName,i.primaryRnaFeatureIdColumn,i.primaryAdtFeatureIdColumn,i.primaryCrisprFeatureIdColumn;(0,o.Z)(this,e),(0,c.Z)(this,A),(0,c.Z)(this,S),(0,c.Z)(this,N),(0,c.Z)(this,R),(0,c.Z)(this,M),(0,c.Z)(this,C),(0,f.Z)(this,b,{writable:!0,value:void 0}),(0,f.Z)(this,g,{writable:!0,value:void 0}),(0,f.Z)(this,_,{writable:!0,value:void 0}),(0,f.Z)(this,k,{writable:!0,value:void 0}),(0,f.Z)(this,x,{writable:!0,value:void 0}),(0,f.Z)(this,E,{writable:!0,value:void 0}),(0,f.Z)(this,O,{writable:!0,value:void 0}),t instanceof Z.z?(0,d.Z)(this,b,t):(0,d.Z)(this,b,new Z.z(t)),n instanceof Z.z||null==n?(0,d.Z)(this,g,n):(0,d.Z)(this,g,new Z.z(n)),r instanceof Z.z||null==r?(0,d.Z)(this,_,r):(0,d.Z)(this,_,new Z.z(r)),(0,d.Z)(this,O,e.defaults()),this.clear()}return(0,l.Z)(e,[{key:"options",value:function(){return(0,u.Z)({},(0,v.Z)(this,O))}},{key:"setOptions",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(0,s.Z)(n[t],2),i=r[0],a=r[1];(0,v.Z)(this,O)[i]=a}}},{key:"clear",value:function(){(0,d.Z)(this,k,null),(0,d.Z)(this,x,null),(0,d.Z)(this,E,null)}},{key:"abbreviate",value:function(e){return(0,h.Z)(this,C,j).call(this,(function(e){return{name:e.name(),size:e.size()}}))}},{key:"summary",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(a.length>0&&void 0!==a[0]?a[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,h.Z)(this,R,D).call(this);case 3:return e.next=5,(0,h.Z)(this,N,P).call(this);case 5:return r={modality_features:y.LR((0,v.Z)(this,x),"type"),cells:(0,v.Z)(this,E)},n||this.clear(),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"previewPrimaryIds",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(a.length>0&&void 0!==a[0]?a[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,h.Z)(this,R,D).call(this);case 3:return r=y.h8((0,v.Z)(this,x),"type",(0,h.Z)(this,S,T).call(this),"RNA",(0,h.Z)(this,A,L).call(this)),n||this.clear(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s,u=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(u.length>0&&void 0!==u[0]?u[0]:{}).cache,n=void 0!==t&&t,e.next=3,(0,h.Z)(this,R,D).call(this);case 3:return e.next=5,(0,h.Z)(this,N,P).call(this);case 5:return r=(0,v.Z)(this,b).name().endsWith(".gz"),a=m._3((0,v.Z)(this,b).content(),{compressed:r}),(s=y.Bs(a,(0,v.Z)(this,x),"type",(0,h.Z)(this,S,T).call(this),"RNA")).cells=(0,v.Z)(this,E),s.primary_ids=y.P2(s.features,(0,h.Z)(this,A,L).call(this)),n||this.clear(),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,h.Z)(this,C,j).call(this,(function(e){return e})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{featureTypeRnaName:"Gene Expression",featureTypeAdtName:"Antibody Capture",featureTypeCrisprName:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:0,primaryAdtFeatureIdColumn:0,primaryCrisprFeatureIdColumn:0}}},{key:"format",value:function(){return"MatrixMarket"}},{key:"unserialize",value:function(){var t=(0,a.Z)((0,i.Z)().mark((function t(n,a){var s,u,o,l,c,f,h;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s={},u=(0,r.Z)(n),t.prev=2,u.s();case 4:if((o=u.n()).done){t.next=11;break}if(!((l=o.value).type in s)){t.next=8;break}throw new Error("duplicate file of type '"+l.type+"' detected during MatrixMarket unserialization");case 8:s[l.type]=l.file;case 9:t.next=4;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),u.e(t.t0);case 16:return t.prev=16,u.f(),t.finish(16);case 19:if("mtx"in s){t.next=21;break}throw new Error("expected file of type 'mtx' for during MatrixMarket unserialization");case 21:return c=null,"genes"in s&&(c=s.genes),f=null,"annotations"in s&&(f=s.annotations),(h=new e(s.mtx,c,f)).setOptions(a),t.abrupt("return",h);case 28:case"end":return t.stop()}}),t,null,[[2,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function j(e){var t=[{type:"mtx",file:e((0,v.Z)(this,b))}];return null!==(0,v.Z)(this,g)&&t.push({type:"genes",file:e((0,v.Z)(this,g))}),null!==(0,v.Z)(this,_)&&t.push({type:"annotations",file:e((0,v.Z)(this,_))}),{files:t,options:this.options()}}function I(){if(null===(0,v.Z)(this,k)){var e=(0,v.Z)(this,b).name().endsWith(".gz"),t=m.us((0,v.Z)(this,b).content(),{compressed:e});(0,d.Z)(this,k,[t.rows,t.columns])}}function D(){return F.apply(this,arguments)}function F(){return(F=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s,u,o,l,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,v.Z)(this,x)){e.next=2;break}return e.abrupt("return");case 2:if((0,h.Z)(this,M,I).call(this),t=(0,v.Z)(this,k)[0],null!=(0,v.Z)(this,g)){e.next=7;break}return(0,d.Z)(this,x,new p.NE({},{numberOfRows:t})),e.abrupt("return");case 7:return n=(0,v.Z)(this,g).name(),r=n.endsWith(".gz"),e.next=11,w.Lm((0,v.Z)(this,g).content(),{compression:r?"gz":"none"});case 11:if((a=e.sent).length!=t+1){e.next=18;break}return s={},a.shift().forEach((function(e,t){s[e]=a.map((function(e){return e[t]}))})),(0,d.Z)(this,x,s),e.abrupt("return");case 18:if(a.length===t){e.next=20;break}throw new Error("number of matrix rows is not equal to the number of rows in '"+n+"'");case 20:return u=[],o=[],a.forEach((function(e){u.push(e[0]),o.push(e[1])})),(l=new p.NE({},{numberOfRows:t})).$setColumn("id",u),l.$setColumn("name",o),a[0].length>2&&(c=[],a.forEach((function(e){c.push(e[2])})),l.$setColumn("type",c)),(0,d.Z)(this,x,l),e.abrupt("return");case 28:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function P(){return z.apply(this,arguments)}function z(){return(z=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a,u,o,l,c,f,m,Z,y;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(0,v.Z)(this,E)){e.next=2;break}return e.abrupt("return");case 2:if((0,h.Z)(this,M,I).call(this),null!=(0,v.Z)(this,_)){e.next=6;break}return(0,d.Z)(this,E,new p.NE({},{numberOfRows:(0,v.Z)(this,k)[1]})),e.abrupt("return");case 6:return t=(0,v.Z)(this,_).name(),n=t.endsWith(".gz"),e.next=10,w.Lm((0,v.Z)(this,_).content(),{compression:n?"gz":"none"});case 10:if(r=e.sent,0!=(a=(0,v.Z)(this,k)[1]-r.length)){e.next=16;break}u=r[0],e.next=21;break;case 16:if(-1!=a){e.next=20;break}u=r.shift(),e.next=21;break;case 20:throw new Error("number of matrix columns is not equal to the number of rows in '"+t+"'");case 21:for(o={},u.forEach((function(e,t){o[e]=r.map((function(e){return e[t]}))})),l=0,c=Object.entries(o);l<c.length;l++)f=(0,s.Z)(c[l],2),m=f[0],Z=f[1],null!==(y=w.id(Z))&&(o[m]=y);return(0,d.Z)(this,E,new p.NE(o)),e.abrupt("return");case 26:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function T(){return{RNA:(0,v.Z)(this,O).featureTypeRnaName,ADT:(0,v.Z)(this,O).featureTypeAdtName,CRISPR:(0,v.Z)(this,O).featureTypeCrisprName}}function L(){return{RNA:(0,v.Z)(this,O).primaryRnaFeatureIdColumn,ADT:(0,v.Z)(this,O).primaryAdtFeatureIdColumn,CRISPR:(0,v.Z)(this,O).primaryCrisprFeatureIdColumn}}},508:function(e,t,n){"use strict";function r(e,t,n,r,i){i("no support for file paths in the browser context")}function i(e,t){throw new Error("no support for file paths in the browser context")}n.d(t,{V:function(){return r},f:function(){return i}})},6180:function(e,t,n){"use strict";n.d(t,{Lm:function(){return b},Qr:function(){return h},R:function(){return v},bw:function(){return w},id:function(){return _},vp:function(){return f}});var r=n(4165),i=n(3324),a=n(5861),s=n(7762),u=n(714),o=n(1025),l=n(508),c=n(6016);function f(e,t){if(!(t in e.children))return null;if("DataSet"!==e.children[t])return null;var n=e.open(t);return"String"!==n.type?null:n.load()}function h(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).limit,n=void 0===t?50:t;if(e instanceof Array){var r=Array.from(new Set(e));r.sort();var i=!1;return r.length>n&&(r=r.slice(0,n),i=!0),{type:"categorical",values:r,truncated:i}}var a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.forEach((function(e){e<a&&(a=e),e>s&&(s=e)})),{type:"continuous",min:a,max:s}}function d(e,t){return null!==t?t:(n=e instanceof Uint8Array?e:l.f(e,3)).length>=3&&31==n[0]&&139==n[1]&&8==n[2]?"gz":"none";var n}function v(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).compression,n=void 0===t?null:t,r="gz"===(n=d(e,n))?u.ec(e):e;return(new TextDecoder).decode(r)}function m(e,t){var n,r=0,i=(0,s.Z)(e);try{for(i.s();!(n=i.n()).done;){r+=n.value.length}}catch(c){i.e(c)}finally{i.f()}var a=new Uint8Array(r);r=0;var u,o=(0,s.Z)(e);try{for(o.s();!(u=o.n()).done;){var l=u.value;a.set(l,r),r+=l.length}}catch(c){o.e(c)}finally{o.f()}return t.decode(a)}function p(e,t,n,r){return Z.apply(this,arguments)}function Z(){return(Z=(0,a.Z)((0,r.Z)().mark((function e(t,n,i,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Uint8Array||(t=t instanceof c.z?t.content():new c.z(t,{name:"dummy"}).content()),"gz"!=d(t,n)){e.next=5;break}return e.next=4,new Promise((function(e,n){var r=new u.T_({chunkSize:i});r.onData=a,r.onEnd=function(t){t?n("gzip decompression failed; "+r.msg):e(null)},"string"==typeof t?l.V(t,i,(function(e){return r.push(e)}),null,n):r.push(t)}));case 4:case 8:return e.abrupt("return");case 5:if("string"!=typeof t){e.next=9;break}return e.next=8,new Promise((function(e,n){return l.V(t,i,a,e,n)}));case 9:return a(t),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return y.apply(this,arguments)}function y(){return y=(0,a.Z)((0,r.Z)().mark((function e(t){var n,i,a,s,u,o,l,c,f,h=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(n=h.length>1&&void 0!==h[1]?h[1]:{}).compression,a=void 0===i?null:i,s=n.chunkSize,u=void 0===s?65536:s,o=new TextDecoder,l=[],c=[],f=function(e){for(var t=0,n=0;n<e.length;n++)if(10==e[n]){var r=e.subarray(t,n);l.length?(l.push(r),c.push(m(l,o)),l=[]):c.push(o.decode(r)),t=n+1}t!=e.length&&l.push(e.slice(t))},e.next=7,p(t,a,u,f);case 7:return l.length&&c.push(m(l,o)),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return g=(0,a.Z)((0,r.Z)().mark((function e(t){var n,i,a,u,l,c,f,h,d,v,Z,w,y,b,g=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(n=g.length>1&&void 0!==g[1]?g[1]:{}).compression,a=void 0===i?null:i,u=n.delim,l=void 0===u?"\t":u,c=n.chunkSize,f=void 0===c?1048576:c,h=new TextDecoder,d=[],v=function(e){var t=o.parse(e,{delimiter:l});if(t.meta.aborted){var n,r="failed to parse delimited file",i=(0,s.Z)(t.errors);try{for(i.s();!(n=i.n()).done;){r+="; "+n.value.message}}catch(f){i.e(f)}finally{i.f()}throw new Error(r)}var a,u=(0,s.Z)(t.data);try{for(u.s();!(a=u.n()).done;){var c=a.value;d.push(c)}}catch(f){u.e(f)}finally{u.f()}},Z=[],w=0,y=function(e){for(var t=0,n=0;n<e.length;n++)if(10==e[n]&&n-t+w>=f){var r=e.subarray(t,n);Z.length?(Z.push(r),v(m(Z,h)),Z=[]):v(h.decode(r)),t=n+1,w=0}t!=e.length&&(Z.push(e.slice(t)),w+=e.length-t)},e.next=9,p(t,a,f,y);case 9:return Z.length&&(b=m(Z,h),v(b),"\n"==b[b.length-1]&&d.pop()),e.abrupt("return",d);case 11:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function _(e){for(var t=new Float64Array(e.length),n=0,r=Object.entries(e);n<r.length;n++){var a=(0,i.Z)(r[n],2),s=a[0],u=a[1],o=Number(u),l=parseFloat(u);if(isNaN(o)||isNaN(l))if(""===u||"NA"===u||"na"==u||"NaN"==u||"nan"==u)t[s]=NaN;else if("Inf"==u||"inf"==u)t[s]=Number.POSITIVE_INFINITY;else{if("-Inf"!=u&&"-inf"!=u)return null;t[s]=Number.NEGATIVE_INFINITY}else t[s]=o}return t}},3121:function(e,t,n){"use strict";n.d(t,{Bs:function(){return f},LR:function(){return u},P2:function(){return d},h8:function(){return c},it:function(){return v}});var r=n(3324),i=n(5831),a=n(6474);function s(e,t){var n={};return n[t]=e,n}function u(e,t){if(e.hasColumn(t)){var n=a.Lm(e.column(t)),r=e.removeColumn(t);return a.Tm(r,n)}return s(e,"")}function o(e,t){for(var n={},i=0,a=Object.entries(t);i<a.length;i++){var s=(0,r.Z)(a[i],2),u=s[0],o=s[1];null!==o&&o in e&&(n[u]=e[o])}return n}function l(e,t,n){var r=a.Lm(e.column(t));return null===n?r:o(r,n)}function c(e,t,n,i,s){if(null!==t&&e.hasColumn(t)){for(var u=l(e,t,n),o=0,c=Object.entries(u);o<c.length;o++){var f=(0,r.Z)(c[o],2),d=f[0],v=f[1],m=h(d,e,s);u[d]=a.Nd(m,v)}return u}var p=function(e,t){for(var n=null,i=!1,a=0,s=Object.entries(e);a<s.length;a++){var u=(0,r.Z)(s[a],2),o=u[0];null!==u[1]&&(null!==n&&(i=!0),n=o)}return null===n||i?t:n}(n,i),Z={};return Z[p]=h(p,e,s),Z}function f(e,t,n,r,u){var o={matrix:new i.VU};try{var c,f=e.matrix,h=e.row_ids;if(o.matrix.add("",f),null!==h?c=a.Nd(t,h):(c=a.bl(t,{deepCopy:!1}),(h=new Int32Array(f.numberOfRows())).forEach((function(e,t){h[t]=t}))),null!==n&&c.hasColumn(n)){var d=l(c,n,r),v=Object.keys(d),m=function(e,t){if(e.length!=t)return!1;for(var n=0;n<t;n++)if(n!==e[n])return!1;return!0}(v[0],f.numberOfRows());if(v.length>1||!m){var p=new i.VU({store:i.vc(f,d)});i.gd(o.matrix),o.matrix=p}else o.matrix.rename("",v[0]);delete c[n],o.features=a.Tm(c,d),o.row_ids=a.Tm(h,d)}else o.matrix.rename("",u),o.row_ids=s(h,u),o.features=s(c,u)}catch(Z){throw i.gd(o.matrix),Z}return o}function h(e,t,n){if(!(e in n))throw new Error("modality '"+e+"' has no primary key identifier");var r=n[e];return"string"==typeof r&&t.hasColumn(r)||"number"==typeof r&&r<t.numberOfColumns()?t.column(r):t.rowNames()}function d(e,t){for(var n={},i=0,a=Object.entries(e);i<a.length;i++){var s=(0,r.Z)(a[i],2),u=s[0],o=s[1];n[u]=h(u,o,t)}return n}function v(e,t,n){return d(o(e,t),n)}},6269:function(e,t,n){"use strict";function r(){return new Worker(new URL(n.p+n.u(484),n.b),{type:void 0})}function i(){return new Worker(new URL(n.p+n.u(933),n.b),{type:void 0})}n.d(t,{k:function(){return r},u:function(){return i}})},8366:function(e,t,n){"use strict";n.d(t,{Cy:function(){return p},m5:function(){return _}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(569),v=n(9873),m=n(2269),p="adt_normalization",Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakSet,_=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,g),(0,u.Z)(this,Z,{writable:!0,value:void 0}),(0,u.Z)(this,w,{writable:!0,value:void 0}),(0,u.Z)(this,y,{writable:!0,value:void 0}),(0,u.Z)(this,b,{writable:!0,value:void 0}),!(t instanceof v.fA))throw new Error("'qc' should be a AdtQualityControlState object");if((0,c.Z)(this,Z,t),!(n instanceof m.H0))throw new Error("'filter' should be a CellFilteringState object");(0,c.Z)(this,w,n),(0,c.Z)(this,y,null===r?{}:r),(0,c.Z)(this,b,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,b).matrix),h.Yl((0,l.Z)(this,b).total_buffer),h.Yl((0,l.Z)(this,b).sf_buffer),h.Yl((0,l.Z)(this,b).centered_sf_buffer)}},{key:"valid",value:function(){return(0,l.Z)(this,w).fetchFilteredMatrix().has("ADT")}},{key:"fetchNormalizedMatrix",value:function(){return"matrix"in(0,l.Z)(this,b)||(0,o.Z)(this,g,k).call(this),(0,l.Z)(this,b).matrix}},{key:"fetchSizeFactors",value:function(){var e;return(0,l.Z)(this,b).sf_buffer&&(e=h.rS((0,l.Z)(this,b).sf_buffer.length,"Float64Array",(0,l.Z)(this,b),"centered_sf_buffer"),f.v_((0,l.Z)(this,b).sf_buffer,{buffer:e,block:(0,l.Z)(this,w).fetchFilteredBlock()})),e}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,y))}},{key:"compute",value:function(e){var t=e.num_pcs,n=e.num_clusters,r=!0;if("remove_bias"in e&&(r=e.remove_bias),this.changed=!1,((0,l.Z)(this,Z).changed||(0,l.Z)(this,w).changed||r!==(0,l.Z)(this,y).remove_bias||r&&(t!==(0,l.Z)(this,y).num_pcs||n!=(0,l.Z)(this,y).num_clusters))&&this.valid()){var i=(0,l.Z)(this,w).fetchFilteredMatrix().get("ADT"),a=d.e((0,l.Z)(this,Z),(0,l.Z)(this,w),i,(0,l.Z)(this,b),"total_buffer"),s=(0,l.Z)(this,w).fetchFilteredBlock(),u=h.rS(i.numberOfColumns(),"Float64Array",(0,l.Z)(this,b),"sf_buffer");r?f.Cb(i,{totals:a,block:s,buffer:u,numberOfPCs:t,numberOfClusters:n}):f.v_(a,{buffer:u,block:s}),this.changed=!0}(0,l.Z)(this,y).remove_bias=r,(0,l.Z)(this,y).num_pcs=t,(0,l.Z)(this,y).num_clusters=n,this.changed&&this.valid()&&(0,o.Z)(this,g,k).call(this)}}],[{key:"defaults",value:function(){return{remove_bias:!0,num_pcs:25,num_clusters:20}}}]),e}();function k(){var e=(0,l.Z)(this,w).fetchFilteredMatrix().get("ADT"),t=(0,l.Z)(this,w).fetchFilteredBlock(),n=(0,l.Z)(this,b).sf_buffer;if(n.length!=e.numberOfColumns())throw new Error("length of size factor vector should equal number of columns after QC");h.Yl((0,l.Z)(this,b).matrix),(0,l.Z)(this,b).matrix=f.gk(e,{sizeFactors:n,block:t,allowZeros:!0})}},7188:function(e,t,n){"use strict";n.d(t,{Cy:function(){return d},Ru:function(){return w}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(2269),h=n(8366),d="adt_pca",v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),!(t instanceof f.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,o.Z)(this,v,t),!(n instanceof h.m5))throw new Error("'norm' should be a AdtNormalizationState object");(0,o.Z)(this,m,n),(0,o.Z)(this,Z,null===r?{}:r),(0,o.Z)(this,p,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,p).pcs)}},{key:"valid",value:function(){return(0,u.Z)(this,m).valid()}},{key:"fetchPCs",value:function(){return(0,u.Z)(this,p).pcs}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,Z))}},{key:"compute",value:function(e){var t=e.num_pcs,n=e.block_method;if(this.changed=!1,(0,u.Z)(this,m).changed||t!==(0,u.Z)(this,Z).num_pcs||n!==(0,u.Z)(this,Z).block_method){if(this.valid()){var r=(0,u.Z)(this,v).fetchFilteredBlock(),i=(0,u.Z)(this,m).fetchNormalizedMatrix();c.Yl((0,u.Z)(this,p).pcs),(0,u.Z)(this,p).pcs=l.aG(i,{numberOfPCs:t,block:r,blockMethod:n}),this.changed=!0}(0,u.Z)(this,Z).num_pcs=t,(0,u.Z)(this,Z).block_method=n}}}],[{key:"defaults",value:function(){return{num_pcs:20,block_method:"none"}}}]),e}()},9873:function(e,t,n){"use strict";n.d(t,{Cy:function(){return d},fA:function(){return Z}});var r=n(7762),i=n(1413),a=n(5671),s=n(3144),u=n(2346),o=n(8916),l=n(2793),c=n(5831),f=n(7891),h=n(6546),d="adt_quality_control",v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,a.Z)(this,e),(0,u.Z)(this,v,{writable:!0,value:void 0}),(0,u.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,p,{writable:!0,value:void 0}),!(t instanceof h.tq))throw new Error("'inputs' should be a State object from './inputs.js'");(0,l.Z)(this,v,t),(0,l.Z)(this,p,null===n?{}:n),(0,l.Z)(this,m,null===r?{}:r),this.changed=!1}return(0,s.Z)(e,[{key:"free",value:function(){f.Yl((0,o.Z)(this,m).metrics),f.Yl((0,o.Z)(this,m).filters),f.Yl((0,o.Z)(this,m).metrics_buffer),f.Yl((0,o.Z)(this,m).discard_buffer)}},{key:"valid",value:function(){return(0,o.Z)(this,v).fetchCountMatrix().has("ADT")}},{key:"fetchParameters",value:function(){return(0,i.Z)({},(0,o.Z)(this,p))}},{key:"fetchFilters",value:function(){return(0,o.Z)(this,m).filters}},{key:"fetchDiscards",value:function(){return(0,o.Z)(this,m).discard_buffer}},{key:"fetchMetrics",value:function(){return(0,o.Z)(this,m).metrics}},{key:"compute",value:function(t){var n,r,i=t.igg_prefix,a=t.nmads,s=t.min_detected_drop;if(this.changed=!1,"automatic"in t?(n=t.automatic,r=t.tag_id_column):(n=!0,r=null),(0,o.Z)(this,v).changed||n!==(0,o.Z)(this,p).automatic||i!==(0,o.Z)(this,p).igg_prefix||!n&&r!==(0,o.Z)(this,p).tag_id_column)if(f.Yl((0,o.Z)(this,m).metrics),this.valid()){var u=(0,o.Z)(this,v).fetchFeatureAnnotations().ADT,l=f.rS(u.numberOfRows(),"Uint8Array",(0,o.Z)(this,m),"metrics_buffer");if(l.fill(0),null!==i){var h=i.toLowerCase(),d=r;n&&(d=e.configureFeatureParameters(h,u));var Z=null==d?u.rowNames():u.column(d);if(null!==Z){var w=l.array();Z.forEach((function(e,t){e.toLowerCase().startsWith(h)&&(w[t]=1)}))}}var y=(0,o.Z)(this,v).fetchCountMatrix().get("ADT");(0,o.Z)(this,m).metrics=c.vy(y,[l]),this.changed=!0}else delete(0,o.Z)(this,m).metrics;if((0,o.Z)(this,p).automatic=n,(0,o.Z)(this,p).tag_id_column=r,(0,o.Z)(this,p).igg_prefix=i,this.changed||a!==(0,o.Z)(this,p).nmads||s!==(0,o.Z)(this,p).min_detected_drop){if(f.Yl((0,o.Z)(this,m).filters),this.valid()){var b=(0,o.Z)(this,v).fetchBlock();(0,o.Z)(this,m).filters=c.nO((0,o.Z)(this,m).metrics,{numberOfMADs:a,minDetectedDrop:s,block:b});var g=f.rS((0,o.Z)(this,m).metrics.numberOfCells(),"Uint8Array",(0,o.Z)(this,m),"discard_buffer");(0,o.Z)(this,m).filters.filter((0,o.Z)(this,m).metrics,{block:b,buffer:g}),this.changed=!0}else delete(0,o.Z)(this,m).filters;(0,o.Z)(this,p).nmads=a,(0,o.Z)(this,p).min_detected_drop=s}}}],[{key:"defaults",value:function(){return{automatic:!0,tag_id_column:null,igg_prefix:"IgG",nmads:3,min_detected_drop:.1}}},{key:"configureFeatureParameters",value:function(e,t){var n=function(t){var n=0;return t.forEach((function(t){t.toLowerCase().startsWith(e)&&n++})),n},i=null,a=0,s=t.rowNames();null!==s&&(a=n(s));var u,o=(0,r.Z)(t.columnNames());try{for(o.s();!(u=o.n()).done;){var l=u.value,c=n(t.column(l));c>a&&(i=l,a=c)}}catch(f){o.e(f)}finally{o.f()}return i}}]),e}()},1944:function(e,t,n){"use strict";n.d(t,{Cy:function(){return d},N_:function(){return w}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(2269),h=n(8580),d="batch_correction",v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),!(t instanceof f.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,o.Z)(this,v,t),!(n instanceof h.BE))throw new Error("'pca' should be a CombineEmbeddingsState object");(0,o.Z)(this,m,n),(0,o.Z)(this,p,null===r?{}:r),(0,o.Z)(this,Z,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,Z).corrected)}},{key:"fetchCorrected",value:function(){return(0,u.Z)(this,Z).corrected}},{key:"fetchNumberOfCells",value:function(){return(0,u.Z)(this,m).fetchNumberOfCells()}},{key:"fetchNumberOfDimensions",value:function(){return(0,u.Z)(this,m).fetchNumberOfDimensions()}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,p))}},{key:"compute",value:function(e){var t=e.method,n=e.num_neighbors,r=e.approximate;this.changed=!1,((0,u.Z)(this,v).changed||(0,u.Z)(this,m).changed)&&(this.changed=!0);var i=(0,u.Z)(this,v).fetchFilteredBlock(),a="mnn"==t&&null!==i;if((this.changed||t!==(0,u.Z)(this,p).method||n!==(0,u.Z)(this,p).num_neighbors||r!==(0,u.Z)(this,p).approximate)&&a){var s=(0,u.Z)(this,m).fetchCombined(),o=c.rS(s.length,"Float64Array",(0,u.Z)(this,Z),"corrected");l.F5(s,i,{k:n,buffer:o,numberOfCells:(0,u.Z)(this,m).fetchNumberOfCells(),numberOfDims:(0,u.Z)(this,m).fetchNumberOfDimensions(),approximate:r}),this.changed=!0}this.changed&&(a||(c.Yl((0,u.Z)(this,Z).corrected),(0,u.Z)(this,Z).corrected=(0,u.Z)(this,m).fetchCombined().view())),(0,u.Z)(this,p).method=t,(0,u.Z)(this,p).num_neighbors=n,(0,u.Z)(this,p).approximate=r}}],[{key:"defaults",value:function(){return{method:"mnn",num_neighbors:15,approximate:!0}}}]),e}()},2269:function(e,t,n){"use strict";n.d(t,{Cy:function(){return w},H0:function(){return O}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(7762),h=n(5831),d=n(7891),v=n(652),m=n(9873),p=n(9751),Z=n(6546),w="cell_filtering";function y(e,t){var n,r=d.Mc(e),i=[],a=(0,f.Z)(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;t[s]&&i.push(e[s])}}catch(u){a.e(u)}finally{a.f()}return i}var b=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakMap,x=new WeakSet,E=new WeakSet,O=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,E),(0,s.Z)(this,x),(0,u.Z)(this,b,{writable:!0,value:void 0}),(0,u.Z)(this,g,{writable:!0,value:void 0}),(0,u.Z)(this,_,{writable:!0,value:void 0}),(0,u.Z)(this,k,{writable:!0,value:void 0}),!(t instanceof Z.tq))throw new Error("'inputs' should be an InputsState object");if((0,c.Z)(this,b,t),!(n.RNA instanceof v.E4))throw new Error("'qc_states.RNA' should be a RnaQualityControlState object");if(!(n.ADT instanceof m.fA))throw new Error("'qc_states.ADT' should be a AdtQualityControlState object");if(!(n.CRISPR instanceof p.IW))throw new Error("'qc_states.CRISPR' should be a CrisprQualityControlState object");(0,c.Z)(this,g,n),(0,c.Z)(this,k,null===r?{}:r),(0,c.Z)(this,_,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){d.Yl((0,l.Z)(this,_).block_buffer),d.Yl((0,l.Z)(this,_).discard_buffer),d.Yl((0,l.Z)(this,_).matrix)}},{key:"fetchFilteredMatrix",value:function(){return"matrix"in(0,l.Z)(this,_)||(0,o.Z)(this,x,C).call(this),(0,l.Z)(this,_).matrix}},{key:"fetchFilteredBlock",value:function(){return"block_buffer"in(0,l.Z)(this,_)||(0,o.Z)(this,E,M).call(this),(0,l.Z)(this,_).block_buffer}},{key:"fetchDiscards",value:function(){return"discard_buffer"in(0,l.Z)(this,_)?(0,l.Z)(this,_).discard_buffer:null}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,k))}},{key:"compute",value:function(e){var t=e.use_rna,n=e.use_adt,r=e.use_crispr;this.changed=!1,(0,l.Z)(this,b).changed&&(this.changed=!0),(0,l.Z)(this,k).use_rna===t&&(0,l.Z)(this,k).use_adt===n&&(0,l.Z)(this,k).use_crispr===r||((0,l.Z)(this,k).use_rna=t,(0,l.Z)(this,k).use_adt=n,(0,l.Z)(this,k).use_crispr=r,this.changed=!0);var i=y((0,l.Z)(this,g),{RNA:t,ADT:n,CRISPR:r});if(!this.changed){var a,s=(0,f.Z)(i);try{for(s.s();!(a=s.n()).done;){if(a.value.changed){this.changed=!0;break}}}catch(p){s.e(p)}finally{s.f()}}if(this.changed){if(i.length>0){var u=i[0].fetchDiscards();if(i.length>1){var c=d.rS(u.length,"Uint8Array",(0,l.Z)(this,_),"discard_buffer");c.fill(0);var h,v=c.array(),m=(0,f.Z)(i);try{for(m.s();!(h=m.n()).done;){h.value.fetchDiscards().forEach((function(e,t){v[t]|=e}))}}catch(p){m.e(p)}finally{m.f()}}else d.Yl((0,l.Z)(this,_).discard_buffer),(0,l.Z)(this,_).discard_buffer=u.view()}else d.Yl((0,l.Z)(this,_).discard_buffer),delete(0,l.Z)(this,_).discard_buffer;(0,o.Z)(this,x,C).call(this),(0,o.Z)(this,E,M).call(this)}}},{key:"applyFilter",value:function(e){if((0,l.Z)(this,b).fetchCountMatrix().numberOfColumns()!=e.length)throw new Error("length of 'x' should be equal to the number of cells in the unfiltered dataset");if("discard_buffer"in(0,l.Z)(this,_)){var t=(0,l.Z)(this,_).discard_buffer.array();return e.filter((function(e,n){return!t[n]}))}return e.slice()}},{key:"undoFilter",value:function(e){var t,n=this.fetchFilteredMatrix().numberOfColumns(),r=(0,f.Z)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i<0||i>=n)throw new Error("entries of 'indices' should be less than the number of cells in the filtered dataset")}}catch(s){r.e(s)}finally{r.f()}if("discard_buffer"in(0,l.Z)(this,_)){var a=[];(0,l.Z)(this,_).discard_buffer.forEach((function(e,t){0==e&&a.push(t)})),e.forEach((function(t,n){e[n]=a[t]}))}}}],[{key:"defaults",value:function(){return{use_rna:!0,use_adt:!0,use_crispr:!0}}}]),e}();function C(){d.Yl((0,l.Z)(this,_).matrix),(0,l.Z)(this,_).matrix=new h.VU;var e,t=(0,l.Z)(this,b).fetchCountMatrix(),n=(0,f.Z)(t.available());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=t.get(r),a=void 0;a="discard_buffer"in(0,l.Z)(this,_)?h.b_(i,(0,l.Z)(this,_).discard_buffer):i.clone(),(0,l.Z)(this,_).matrix.add(r,a)}}catch(s){n.e(s)}finally{n.f()}}function M(){d.Yl((0,l.Z)(this,_).block_buffer);var e=(0,l.Z)(this,b).fetchBlock();if(null!==e)if("discard_buffer"in(0,l.Z)(this,_)){var t=this.fetchFilteredMatrix().numberOfColumns(),n=d.rS(t,"Int32Array",(0,l.Z)(this,_),"block_buffer");h.fw(e,(0,l.Z)(this,_).discard_buffer,{buffer:n})}else(0,l.Z)(this,_).block_buffer=e.view();else(0,l.Z)(this,_).block_buffer=null}},4:function(e,t,n){"use strict";n.d(t,{ES:function(){return G}});var r=n(101),i=n(3889),a=n(4165),s=n(5671),u=n(3144),o=n(4942),l=n(2346),c=n(8916),f=n(2793),h=n(7762),d=n(1413),v=n(3324),m=n(5861),p=n(5831),Z=n(6474),w=n(7891),y=n(4833),b=n(6546),g=(n(7317),"https://github.com/kanaverse/singlepp-references/releases/download/2023-04-28"),_=w.we;function k(e){var t=_;return _=e,t}function x(e,t){return E.apply(this,arguments)}function E(){return(E=(0,m.Z)((0,a.Z)().mark((function e(t,n){var r,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t+"_"+n,e.next=3,_(g+"/"+r);case 3:return i=e.sent,e.abrupt("return",new y.zD(i,{name:r}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O={};function C(e){if("prepared"in e){for(var t=0,n=Object.values(e.prepared);t<n.length;t++){n[t].built.raw.free()}delete e.prepared}}function M(e){return R.apply(this,arguments)}function R(){return(R=(0,m.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.bw(t.content(),{compression:"gz"});case 2:n=e.sent,r=[],i=(0,h.Z)(n);try{for(i.s();!(s=i.n()).done;)u=s.value,o=null,""!==u&&1==(o=u.split("\t")).length&&(o=o[0]),r.push(o)}catch(a){i.e(a)}finally{i.f()}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return S.apply(this,arguments)}function S(){return(S=(0,m.Z)((0,a.Z)().mark((function e(t,n){var r,i,s,u,o,l,c,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="genes_"+n.toLowerCase()+".csv.gz",!(t in O)){e.next=13;break}if(i=O[t],s=i.genes,n in s){e.next=12;break}return e.t0=M,e.next=8,x(t,r);case 8:return e.t1=e.sent,e.next=11,(0,e.t0)(e.t1);case 11:s[n]=e.sent;case 12:return e.abrupt("return",i);case 13:return u=["labels_fine.csv.gz","label_names_fine.csv.gz","markers_fine.gmt.gz","matrix.csv.gz",r],e.next=16,Promise.all(u.map((function(e){return x(t,e)})));case 16:return o=e.sent,e.prev=17,l=p.tY(o[3].buffer(),o[2].buffer(),o[0].buffer()),e.next=21,y.bw(o[1].content(),{compression:"gz"});case 21:return f=e.sent,c={raw:l,labels:f,genes:{}},e.next=25,M(o[4]);case 25:c.genes[n]=e.sent,O[t]=c,e.next=33;break;case 29:throw e.prev=29,e.t2=e.catch(17),w.Yl(l),e.t2;case 33:return e.abrupt("return",c);case 34:case"end":return e.stop()}}),e,null,[[17,29]])})))).apply(this,arguments)}function A(){for(var e=0,t=Object.entries(O);e<t.length;e++){var n=(0,v.Z)(t[e],2),r=n[0];n[1].raw.free(),delete O[r]}}var W={9606:["BlueprintEncode","DatabaseImmuneCellExpression","HumanPrimaryCellAtlas","MonacoImmune","NovershternHematopoietic"],10090:["ImmGen","MouseRNAseq"]};function j(e,t,n){var r,i;try{var a=O[e],s=a.raw;if(!(n in a.genes))throw new Error("unknown gene type '"+n+"'");var u=a.genes[n];i={loaded:a,built:{features:u,raw:r=p.St(t,s,u)}}}catch(o){throw w.Yl(r),o}return i}function I(e,t,n,r,i,a,s,u,o){return D.apply(this,arguments)}function D(){return(D=(0,m.Z)((0,a.Z)().mark((function e(t,n,r,i,s,u,o,l,c){var f,d,v,m,Z,y,b,g,_,k,x,E,O,M,R,S,A,I,D;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r===o.automatic&&!w.xi(n,o.references)&&(r||i===o.species&&s===o.gene_id_column&&u===o.gene_id_type)){e.next=39;break}f=i,d=s,v=u,r&&(m=G.configureFeatureParameters(c()),f=m.species,d=m.gene_id_column,v=m.gene_id_type),Z=new Set,y=(0,h.Z)(f);try{for(y.s();!(b=y.n()).done;)(g=b.value)in W&&W[g].forEach((function(e){Z.add(e)}))}catch(a){y.e(a)}finally{y.f()}if(_=l(),k=null==d?_.rowNames():_.column(d),t.gene_ids=k,x={},null===k){e.next=33;break}null==n&&(n=Array.from(Z)),E=(0,h.Z)(n),e.prev=15,E.s();case 17:if((O=E.n()).done){e.next=25;break}if(M=O.value,!Z.has(M)){e.next=23;break}return e.next=22,N(M,v);case 22:x[M]=j(M,k,v);case 23:e.next=17;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(15),E.e(e.t0);case 30:return e.prev=30,E.f(),e.finish(30);case 33:return C(t),t.prepared=x,(R=Object.keys(x)).length>1?(S=Object.values(x),A=S.map((function(e){return e.loaded.raw})),I=S.map((function(e){return e.built.features})),D=S.map((function(e){return e.built.raw})),w.Yl(t.integrated),t.integrated=p.Qj(k,A,I,D)):(w.Yl(t.integrated),delete t.integrated),t.used_refs=R,e.abrupt("return",!0);case 39:return e.abrupt("return",!1);case 40:case"end":return e.stop()}}),e,null,[[15,27,30,33]])})))).apply(this,arguments)}function F(e,t,n,r,i,a){a.references=Z.bl(e),a.automatic=t,a.species=Z.bl(n),a.gene_id_column=r,a.gene_id_type=i}function P(e){var t=(0,d.Z)({},e);return t.references=Z.bl(t.references),t.species=Z.bl(t.species),t}function z(e,t,n){for(var r=t.numberOfCells(),i=e.length,a=new Array(r),s=0;s<r;s++){for(var u={},o=t.scoresForCell(s),l=0;l<i;l++)u[e[l]]=o[l];a[s]={best:e[n[s]],all:u}}return a}function T(e,t){var n,r,i=e;if(e instanceof p.OV){var a=e.numberOfGroups();if(null===t.gene_ids)i=null;else{var s=t.gene_ids.length;n=p.RJ(a*s);for(var u=0;u<a;u++){var o=e.means(u,{copy:!1});if(o.length!==s)throw new Error("unexpected number of genes in marker results");n.array().set(o,u*s)}i=r=p.o1.createDenseMatrix(s,a,n,{columnMajor:!0,copy:!1})}}else if(null!==t.gene_ids&&e.numberOfRows()!==t.gene_ids.length)throw new Error("unexpected number of genes in the input matrix");for(var l=t.prepared,c={per_reference:{}},f={},d=0,m=Object.entries(l);d<m.length;d++){var Z=(0,v.Z)(m[d],2),y=Z[0],b=Z[1],g=p.pG(i,b.built.raw);f[y]=g,c.per_reference[y]=z(b.loaded.labels,g,g.predictedLabels({copy:!1}))}if("integrated"in t){var _,k=[],x=(0,h.Z)(t.used_refs);try{for(x.s();!(_=x.n()).done;){var E=_.value;k.push(f[E])}}catch(R){x.e(R)}finally{x.f()}var O=p.Os(i,k,t.integrated);c.integrated=z(t.used_refs,O,O.predictedReferences({copy:!1})),O.free()}for(var C=0,M=Object.values(f);C<M.length;C++){M[C].free()}return w.Yl(r),w.Yl(n),c}function L(e,t,n){if(null===t)return T(e,n);var r,i=[];try{var a=w.XZ([t]);i.push(a.arrays[0].ids);var s=e;if(null!==a.retain){var u=p.ZW(e,a.retain);i.push(u),s=u}var o=p.p4(s,a.arrays[0].ids,{average:!0});i.push(o);var l=p.o1.createDenseMatrix(s.numberOfRows(),o.numberOfGroups(),o.sums(null,{copy:"view"}),{columnMajor:!0,copy:!1});i.push(l),(r=T(l,n)).groups=a.arrays[0].levels}finally{i.forEach(w.Yl)}return r}var B=new WeakMap,Y=new WeakMap,q=new WeakMap,G=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,s.Z)(this,e),(0,l.Z)(this,B,{writable:!0,value:void 0}),(0,l.Z)(this,Y,{writable:!0,value:void 0}),(0,l.Z)(this,q,{writable:!0,value:void 0}),!(t instanceof b.tq))throw new Error("'inputs' should be a State object from './inputs.js'");(0,f.Z)(this,B,t),(0,f.Z)(this,Y,null===n?{}:n),(0,f.Z)(this,q,null===r?{}:r),this.changed=!1}return(0,u.Z)(e,[{key:"free",value:function(){C((0,c.Z)(this,q))}},{key:"valid",value:function(){return(0,c.Z)(this,B).fetchCountMatrix().has("RNA")}},{key:"fetchParameters",value:function(){return P((0,c.Z)(this,Y))}},{key:"fetchNumberOfSharedFeatures",value:function(){var e,t={},n=(0,h.Z)((0,c.Z)(this,q).used_refs);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=(0,c.Z)(this,q).prepared[r].built.raw.sharedFeatures()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"compute",value:function(){var t=(0,m.Z)((0,a.Z)().mark((function t(n){var r,i,s,u,o,l,f=this;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("references"in n?(r=n.references,i=n.automatic,s=n.species,u=n.gene_id_column,o=n.gene_id_type):(r=null,i=!0,l=e.defaults(),s=l.species,u=l.gene_id_column,o=l.gene_id_type),this.changed=!1,!this.valid()){t.next=6;break}return t.next=5,I((0,c.Z)(this,q),r,i,s,u,o,(0,c.Z)(this,Y),(function(){return(0,c.Z)(f,B).fetchFeatureAnnotations().RNA}),(function(){return(0,c.Z)(f,B).guessRnaFeatureTypes()}));case 5:this.changed=t.sent;case 6:F(r,i,s,u,o,(0,c.Z)(this,Y));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"computeLabels",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).group;return L(e,void 0===t?null:t,(0,c.Z)(this,q))}}],[{key:"defaults",value:function(){return{references:null,automatic:!0,species:[],gene_id_column:null,gene_id_type:"ENSEMBL"}}},{key:"configureFeatureParameters",value:function(e){var t=null,n={type:"symbol",species:"human",confidence:0};if("row_names"in e){var r=e.row_names;r.confidence>n.confidence&&(n=r)}for(var i=0,a=Object.entries(e.columns);i<a.length;i++){var s=(0,v.Z)(a[i],2),u=s[0],o=s[1];o.confidence>n.confidence&&(n=o,t=u)}return{gene_id_column:t,species:[n.species],gene_id_type:n.type.toUpperCase()}}},{key:"flush",value:function(){A()}},{key:"setDownload",value:function(e){return k(e)}}]),e}();(0,o.Z)(G,"availableReferences",W);var U=new WeakMap,V=new WeakMap,H=new WeakMap,$=new WeakMap,Q=new WeakMap,J=new WeakSet,K=function(){function e(t){(0,s.Z)(this,e),(0,r.Z)(this,J),(0,l.Z)(this,U,{writable:!0,value:void 0}),(0,l.Z)(this,V,{writable:!0,value:void 0}),(0,l.Z)(this,H,{writable:!0,value:void 0}),(0,l.Z)(this,$,{writable:!0,value:void 0}),(0,l.Z)(this,Q,{writable:!0,value:void 0}),(0,f.Z)(this,U,{}),(0,f.Z)(this,Q,e.defaults()),(0,f.Z)(this,H,t),(0,f.Z)(this,V,{}),(0,f.Z)(this,$,null)}return(0,u.Z)(e,[{key:"free",value:function(){C((0,c.Z)(this,V))}},{key:"fetchParameters",value:function(){return P((0,c.Z)(this,Q))}},{key:"setParameters",value:function(){var e=(0,m.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.references,r=t.automatic,i=t.species,s=t.gene_id_column,u=t.gene_id_type,F(n,r,i,s,u,(0,c.Z)(this,Q));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"ready",value:function(){var e=(0,m.Z)((0,a.Z)().mark((function e(){var t,n,r,s,u,o,l=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.Z)(this,Q),n=t.references,r=t.automatic,s=t.species,u=t.gene_id_column,o=t.gene_id_type,e.next=3,I((0,c.Z)(this,V),n,r,s,u,o,(0,c.Z)(this,U),(function(){return(0,c.Z)(l,H)}),(function(){return(0,i.Z)(l,J,X).call(l)}));case 3:(0,f.Z)(this,U,(0,c.Z)(this,Q));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"computeLabels",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).group;return L(e,void 0===t?null:t,(0,c.Z)(this,V))}}],[{key:"defaults",value:function(){return{references:null,automatic:!0,species:[],gene_id_column:null,gene_id_type:"ENSEMBL"}}},{key:"flush",value:function(){A()}},{key:"setDownload",value:function(e){return k(e)}}]),e}();function X(){return null==(0,c.Z)(this,$)&&(0,f.Z)(this,$,w.zS((0,c.Z)(this,H))),(0,c.Z)(this,$)}(0,o.Z)(K,"availableReferences",W)},7139:function(e,t,n){"use strict";n.d(t,{c:function(){return m}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=(n(5831),n(7891),n(4414)),c=n(8849),f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,f,{writable:!0,value:void 0}),(0,s.Z)(this,h,{writable:!0,value:void 0}),(0,s.Z)(this,d,{writable:!0,value:void 0}),(0,s.Z)(this,v,{writable:!0,value:void 0}),!(t instanceof l.Xs))throw new Error("'snn' should be a State object from './snn_graph_cluster.js'");if((0,o.Z)(this,f,t),!(n instanceof c.d))throw new Error("'kmeans' should be a State object from './kmeans_cluster.js'");(0,o.Z)(this,h,n),(0,o.Z)(this,d,null===r?{}:r),(0,o.Z)(this,v,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){}},{key:"fetchClusters",value:function(){return"snn_graph"==(0,u.Z)(this,d).method?(0,u.Z)(this,f).fetchClusters():"kmeans"==(0,u.Z)(this,d).method?(0,u.Z)(this,h).fetchClusters():void 0}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,d))}},{key:"compute",value:function(e){var t=e.method;this.changed=!0,t==(0,u.Z)(this,d).method&&("snn_graph"==t?(0,u.Z)(this,f).changed||(this.changed=!1):"kmeans"==t&&((0,u.Z)(this,h).changed||(this.changed=!1))),(0,u.Z)(this,d).method=t}}]),e}()},8580:function(e,t,n){"use strict";n.d(t,{BE:function(){return b},Cy:function(){return m}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(7762),c=n(5831),f=n(7891),h=n(384),d=n(7188),v=n(6849),m="combine_embeddings";function p(e,t){var n,r=f.Mc(e),i=[],a=(0,l.Z)(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;t[s]>0&&i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i}var Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,i.Z)(this,e),(0,s.Z)(this,Z,{writable:!0,value:void 0}),(0,s.Z)(this,w,{writable:!0,value:void 0}),(0,s.Z)(this,y,{writable:!0,value:void 0}),!(t.RNA instanceof h.rR))throw new Error("'pca_states.RNA' should be an RnaPcaState object");if(!(t.ADT instanceof d.Ru))throw new Error("'pca_states.ADT' should be an AdtPcaState object");if(!(t.CRISPR instanceof v.zR))throw new Error("'pca_states.CRISPR' should be an CrisprPcaState object");(0,o.Z)(this,Z,t),(0,o.Z)(this,w,null===n?{}:n),(0,o.Z)(this,y,null===r?{}:r),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){f.Yl((0,u.Z)(this,y).combined_buffer)}},{key:"fetchCombined",value:function(){return(0,u.Z)(this,y).combined_buffer}},{key:"fetchNumberOfCells",value:function(){return(0,u.Z)(this,y).num_cells}},{key:"fetchNumberOfDimensions",value:function(){return(0,u.Z)(this,y).total_dims}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,w))}},{key:"compute",value:function(e){var t=e.rna_weight,n=e.adt_weight,r=e.crispr_weight,i=e.approximate;this.changed=!1;for(var a=0,s=Object.values((0,u.Z)(this,Z));a<s.length;a++){if(s[a].changed){this.changed=!0;break}}if(i!==(0,u.Z)(this,w).approximate&&((0,u.Z)(this,w).approximate=i,this.changed=!0),t===(0,u.Z)(this,w).rna_weight&&n===(0,u.Z)(this,w).adt_weight&&r===(0,u.Z)(this,w).crispr_weight||((0,u.Z)(this,w).rna_weight=t,(0,u.Z)(this,w).adt_weight=n,(0,u.Z)(this,w).crispr_weight=r,this.changed=!0),this.changed){var o={RNA:t,ADT:n,CRISPR:r},h=p((0,u.Z)(this,Z),o);if(h.length>1){var d,v=h.map((function(e){return o[e]})),m=[],b=0,g=null,_=(0,l.Z)(h);try{for(_.s();!(d=_.n()).done;){var k=d.value,x=(0,u.Z)(this,Z)[k].fetchPCs();if(m.push(x.principalComponents({copy:"view"})),null==g)g=x.numberOfCells();else if(g!==x.numberOfCells())throw new Error("number of cells should be consistent across all embeddings");b+=x.numberOfPCs()}}catch(C){_.e(C)}finally{_.f()}var E=f.rS(g*b,"Float64Array",(0,u.Z)(this,y),"combined_buffer");c.jX(m,g,{buffer:E,weights:v,approximate:i}),(0,u.Z)(this,y).num_cells=g,(0,u.Z)(this,y).total_dims=b}else{var O=(0,u.Z)(this,Z)[h[0]].fetchPCs();this.constructor.createPcsView((0,u.Z)(this,y),O)}}}}],[{key:"defaults",value:function(){return{rna_weight:1,adt_weight:1,crispr_weight:0,approximate:!0}}},{key:"createPcsView",value:function(e,t){f.Yl(e.combined_buffer),e.combined_buffer=t.principalComponents({copy:"view"}).view(),e.num_cells=t.numberOfCells(),e.total_dims=t.numberOfPCs()}}]),e}()},2615:function(e,t,n){"use strict";n.d(t,{$M:function(){return _},Cy:function(){return p}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(569),v=n(9751),m=n(2269),p="crispr_normalization",Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakSet,_=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,g),(0,u.Z)(this,Z,{writable:!0,value:void 0}),(0,u.Z)(this,w,{writable:!0,value:void 0}),(0,u.Z)(this,y,{writable:!0,value:void 0}),(0,u.Z)(this,b,{writable:!0,value:void 0}),!(t instanceof v.IW))throw new Error("'qc' should be a CrisprQualityControlState object");if((0,c.Z)(this,Z,t),!(n instanceof m.H0))throw new Error("'filter' should be a CellFilteringState object");(0,c.Z)(this,w,n),(0,c.Z)(this,y,null===r?{}:r),(0,c.Z)(this,b,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,b).matrix),h.Yl((0,l.Z)(this,b).total_buffer),h.Yl((0,l.Z)(this,b).centered_buffer)}},{key:"valid",value:function(){return(0,l.Z)(this,w).fetchFilteredMatrix().has("CRISPR")}},{key:"fetchNormalizedMatrix",value:function(){return"matrix"in(0,l.Z)(this,b)||(0,o.Z)(this,g,k).call(this),(0,l.Z)(this,b).matrix}},{key:"fetchSizeFactors",value:function(){var e;return(0,l.Z)(this,b).sum_buffer&&(e=h.rS((0,l.Z)(this,b).sum_buffer.length,"Float64Array",(0,l.Z)(this,b),"centered_buffer"),f.v_((0,l.Z)(this,b).sum_buffer,{buffer:e,block:(0,l.Z)(this,w).fetchFilteredBlock()})),e}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,y))}},{key:"compute",value:function(e){this.changed=!1,((0,l.Z)(this,Z).changed||(0,l.Z)(this,w).changed)&&this.valid()&&((0,o.Z)(this,g,k).call(this),this.changed=!0)}},{key:"serialize",value:function(e){var t=e.createGroup(p);t.createGroup("parameters"),t.createGroup("results")}}],[{key:"defaults",value:function(){return{}}}]),e}();function k(){var e=(0,l.Z)(this,w).fetchFilteredMatrix().get("CRISPR"),t=d.e((0,l.Z)(this,Z),(0,l.Z)(this,w),e,(0,l.Z)(this,b),"sum_buffer"),n=(0,l.Z)(this,w).fetchFilteredBlock();h.Yl((0,l.Z)(this,b).matrix),(0,l.Z)(this,b).matrix=f.gk(e,{sizeFactors:t,block:n,allowZeros:!0})}},6849:function(e,t,n){"use strict";n.d(t,{Cy:function(){return d},zR:function(){return w}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(2269),h=n(2615),d="crispr_pca",v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),!(t instanceof f.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,o.Z)(this,v,t),!(n instanceof h.$M))throw new Error("'norm' should be a CrisprNormalizationState object");(0,o.Z)(this,m,n),(0,o.Z)(this,Z,null===r?{}:r),(0,o.Z)(this,p,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,p).pcs)}},{key:"valid",value:function(){return(0,u.Z)(this,m).valid()}},{key:"fetchPCs",value:function(){return(0,u.Z)(this,p).pcs}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,Z))}},{key:"compute",value:function(e){var t=e.num_pcs,n=e.block_method;if(this.changed=!1,(0,u.Z)(this,m).changed||t!==(0,u.Z)(this,Z).num_pcs||n!==(0,u.Z)(this,Z).block_method){if(this.valid()){var r=(0,u.Z)(this,v).fetchFilteredBlock(),i=(0,u.Z)(this,m).fetchNormalizedMatrix();c.Yl((0,u.Z)(this,p).pcs),(0,u.Z)(this,p).pcs=l.aG(i,{numberOfPCs:t,block:r,blockMethod:n}),this.changed=!0}(0,u.Z)(this,Z).num_pcs=t,(0,u.Z)(this,Z).block_method=n}}}],[{key:"defaults",value:function(){return{num_pcs:20,block_method:"none"}}}]),e}()},9751:function(e,t,n){"use strict";n.d(t,{Cy:function(){return h},IW:function(){return p}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(6546),h="crispr_quality_control",d=new WeakMap,v=new WeakMap,m=new WeakMap,p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,i.Z)(this,e),(0,s.Z)(this,d,{writable:!0,value:void 0}),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),!(t instanceof f.tq))throw new Error("'inputs' should be a State object from './inputs.js'");(0,o.Z)(this,d,t),(0,o.Z)(this,m,null===n?{}:n),(0,o.Z)(this,v,null===r?{}:r),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,v).metrics),c.Yl((0,u.Z)(this,v).filters),c.Yl((0,u.Z)(this,v).metrics_buffer),c.Yl((0,u.Z)(this,v).discard_buffer)}},{key:"valid",value:function(){return(0,u.Z)(this,d).fetchCountMatrix().has("CRISPR")}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,m))}},{key:"fetchFilters",value:function(){return(0,u.Z)(this,v).filters}},{key:"fetchDiscards",value:function(){return(0,u.Z)(this,v).discard_buffer}},{key:"fetchMetrics",value:function(){return(0,u.Z)(this,v).metrics}},{key:"compute",value:function(e){var t=e.nmads;if(this.changed=!1,(0,u.Z)(this,d).changed)if(c.Yl((0,u.Z)(this,v).metrics),this.valid()){var n=(0,u.Z)(this,d).fetchCountMatrix().get("CRISPR");(0,u.Z)(this,v).metrics=l.J4(n),this.changed=!0}else delete(0,u.Z)(this,v).metrics;if(this.changed||t!==(0,u.Z)(this,m).nmads){if(c.Yl((0,u.Z)(this,v).filters),this.valid()){var r=(0,u.Z)(this,d).fetchBlock();(0,u.Z)(this,v).filters=l.XU((0,u.Z)(this,v).metrics,{numberOfMADs:t,block:r});var i=c.rS((0,u.Z)(this,v).metrics.numberOfCells(),"Uint8Array",(0,u.Z)(this,v),"discard_buffer");(0,u.Z)(this,v).filters.filter((0,u.Z)(this,v).metrics,{block:r,buffer:i}),this.changed=!0}else delete(0,u.Z)(this,v).filters;(0,u.Z)(this,m).nmads=t}}}],[{key:"defaults",value:function(){return{nmads:3}}}]),e}()},8391:function(e,t,n){"use strict";n.d(t,{$:function(){return Z}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(2269),h=n(7317),d=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,d,{writable:!0,value:void 0}),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),!(t instanceof f.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,o.Z)(this,d,t),!(n instanceof h.ue))throw new Error("'norm' should be an RnaNormalizationState object");(0,o.Z)(this,v,n),(0,o.Z)(this,p,null===r?{}:r),(0,o.Z)(this,m,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,m).matrix)}},{key:"valid",value:function(){return(0,u.Z)(this,v).valid()}},{key:"fetchResults",value:function(){return(0,u.Z)(this,m).results}},{key:"fetchSortedResiduals",value:function(){return(0,u.Z)(this,m).sorted_residuals}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,p))}},{key:"compute",value:function(e){var t=e.span;if(this.changed=!1,(0,u.Z)(this,v).changed||t!=(0,u.Z)(this,p).span){if(c.Yl((0,u.Z)(this,m).results),this.valid()){var n=(0,u.Z)(this,v).fetchNormalizedMatrix(),r=(0,u.Z)(this,d).fetchFilteredBlock();(0,u.Z)(this,m).results=l.rY(n,{span:t,block:r}),(0,u.Z)(this,m).sorted_residuals=(0,u.Z)(this,m).results.residuals().slice(),(0,u.Z)(this,m).sorted_residuals.sort(),this.changed=!0}(0,u.Z)(this,p).span=t}}}]),e}()},8849:function(e,t,n){"use strict";n.d(t,{d:function(){return w}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(1944),v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakSet,w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,i.Z)(this,e),(0,s.Z)(this,Z),(0,u.Z)(this,v,{writable:!0,value:void 0}),(0,u.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,p,{writable:!0,value:void 0}),!(t instanceof d.N_))throw new Error("'correct' should be a BatchCorrectionState object");(0,c.Z)(this,v,t),(0,c.Z)(this,m,null===n?{}:n),(0,c.Z)(this,p,null===r?{}:r),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,p).raw)}},{key:"fetchClusters",value:function(){if((0,o.Z)(this,Z,y).call(this))return(0,l.Z)(this,p).raw.clusters({copy:"view"});throw new Error("cannot fetch k-means clusters from an invalid state")}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,m))}},{key:"compute",value:function(e,t){var n=t.k;if(this.changed=!1,(0,l.Z)(this,v).changed||n!=(0,l.Z)(this,m).k||!(0,o.Z)(this,Z,y).call(this)&&e){if(h.Yl((0,l.Z)(this,p).raw),e){var r=(0,l.Z)(this,v).fetchCorrected();(0,l.Z)(this,p).raw=f.eu(r,n,{numberOfDims:(0,l.Z)(this,v).fetchNumberOfDimensions(),numberOfCells:(0,l.Z)(this,v).fetchNumberOfCells(),initMethod:"pca-part"})}else delete(0,l.Z)(this,p).raw;(0,l.Z)(this,m).k=n,this.changed=!0}}}]),e}();function y(){return"raw"in(0,l.Z)(this,p)}},8334:function(e,t,n){"use strict";n.d(t,{Cy:function(){return y},J6:function(){return I},UL:function(){return C}});var r=n(7762),i=n(3324),a=n(1413),s=n(5671),u=n(3144),o=n(2346),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(818),v=n(2269),m=n(7139),p=n(7317),Z=n(8366),w=n(2615),y="marker_detection";function b(e){for(var t=0,n=Object.values(e.raw);t<n.length;t++){var r=n[t];h.Yl(r)}e.raw={},d.eo(e.versus),delete e.versus}function g(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.cache,s=void 0===a?{}:a,u=i.block,o=void 0===u?null:u,l=i.lfc_threshold,c=void 0===l?0:l,f=i.compute_auc,h=void 0===f||f,v=d.Bh(e,t,s),m=v.left_small?0:1,p=v.left_small?1:0;if(v.run){var Z=[],w=[],y=!1,b=!1;if(r.forEach((function(n,r){n==e?(Z.push(m),w.push(r),y=!0):n==t&&(Z.push(p),w.push(r),b=!0)})),!y||!b)throw new Error("non-zero entries should be present for both requested clusters in versus mode");d.c9(n,Z,o,w,v.cached,c,h)}return{results:v.cached,left:m,right:p}}var _=new WeakMap,k=new WeakMap,x=new WeakMap,E=new WeakMap,O=new WeakMap,C=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,s.Z)(this,e),(0,o.Z)(this,_,{writable:!0,value:void 0}),(0,o.Z)(this,k,{writable:!0,value:void 0}),(0,o.Z)(this,x,{writable:!0,value:void 0}),(0,o.Z)(this,E,{writable:!0,value:void 0}),(0,o.Z)(this,O,{writable:!0,value:void 0}),!(t instanceof v.H0))throw new Error("'filter' should be a State object from './cell_filtering.js'");if((0,c.Z)(this,_,t),!(n.RNA instanceof p.ue))throw new Error("'norm_states.RNA' should be an RnaNormalizationState object");if(!(n.ADT instanceof Z.m5))throw new Error("'norm_states.ADT' should be an AdtNormalizationState object");if(!(n.CRISPR instanceof w.$M))throw new Error("'norm_states.CRISPR' should be an CrisprNormalizationState object");if((0,c.Z)(this,k,n),!(r instanceof m.c))throw new Error("'choice' should be a State object from './choose_clustering.js'");(0,c.Z)(this,x,r),(0,c.Z)(this,E,null===i?{}:i),(0,c.Z)(this,O,null===a?{raw:{}}:a),this.changed=!1}return(0,u.Z)(e,[{key:"free",value:function(){b((0,l.Z)(this,O))}},{key:"fetchResults",value:function(){return(0,l.Z)(this,O).raw}},{key:"fetchParameters",value:function(){return(0,a.Z)({},(0,l.Z)(this,E))}},{key:"compute",value:function(e){var t=e.lfc_threshold,n=e.compute_auc;this.changed=!1;for(var r=t!==(0,l.Z)(this,E).lfc_threshold||n!==(0,l.Z)(this,E).compute_auc,a=0,s=Object.entries((0,l.Z)(this,k));a<s.length;a++){var u=(0,i.Z)(s[a],2),o=u[0],c=u[1];if(c.valid()&&((0,l.Z)(this,x).changed||c.changed||r)){var v=c.fetchNormalizedMatrix(),m=(0,l.Z)(this,x).fetchClusters(),p=(0,l.Z)(this,_).fetchFilteredBlock();h.Yl((0,l.Z)(this,O).raw[o]),(0,l.Z)(this,O).raw[o]=f.y5(v,m,{block:p,lfcThreshold:t,computeAuc:n}),this.changed=!0}}(0,l.Z)(this,E).lfc_threshold=t,(0,l.Z)(this,E).compute_auc=n,this.changed&&d.eo((0,l.Z)(this,O).versus)}},{key:"computeVersus",value:function(e,t){for(var n=(0,l.Z)(this,x).fetchClusters(),r=(0,l.Z)(this,_).fetchFilteredBlock(),a=new f.VU,s=0,u=Object.entries((0,l.Z)(this,k));s<u.length;s++){var o=(0,i.Z)(u[s],2),c=o[0],h=o[1];h.valid()&&a.add(c,h.fetchNormalizedMatrix())}return"versus"in(0,l.Z)(this,O)||((0,l.Z)(this,O).versus={}),g(e,t,a,n,{cache:(0,l.Z)(this,O).versus,block:r,lfc_threshold:(0,l.Z)(this,E).lfc_threshold,compute_auc:(0,l.Z)(this,E).compute_auc})}}],[{key:"defaults",value:function(){return{lfc_threshold:0,compute_auc:!0}}},{key:"computeVersusCustom",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.cache,s=void 0===a?{}:a,u=i.block,o=void 0===u?null:u,l=i.lfc_threshold,c=void 0===l?0:l,f=i.compute_auc;return computeVersus(e,t,n,r,{cache:s,block:o,lfc_threshold:c,compute_auc:void 0===f||f})}}]),e}(),M=new WeakMap,R=new WeakMap,N=new WeakMap,S=new WeakMap,A=new WeakMap,W=new WeakMap,j=new WeakMap,I=function(){function e(t,n){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).block,a=void 0===i?null:i;(0,s.Z)(this,e),(0,o.Z)(this,M,{writable:!0,value:void 0}),(0,o.Z)(this,R,{writable:!0,value:void 0}),(0,o.Z)(this,N,{writable:!0,value:void 0}),(0,o.Z)(this,S,{writable:!0,value:void 0}),(0,o.Z)(this,A,{writable:!0,value:void 0}),(0,o.Z)(this,W,{writable:!0,value:void 0}),(0,o.Z)(this,j,{writable:!0,value:void 0});var u,l=n.length,d=(0,r.Z)(t.available());try{for(d.s();!(u=d.n()).done;){var v=u.value;if(t.get(v).numberOfColumns()!=l)throw new Error("all matrices in 'normalized' should have the same number of columns as the length of 'groups'")}}catch(_){d.e(_)}finally{d.f()}if(null!==a&&a.length!=l)throw new Error("'block' should have the same length as 'groups' if not null");var m=[n];null!==a&&m.push(a);var p,Z=h.XZ(m);if(null!==Z.retain){p=new f.VU;var w=f.Wf(Z.retain.length);try{w.set(Z.retain);var y,b=(0,r.Z)(t.available());try{for(b.s();!(y=b.n()).done;){var g=y.value;p.add(g,f.ZW(t.get(g),w))}}catch(_){b.e(_)}finally{b.f()}}catch(k){throw p.free(),k}finally{f.gd(w)}}else p=t.clone();(0,c.Z)(this,M,p),(0,c.Z)(this,R,Z.arrays[0].ids),(0,c.Z)(this,N,Z.arrays[0].levels),null!==a?((0,c.Z)(this,S,Z.arrays[1].ids),(0,c.Z)(this,A,Z.arrays[1].levels)):((0,c.Z)(this,S,null),(0,c.Z)(this,A,null)),(0,c.Z)(this,W,{raw:{},init:!0}),(0,c.Z)(this,j,C.defaults()),this.changed=!1}return(0,u.Z)(e,[{key:"free",value:function(){f.gd((0,l.Z)(this,R)),f.gd((0,l.Z)(this,S)),f.gd((0,l.Z)(this,M)),b((0,l.Z)(this,W))}},{key:"fetchResults",value:function(){return(0,l.Z)(this,W).raw}},{key:"fetchParameters",value:function(){return(0,a.Z)({},(0,l.Z)(this,j))}},{key:"fetchGroupLevels",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e,n=(0,l.Z)(this,N);return t?n.slice():n}},{key:"fetchBlockLevels",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e,n=(0,l.Z)(this,A);return t?n.slice():n}},{key:"_peekMatrices",value:function(){return(0,l.Z)(this,M)}},{key:"_peekGroups",value:function(){return(0,l.Z)(this,R)}},{key:"_peekBlock",value:function(){return(0,l.Z)(this,S)}},{key:"setParameters",value:function(e){(0,l.Z)(this,j).lfc_threshold===e.lfc_threshold&&(0,l.Z)(this,j).compute_auc===e.compute_auc||this.free(),(0,c.Z)(this,j,(0,a.Z)({},e))}},{key:"computeAll",value:function(){var e,t=(0,l.Z)(this,j),n=t.lfc_threshold,i=t.compute_auc,a=(0,r.Z)((0,l.Z)(this,M).available());try{for(a.s();!(e=a.n()).done;){var s=e.value,u=(0,l.Z)(this,M).get(s);h.Yl((0,l.Z)(this,W).raw[s]),(0,l.Z)(this,W).raw[s]=f.y5(u,(0,l.Z)(this,R),{block:(0,l.Z)(this,S),lfcThreshold:n,computeAuc:i})}}catch(o){a.e(o)}finally{a.f()}}},{key:"computeVersus",value:function(e,t){return"versus"in(0,l.Z)(this,W)||((0,l.Z)(this,W).versus={}),g(e,t,(0,l.Z)(this,M),(0,l.Z)(this,R),{cache:(0,l.Z)(this,W).versus,block:(0,l.Z)(this,S),lfc_threshold:(0,l.Z)(this,j).lfc_threshold,compute_auc:(0,l.Z)(this,j).compute_auc})}}]),e}()},7625:function(e,t,n){"use strict";n.d(t,{Cy:function(){return v},Xr:function(){return y}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(1944),v="neighbor_index",m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakSet,y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,i.Z)(this,e),(0,s.Z)(this,w),(0,u.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,Z,{writable:!0,value:void 0}),!(t instanceof d.N_))throw new Error("'correct' should be a BatchCorrectionState object");(0,c.Z)(this,m,t),(0,c.Z)(this,p,null===n?{}:n),(0,c.Z)(this,Z,null===r?{}:r),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,Z).raw)}},{key:"fetchIndex",value:function(){return"raw"in(0,l.Z)(this,Z)||(0,o.Z)(this,w,b).call(this,(0,l.Z)(this,p).approximate),(0,l.Z)(this,Z).raw}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,p))}},{key:"compute",value:function(e){var t=e.approximate;this.changed=!1,((0,l.Z)(this,m).changed||t!=(0,l.Z)(this,p).approximate)&&(h.Yl((0,l.Z)(this,Z).raw),(0,o.Z)(this,w,b).call(this,t),(0,l.Z)(this,p).approximate=t,this.changed=!0)}}],[{key:"defaults",value:function(){return{approximate:!0}}}]),e}();function b(e){(0,l.Z)(this,Z).raw=f.Fu((0,l.Z)(this,m).fetchCorrected(),{approximate:e,numberOfDims:(0,l.Z)(this,m).fetchNumberOfDimensions(),numberOfCells:(0,l.Z)(this,m).fetchNumberOfCells()})}},7317:function(e,t,n){"use strict";n.d(t,{Cy:function(){return p},ue:function(){return _}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(569),v=n(652),m=n(2269),p="rna_normalization",Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakSet,_=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,i.Z)(this,e),(0,s.Z)(this,g),(0,u.Z)(this,Z,{writable:!0,value:void 0}),(0,u.Z)(this,w,{writable:!0,value:void 0}),(0,u.Z)(this,y,{writable:!0,value:void 0}),(0,u.Z)(this,b,{writable:!0,value:void 0}),!(t instanceof v.E4))throw new Error("'qc' should be a RnaQualityControlState object");if((0,c.Z)(this,Z,t),!(n instanceof m.H0))throw new Error("'filter' should be a CellFilteringState object");(0,c.Z)(this,w,n),(0,c.Z)(this,y,null===r?{}:r),(0,c.Z)(this,b,null===a?{}:a),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,b).matrix),h.Yl((0,l.Z)(this,b).sum_buffer)}},{key:"valid",value:function(){return(0,l.Z)(this,w).fetchFilteredMatrix().has("RNA")}},{key:"fetchNormalizedMatrix",value:function(){return"matrix"in(0,l.Z)(this,b)||(0,o.Z)(this,g,k).call(this),(0,l.Z)(this,b).matrix}},{key:"fetchSizeFactors",value:function(){var e;return(0,l.Z)(this,b).sum_buffer&&(e=h.rS((0,l.Z)(this,b).sum_buffer.length,"Float64Array",(0,l.Z)(this,b),"centered_buffer"),f.v_((0,l.Z)(this,b).sum_buffer,{buffer:e,block:(0,l.Z)(this,w).fetchFilteredBlock()})),e}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,y))}},{key:"compute",value:function(e){this.changed=!1,((0,l.Z)(this,Z).changed||(0,l.Z)(this,w).changed)&&this.valid()&&(this.changed=!0),this.changed&&(0,o.Z)(this,g,k).call(this)}}],[{key:"defaults",value:function(){return{}}}]),e}();function k(){var e=(0,l.Z)(this,w).fetchFilteredMatrix().get("RNA"),t=d.e((0,l.Z)(this,Z),(0,l.Z)(this,w),e,(0,l.Z)(this,b),"sum_buffer"),n=(0,l.Z)(this,w).fetchFilteredBlock();h.Yl((0,l.Z)(this,b).matrix),(0,l.Z)(this,b).matrix=f.gk(e,{sizeFactors:t,block:n,allowZeros:!0})}},384:function(e,t,n){"use strict";n.d(t,{Cy:function(){return v},rR:function(){return b}});var r=n(1413),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(5831),c=n(7891),f=n(2269),h=n(7317),d=n(8391),v="rna_pca",m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,i.Z)(this,e),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),(0,s.Z)(this,w,{writable:!0,value:void 0}),(0,s.Z)(this,y,{writable:!0,value:void 0}),!(t instanceof f.H0))throw new Error("'filter' should be a CellFilteringState object");if((0,o.Z)(this,m,t),!(n instanceof h.ue))throw new Error("'norm' should be an RnaNormalizationState object");if((0,o.Z)(this,p,n),!(r instanceof d.$))throw new Error("'feat' should be a FeatureSelectionState object");(0,o.Z)(this,Z,r),(0,o.Z)(this,y,null===a?{}:a),(0,o.Z)(this,w,null===u?{}:u),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){c.Yl((0,u.Z)(this,w).hvg_buffer),c.Yl((0,u.Z)(this,w).pcs)}},{key:"valid",value:function(){return(0,u.Z)(this,p).valid()}},{key:"fetchPCs",value:function(){return(0,u.Z)(this,w).pcs}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,u.Z)(this,y))}},{key:"compute",value:function(e){var t=e.num_hvgs,n=e.num_pcs,r=e.block_method;if(this.changed=!1,((0,u.Z)(this,Z).changed||t!==(0,u.Z)(this,y).num_hvgs)&&(this.valid()&&(g(t,(0,u.Z)(this,Z),(0,u.Z)(this,w)),this.changed=!0),(0,u.Z)(this,y).num_hvgs=t),this.changed||(0,u.Z)(this,p).changed||n!==(0,u.Z)(this,y).num_pcs||r!==(0,u.Z)(this,y).block_method){if(c.Yl((0,u.Z)(this,w).pcs),this.valid()){var i=(0,u.Z)(this,w).hvg_buffer,a=(0,u.Z)(this,m).fetchFilteredBlock(),s=(0,u.Z)(this,p).fetchNormalizedMatrix();(0,u.Z)(this,w).pcs=l.aG(s,{features:i,numberOfPCs:n,block:a,blockMethod:r}),this.changed=!0}(0,u.Z)(this,y).num_pcs=n,(0,u.Z)(this,y).block_method=r}}}],[{key:"defaults",value:function(){return{num_hvgs:2e3,num_pcs:20,block_method:"none"}}}]),e}();function g(e,t,n){var r=t.fetchSortedResiduals(),i=c.rS(r.length,"Uint8Array",n,"hvg_buffer");if(e<r.length){var a=r[r.length-e],s=t.fetchResults().residuals({copy:!1});i.array().forEach((function(e,t,n){n[t]=s[t]>=a}))}else i.fill(1);return i}},652:function(e,t,n){"use strict";n.d(t,{Cy:function(){return x},E4:function(){return N}});var r=n(7762),i=n(3324),a=n(4165),s=n(5861),u=n(1413),o=n(5671),l=n(3144),c=n(101),f=n(4942),h=n(2346),d=n(3889),v=n(3966),m=n(9902),p=n(8916),Z=n(2793),w=n(5831),y=n(6474),b=n(7891),g=n(6546),_=n(4833),k="https://github.com/kanaverse/kana-special-features/releases/download/v1.0.0",x="rna_quality_control",E=new WeakMap,O=new WeakMap,C=new WeakMap,M=new WeakMap,R=new WeakSet,N=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,o.Z)(this,e),(0,c.Z)(this,R),(0,h.Z)(this,E,{writable:!0,value:void 0}),(0,h.Z)(this,O,{writable:!0,value:void 0}),(0,h.Z)(this,C,{writable:!0,value:void 0}),(0,h.Z)(this,M,{writable:!0,value:void 0}),!(t instanceof g.tq))throw new Error("'inputs' should be an InputsState object");(0,Z.Z)(this,E,t),(0,Z.Z)(this,C,null===n?{}:n),(0,Z.Z)(this,O,null===r?{}:r),(0,Z.Z)(this,M,!1),this.changed=!1}return(0,l.Z)(e,[{key:"free",value:function(){b.Yl((0,p.Z)(this,O).metrics),b.Yl((0,p.Z)(this,O).filters),b.Yl((0,p.Z)(this,O).metrics_buffer),b.Yl((0,p.Z)(this,O).discard_buffer)}},{key:"valid",value:function(){return(0,p.Z)(this,E).fetchCountMatrix().has("RNA")}},{key:"fetchParameters",value:function(){var e=(0,u.Z)({},(0,p.Z)(this,C));return e.species=y.bl(e.species),e}},{key:"fetchDiscards",value:function(){return(0,p.Z)(this,O).discard_buffer}},{key:"fetchFilters",value:function(){return(0,p.Z)(this,O).filters}},{key:"fetchMetrics",value:function(){return(0,p.Z)(this,O).metrics}},{key:"compute",value:function(){var t=(0,s.Z)((0,a.Z)().mark((function t(n){var r,i,s,u,o,l,c,f,h,v,m,Z,g,_,k,x,M,N,A,W,j,I;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.mito_prefix,i=n.nmads,"use_reference_mito"in n?(s=n.automatic,u=n.use_reference_mito,o=n.gene_id_column,l=n.species,c=n.gene_id_type):(s=!0,u=n.use_mito_default,f=e.defaults(),o=f.gene_id_column,l=f.species,c=f.gene_id_type),this.changed=!1,!((0,p.Z)(this,E).changed||s!==(0,p.Z)(this,C).automatic||u!==(0,p.Z)(this,C).use_reference_mito||!s&&(o!==(0,p.Z)(this,C).gene_id_column||!u&&r!==(0,p.Z)(this,C).mito_prefix||u&&(b.xi(l,(0,p.Z)(this,C).species)||c!==(0,p.Z)(this,C).gene_id_type)))){t.next=30;break}if(b.Yl((0,p.Z)(this,O).metrics),!this.valid()){t.next=29;break}if(h=o,v=l,m=c,s&&(Z=(0,p.Z)(this,E).guessRnaFeatureTypes(),g=e.configureFeatureParameters(u,Z),h=g.gene_id_column,v=g.species,m=g.gene_id_type),_=(0,p.Z)(this,E).fetchFeatureAnnotations().RNA,k=null==h?_.rowNames():_.column(h),(x=b.rS(_.numberOfRows(),"Uint8Array",(0,p.Z)(this,O),"metrics_buffer")).fill(0),null===k){t.next=24;break}if(!u){t.next=23;break}return t.next=18,(0,d.Z)(this,R,S).call(this,v,m);case 18:M=t.sent,N=x.array(),k.forEach((function(e,t){M.has(e)&&(N[t]=1)})),t.next=24;break;case 23:null!==r&&(A=r.toLowerCase(),N=x.array(),k.forEach((function(e,t){e.toLowerCase().startsWith(A)&&(N[t]=1)})));case 24:W=(0,p.Z)(this,E).fetchCountMatrix().get("RNA"),(0,p.Z)(this,O).metrics=w.wj(W,[x]),this.changed=!0,t.next=30;break;case 29:delete(0,p.Z)(this,O).metrics;case 30:return(0,p.Z)(this,C).automatic=s,(0,p.Z)(this,C).gene_id_column=o,(0,p.Z)(this,C).use_reference_mito=u,(0,p.Z)(this,C).species=y.bl(l),(0,p.Z)(this,C).gene_id_type=c,(0,p.Z)(this,C).mito_prefix=r,(this.changed||i!==(0,p.Z)(this,C).nmads)&&(b.Yl((0,p.Z)(this,O).filters),this.valid()?(j=(0,p.Z)(this,E).fetchBlock(),(0,p.Z)(this,O).filters=w.Lw((0,p.Z)(this,O).metrics,{numberOfMADs:i,block:j}),I=b.rS((0,p.Z)(this,O).metrics.numberOfCells(),"Uint8Array",(0,p.Z)(this,O),"discard_buffer"),(0,p.Z)(this,O).filters.filter((0,p.Z)(this,O).metrics,{block:j,buffer:I}),this.changed=!0):delete(0,p.Z)(this,O).filters,(0,p.Z)(this,C).nmads=i),t.abrupt("return");case 38:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}],[{key:"defaults",value:function(){return{automatic:!0,gene_id_column:null,use_reference_mito:!0,species:[],gene_id_type:"ENSEMBL",mito_prefix:"mt-",nmads:3}}},{key:"configureFeatureParameters",value:function(e,t){var n=null,r={type:"symbol",species:"human",confidence:0};if("row_names"in t){var a=t.row_names;a.confidence>r.confidence&&(e||"symbol"==a.type)&&(r=a)}for(var s=0,u=Object.entries(t.columns);s<u.length;s++){var o=(0,i.Z)(u[s],2),l=o[0],c=o[1];c.confidence>r.confidence&&(e||"symbol"==c.type)&&(r=c,n=l)}return{gene_id_column:n,species:[r.species],gene_id_type:r.type.toUpperCase()}}},{key:"flush",value:function(){(0,v.Z)(e,e,W,{})}},{key:"setDownload",value:function(t){var n=(0,m.Z)(e,e,j);return(0,v.Z)(e,e,j,t),n}}]),e}();function S(e,t){return A.apply(this,arguments)}function A(){return(A=(0,s.Z)((0,a.Z)().mark((function e(t,n){var i,s,u,o,l,c,f,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new Set,s=(0,m.Z)(N,N,W),u=(0,r.Z)(t),e.prev=3,u.s();case 5:if((o=u.n()).done){e.next=19;break}if(l=o.value,(c=l+"-mito-"+n.toLowerCase()+".txt.gz")in s){e.next=16;break}return e.next=11,(0,m.Z)(N,N,j).call(N,k+"/"+c);case 11:return f=e.sent,e.next=14,_.bw(f,{compression:"gz"});case 14:h=e.sent,s[c]=h;case 16:s[c].forEach((function(e){i.add(e)}));case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),u.e(e.t0);case 24:return e.prev=24,u.f(),e.finish(24);case 27:return e.abrupt("return",i);case 28:case"end":return e.stop()}}),e,null,[[3,21,24,27]])})))).apply(this,arguments)}(0,f.Z)(N,"mitochondriaSpecies",["9606","10090","6239","10116","9541","7227","7955","9598"]);var W={writable:!0,value:{}},j={writable:!0,value:b.we}},4414:function(e,t,n){"use strict";n.d(t,{Cy:function(){return v},Xs:function(){return _}});var r=n(1413),i=n(5671),a=n(3144),s=n(101),u=n(2346),o=n(3889),l=n(8916),c=n(2793),f=n(5831),h=n(7891),d=n(7625),v="snn_graph_cluster",m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakSet,y=new WeakSet,b=new WeakSet,g=new WeakSet,_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,i.Z)(this,e),(0,s.Z)(this,g),(0,s.Z)(this,b),(0,s.Z)(this,y),(0,s.Z)(this,w),(0,u.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,Z,{writable:!0,value:void 0}),!(t instanceof d.Xr))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,c.Z)(this,m,t),(0,c.Z)(this,p,null===n?{}:n),(0,c.Z)(this,Z,null===r?{}:r),this.changed=!1}return(0,a.Z)(e,[{key:"free",value:function(){h.Yl((0,l.Z)(this,Z).neighbors),h.Yl((0,l.Z)(this,Z).graph),h.Yl((0,l.Z)(this,Z).clusters)}},{key:"fetchClusters",value:function(){if((0,o.Z)(this,w,k).call(this))return(0,l.Z)(this,Z).clusters.membership({copy:"view"});throw"cannot fetch SNN clusters from an invalid state"}},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,l.Z)(this,p))}},{key:"compute",value:function(e,t){var n=t.k,r=t.scheme,i=t.algorithm,a=t.multilevel_resolution,s=t.leiden_resolution,u=t.walktrap_steps;this.changed=!1,((0,l.Z)(this,m).changed||n!==(0,l.Z)(this,p).k)&&(h.Yl((0,l.Z)(this,Z).neighbors),e?(0,o.Z)(this,y,x).call(this,n):delete(0,l.Z)(this,Z).neighbors,(0,l.Z)(this,p).k=n,this.changed=!0),(this.changed||r!==(0,l.Z)(this,p).scheme)&&(h.Yl((0,l.Z)(this,Z).graph),e?(0,o.Z)(this,b,E).call(this,r):delete(0,l.Z)(this,Z).graph,(0,l.Z)(this,p).scheme=r,this.changed=!0),(this.changed||i!==(0,l.Z)(this,p).algorithm||a!==(0,l.Z)(this,p).multilevel_resolution||s!==(0,l.Z)(this,p).leiden_resolution||u!==(0,l.Z)(this,p).walktrap_steps||!(0,o.Z)(this,w,k).call(this)&&e)&&(h.Yl((0,l.Z)(this,Z).clusters),e?(0,o.Z)(this,g,O).call(this,i,a,s,u):delete(0,l.Z)(this,Z).clusters,(0,l.Z)(this,p).algorithm=i,(0,l.Z)(this,p).multilevel_resolution=a,(0,l.Z)(this,p).leiden_resolution=s,(0,l.Z)(this,p).walktrap_steps=u,this.changed=!0)}}],[{key:"defaults",value:function(){return{k:10,scheme:"rank",algorithm:"multilevel",multilevel_resolution:1,leiden_resolution:1,walktrap_steps:4}}}]),e}();function k(){return"clusters"in(0,l.Z)(this,Z)}function x(e){(0,l.Z)(this,Z).neighbors=f.wf((0,l.Z)(this,m).fetchIndex(),e)}function E(e){"neighbors"in(0,l.Z)(this,Z)||(0,o.Z)(this,y,x).call(this,(0,l.Z)(this,p).k),(0,l.Z)(this,Z).graph=f.bD((0,l.Z)(this,Z).neighbors,{scheme:e})}function O(e,t,n,r){"graph"in(0,l.Z)(this,Z)||(0,o.Z)(this,b,E).call(this,(0,l.Z)(this,p).scheme),(0,l.Z)(this,Z).clusters=f.ZI((0,l.Z)(this,Z).graph,{method:e,multiLevelResolution:t,leidenResolution:n,leidenModularityObjective:!0,walktrapSteps:r})}},3060:function(e,t,n){"use strict";n.d(t,{T:function(){return x}});var r=n(4165),i=n(5861),a=n(1413),s=n(5671),u=n(3144),o=n(101),l=n(2346),c=n(3889),f=n(8916),h=n(2793),d=n(5831),v=n(4071),m=(n(7891),n(7625)),p=n(6269),Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakSet,x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,s.Z)(this,e),(0,o.Z)(this,k),(0,l.Z)(this,Z,{writable:!0,value:void 0}),(0,l.Z)(this,w,{writable:!0,value:void 0}),(0,l.Z)(this,y,{writable:!0,value:void 0}),(0,l.Z)(this,b,{writable:!0,value:void 0}),(0,l.Z)(this,g,{writable:!0,value:void 0}),(0,l.Z)(this,_,{writable:!0,value:void 0}),!(t instanceof m.Xr))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,h.Z)(this,Z,t),(0,h.Z)(this,w,null===n?{}:n),(0,h.Z)(this,y,r),this.changed=!1;var i=p.k(),a=v.Ig(i,v.yc),u=a.worker_id,c=a.ready;(0,h.Z)(this,b,u),(0,h.Z)(this,g,c),(0,h.Z)(this,_,null)}return(0,u.Z)(e,[{key:"ready",value:function(){return(0,f.Z)(this,g)}},{key:"free",value:function(){return v.qM((0,f.Z)(this,b))}},{key:"fetchParameters",value:function(){return(0,a.Z)({},(0,f.Z)(this,w))}},{key:"fetchResults",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i,a=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a.length>0&&void 0!==a[0]?a[0]:{}).copy,n=void 0===t||t,null===(0,f.Z)(this,y)){e.next=8;break}return i={x:(0,f.Z)(this,y).x,y:(0,f.Z)(this,y).y},n&&(i.x=i.x.slice(),i.y=i.y.slice()),i.iterations=(0,f.Z)(this,w).iterations,e.abrupt("return",i);case 8:return e.next=10,(0,f.Z)(this,_);case 10:return e.abrupt("return",v.cE((0,f.Z)(this,b),{cmd:"FETCH"}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"compute",value:function(e){var t=e.perplexity,n=e.iterations,r=e.animate,i=!(0,f.Z)(this,Z).changed&&t===(0,f.Z)(this,w).perplexity;return i&&n==(0,f.Z)(this,w).iterations?(this.changed=!1,new Promise((function(e){return e(null)}))):(null!==(0,f.Z)(this,y)&&(i=!1,(0,h.Z)(this,y,null)),(0,c.Z)(this,k,E).call(this,t,n,r,!i),(0,f.Z)(this,w).perplexity=t,(0,f.Z)(this,w).iterations=n,(0,f.Z)(this,w).animate=r,this.changed=!0,(0,f.Z)(this,_))}},{key:"animate",value:function(){return null!==(0,f.Z)(this,y)?((0,h.Z)(this,y,null),(0,c.Z)(this,k,E).call(this,(0,f.Z)(this,w).perplexity,(0,f.Z)(this,w).iterations,!0,!0),(0,f.Z)(this,_).then((function(e){return{type:"tsne_rerun",data:{status:"SUCCESS"}}}))):v.cE((0,f.Z)(this,b),{cmd:"RERUN"})}}]),e}();function E(e,t,n,r){var i=null;if(r){var a=d.Tk(e);i=v.AB((0,f.Z)(this,Z),a)}var s={perplexity:e,iterations:t,animate:n};(0,h.Z)(this,_,v.Vi((0,f.Z)(this,b),s,i))}},7270:function(e,t,n){"use strict";n.d(t,{D:function(){return k}});var r=n(1413),i=n(4165),a=n(5861),s=n(5671),u=n(3144),o=n(101),l=n(2346),c=n(3889),f=n(8916),h=n(2793),d=(n(5831),n(4071)),v=(n(7891),n(7625)),m=n(6269),p=new WeakMap,Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakSet,k=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,s.Z)(this,e),(0,o.Z)(this,_),(0,l.Z)(this,p,{writable:!0,value:void 0}),(0,l.Z)(this,Z,{writable:!0,value:void 0}),(0,l.Z)(this,w,{writable:!0,value:void 0}),(0,l.Z)(this,y,{writable:!0,value:void 0}),(0,l.Z)(this,b,{writable:!0,value:void 0}),(0,l.Z)(this,g,{writable:!0,value:void 0}),!(t instanceof v.Xr))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,h.Z)(this,p,t),(0,h.Z)(this,Z,null===n?{}:n),(0,h.Z)(this,w,r),this.changed=!1;var i=m.u(),a=d.Ig(i,d.yc),u=a.worker_id,c=a.ready;(0,h.Z)(this,y,u),(0,h.Z)(this,b,c),(0,h.Z)(this,g,null)}return(0,u.Z)(e,[{key:"ready",value:function(){return(0,f.Z)(this,b)}},{key:"free",value:function(){return d.qM((0,f.Z)(this,y))}},{key:"fetchResults",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,r,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a.length>0&&void 0!==a[0]?a[0]:{}).copy,n=void 0===t||t,null===(0,f.Z)(this,w)){e.next=8;break}return r={x:(0,f.Z)(this,w).x,y:(0,f.Z)(this,w).y},n&&(r.x=r.x.slice(),r.y=r.y.slice()),r.iterations=(0,f.Z)(this,Z).num_epochs,e.abrupt("return",r);case 8:return e.next=10,(0,f.Z)(this,g);case 10:return e.abrupt("return",d.cE((0,f.Z)(this,y),{cmd:"FETCH"}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchParameters",value:function(){return(0,r.Z)({},(0,f.Z)(this,Z))}},{key:"compute",value:function(e){var t=e.num_neighbors,n=e.num_epochs,r=e.min_dist,i=e.animate,a=!(0,f.Z)(this,p).changed&&(0,f.Z)(this,Z).num_neighbors===t;return a&&n===(0,f.Z)(this,Z).num_epochs&&r===(0,f.Z)(this,Z).min_dist?(this.changed=!1,new Promise((function(e){return e(null)}))):(null!==(0,f.Z)(this,w)&&(a=!1,(0,h.Z)(this,w,null)),(0,c.Z)(this,_,x).call(this,t,n,r,i,!a),(0,f.Z)(this,Z).num_neighbors=t,(0,f.Z)(this,Z).num_epochs=n,(0,f.Z)(this,Z).min_dist=r,(0,f.Z)(this,Z).animate=i,this.changed=!0,(0,f.Z)(this,g))}},{key:"animate",value:function(){return null!==(0,f.Z)(this,w)?((0,h.Z)(this,w,null),(0,c.Z)(this,_,x).call(this,(0,f.Z)(this,Z).num_neighbors,(0,f.Z)(this,Z).num_epochs,(0,f.Z)(this,Z).min_dist,!0,!0),(0,f.Z)(this,g).then((function(e){return{type:"umap_rerun",data:{status:"SUCCESS"}}}))):d.cE((0,f.Z)(this,y),{cmd:"RERUN"})}}]),e}();function x(e,t,n,r,i){var a=null;i&&(a=d.AB((0,f.Z)(this,p),e));var s={num_neighbors:e,num_epochs:t,min_dist:n,animate:r};(0,h.Z)(this,g,d.Vi((0,f.Z)(this,y),s,a))}},8794:function(e,t,n){"use strict";function r(e,t){e.onmessage=t}function i(e,t,n){e.postMessage(t,n)}function a(e){e.terminate()}n.d(t,{Ae:function(){return a},bG:function(){return i},jC:function(){return r}})},7891:function(e,t,n){"use strict";n.d(t,{Mc:function(){return h},N2:function(){return d},XZ:function(){return Z},Yl:function(){return o},rS:function(){return f},we:function(){return v},xi:function(){return c},zS:function(){return p}});var r=n(4165),i=n(5861),a=n(7762),s=n(3324),u=n(5831);function o(e){u.gd(e)}function l(e,t,n,r){if(!n&&(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("parameters cannot contain ArrayBuffers or their views");if(!r&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("parameters cannot contain ArrayBuffers or their views")}function c(e,t){if(typeof e!=typeof t)return l(e,t,!1,!1),!0;if("object"!=typeof e)return e!=t;var n=null===e,r=null===t;if(n!==r)return l(e,t,n,r),!0;if(n)return!1;var i=e instanceof Array,a=t instanceof Array;if(i!=a)return l(e,t,i,a),!0;if(i){if(e.length!=t.length)return!0;for(var s=0;s<e.length;s++)if(c(e[s],t[s]))return!0;return!1}l(e,t,!1,!1);var u=Object.keys(e),o=Object.keys(t);if(u.length!=o.length)return!0;u.sort(),o.sort();for(s=0;s<u.length;s++)if(u[s]!=o[s])return!0;for(var f=0,h=u;f<h.length;f++){var d=h[f];if(c(e[d],t[d]))return!0}return!1}function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buffer",i=!0;if(r in n){var a=n[r];a.size!=e||a.constructor.className!=t||null!==a.owner?a.free():i=!1}if(i)switch(t){case"Uint8Array":n[r]=u.TS(e);break;case"Int32Array":n[r]=u.Wf(e);break;case"Float64Array":n[r]=u.RJ(e);break;default:throw"allocating '"+t+"' not yet supported"}return n[r]}function h(e,t){for(var n=[],r=0,i=Object.entries(e);r<i.length;r++){var a=(0,s.Z)(i[r],2),u=a[0];a[1].valid()&&n.push(u)}if(0==n.length)throw new Error("expected at least one valid upstream "+t+" state");return n}function d(e,t){if(null!==t){var n,r=(0,a.Z)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i<0||i>=t)throw new Error("subset indices are out of range")}}catch(u){r.e(u)}finally{r.f()}}for(var s=1;s<e.length;s++)if(e[s]<=e[s-1])throw new Error("subset indices must be sorted and unique")}function v(e){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("failed to fetch content at "+t+"("+n.status+")");case 5:return e.t0=Uint8Array,e.next=8,n.arrayBuffer();case 8:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){var t={columns:{}},n=e.rowNames();null!==n&&(t.row_names=u.gn(n,{forceTaxonomy:!0}));var r,i=(0,a.Z)(e.columnNames());try{for(i.s();!(r=i.n()).done;){var s=r.value;e.column(s)instanceof Array&&(t.columns[s]=u.gn(e.column(s),{forceTaxonomy:!0}))}}catch(o){i.e(o)}finally{i.f()}return t}function Z(e){var t=e[0].length,n={arrays:[],retain:null},r=new Uint8Array(t);r.fill(0);var i,s=(0,a.Z)(e);try{for(s.s();!(i=s.n()).done;){var o=i.value,l=u.Yh(o,{action:"none",placeholder:-1});n.arrays.push(l),l.ids.forEach((function(e,t){-1==e&&(r[t]=1)}))}}catch(m){s.e(m)}finally{s.f()}var c=0;if(r.forEach((function(e){c+=e})),0==c)return n;for(var f=new Int32Array(t-c),h=0,d=0;d<t;d++)0==r[d]&&(f[h]=d,h++);n.retain=f;var v=function(){var e=n.arrays[d],t=u.DS(e.ids,f),r=u.D4(t).map((function(t){return e.levels[t]}));u.gd(e.ids),e.ids=t,e.levels=r};for(d=0;d<n.arrays.length;d++)v();return n}},818:function(e,t,n){"use strict";n.d(t,{Bh:function(){return u},c9:function(){return l},eo:function(){return o},iG:function(){return a},jJ:function(){return s}});var r=n(7762),i=n(5831),a={min:0,mean:1,min_rank:4};function s(e,t,n){var r;n&&void 0!==n||(n="cohen-min-rank");var i,a=!1,s=1;if(n.match(/-min$/)?s=0:n.match(/-min-rank$/)&&(a=!0,s=4),n.match(/^cohen-/))i=e.cohen(t,{summary:s,copy:!1});else if(n.match(/^auc-/))i=e.auc(t,{summary:s,copy:!1});else if(n.match(/^lfc-/))i=e.lfc(t,{summary:s,copy:!1});else{if(!n.match(/^delta-d-/))throw"unknown rank type '"+n+"'";i=e.deltaDetected(t,{summary:s,copy:!1})}r=new Int32Array(i.length);for(var u=0;u<r.length;u++)r[u]=u;a?r.sort((function(e,t){return i[e]-i[t]})):r.sort((function(e,t){return i[t]-i[e]}));var o=function(e){for(var t=new Float64Array(e.length),n=0;n<r.length;n++)t[n]=e[r[n]];return t},l=o(e.detected(t,{copy:!1})),c=o(e.means(t,{copy:!1})),f=o(e.lfc(t,{summary:1,copy:!1})),h=o(e.deltaDetected(t,{summary:1,copy:!1}));return{ordering:r,means:c,detected:l,lfc:f,delta_detected:h}}function u(e,t,n){var r=e<t,i=r?t:e;i in n||(n[i]={});var a=n[i],s=r?e:t,u=!(s in a);return u&&(a[s]={}),{cached:a[s],run:u,left_small:r}}function o(e){if(e){for(var t=0,n=Object.values(e);t<n.length;t++)for(var r=n[t],a=0,s=Object.values(r);a<s.length;a++)for(var u=s[a],o=0,l=Object.values(u);o<l.length;o++){var c=l[o];i.gd(c)}for(var f=0,h=Object.keys(e);f<h.length;f++){delete e[h[f]]}}}function l(e,t,n,a,s,u,o){var l=null;null!==n&&(l=i.DS(n,a),i.D4(l));var c,f=(0,r.Z)(e.available());try{for(f.s();!(c=f.n()).done;){var h=c.value,d=e.get(h),v=void 0;try{v=i.ZW(d,a),s[h]=i.y5(v,t,{block:l,lfcThreshold:u,computeAuc:o})}finally{i.gd(v)}}}catch(m){f.e(m)}finally{f.f()}}},569:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(7891);function i(e,t,n,i,a){var s=r.rS(n.numberOfColumns(),"Float64Array",i,a),u=t.fetchDiscards(),o=e.fetchMetrics().sums({copy:!1});if(null==u)s.set(o);else{var l=s.array(),c=0;if(u.forEach((function(e,t){if(!e){if(c==s.length)throw new Error("normalization and filtering are not in sync");l[c]=o[t],c++}})),c!==s.length)throw new Error("normalization and filtering are not in sync")}return s}},7806:function(e,t,n){"use strict";n.d(t,{Ab:function(){return d},Et:function(){return v},G:function(){return Z},G9:function(){return o},NR:function(){return c},Nd:function(){return l},Su:function(){return p},Tm:function(){return h},V_:function(){return m},bl:function(){return f}});var r=n(1413),i=n(3324),a=n(7762),s=n(3637),u=n(8497);function o(e){if("_bioconductor_LENGTH"in e)return e._bioconductor_LENGTH();if(!s.zG(e))throw new Error("no method for 'LENGTH' in '"+e.constructor.name+"' instance");return e.length}function l(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowView,r=void 0!==n&&n;if("_bioconductor_SLICE"in e){var i=new e.constructor;return e._bioconductor_SLICE(i,t,{allowView:r}),i}if(!s.zG(e))throw new Error("no method for 'SLICE' in '"+e.constructor.name+"' instance");if(t.constructor==Object)return r&&ArrayBuffer.isView(e)?e.subarray(t.start,t.end):e.slice(t.start,t.end);var a=new e.constructor(t.length);return t.forEach((function(t,n){a[n]=e[t]})),a}function c(e){var t=e[0];if("_bioconductor_COMBINE"in t){var n=new t.constructor;return t._bioconductor_COMBINE(n,e),n}if(!s.zG(t))throw new Error("no method for 'COMBINE' in '"+t.constructor.name+"' instance");var r,i=0,u=t.constructor,o=(0,a.Z)(e);try{for(o.s();!(r=o.n()).done;){var l=r.value;i+=l.length,u=s.BQ(u,l.constructor)}}catch(m){o.e(m)}finally{o.f()}var c,f=new u(i),h=0,d=(0,a.Z)(e);try{for(d.s();!(c=d.n()).done;){var v=c.value;"set"in f?(f.set(v,h),h+=v.length):v.forEach((function(e){f[h]=e,h++}))}}catch(m){d.e(m)}finally{d.f()}return f}function f(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deepCopy,n=void 0===t||t;if(e instanceof Object){var u={deepCopy:n};if("_bioconductor_CLONE"in e){var o=new e.constructor;return e._bioconductor_CLONE(o,u),o}if(s.zG(e))return e.constructor==Array?e.map((function(e){return f(e,u)})):n?e.slice():e.subarray();if(e.constructor==Object){if(n){for(var l={},c=0,h=Object.entries(e);c<h.length;c++){var d=(0,i.Z)(h[c],2),v=d[0],m=d[1];l[v]=f(m)}return l}return(0,r.Z)({},e)}if(e.constructor==Map){var p,Z=new Map,w=(0,a.Z)(e);try{for(w.s();!(p=w.n()).done;){var y=(0,i.Z)(p.value,2),b=y[0],g=y[1];Z.set(b,n?f(g):g)}}catch(O){w.e(O)}finally{w.f()}return Z}if(e.constructor==Set){var _,k=new Set,x=(0,a.Z)(e);try{for(x.s();!(_=x.n()).done;){var E=_.value;k.add(n?f(E):E)}}catch(O){x.e(O)}finally{x.f()}return k}throw new Error("unknown CLONE operation for instance of class '"+e.constructor.name+"'")}return e}function h(e,t){if(t.constructor!=Object&&(t=u.L(t)),"_bioconductor_SPLIT"in e)return e._bioconductor_SPLIT(t);for(var n={},r=0,a=Object.entries(t);r<a.length;r++){var s=(0,i.Z)(a[r],2),o=s[0],c=s[1];n[o]=l(e,c)}return n}function d(e){if(!("_bioconductor_NUMBER_OF_ROWS"in e))throw new Error("no 'NUMBER_OF_ROWS' method available for '"+e.constructor.name+"' instance");return e._bioconductor_NUMBER_OF_ROWS()}function v(e){if(!("_bioconductor_NUMBER_OF_COLUMNS"in e))throw new Error("no 'NUMBER_OF_COLUMNS' method available for '"+e.constructor.name+"' instance");return e._bioconductor_NUMBER_OF_COLUMNS()}function m(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allowView,i=void 0!==r&&r;if(!("_bioconductor_SLICE_2D"in e))throw new Error("no 'SLICE_2D' method available for '"+e.constructor.name+"' instance");var a=new e.constructor;return e._bioconductor_SLICE_2D(a,t,n,{allowView:i}),a}function p(e){var t=e[0];if(!("_bioconductor_COMBINE_ROWS"in t))throw new Error("no 'COMBINE_ROWS' method available for '"+t.constructor.name+"' instance");var n=new t.constructor;return t._bioconductor_COMBINE_ROWS(n,e),n}function Z(e){var t=e[0];if(!("_bioconductor_COMBINE_COLUMNS"in t))throw new Error("no 'COMBINE_COLUMNS' method available for '"+t.constructor.name+"' instance");var n=new t.constructor;return t._bioconductor_COMBINE_COLUMNS(n,e),n}},3750:function(e,t,n){"use strict";n.d(t,{M:function(){return u}});var r=n(5671),i=n(3144),a=n(9648),s=n(3637),u=function(){function e(t){(0,r.Z)(this,e),0!=arguments.length&&(this._metadata=s.OI(t))}return(0,i.Z)(e,[{key:"metadata",value:function(){return this._metadata}},{key:"setMetadata",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=a.Q(this,n);return r._metadata=s.OI(e),r}},{key:"$setMetadata",value:function(e){return this.setMetadata(e,{inPlace:!0})}},{key:"_bioconductor_CLONE",value:function(e,t){var n=t.deepCopy,r=void 0===n||n;e._metadata=a.J(this._metadata,r)}}]),e}()},815:function(e,t,n){"use strict";n.d(t,{N:function(){return Z},s:function(){return w}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(4942),h=n(7806),d=n(3637),v=n(9648),m=n(3750),p=n(6674),Z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var a,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=u.numberOfRows,l=void 0===o?null:o,c=u.rowNames,f=void 0===c?null:c,v=u.columnOrder,m=void 0===v?null:v,Z=u.metadata,w=void 0===Z?{}:Z;if((0,i.Z)(this,n),0==arguments.length)return a=t.call(this),(0,s.Z)(a);(a=t.call(this,w))._numberOfRows=l,a._rowNames=f;try{a._columns=new p.H(e,m)}catch(k){throw new Error("failed to initialize columns for this "+a.constructor.className+"; "+k.message,{cause:k})}var y,b=(0,r.Z)(a._columns.names());try{for(b.s();!(y=b.n()).done;){var g=y.value,_=h.G9(a._columns.entry(g));if(null==a._numberOfRows)a._numberOfRows=_;else if(_!=a._numberOfRows)throw new Error("expected all arrays in 'columns' to have equal length")}}catch(x){b.e(x)}finally{b.f()}return null!=f&&(null==a._numberOfRows&&(a._numberOfRows=f.length),d.Vt(f,"'rowNames'",a._numberOfRows,"'numberOfRows' or the length of arrays in 'columns'")),null==a._numberOfRows&&(a._numberOfRows=0),(0,s.Z)(a)}return(0,a.Z)(n,[{key:"rowNames",value:function(){return this._rowNames}},{key:"columnNames",value:function(){return this._columns.names()}},{key:"hasColumn",value:function(e){return this._columns.has(e)}},{key:"numberOfRows",value:function(){return this._numberOfRows}},{key:"numberOfColumns",value:function(){return this._columns.numberOfEntries()}},{key:"column",value:function(e){return this._columns.entry(e)}},{key:"removeColumn",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=v.Q(this,n);return r._columns=this._columns.delete(e,{inPlace:n}),r}},{key:"$removeColumn",value:function(e){return this.removeColumn(e,{inPlace:!0})}},{key:"setColumn",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(h.G9(t)!=this._numberOfRows)throw new Error("expected 'value' to have the same length as the number of rows in 'x'");var i=v.Q(this,r);return i._columns=this._columns.set(e,t,{inPlace:r}),i}},{key:"$setColumn",value:function(e,t){return this.setColumn(e,t,{inPlace:!0})}},{key:"setColumnNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=v.Q(this,n);return r._columns=r._columns.setNames(e,{inPlace:n}),r}},{key:"$setColumnNames",value:function(e){return this.setColumnNames(e,{inPlace:!0})}},{key:"setRowNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;null!=e&&d.Vt(e,"replacement 'names'",this._numberOfRows,"'numberOfRows()'");var r=v.Q(this,n);return r._rowNames=e,r}},{key:"$setRowNames",value:function(e){return this.setRowNames(e,{inPlace:!0})}},{key:"sliceColumns",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=v.Q(this,n);return r._columns=this._columns.slice(e,{inPlace:n}),r}},{key:"$sliceColumns",value:function(e){return this.sliceColumns(e,{inPlace:!0})}},{key:"_bioconductor_LENGTH",value:function(){return this.numberOfRows()}},{key:"_bioconductor_SLICE",value:function(e,t,n){var r,i=n.allowView,a={allowView:void 0!==i&&i},s=this._columns.apply((function(e){return h.Nd(e,t,a)})),u=null==this._rowNames?null:h.Nd(this._rowNames,t,a);r=t.constructor==Object?t.end-t.start:t.length,e._rowNames=u,e._columns=s,e._numberOfRows=r,e._metadata=this._metadata}},{key:"_bioconductor_COMBINE",value:function(e,t){var n,i=p.H.parallelCombine(t.map((function(e){return e._columns})),h.NR),a=[],s=[],u=(0,r.Z)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;a.push(o.rowNames()),s.push(o.numberOfRows())}}catch(f){u.e(f)}finally{u.f()}var l=d.Sm(s),c=d.SE(a,s,l);e._rowNames=c,e._columns=i,e._numberOfRows=l,e._metadata=this._metadata}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),e._columns=v.J(this._columns,i),e._rowNames=v.J(this._rowNames,i),e._numberOfRows=this._numberOfRows}}]),n}(m.M);function w(e){var t,n=new Set,i=[],a=(0,r.Z)(e);try{for(a.s();!(t=a.n()).done;){var s,u=t.value.columnNames(),o=(0,r.Z)(u);try{for(o.s();!(s=o.n()).done;){var l=s.value;n.has(l)||(n.add(l),i.push(l))}}catch(b){o.e(b)}finally{o.f()}}}catch(b){a.e(b)}finally{a.f()}var c,f=[],d=(0,r.Z)(e);try{for(d.s();!(c=d.n()).done;){var v=c.value,m=new Array(v.numberOfRows());m.fill(null);var p,Z=h.bl(v,{deepCopy:!1}),w=(0,r.Z)(i);try{for(w.s();!(p=w.n()).done;){var y=p.value;v.hasColumn(y)||Z.$setColumn(y,m)}}catch(b){w.e(b)}finally{w.f()}Z._columns=Z._columns.reorder(i),f.push(Z)}}catch(b){d.e(b)}finally{d.f()}return h.NR(f)}(0,f.Z)(Z,"className","DataFrame")},8882:function(e,t,n){"use strict";var r=n(6459),i=n(5671),a=n(3144),s=n(101),u=n(4942),o=n(3889),l=n(9648),c=new WeakSet,f=new WeakSet,h=new WeakSet,d=new WeakSet,v=function(){function e(t,n,r){var a=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).columnMajor,u=void 0===a||a;if((0,i.Z)(this,e),(0,s.Z)(this,d),(0,s.Z)(this,h),(0,s.Z)(this,f),(0,s.Z)(this,c),0!=arguments.length&&(this._numberOfRows=t,this._numberOfColumns=n,this._values=r,this._columnMajor=u,t*n!=r.length))throw new Error("length of 'values' should be equal to the product of 'dimensions'")}return(0,a.Z)(e,[{key:"numberOfRows",value:function(){return this._numberOfRows}},{key:"numberOfColumns",value:function(){return this._numberOfColumns}},{key:"isColumnMajor",value:function(){return this._columnMajor}},{key:"values",value:function(){return this._values}},{key:"row",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowView,n=void 0!==t&&t;return(0,o.Z)(this,c,m).call(this,e,this._numberOfRows,this._numberOfColumns,n,!this._columnMajor)}},{key:"column",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowView,n=void 0!==t&&t;return(0,o.Z)(this,c,m).call(this,e,this._numberOfColumns,this._numberOfRows,n,this._columnMajor)}},{key:"setValues",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(e.length!==this._values.length)throw new Error("replacement 'values' should have length equal to 'values()'");var r=l.Q(this,n);return r._values=e,r}},{key:"$setValues",value:function(e){return this.setValues(e,{inPlace:!0})}},{key:"setRow",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(t.length!==this._numberOfColumns)throw new Error("replacement row should have length equal to 'numberOfColumns()'");var i=l.Q(this,r);return r||(i._values=i._values.slice()),(0,o.Z)(i,f,p).call(i,e,i._numberOfRows,i._numberOfColumns,!i._columnMajor,t),i}},{key:"$setRow",value:function(e,t){return this.setRow(e,t,{inPlace:!0})}},{key:"setColumn",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(t.length!==this._numberOfRows)throw new Error("replacement column should have length equal to 'numberOfRows()'");var i=l.Q(this,r);return r||(i._values=i._values.slice()),(0,o.Z)(i,f,p).call(i,e,i._numberOfColumns,i._numberOfRows,i._columnMajor,t),i}},{key:"$setColumn",value:function(e,t){return this.setColumn(e,t,{inPlace:!0})}},{key:"_bioconductor_NUMBER_OF_ROWS",value:function(){return this.numberOfRows()}},{key:"_bioconductor_NUMBER_OF_COLUMNS",value:function(){return this.numberOfColumns()}},{key:"_bioconductor_SLICE_2D",value:function(e,t,n,i){(0,r.Z)(i);var a=null===t,s=!a&&t.constructor==Object,u=a?this._numberOfRows:s?t.end-t.start:t.length;e._numberOfRows=u;var l=null===n,c=!l&&n.constructor==Object,f=l?this._numberOfColumns:c?n.end-n.start:n.length;e._numberOfColumns=f;var d=new this._values.constructor(u*f);e._values=d,this._columnMajor?(0,o.Z)(this,h,Z).call(this,n,l,c,this._numberOfColumns,t,a,s,this._numberOfRows,u,d):(0,o.Z)(this,h,Z).call(this,t,a,s,this._numberOfRows,n,l,c,this._numberOfColumns,f,d),e._columnMajor=this._columnMajor}},{key:"_combiner",value:function(e,t,n,r,i){for(var a=t(e[0]),s=n(e[0]),u=1;u<e.length;u++){if(n(e[u])!==s)throw new Error("all objects must have the same number of "+i);a+=t(e[u])}var o=r(e[0]),l=new e[0]._values.constructor(a*s);if(o){var c=0;for(u=0;u<e.length;u++){var f=e[u],h=t(f),d=c*s;if(r(f))l.set(f._values,d);else for(var v=0;v<s;v++)for(var m=v*h,p=d+v,Z=0;Z<h;Z++)l[p+Z*s]=f._values[m+Z];c+=h}}else{var w=0;for(u=0;u<e.length;u++){var y=e[u],b=t(y);if(r(y))for(Z=0;Z<b;Z++){var g=Z*s,_=w+Z;for(v=0;v<s;v++)l[_+v*a]=y._values[g+v]}else for(var v=0;v<s;v++){var k=v*b,x=y._values.subarray(k,k+b);l.set(x,w+v*a)}w+=b}}return{num_primary:a,num_secondary:s,values:l,primary_major:o}}},{key:"_bioconductor_COMBINE_ROWS",value:function(e,t){var n=this._combiner(t,(function(e){return e._numberOfRows}),(function(e){return e._numberOfColumns}),(function(e){return!e._columnMajor}),"columns");e._numberOfRows=n.num_primary,e._numberOfColumns=n.num_secondary,e._values=n.values,e._columnMajor=!n.primary_major}},{key:"_bioconductor_COMBINE_COLUMNS",value:function(e,t){var n=this._combiner(t,(function(e){return e._numberOfColumns}),(function(e){return e._numberOfRows}),(function(e){return e._columnMajor}),"rows");e._numberOfColumns=n.num_primary,e._numberOfRows=n.num_secondary,e._values=n.values,e._columnMajor=n.primary_major}},{key:"_bioconductor_CLONE",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deepCopy,n=void 0===t||t;e._values=n?this._values.slice():this._values,e._numberOfRows=this._numberOfRows,e._numberOfColumns=this._numberOfColumns,e._columnMajor=this._columnMajor}}]),e}();function m(e,t,n,r,i){if(i){var a=e*n,s=a+n;return r?this._values.subarray(a,s):this._values.slice(a,s)}for(var u=new this._values.constructor(n),o=e,l=0;l<n;l++)u[l]=this._values[o],o+=t;return u}function p(e,t,n,r,i){if(r){var a=e*n;this._values.set(i,a)}else{new this._values.constructor(n);for(var s=e,u=0;u<n;u++)this._values[s]=i[u],s+=t}}function Z(e,t,n,r,i,a,s,u,l,c){if(t)for(var f=0;f<r;f++)(0,o.Z)(this,d,w).call(this,i,a,s,u,l,c,f,f);else if(n)for(f=e.start;f<e.end;f++)(0,o.Z)(this,d,w).call(this,i,a,s,u,l,c,f,f-e.start);else for(var h=0;h<e.length;h++)(0,o.Z)(this,d,w).call(this,i,a,s,u,l,c,e[h],h)}function w(e,t,n,r,i,a,s,u){var o=s*r,l=u*i;if(t){var c=this._values.subarray(o,o+r);a.set(c,l)}else if(n)for(var f=e.start;f<e.end;f++)a[l+f-e.start]=this._values[o+f];else for(var h=0;h<e.length;h++)a[l+h]=this._values[o+e[h]]}(0,u.Z)(v,"name","DenseMatrix")},5605:function(e,t,n){"use strict";n.d(t,{a:function(){return w}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(2415),h=n(7806),d=n(3637),v=n(9648),m=n(1774),p=n(1380),Z=n(9420),w=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e,r){var a,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=u.strand,l=void 0===o?null:o,c=u.names,v=void 0===c?null:c,m=u.elementMetadata,p=void 0===m?null:m,Z=u.metadata,w=void 0===Z?{}:Z;if((0,i.Z)(this,n),0==arguments.length)return a=t.call(this),(0,s.Z)(a);a=t.call(this,e.length,{names:v,elementMetadata:p,metadata:w}),d.K1(e,"seqnames"),a._seqnames=e;var g=e.length;if(g!==h.G9(r))throw d.rS("'ranges'","'seqnames'");if(a._ranges=r,null!==l){if(g!==l.length)throw d.rS("'strand'","'seqnames'");l=(0,f.Z)(n,n,y).call(n,l),(0,f.Z)(n,n,b).call(n,l)}else(l=new Int8Array(g)).fill(0);return a._strand=l,(0,s.Z)(a)}return(0,a.Z)(n,[{key:"start",value:function(){return this._ranges.start()}},{key:"end",value:function(){return this._ranges.end()}},{key:"width",value:function(){return this._ranges.width()}},{key:"seqnames",value:function(){return this._seqnames}},{key:"ranges",value:function(){return this._ranges}},{key:"strand",value:function(){return this._strand}},{key:"setSeqnames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;d.Vt(e,"replacement 'seqnames'",h.G9(this),"'LENGTH(<GRanges>)'");var r=v.Q(this,n);return r._seqnames=e,r}},{key:"$setSeqnames",value:function(e){return this.setSeqnames(e,{inPlace:!0})}},{key:"setRanges",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(!(e instanceof m.Z))throw new Error("'ranges' should be an IRanges object");if(h.G9(e)!==h.G9(this._ranges))throw d.rS("replacement 'ranges'","'LENGTH(<GRanges>)'");var r=v.Q(this,n);return r._ranges=e,r}},{key:"$setRanges",value:function(e){return this.setRanges(e,{inPlace:!0})}},{key:"setStrand",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,r=void 0!==t&&t;if(this._strand.length!==e.length)throw d.rS("'strand'","'seqnames'");e=(0,f.Z)(n,n,y).call(n,e),(0,f.Z)(n,n,b).call(n,e);var i=v.Q(this,r);return i._strand=e,i}},{key:"$setStrand",value:function(e){return this.setStrand(e,{inPlace:!0})}},{key:"buildOverlapIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.restrictToSeqnames,n=void 0===t?null:t,r=e.restrictToStrand,i=void 0===r?null:r,a=d.Nt(h.G9(this)),s=h.Tm(a,this._seqnames),u=this.start(),o=this.end();null!==n&&n instanceof Array&&(n=new Set(n)),null!==i&&i instanceof Array&&(i=new Set(i));for(var l=0,c=Object.keys(s);l<c.length;l++){var f=c[l];if(null===n||n.has(f)){for(var v=s[f],m=h.Nd(this._strand,v),p=h.Tm(v,m),w=0,y=Object.keys(p);w<y.length;w++){var b=y[w];if(null===i||i.has(Number(b))){var _=p[b];p[b]=Z.lZ(u,o,{slice:_})}else delete p[b]}s[f]=p}else delete s[f]}return new g(s)}},{key:"_bioconductor_LENGTH",value:function(){return this._seqnames.length}},{key:"_bioconductor_SLICE",value:function(e,t,r){var i=r.allowView,a=void 0!==i&&i;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_SLICE",this).call(this,e,t,{allowView:a}),e._seqnames=h.Nd(this._seqnames,t,{allowView:a}),e._ranges=h.Nd(this._ranges,t,{allowView:a}),e._strand=h.Nd(this._strand,t,{allowView:a})}},{key:"_bioconductor_COMBINE",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE",this).call(this,e,t);var i,a=[],s=[],l=[],c=(0,r.Z)(t);try{for(c.s();!(i=c.n()).done;){var f=i.value;a.push(f._seqnames),s.push(f._ranges),l.push(f._strand)}}catch(d){c.e(d)}finally{c.f()}e._seqnames=h.NR(a),e._ranges=h.NR(s),e._strand=h.NR(l)}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),e._seqnames=v.J(this._seqnames,i),e._ranges=v.J(this._ranges,i),e._strand=v.J(this._strand,i)}}],[{key:"empty",value:function(){return new n([],m.Z.empty())}}]),n}(p.O);function y(e){return e instanceof Int8Array?e:new Int8Array(e)}function b(e){var t,n=(0,r.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i<-1||i>1)throw new Error("'strand' must be -1, 0 or 1")}}catch(a){n.e(a)}finally{n.f()}}var g=function(){function e(t){(0,i.Z)(this,e),this._index=t}return(0,a.Z)(e,[{key:"overlap",value:function(e){for(var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreStrand,i=void 0===n||n,a=h.G9(e),s=new Array(a),u=e.start(),o=e.end(),l=function(){s[c]=[];var n=s[c],a=e._seqnames[c];if(!(a in t._index))return"continue";var l,f=t._index[a],h=e._strand[c];if(i||0==h)l=Object.keys(f);else{var d=String(h);if(!(d in f))return"continue";l=[d]}var v,m=u[c],p=o[c],w=(0,r.Z)(l);try{for(w.s();!(v=w.n()).done;){var y=v.value;Z.rl(m,p,f[y]).forEach((function(e){return n.push(e)}))}}catch(b){w.e(b)}finally{w.f()}},c=0;c<a;c++)l();return s}}]),e}()},3403:function(e,t,n){"use strict";n.d(t,{f:function(){return E}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(7326),o=n(8301),l=n(1120),c=n(136),f=n(9388),h=n(101),d=n(2346),v=n(2793),m=n(8916),p=n(3889),Z=n(2415),w=n(1380),y=n(5605),b=n(3637),g=n(9648),_=n(7806),k=new WeakMap,x=new WeakSet,E=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.rangeLengths,l=void 0===o?null:o,c=a.names,f=void 0===c?null:c,v=a.elementMetadata,m=void 0===v?null:v,p=a.metadata,w=void 0===p?{}:p;if((0,i.Z)(this,n),0==arguments.length)return r=t.call(this),(0,h.Z)((0,u.Z)(r),x),(0,d.Z)((0,u.Z)(r),k,{writable:!0,value:null}),(0,s.Z)(r);if(e.constructor==Array){r=t.call(this,e.length,{names:f,elementMetadata:m,metadata:w}),(0,h.Z)((0,u.Z)(r),x),(0,d.Z)((0,u.Z)(r),k,{writable:!0,value:null}),l=new Int32Array(e.length);for(var g=0;g<l.length;g++){if(!(e[g]instanceof y.a))throw new Error("'ranges' must either be a 'GRanges' or an array of 'GRanges'");l[g]=_.G9(e[g])}e=_.NR(e)}else{if(!(e instanceof y.a))throw new Error("'ranges' must either be a 'GRanges' or an array of 'GRanges'");if(null==l)throw new Error("'rangeLengths' must be specified when 'ranges' is a 'GRanges'");r=t.call(this,l.length,{names:f,elementMetadata:m,metadata:w}),(0,h.Z)((0,u.Z)(r),x),(0,d.Z)((0,u.Z)(r),k,{writable:!0,value:null}),l=b.CY(l),b.Qp(l)}r._ranges=e,r._rangeLengths=l;var E=(0,Z.Z)(n,n,O).call(n,l);if(r._rangeStarts=E.starts,E.total!==_.G9(e))throw new Error("sum of 'rangeLengths' must be equal to the length of 'ranges'");return(0,s.Z)(r)}return(0,a.Z)(n,[{key:"ranges",value:function(){return(0,p.Z)(this,x,C).call(this),this._ranges}},{key:"rangeStarts",value:function(){return(0,p.Z)(this,x,C).call(this),this._rangeStarts}},{key:"rangeLengths",value:function(){return(0,p.Z)(this,x,C).call(this),this._rangeLengths}},{key:"group",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).allowView,n=void 0!==t&&t;(0,p.Z)(this,x,C).call(this);var r=this._rangeStarts[e];return _.Nd(this._ranges,{start:r,end:r+this._rangeLengths[e]},{allowView:n})}},{key:"numberOfGroups",value:function(){return this._rangeStarts.length}},{key:"setRanges",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(!(e instanceof y.a))throw new Error("'ranges' must be a 'GRanges'");if((0,p.Z)(this,x,C).call(this),_.G9(e)!==_.G9(this._ranges))throw b.rS("'ranges'","number of ranges");var r=g.Q(this,n);return r._ranges=e,r}},{key:"$setRanges",value:function(e){return this.setRanges(e,{inPlace:!0})}},{key:"setGroup",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n,i=g.Q(this,r);null===(0,m.Z)(i,k)?(0,v.Z)(i,k,[]):r||(0,v.Z)(i,k,(0,m.Z)(i,k).slice()),r||(i._rangeStarts=i._rangeStarts.slice(),i._rangeLengths=i._rangeLengths.slice());var a=(0,m.Z)(i,k).length;return(0,m.Z)(i,k).push([e,a,t]),i}},{key:"$setGroup",value:function(e,t){return this.setGroup(e,t,{inPlace:!0})}},{key:"buildOverlapIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.restrictToSeqnames,n=void 0===t?null:t,r=e.restrictToStrand,i=void 0===r?null:r;return(0,p.Z)(this,x,C).call(this),new M(this._ranges.buildOverlapIndex({restrictToSeqnames:n,restrictToStrand:i}),_.G9(this._ranges),this._rangeStarts,this._rangeLengths)}},{key:"_bioconductor_LENGTH",value:function(){return this._rangeStarts.length}},{key:"_bioconductor_SLICE",value:function(e,t){var i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allowView,a=void 0!==i&&i;(0,o.Z)((0,l.Z)(n.prototype),"_bioconductor_SLICE",this).call(this,e,t,{allowView:a}),(0,p.Z)(this,x,C).call(this),e._rangeLengths=_.Nd(this._rangeLengths,t,{allowView:a});var s=(0,Z.Z)(n,n,O).call(n,e._rangeLengths);if(e._rangeStarts=s.starts,t.constructor==Object){var u=this._rangeStarts[t.start];e._ranges=_.Nd(this._ranges,{start:u,end:u+s.total},{allowView:a})}else{var c,f=new Int32Array(s.total),h=0,d=(0,r.Z)(t);try{for(d.s();!(c=d.n()).done;)for(var v=c.value,m=this._rangeStarts[v],w=m+this._rangeLengths[v],y=m;y<w;y++)f[h]=y,h++}catch(b){d.e(b)}finally{d.f()}e._ranges=_.Nd(this._ranges,f,{allowView:a})}}},{key:"_bioconductor_COMBINE",value:function(e,t){(0,o.Z)((0,l.Z)(n.prototype),"_bioconductor_COMBINE",this).call(this,e,t);var i,a=(0,r.Z)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;(0,p.Z)(s,x,C).call(s)}}catch(c){a.e(c)}finally{a.f()}e._rangeLengths=_.NR(t.map((function(e){return e.rangeLengths()})));var u=(0,Z.Z)(n,n,O).call(n,e._rangeLengths);e._rangeStarts=u.starts,e._ranges=_.NR(t.map((function(e){return e._ranges})))}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,o.Z)((0,l.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),(0,v.Z)(e,k,g.J((0,m.Z)(this,k),i)),e._rangeLengths=g.J(this._rangeLengths,i),e._rangeStarts=g.J(this._rangeStarts,i),e._ranges=g.J(this._ranges,i)}}],[{key:"empty",value:function(e){var t=new Int32Array(e);return t.fill(0),new n(y.a.empty(),{rangeLengths:t})}}]),n}(w.O);function O(e){for(var t=new Int32Array(e.length),n=0,r=0;r<e.length;r++)t[r]=n,n+=e[r];return{starts:t,total:n}}function C(){var e=(0,m.Z)(this,k);if(null!==e){e.sort((function(e,t){var n=e[0]-t[0];return 0===n?e[1]-t[1]:n}));for(var t=0,n=0,r=0,i=[],a=this.numberOfGroups(),s=0;s<a;s++){if(t<e.length&&s==e[t][0]){var u=this._rangeStarts[s];r<u&&i.push(_.Nd(this._ranges,{start:r,end:u})),r=u+this._rangeLengths[s];var o=void 0;do{o=e[t][2],t++}while(t<e.length&&s==e[t][0]);i.push(o),this._rangeLengths[s]=_.G9(o)}this._rangeStarts[s]=n,n+=this._rangeLengths[s]}var l=_.G9(this._ranges);r<l&&i.push(_.Nd(this._ranges,{start:r,end:l}));try{this._ranges=_.NR(i)}catch(c){throw new Error("failed to combine staged '$setGroup' operations; "+c.message)}(0,v.Z)(this,k,null)}}var M=function(){function e(t,n,r,a){(0,i.Z)(this,e),this._index=t,this._rangeStarts=r,this._rangeLengths=a;for(var s=new Int32Array(n),u=0;u<r.length;u++)for(var o=r[u],l=o+a[u],c=o;c<l;c++)s[c]=u;this._reverseMapping=s}return(0,a.Z)(e,[{key:"overlap",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreStrand;var t=new Array(this._rangeStarts.length),n=this._reverseMapping;if(e instanceof E)for(var r=this._index.overlap(e._ranges),i=function(){var i=e._rangeStarts[a],u=i+e._rangeLengths[a],o=new Set;for(s=i;s<u;s++)r[s].forEach((function(e){return o.add(n[e])}));t[a]=Array.from(o)},a=0;a<e._rangeStarts.length;a++){var s;i()}else{var u=this._index.overlap(e),o=function(){var e=new Set;u[a].forEach((function(t){return e.add(n[t])})),t[a]=Array.from(e)};for(a=0;a<u.length;a++)o()}return t}}]),e}()},1774:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(4942),h=n(7806),d=n(3637),v=n(9648),m=(n(815),n(1380)),p=n(9420),Z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e,r){var a,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=u.names,l=void 0===o?null:o,c=u.elementMetadata,f=void 0===c?null:c,h=u.metadata,v=void 0===h?{}:h;if((0,i.Z)(this,n),0==arguments.length)return a=t.call(this),(0,s.Z)(a);if((a=t.call(this,e.length,{names:l,elementMetadata:f,metadata:v}))._start=d.CY(e),d.Qp(a._start,"start"),a._width=d.CY(r),d.Qp(a._width,"width"),a._start.length!==a._width.length)throw new Error("'start' and 'width' should have the same length");return(0,s.Z)(a)}return(0,a.Z)(n,[{key:"start",value:function(){return this._start}},{key:"end",value:function(){var e=this;return this._start.map((function(t,n){return t+e._width[n]}))}},{key:"width",value:function(){return this._width}},{key:"setStart",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=d.CY(e);if(r.length!==h.G9(this))throw new Error("'start' should be replaced by array of the same length");d.Qp(r,"start");var i=v.Q(this,n);return i._start=r,i}},{key:"$setStart",value:function(e){return this.setStart(e,{inPlace:!0})}},{key:"setWidth",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=d.CY(e);if(r.length!==h.G9(this))throw new Error("'width' should be replaced by array of the same length");d.Qp(r,"width");var i=v.Q(this,n);return i._width=r,i}},{key:"$setWidth",value:function(e){return this.setWidth(e,{inPlace:!0})}},{key:"buildOverlapIndex",value:function(){var e=p.lZ(this._start,this.end());return new w(e)}},{key:"_bioconductor_LENGTH",value:function(){return this._start.length}},{key:"_bioconductor_SLICE",value:function(e,t,r){var i=r.allowView,a=void 0!==i&&i;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_SLICE",this).call(this,e,t,{allowView:a}),e._start=h.Nd(this._start,t,{allowView:a}),e._width=h.Nd(this._width,t,{allowView:a})}},{key:"_bioconductor_COMBINE",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE",this).call(this,e,t);var i,a=[],s=[],l=(0,r.Z)(t);try{for(l.s();!(i=l.n()).done;){var c=i.value;a.push(c._start),s.push(c._width)}}catch(f){l.e(f)}finally{l.f()}e._start=h.NR(a),e._width=h.NR(s)}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),e._start=v.J(this._start,i),e._width=v.J(this._width,i)}}],[{key:"empty",value:function(){return new n(new Int32Array,new Int32Array)}}]),n}(m.O);(0,f.Z)(Z,"className","IRanges");var w=function(){function e(t){(0,i.Z)(this,e),this._tree=t}return(0,a.Z)(e,[{key:"overlap",value:function(e){for(var t=h.G9(e),n=new Array(t),r=0;r<t;r++)n[r]=p.rl(e._start[r],e._start[r]+e._width[r],this._tree);return n}}]),e}()},6674:function(e,t,n){"use strict";n.d(t,{H:function(){return v}});var r=n(3324),i=n(7762),a=n(5671),s=n(3144),u=n(101),o=n(4942),l=n(3889),c=n(3637),f=n(9648),h=n(7806),d=new WeakSet,v=function(){function e(t,n){if((0,a.Z)(this,e),(0,u.Z)(this,d),0!=arguments.length){t=c.OI(t);var r=Array.from(t.keys());if(null!==n){c.Vt(n,"'order'",r.length,"the length of 'entries'");var i=n.slice().sort();if(r.sort(),!c.Hj(i,r))throw new Error("values of 'order' should be the same as the keys of 'entries'")}else n=r;this._entries=t,this._order=n}}return(0,s.Z)(e,[{key:"names",value:function(){return this._order}},{key:"numberOfEntries",value:function(){return this._order.length}},{key:"entry",value:function(e){if("string"==typeof e){if(!this._entries.has(e))throw new Error("no entry '"+e+"' present in this "+this.constructor.className);return this._entries.get(e)}return(0,l.Z)(this,d,m).call(this,e),this._entries.get(this._order[e])}},{key:"has",value:function(e){return this._entries.has(e)}},{key:"delete",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=f.Q(this,n);if(n||(r._order=r._order.slice(),r._entries=new Map(r._entries)),"string"==typeof e){var i=r._order.indexOf(e);if(i<0)throw new Error("no entry '"+e+"' present in this "+this.constructor.className);r._order.splice(i,1),r._entries.delete(e)}else{(0,l.Z)(this,d,m).call(this,e);var a=r._order[e];r._order.splice(e,1),r._entries.delete(a)}return r}},{key:"set",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n,i=f.Q(this,r);return r||(i._entries=new Map(i._entries)),"string"==typeof e?(i._entries.has(e)||(r||(i._order=i._order.slice()),i._order.push(e)),i._entries.set(e,t)):((0,l.Z)(this,d,m).call(this,e),i._entries.set(i._order[e],t)),i}},{key:"setNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;c.Vt(e,"replacement 'names'",this._order.length,"length of 'names()'");for(var r=new Map,i=0;i<e.length;i++){if(r.has(e[i]))throw new Error("detected duplicate value '"+e[i]+"' in replacement 'names'");r.set(e[i],this._entries.get(this._order[i]))}var a=f.Q(this,n);return a._entries=r,a._order=e,a}},{key:"slice",value:function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,r=void 0!==n&&n,a=new Map,s=[],u=(0,i.Z)(e);try{for(u.s();!(t=u.n()).done;){var o=t.value;if("string"!=typeof o&&((0,l.Z)(this,d,m).call(this,o),o=this._order[o]),a.has(o))throw new Error("duplicate entries detected in slice request");if(!this._entries.has(o))throw new Error("slice contains missing entry '"+o+"' ");a.set(o,this._entries.get(o)),s.push(o)}}catch(h){u.e(h)}finally{u.f()}var c=f.Q(this,r);return c._entries=a,c._order=s,c}},{key:"reorder",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(e.length!==this._order.length)throw c.rS("reordered indices","the number of existing entries");var r,a=[],s=(0,i.Z)(e);try{for(s.s();!(r=s.n()).done;){var u=r.value;if("string"!=typeof u&&((0,l.Z)(this,d,m).call(this,u),u=this._order[u]),!this._entries.has(u))throw new Error("missing entry '"+u+"' among the reordered indices");a.push(u)}}catch(h){s.e(h)}finally{s.f()}var o=f.Q(this,n);return o._order=a,o}},{key:"_bioconductor_CLONE",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deepCopy,n=void 0===t||t;e._entries=n?h.bl(this._entries):this._entries,e._order=n?h.bl(this._order):this._order}},{key:"apply",value:function(t){var n,a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,s=void 0!==a&&a,u=s?this._entries:new Map,o=(0,i.Z)(this._entries);try{for(o.s();!(n=o.n()).done;){var l=(0,r.Z)(n.value,2),c=l[0],f=l[1];u.set(c,t(f))}}catch(h){o.e(h)}finally{o.f()}return s?this:new e(u,this._order)}}],[{key:"parallelCombine",value:function(t,n){for(var r=t[0]._order,a=1;a<t.length;a++)if(!c.Hj(r,t[a]._order))throw new Error("detected differences in names between first object and object "+String(a)+" to be combined");var s,u=new Map,o=(0,i.Z)(r);try{var l=function(){var e=s.value,r=t.map((function(t){return t._entries.get(e)}));u.set(e,n(r))};for(o.s();!(s=o.n()).done;)l()}catch(f){o.e(f)}finally{o.f()}return new e(u,r)}}]),e}();function m(e){if(e<0||e>=this._order.length)throw new Error(" index '"+String(e)+"' out of range for this "+this.constructor.className)}(0,o.Z)(v,"className","InternalList")},9060:function(e,t,n){"use strict";n.d(t,{Q:function(){return b}});var r=n(5671),i=n(3144),a=n(2963),s=n(7326),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(101),h=n(3889),d=n(7806),v=n(5605),m=n(3403),p=n(5351),Z=n(3637),w=n(9648),y=new WeakSet,b=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e,i){var u,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,r.Z)(this,n),0==arguments.length?(u=t.call(this),(0,f.Z)((0,s.Z)(u),y),(0,a.Z)(u)):(u=t.call(this,e,o),(0,f.Z)((0,s.Z)(u),y),null===i?i=m.f.empty(u.numberOfRows()):(0,h.Z)((0,s.Z)(u),y,g).call((0,s.Z)(u),i),u._rowRanges=i,(0,a.Z)(u))}return(0,i.Z)(n,[{key:"rowRanges",value:function(){return this._rowRanges}},{key:"setRowRanges",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;(0,h.Z)(this,y,g).call(this,e);var r=w.Q(this,n);return r._rowRanges=e,r}},{key:"$setRowRanges",value:function(e){return this.setRowRanges(e,{inPlace:!0})}},{key:"_bioconductor_SLICE_2D",value:function(e,t,r,i){var a=i.allowView,s=void 0!==a&&a;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_SLICE_2D",this).call(this,e,t,r,{allowView:s}),e._rowRanges=null!==t?d.Nd(this._rowRanges,t):this._rowRanges}},{key:"_bioconductor_COMBINE_ROWS",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE_ROWS",this).call(this,e,t);for(var r=[],i=!1,a=!1,s=0;s<t.length;s++){var l=t[s];if(l instanceof n){var c=l._rowRanges;c instanceof m.f&&(a=!0),r.push(c)}else{if(!(l instanceof p.E))throw new Error("objects to be combined must be SummarizedExperiments (failing for object "+String(s)+")");i=!0,r.push(null)}}if(i||a)for(s=0;s<r.length;s++){var f=r[s];if(f instanceof v.a){var h=new Int32Array(d.G9(f));h.fill(1);var Z={rangeLengths:h,names:f.names(),elementMetadata:f.elementMetadata(),metadata:f.metadata()};null!==Z.names&&(f=f.setNames(null)),(Z.elementMetadata.metadata().size>0||Z.elementMetadata.numberOfColumns()>0)&&(f=f.setElementMetadata(null)),Z.metadata.size>0&&(f=f.setMetadata(new Map)),r[s]=new m.f(f,Z)}else null===f&&(r[s]=m.f.empty(t[s].numberOfRows()))}e._rowRanges=d.NR(r)}},{key:"_bioconductor_COMBINE_COLUMNS",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE_COLUMNS",this).call(this,e,t),e._rowRanges=t[0]._rowRanges}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:r}),e._rowRanges=w.J(this._rowRanges,r)}}]),n}(p.E);function g(e){if(!(e instanceof v.a)&&!(e instanceof m.f))throw new Error("'rowRanges' should be a 'GRanges' or 'GroupedGRanges' instance");if(d.G9(e)!==this._rowData.numberOfRows())throw Z.rS("'rowRanges'","the number of rows")}},3215:function(e,t,n){"use strict";var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(4942),h=n(7806),d=n(9060),v=n(5351),m=n(9648),p=n(6674),Z=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var a,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,i.Z)(this,n),0==arguments.length)return a=t.call(this),(0,s.Z)(a);var o=u.reducedDimensions,l=void 0===o?{}:o,c=u.reducedDimensionOrder,f=void 0===c?null:c,d=u.alternativeExperiments,m=void 0===d?{}:d,Z=u.alternativeExperimentOrder,w=void 0===Z?null:Z,y=u.rowRanges,b=void 0===y?null:y,g=(a=t.call(this,e,b,u)).numberOfColumns();try{a._reducedDimensions=new p.H(l,f)}catch(N){throw new Error("failed to initialize reduced dimension list for this "+a.constructor.className+"; "+N.message,{cause:N})}var _,k=(0,r.Z)(a._reducedDimensions.names());try{for(k.s();!(_=k.n()).done;){var x=_.value,E=a._reducedDimensions.entry(x);if(h.Ab(E)!==g)throw new Error("number of rows for reduced dimension '"+x+"' is not equal to number of columns for this "+a.constructor.className)}}catch(S){k.e(S)}finally{k.f()}try{a._alternativeExperiments=new p.H(m,w)}catch(N){throw new Error("failed to initialize alternative experiment list for this "+a.constructor.className+"; "+N.message,{cause:N})}var O,C=(0,r.Z)(a._alternativeExperiments.names());try{for(C.s();!(O=C.n()).done;){var M=O.value,R=a._alternativeExperiments.entry(M);if(!(R instanceof v.E))throw new Error("alternative experiment '"+M+"' is not a SummarizedExperiment");if(R.numberOfColumns(R)!==g)throw new Error("number of columns for alternative experiment '"+M+"' is not equal to number of columns for this "+a.constructor.className)}}catch(S){C.e(S)}finally{C.f()}return(0,s.Z)(a)}return(0,a.Z)(n,[{key:"reducedDimensionNames",value:function(){return this._reducedDimensions.names()}},{key:"reducedDimension",value:function(e){var t;try{t=this._reducedDimensions.entry(e)}catch(n){throw new Error("failed to retrieve the specified reduced dimension from this "+this.constructor.className+"; "+n.message,{cause:n})}return t}},{key:"alternativeExperimentNames",value:function(){return this._alternativeExperiments.names()}},{key:"alternativeExperiment",value:function(e){var t;try{t=this._alternativeExperiments.entry(e)}catch(n){throw new Error("failed to retrieve the specified alternative experiment from this "+this.constructor.className+"; "+n.message,{cause:n})}return t}},{key:"removeReducedDimension",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._reducedDimensions=r._reducedDimensions.delete(e,{inPlace:n})}catch(i){throw new Error("failed to remove the specified reduced dimension from this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$removeReducedDimension",value:function(e){return this.removeReducedDimension(e,{inPlace:!0})}},{key:"setReducedDimension",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(h.Ab(t)!=this.numberOfColumns())throw new Error("number of rows of 'value' should be the same as the number of columns of this SingleCellExperiment");var i=m.Q(this,r);return i._reducedDimensions=i._reducedDimensions.set(e,t,{inPlace:r}),i}},{key:"$setReducedDimension",value:function(e,t){return this.setReducedDimension(e,t,{inPlace:!0})}},{key:"setReducedDimensionNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._reducedDimensions=r._reducedDimensions.setNames(e,{inPlace:n})}catch(i){throw new Error("failed to set the reduced dimension names for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$setReducedDimensionNames",value:function(e){return this.setReducedDimensionNames(e,{inPlace:!0})}},{key:"sliceReducedDimensions",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._reducedDimensions=this._reducedDimensions.slice(e,{inPlace:n})}catch(i){throw new Error("failed to slice the reduced dimensions for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$sliceReducedDimensions",value:function(e){return this.sliceReducedDimensions(e,{inPlace:!0})}},{key:"removeAlternativeExperiment",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._alternativeExperiments=r._alternativeExperiments.delete(e,{inPlace:n})}catch(i){throw new Error("failed to remove the specified alternative experiment from this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$removeAlternativeExperiment",value:function(e){return this.removeAlternativeExperiment(e,{inPlace:!0})}},{key:"setAlternativeExperiment",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(!(t instanceof v.E)||h.Et(t)!=this.numberOfColumns())throw new Error("'value' should be a SummarizedExperiment with the same number of columns as this SingleCellExperiment");var i=m.Q(this,r);return i._alternativeExperiments=i._alternativeExperiments.set(e,t,{inPlace:r}),i}},{key:"$setAlternativeExperiment",value:function(e,t){return this.setAlternativeExperiment(e,t,{inPlace:!0})}},{key:"setAlternativeExperimentNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._alternativeExperiments=r._alternativeExperiments.setNames(e,{inPlace:n})}catch(i){throw new Error("failed to set the alternative experiment names for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$setAlternativeExperimentNames",value:function(e){return this.setAlternativeExperimentNames(e,{inPlace:!0})}},{key:"sliceAlternativeExperiments",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=m.Q(this,n);try{r._alternativeExperiments=this._alternativeExperiments.slice(e,{inPlace:n})}catch(i){throw new Error("failed to slice the alternative experiments for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$sliceAlternativeExperiments",value:function(e){return this.sliceAlternativeExperiments(e,{inPlace:!0})}},{key:"_bioconductor_SLICE_2D",value:function(e,t,r,i){var a=i.allowView,s=void 0!==a&&a;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_SLICE_2D",this).call(this,e,t,r,{allowView:s}),null!==r?(e._reducedDimensions=this._reducedDimensions.apply((function(e){return h.V_(e,r,null,{allowView:s})})),e._alternativeExperiments=this._alternativeExperiments.apply((function(e){return h.V_(e,null,r,{allowView:s})}))):(e._reducedDimensions=this._reducedDimensions,e._alternativeExperiments=this._alternativeExperiments)}},{key:"_bioconductor_COMBINE_ROWS",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE_ROWS",this).call(this,e,t),e._reducedDimensions=this._reducedDimensions,e._alternativeExperiments=this._alternativeExperiments}},{key:"_bioconductor_COMBINE_COLUMNS",value:function(e,t){(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_COMBINE_COLUMNS",this).call(this,e,t);try{e._reducedDimensions=p.H.parallelCombine(t.map((function(e){return e._reducedDimensions})),h.Su)}catch(r){throw new Error("failed to combine reduced dimensions for "+this.constructor.className+" objects; "+r.message,{cause:r})}try{e._alternativeExperiments=p.H.parallelCombine(t.map((function(e){return e._alternativeExperiments})),h.G)}catch(r){throw new Error("failed to combine alternative experiments for "+this.constructor.className+" objects; "+r.message,{cause:r})}}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:r}),e._reducedDimensions=m.J(this._reducedDimensions,r),e._alternativeExperiments=m.J(this._alternativeExperiments,r)}}]),n}(d.Q);(0,f.Z)(Z,"className","SingleCellExperiment")},5351:function(e,t,n){"use strict";n.d(t,{E:function(){return w}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(4942),h=n(7806),d=n(3750),v=n(815),m=n(3637),p=n(9648),Z=n(6674),w=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var a,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=u.assayOrder,l=void 0===o?null:o,c=u.rowData,f=void 0===c?null:c,d=u.columnData,p=void 0===d?null:d,w=u.rowNames,y=void 0===w?null:w,b=u.columnNames,g=void 0===b?null:b,_=u.metadata,k=void 0===_?{}:_;if((0,i.Z)(this,n),0==arguments.length)return a=t.call(this),(0,s.Z)(a);a=t.call(this,k);try{a._assays=new Z.H(e,l)}catch(A){throw new Error("failed to initialize assay list for this SummarizedExperiment; "+A.message,{cause:A})}var x,E=null,O=null,C=(0,r.Z)(a._assays.names());try{for(C.s();!(x=C.n()).done;){var M=x.value,R=a._assays.entry(M),N=h.Ab(R),S=h.Et(R);if(null==E)E=N,O=S;else if(E!==N||O!==S)throw new Error("expected all assays in 'assays' to have the same number of rows and columns")}}catch(W){C.e(W)}finally{C.f()}if(null===f){if(null==E)throw new Error("'rowData' must be specified if 'assays' is empty");f=new v.N({},{numberOfRows:E})}else if(null!==E&&E!==h.G9(f))throw new Error("'rowData' should be equal to the number of rows in each 'assays'");if(a._rowData=f,null===p){if(null==O)throw new Error("'columnData' must be specified if 'assays' is empty");p=new v.N({},{numberOfRows:O})}else if(null!==O&&O!==h.G9(p))throw new Error("'columnData' should be equal to the number of columns in each 'assays'");return a._columnData=p,null!=y&&m.Vt(y,"'rowNames'",a._rowData.numberOfRows(),"the number of rows in each 'assays'"),a._rowNames=y,null!=g&&m.Vt(g,"'columnNames'",a._columnData.numberOfRows(),"the number of columns in each 'assays'"),a._columnNames=g,(0,s.Z)(a)}return(0,a.Z)(n,[{key:"assayNames",value:function(){return this._assays.names()}},{key:"numberOfAssays",value:function(){return this._assays.numberOfEntries()}},{key:"assay",value:function(e){var t;try{t=this._assays.entry(e)}catch(n){throw new Error("failed to retrieve the specified assay from this "+this.constructor.className+"; "+n.message,{cause:n})}return t}},{key:"rowData",value:function(){return this._rowData}},{key:"numberOfRows",value:function(){return this._rowData.numberOfRows()}},{key:"rowNames",value:function(){return this._rowNames}},{key:"columnData",value:function(){return this._columnData}},{key:"numberOfColumns",value:function(){return this._columnData.numberOfRows()}},{key:"columnNames",value:function(){return this._columnNames}},{key:"removeAssay",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=p.Q(this,n);try{r._assays=r._assays.delete(e,{inPlace:n})}catch(i){throw new Error("failed to remove assay "+("string"==typeof e?"'"+e+"'":String(e))+" from this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$removeAssay",value:function(e){return this.removeAssay(e,{inPlace:!0})}},{key:"setAssay",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,r=void 0!==n&&n;if(h.Ab(t)!==this.numberOfRows()||h.Et(t)!==this.numberOfColumns())throw new Error("expected 'value' to have the same dimensions as this 'SummarizedExperiment'");var i=p.Q(this,r);return i._assays=i._assays.set(e,t,{inPlace:r}),i}},{key:"$setAssay",value:function(e,t){return this.setAssay(e,t,{inPlace:!0})}},{key:"setAssayNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=p.Q(this,n);try{r._assays=r._assays.setNames(e,{inPlace:n})}catch(i){throw new Error("failed to set the assay names for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$setAssayNames",value:function(e){return this.setAssayNames(e,{inPlace:!0})}},{key:"sliceAssays",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=p.Q(this,n);try{r._assays=this._assays.slice(e,{inPlace:n})}catch(i){throw new Error("failed to slice the assays for this "+this.constructor.className+"; "+i.message,{cause:i})}return r}},{key:"$sliceAssays",value:function(e){return this.sliceAssays(e,{inPlace:!0})}},{key:"setRowData",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(!(e instanceof v.N))throw new Error("'value' should be a DataFrame");if(e.numberOfRows()!==this.numberOfRows())throw new Error("expected 'value' to have the same number of rows as this 'SummarizedExperiment'");var r=p.Q(this,n);return r._rowData=e,r}},{key:"$setRowData",value:function(e){return this.setRowData(e,{inPlace:!0})}},{key:"setColumnData",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;if(!(e instanceof v.N))throw new Error("'value' should be a DataFrame");if(e.numberOfRows()!==this.numberOfColumns())throw new Error("expected 'value' to have the same number of rows as the number of columns of this 'SummarizedExperiment'");var r=p.Q(this,n);return r._columnData=e,r}},{key:"$setColumnData",value:function(e){return this.setColumnData(e,{inPlace:!0})}},{key:"setRowNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;null!==e&&m.Vt(e,"replacement 'names'",this.numberOfRows(),"'numberOfRows()'");var r=p.Q(this,n);return r._rowNames=e,r}},{key:"$setRowNames",value:function(e){return this.setRowNames(e,{inPlace:!0})}},{key:"setColumnNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;null!==e&&m.Vt(e,"replacement 'names'",this.numberOfColumns(),"'numberOfColumns()'");var r=p.Q(this,n);return r._columnNames=e,r}},{key:"$setColumnNames",value:function(e){return this.setColumnNames(e,{inPlace:!0})}},{key:"_bioconductor_NUMBER_OF_ROWS",value:function(){return this.numberOfRows()}},{key:"_bioconductor_NUMBER_OF_COLUMNS",value:function(){return this.numberOfColumns()}},{key:"_bioconductor_SLICE_2D",value:function(e,t,n,r){var i=r.allowView,a=void 0!==i&&i;e._assays=this._assays.apply((function(e){return h.V_(e,t,n,{allowView:a})})),null!==t?(e._rowData=h.Nd(this._rowData,t,{allowView:a}),e._rowNames=null==this._rowNames?null:h.Nd(this._rowNames,t,{allowView:a})):(e._rowData=this._rowData,e._rowNames=this._rowNames),null!==n?(e._columnData=h.Nd(this._columnData,n,{allowView:a}),e._columnNames=null==this._columnNames?null:h.Nd(this._columnNames,n,{allowView:a})):(e._columnData=this._columnData,e._columnNames=this._columnNames),e._metadata=this._metadata}},{key:"_bioconductor_COMBINE_ROWS",value:function(e,t){e._assays=Z.H.parallelCombine(t.map((function(e){return e._assays})),h.Su);var n=t.map((function(e){return e._rowData}));e._rowData=h.NR(n);var r=t.map((function(e){return e._rowNames})),i=t.map((function(e){return e.numberOfRows()}));e._rowNames=m.SE(r,i),e._columnData=this._columnData,e._columnNames=this._columnNames,e._metadata=this._metadata}},{key:"_bioconductor_COMBINE_COLUMNS",value:function(e,t){e._assays=Z.H.parallelCombine(t.map((function(e){return e._assays})),h.G);var n=t.map((function(e){return e._columnData}));e._columnData=h.NR(n);var r=t.map((function(e){return e._columnNames})),i=t.map((function(e){return e.numberOfColumns()}));e._columnNames=m.SE(r,i),e._rowData=this._rowData,e._rowNames=this._rowNames,e._metadata=this._metadata}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),e._assays=p.J(this._assays,i),e._rowData=p.J(this._rowData,i),e._rowNames=p.J(this._rowNames,i),e._columnData=p.J(this._columnData,i),e._columnNames=p.J(this._columnNames,i)}}]),n}(d.M);(0,f.Z)(w,"className","SummarizedExperiment")},1380:function(e,t,n){"use strict";n.d(t,{O:function(){return p}});var r=n(7762),i=n(5671),a=n(3144),s=n(2963),u=n(8301),o=n(1120),l=n(136),c=n(9388),f=n(7806),h=n(3637),d=n(9648),v=n(815);function m(e,t,n){if(null!==e){if(!(e instanceof v.N))throw new Error("'elementMetadata' should be a DataFrame");if(f.G9(e)!==t)throw new Error("'elementMetadata' should have the same number of rows as 'LENGTH(<"+n+">)'")}else e=new v.N({},{numberOfRows:t});return e}var p=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=a.names,o=void 0===u?null:u,l=a.elementMetadata,c=void 0===l?null:l,f=a.metadata,d=void 0===f?{}:f;return(0,i.Z)(this,n),0==arguments.length?(r=t.call(this),(0,s.Z)(r)):((r=t.call(this,d))._elementMetadata=m(c,e,r.constructor.className),null!==o&&h.Vt(o,"'names'",e,"'LENGTH(<"+r.constructor.className+">)'"),r._names=o,(0,s.Z)(r))}return(0,a.Z)(n,[{key:"elementMetadata",value:function(){return this._elementMetadata}},{key:"names",value:function(){return this._names}},{key:"setElementMetadata",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t,r=d.Q(this,n);return r._elementMetadata=m(e,f.G9(r),r.constructor.className),r}},{key:"$setElementMetadata",value:function(e){return this.setElementMetadata(e,{inPlace:!0})}},{key:"setNames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).inPlace,n=void 0!==t&&t;null!==e&&h.Vt(e,"replacement 'names'",f.G9(this),"'LENGTH(<"+this.constructor.className+">)'");var r=d.Q(this,n);return r._names=e,r}},{key:"$setNames",value:function(e){return this.setNames(e,{inPlace:!0})}},{key:"_bioconductor_SLICE",value:function(e,t,n){var r=n.allowView,i=void 0!==r&&r;e._elementMetadata=f.Nd(this._elementMetadata,t,{allowView:i}),e._names=null===this._names?null:f.Nd(this._names,t,{allowView:i}),e._metadata=this._metadata}},{key:"_bioconductor_COMBINE",value:function(e,t){var n,i=[],a=[],s=[],u=(0,r.Z)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value;i.push(o._elementMetadata),a.push(o._names),s.push(f.G9(o))}}catch(l){u.e(l)}finally{u.f()}e._elementMetadata=f.NR(i),e._names=h.SE(a,s)}},{key:"_bioconductor_CLONE",value:function(e,t){var r=t.deepCopy,i=void 0===r||r;(0,u.Z)((0,o.Z)(n.prototype),"_bioconductor_CLONE",this).call(this,e,{deepCopy:i}),e._elementMetadata=d.J(this._elementMetadata,i),e._names=d.J(this._names,i)}}]),n}(n(3750).M)},9648:function(e,t,n){"use strict";n.d(t,{J:function(){return a},Q:function(){return i}});var r=n(7806);function i(e,t){return t?e:r.bl(e,{deepCopy:!1})}function a(e,t){return t?r.bl(e):e}},6474:function(e,t,n){"use strict";n.d(t,{Lm:function(){return a.L},NE:function(){return r.N},NR:function(){return i.NR},Nd:function(){return i.Nd},Tm:function(){return i.Tm},bl:function(){return i.bl},sj:function(){return r.s}});var r=n(815),i=(n(1774),n(5605),n(3403),n(8882),n(5351),n(9060),n(3215),n(7806)),a=n(8497)},8497:function(e,t,n){"use strict";function r(e){var t={};return e.forEach((function(e,n){e in t||(t[e]=[]),t[e].push(n)})),t}n.d(t,{L:function(){return r}})},9420:function(e,t,n){"use strict";n.d(t,{lZ:function(){return a},rl:function(){return o}});var r=n(7762),i=n(3637);function a(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).slice,a=void 0===n?null:n,o=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).slice,a=void 0===n?null:n,s=null==a?e.length:a.length,u=new Int32Array(2*s),o=new Uint8Array(2*s),l=new Int32Array(2*s),c=0,f=function(n){var r=2*c,i=r+1;u[r]=e[n],u[i]=t[n],o[r]=1,o[i]=0,l[r]=c,l[i]=c,c++};if(null===a)for(var h=0;h<s;h++)f(h);else{var d,v=(0,r.Z)(a);try{for(v.s();!(d=v.n()).done;)f(d.value)}catch(E){v.e(E)}finally{v.f()}}var m=i.Nt(u.length);m.sort((function(e,t){return u[e]-u[t]}));var p,Z=[],w=new Int32Array(s),y=new Int32Array(s),b=null,g=(0,r.Z)(m);try{for(g.s();!(p=g.n()).done;){var _=p.value,k=u[_],x=l[_];k!==b&&(Z.push(k),b=k),o[_]?w[x]=Z.length-1:y[x]=Z.length-1}}catch(E){g.e(E)}finally{g.f()}return{rank2position:Z,startRanks:w,endRanks:y}}(e,t,{slice:a}),l=o.rank2position,c=o.startRanks,f=o.endRanks,h=[s(0,l.length)];if(null===a)for(var d=0;d<c.length;d++)u(c[d],f[d],d,h,0);else for(d=0;d<c.length;d++)u(c[d],f[d],a[d],h,0);var v=l.length>0?l[l.length-1]+1:1;l.push(v);for(var m=0,p=h;m<p.length;m++){var Z=p[m];Z.left_bound=l[Z.left_bound],Z.right_bound=l[Z.right_bound],Z.center=l[Z.center];var w=Z.overlaps.slice().sort((function(t,n){return e[t]-e[n]})),y=Z.overlaps.sort((function(e,n){return t[n]-t[e]}));Z.overlaps={start:w.map((function(t){return[e[t],t]})),end:y.map((function(e){return[t[e],e]}))}}return h}function s(e,t){return{left_bound:e,right_bound:t,center:e+Math.floor((t-e)/2),left_node:null,right_node:null,overlaps:[]}}function u(e,t,n,r,i){var a=r[i];e>a.center?(null===a.right_node&&(a.right_node=r.length,r.push(s(a.center,a.right_bound))),u(e,t,n,r,a.right_node)):t<a.center||t==a.center&&t>e?(null===a.left_node&&(a.left_node=r.length,r.push(s(a.left_bound,a.center))),u(e,t,n,r,a.left_node)):a.overlaps.push(n)}function o(e,t,n){var r=[];return e>n.right_bound||t<n.left_bound||t==n.left_bound&&t>e||l(e,t,n,0,r),r}function l(e,t,n,i,a){var s=n[i];if(e>s.center){var u,o=(0,r.Z)(s.overlaps.end);try{for(o.s();!(u=o.n()).done;){var c=u.value;if(!(c[0]>e))break;a.push(c[1])}}catch(Z){o.e(Z)}finally{o.f()}null!==s.right_node&&l(e,t,n,s.right_node,a)}else if(t<s.center||t==s.center&&t>e){var f,h=(0,r.Z)(s.overlaps.start);try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!(d[0]<t||d[0]==t&&e==t))break;a.push(d[1])}}catch(Z){h.e(Z)}finally{h.f()}null!==s.left_node&&l(e,t,n,s.left_node,a)}else{var v,m=(0,r.Z)(s.overlaps.start);try{for(m.s();!(v=m.n()).done;){var p=v.value;a.push(p[1])}}catch(Z){m.e(Z)}finally{m.f()}t>s.center&&null!==s.right_node&&l(e,t,n,s.right_node,a),e<s.center&&null!==s.left_node&&l(e,t,n,s.left_node,a)}}},3637:function(e,t,n){"use strict";n.d(t,{BQ:function(){return u},CY:function(){return v},Hj:function(){return a},K1:function(){return l},Nt:function(){return d},OI:function(){return p},Qp:function(){return m},SE:function(){return h},Sm:function(){return f},Vt:function(){return c},rS:function(){return o},zG:function(){return s}});var r=n(3324),i=n(7762);function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function s(e){return e.constructor==Array||ArrayBuffer.isView(e)}function u(e,t){return e==t?e:e==Array||t==Array||e==BigInt64Array||t==BigInt64Array||e==BigUint64Array||t==BigUint64Array?Array:Float64Array}function o(e,t){return new Error(e+" should have length equal to "+t)}function l(e,t){var n,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){if("string"!==typeof n.value)throw new Error(t+" array should only contain strings")}}catch(a){r.e(a)}finally{r.f()}}function c(e,t,n,r){if(l(e,t),e.length!=n)throw o(t+" array",r)}function f(e){var t=0;return e.forEach((function(e){t+=e})),t}function h(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!0,i=0;i<e.length;i++)null!==e[i]&&(r=!1);if(r)return null;null===n&&(n=f(t));var a=new Array(n),s=0;for(i=0;i<e.length;i++){var u=e[i];null===u?(a.fill("",s,s+t[i]),s+=t[i]):u.forEach((function(e){a[s]=e,s++}))}return a}function d(e){for(var t=new Int32Array(e),n=0;n<e;n++)t[n]=n;return t}function v(e){return e instanceof Int32Array?e:new Int32Array(e)}function m(e,t){var n,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){if(n.value<0)throw new Error("detected a negative entry in '"+t+"'")}}catch(a){r.e(a)}finally{r.f()}}function p(e){if(e.constructor==Object){for(var t=new Map,n=0,i=Object.entries(e);n<i.length;n++){var a=(0,r.Z)(i[n],2),s=a[0],u=a[1];t.set(s,u)}return t}if(!(e instanceof Map))throw new Error("'x' should be either an object or Map");return e}},3192:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var r=n(4165),i=n(5861),a=n(8137),s=new Map;function u(e){return o.apply(this,arguments)}function o(){return o=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u,o,l,c,f,h,d,v,m=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(m.length>1&&void 0!==m[1]?m[1]:{}).download,i=void 0===n||n,"undefined"===typeof(u=s.get(t))){e.next=6;break}return e.abrupt("return",u);case 6:if(i){e.next=8;break}return e.abrupt("return",null);case 8:return u=[],s.set(t,u),e.next=12,(0,a.reference_download)(t+"_collections.tsv.gz");case 12:if((o=e.sent).ok){e.next=15;break}throw new Error("failed to fetch collection information for species '"+t+"'");case 15:return e.t0=a.decompressLines,e.next=18,o.arrayBuffer();case 18:for(e.t1=e.sent,l=(0,e.t0)(e.t1),c=0,f=0;f<l.length;f++)h=l[f],d=h.split("\t"),v=Number(d[5]),u.push({title:d[0],description:d[1],species:d[2],maintainer:d[3],source:d[4],start:c,size:v}),c+=v;return e.abrupt("return",u);case 23:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}},4147:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(4165),i=n(7762),a=n(5861),s=n(8137),u=new Map;function o(e){return l.apply(this,arguments)}function l(){return l=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,o,l,c,f,h,d,v,m,p,Z,w,y,b,g,_,k,x,E,O=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(O.length>1&&void 0!==O[1]?O[1]:{}).types,null==(a=void 0===n?null:n)&&(a=["symbol","entrez","ensembl"]),"undefined"==typeof(o=u.get(t))&&(o=new Map,u.set(t,o)),l=new Map,c=[],f=[],h=(0,i.Z)(a);try{for(h.s();!(d=h.n()).done;)v=d.value,"undefined"==typeof(m=o.get(v))?(c.push((0,s.gene_download)(t+"_"+v+".tsv.gz")),f.push(v)):l.set(v,m)}catch(r){h.e(r)}finally{h.f()}if(!(c.length>0)){e.next=31;break}return e.next=12,Promise.all(c);case 12:p=e.sent,Z=0;case 14:if(!(Z<p.length)){e.next=31;break}if((w=p[Z]).ok){e.next=18;break}throw"failed to fetch symbol information for genes";case 18:return e.next=20,w.arrayBuffer();case 20:y=e.sent,b=(0,s.decompressLines)(y),g=[],_=(0,i.Z)(b);try{for(_.s();!(k=_.n()).done;)""==(x=k.value)?g.push([]):g.push(x.split("\t"))}catch(r){_.e(r)}finally{_.f()}E=f[Z],o.set(E,g),l.set(E,g);case 28:Z++,e.next=14;break;case 31:return e.abrupt("return",l);case 32:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}},7899:function(e,t,n){"use strict";n.d(t,{b:function(){return l}});var r=n(4165),i=n(3324),a=n(5861),s=n(8137),u=n(3192),o=new Map;function l(e){return c.apply(this,arguments)}function c(){return c=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,l,c,f,h,d,v,m,p,Z,w,y,b,g=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(g.length>1&&void 0!==g[1]?g[1]:{}).download,a=void 0===n||n,"undefined"===typeof(l=o.get(t))){e.next=6;break}return e.abrupt("return",l);case 6:if(a){e.next=8;break}return e.abrupt("return",null);case 8:return l=[],o.set(t,l),e.next=12,Promise.all([(0,s.reference_download)(t+"_sets.tsv.gz"),(0,u.i)(t)]);case 12:if(c=e.sent,f=(0,i.Z)(c,2),h=f[0],d=f[1],h.ok){e.next=18;break}throw new Error("failed to fetch set information for species '"+t+"'");case 18:return e.t0=s.decompressLines,e.next=21,h.arrayBuffer();case 21:for(e.t1=e.sent,v=(0,e.t0)(e.t1),m=0;m<v.length;m++)p=v[m],Z=p.split("\t"),l.push({name:Z[0],description:Z[1],size:Number(Z[2])});for(w=0,m=0;m<d.length;m++){for(y=d[m].size,b=0;b<y;b++)l[b+w].collection=m,l[b+w].number=b;w+=y}return e.abrupt("return",l);case 27:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}},7855:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(4165),i=n(5861),a=n(8137),s=new Map;function u(e){return o.apply(this,arguments)}function o(){return o=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u,o,l,c,f=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(f.length>1&&void 0!==f[1]?f[1]:{}).download,i=void 0===n||n,"undefined"===typeof(u=s.get(t))){e.next=6;break}return e.abrupt("return",u);case 6:if(i){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,a.reference_download(t+"_set2gene.tsv.gz");case 10:if((o=e.sent).ok){e.next=13;break}throw new Error("failed to fetch full set-to-gene information for species '"+t+"'");case 13:return e.t0=a,e.next=16,o.arrayBuffer();case 16:return e.t1=e.sent,l=e.t0.decompressLines.call(e.t0,e.t1),c=l.map(a.convertToUint32Array),s.set(t,c),e.abrupt("return",c);case 21:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}},4479:function(e,t,n){"use strict";n(8137),n(7855),new Map,new Map},2666:function(e,t,n){"use strict";n.d(t,{R:function(){return u}});var r=n(4165),i=n(5861),a=n(8137),s=new Map;function u(e){return o.apply(this,arguments)}function o(){return o=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,u,o,l,c,f=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(f.length>1&&void 0!==f[1]?f[1]:{}).download,i=void 0===n||n,"undefined"===typeof(u=s.get(t))){e.next=6;break}return e.abrupt("return",u);case 6:if(i){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,a.reference_download(t+"_gene2set.tsv.gz");case 10:if((o=e.sent).ok){e.next=13;break}throw new Error("failed to fetch full gene-to-set information for species '"+t+"'");case 13:return e.t0=a,e.next=16,o.arrayBuffer();case 16:return e.t1=e.sent,l=e.t0.decompressLines.call(e.t0,e.t1),c=l.map(a.convertToUint32Array),s.set(t,c),e.abrupt("return",c);case 21:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}},320:function(e,t,n){"use strict";n(8137),n(2666),new Map,new Map},6331:function(e,t,n){"use strict";n(8137),n(3192),new Map,new Map,new Map,new Map},4127:function(e,t,n){"use strict";n(8137),n(7899),n(6331),new Map,new Map,new Map,new Map,new Map,new Map},7078:function(e,t,n){"use strict";n.d(t,{B:function(){return c}});var r=n(4165),i=n(3324),a=n(7762),s=n(5861),u=n(4147),o=new Map,l=new Map;function c(e,t){return f.apply(this,arguments)}function f(){return f=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s,c,f,h,d,v,m,p,Z,w,y,b,g,_,k,x,E=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(E.length>2&&void 0!==E[2]?E[2]:{}).lowerCase,"undefined"===typeof(h=(f=(c=void 0!==s&&s)?l:o).get(t))&&(h=new Map,f.set(t,h)),"undefined"!==typeof(d=h.get(n))){e.next=14;break}return d=new Map,h.set(n,d),e.next=10,(0,u.a)(t,{types:[n]});case 10:for(v=e.sent.get(n),m=0;m<v.length;m++){p=(0,a.Z)(v[m]);try{for(p.s();!(Z=p.n()).done;)w=Z.value,c&&(w=w.toLowerCase()),"undefined"!==typeof(y=d.get(w))?y.add(m):d.set(w,new Set([m]))}catch(r){p.e(r)}finally{p.f()}}b=(0,a.Z)(d);try{for(b.s();!(g=b.n()).done;)_=(0,i.Z)(g.value,2),k=_[0],x=_[1],d.set(k,Array.from(x))}catch(r){b.e(r)}finally{b.f()}case 14:return e.abrupt("return",d);case 15:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}},7101:function(e,t,n){"use strict";n.d(t,{$:function(){return a}});var r=n(3324),i=n(7762);function a(e,t){for(var n=new Map,a=0;a<e.length;a++){var s,u=(0,i.Z)(e[a]);try{for(u.s();!(s=u.n()).done;){var o=s.value,l=n.get(o);"undefined"==typeof l&&(l=new Set,n.set(o,l)),l.add(a)}}catch(x){u.e(x)}finally{u.f()}}var c,f=(0,i.Z)(n);try{for(f.s();!(c=f.n()).done;){var h=(0,r.Z)(c.value,2),d=h[0],v=h[1];n[d]=new Uint32Array(v)}}catch(x){f.e(x)}finally{f.f()}var m=new Array(t.length);for(a=0;a<t.length;a++){var p,Z=new Set,w=(0,i.Z)(t[a]);try{for(w.s();!(p=w.n()).done;){var y=p.value,b=n.get(y);if("undefined"!==typeof b){var g,_=(0,i.Z)(b);try{for(_.s();!(g=_.n()).done;){var k=g.value;Z.add(k)}}catch(x){_.e(x)}finally{_.f()}}}}catch(x){w.e(x)}finally{w.f()}m[a]=new Uint32Array(Z).sort()}return m}},5479:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var r=n(7762);function i(e,t){for(var n=new Array(e.length),i=0;i<e.length;i++){var a,s=new Set,u=(0,r.Z)(e[i]);try{for(u.s();!(a=u.n()).done;){var o,l=a.value,c=(0,r.Z)(t[l]);try{for(c.s();!(o=c.n()).done;){var f=o.value;s.add(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){u.e(h)}finally{u.f()}n[i]=new Uint32Array(s).sort()}return n}},5719:function(e,t,n){"use strict";n(8137);new Map,new Map,new Map;new Map,new Map,new Map},4021:function(e,t,n){"use strict";n.d(t,{V:function(){return h}});var r=n(3324),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(6635),c=new WeakMap,f=new WeakMap,h=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).store,n=void 0===t?{}:t;(0,i.Z)(this,e),(0,s.Z)(this,c,{writable:!0,value:void 0}),(0,s.Z)(this,f,{writable:!0,value:void 0}),(0,o.Z)(this,c,n),(0,o.Z)(this,f,null);var r=Object.keys(n);if(r.length)for(var a=0;a<r.length;a++){var l=n[r[a]];if(0==a)(0,o.Z)(this,f,l.numberOfColumns());else if(l.numberOfColumns()!=(0,u.Z)(this,f))throw new Error("all matrices should have the same number of columns")}}return(0,a.Z)(e,[{key:"numberOfColumns",value:function(){return(0,u.Z)(this,f)}},{key:"available",value:function(){return Object.keys((0,u.Z)(this,c))}},{key:"has",value:function(e){return e in(0,u.Z)(this,c)}},{key:"get",value:function(e){return(0,u.Z)(this,c)[e]}},{key:"add",value:function(e,t){if(null===(0,u.Z)(this,f))(0,o.Z)(this,f,t.numberOfColumns());else if(t.numberOfColumns()!=(0,u.Z)(this,f))throw new Error("all matrices should have the same number of columns");if(e in(0,u.Z)(this,c)){var n=(0,u.Z)(this,c)[e];l.gd(n)}(0,u.Z)(this,c)[e]=t}},{key:"remove",value:function(e){l.gd((0,u.Z)(this,c)[e]),delete(0,u.Z)(this,c)[e],0==Object.keys((0,u.Z)(this,c)).length&&(0,o.Z)(this,f,null)}},{key:"clone",value:function(){var t=new e;try{for(var n=0,i=Object.entries((0,u.Z)(this,c));n<i.length;n++){var a=(0,r.Z)(i[n],2),s=a[0],o=a[1];t.add(s,o.clone())}}catch(l){throw t.free(),l}return t}},{key:"rename",value:function(e,t){e!==t&&(t in(0,u.Z)(this,c)&&l.gd((0,u.Z)(this,c)[t]),(0,u.Z)(this,c)[t]=(0,u.Z)(this,c)[e],delete(0,u.Z)(this,c)[e])}},{key:"free",value:function(){for(var e=0,t=Object.entries((0,u.Z)(this,c));e<t.length;e++){var n=(0,r.Z)(t[e],2),i=(n[0],n[1]);l.gd(i)}}}]),e}()},2306:function(e,t,n){"use strict";n.d(t,{p:function(){return d}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(6635),l=n(7108),c=n(6650),f=new WeakMap,h=new WeakMap,d=function(){function e(t,n){(0,r.Z)(this,e),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,u.Z)(this,f,t),(0,u.Z)(this,h,n)}return(0,i.Z)(e,[{key:"clone",value:function(){var t=this;return l.R((function(e){return(0,s.Z)(t,h).clone()}),e)}},{key:"matrix",get:function(){return(0,s.Z)(this,h)}},{key:"numberOfRows",value:function(){return(0,s.Z)(this,h).nrow()}},{key:"numberOfColumns",value:function(){return(0,s.Z)(this,h).ncol()}},{key:"row",value:function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).buffer,r=void 0===n?null:n;if(null!=r)return(0,s.Z)(this,h).row(e,r.offset),r.array();r=o.RJ((0,s.Z)(this,h).ncol());try{(0,s.Z)(this,h).row(e,r.offset),t=r.slice()}finally{r.free()}return t}},{key:"column",value:function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).buffer,r=void 0===n?null:n;if(null!=r)return(0,s.Z)(this,h).column(e,r.offset),r.array();r=o.RJ((0,s.Z)(this,h).nrow());try{(0,s.Z)(this,h).column(e,r.offset),t=r.slice()}finally{r.free()}return t}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(l.A((0,s.Z)(this,f)),(0,u.Z)(this,h,null))}},{key:"isSparse",value:function(){return(0,s.Z)(this,h).sparse()}},{key:"isReorganized",value:function(){return(0,s.Z)(this,h).reorganized()}},{key:"identities",value:function(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).buffer,n=void 0===t?null:t;if(null!=n)return(0,s.Z)(this,h).identities(n.offset),n.array();n=o.Wf((0,s.Z)(this,h).nrow());try{(0,s.Z)(this,h).identities(n.offset),e=n.slice()}finally{n.free()}return e}},{key:"wipeIdentities",value:function(){(0,s.Z)(this,h).wipe_identities()}}],[{key:"createDenseMatrix",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i.columnMajor,s=void 0===a||a,u=i.copy,o=void 0===u||u;if(!(r instanceof c.lt))throw new Error("'contents' should be a Float64WasmArray");if(r.length!=t*n)throw new Error("length of 'contents' should equal the product of 'rows' and 'columns'");return l.R((function(e){return new e.NumericMatrix(t,n,r.offset,s,o)}),e)}}]),e}()},3102:function(e,t,n){"use strict";n.d(t,{E:function(){return i},z:function(){return a}});var r=n(489);function i(e,t){var n;do{n=e+String(Number(new Date))+"_"+String(Math.round(1e4*Math.random()))+t}while(r.xW(n));return n}function a(e){throw new Error("cannot access the file system in a browser context")}},6961:function(e,t,n){"use strict";n.d(t,{p:function(){return d}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=(n(2306),new WeakMap),f=new WeakMap,h=function(){function e(t,n){(0,r.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,u.Z)(this,c,t),(0,u.Z)(this,f,n)}return(0,i.Z)(e,[{key:"numberOfGroups",value:function(){return(0,s.Z)(this,f).num_groups()}},{key:"numberOfGenes",value:function(){return(0,s.Z)(this,f).num_genes()}},{key:"sums",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).copy,n=void 0===t||t,r=null!==e?(0,s.Z)(this,f).group_sums(e):(0,s.Z)(this,f).all_sums();return l.Yj(r,n)}},{key:"detected",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).copy,n=void 0===t||t,r=null!==e?(0,s.Z)(this,f).group_detected(e):(0,s.Z)(this,f).all_detected();return l.Yj(r,n)}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(o.A((0,s.Z)(this,c)),(0,u.Z)(this,f,null))}}]),e}();function d(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.average,s=void 0!==a&&a,u=i.numberOfThreads,c=void 0===u?null:u,f=l.mV(c);try{if((n=l.de(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'groups' should be equal to number of columns in 'x'");r=o.R((function(t){return t.aggregate_across_cells(e.matrix,n.offset,s,f)}),h)}catch(d){throw l.gd(r),d}finally{l.gd(n)}return r}},5644:function(e,t,n){"use strict";n.d(t,{D4:function(){return l},DS:function(){return u},fw:function(){return o},j4:function(){return s}});var r=n(6635),i=n(6650),a=n(4292);function s(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).buffer,i=void 0===n?null:n,a=0;e.forEach((function(e){a+=e}));try{if(null==i)i=t=r.Wf(a);else if(i.length!==a)throw new Error("'buffer' should have length equal to sum of 'ncells'");for(var s=i.array(),u=0,o=0;o<e.length;o++){var l=u;u+=e[o],s.fill(o,l,u)}}catch(c){throw r.gd(t),c}return i}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.filter,a=void 0===r?null:r,s=n.buffer,u=void 0===s?null:s;return i.n6(e,t,{filter:a,buffer:u})}function o(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).buffer;return u(e,t,{buffer:void 0===n?null:n,filter:!0})}function l(e){return a.fd(e)}},5470:function(e,t,n){"use strict";n.d(t,{KV:function(){return o}});var r=n(7762),i=n(6635),a=n(2306),s=n(7108);function u(e){for(var t=i.GF(e.length),n=t.array(),r=0;r<e.length;r++)n[r]=BigInt(e[r].matrix.$$.ptr);return t}function o(e,t){var n,o,l,c=[],f={};try{if(t.length!==e.length)throw new Error("length of 'names' should be equal to length of 'x'");for(var h={},d=[],v=0;v<t.length;v++){if(e[v].numberOfRows()!==t[v].length)throw new Error("length of each 'names' must equal number of rows of its corresponding 'x'");t[v].forEach((function(e){e in h||(h[e]=d.length,d.push(e))}))}var m=(o=i.GF(e.length)).array(),p=function(){var e=t[v],n=i.Wf(e.length),r=n.array();e.forEach((function(e,t){r[t]=h[e]})),c.push(n),m[v]=BigInt(n.offset)};for(v=0;v<t.length;v++)p();n=u(e),l=i.Wf(e[0].numberOfRows()),f.matrix=s.R((function(t){return t.cbind_with_rownames(e.length,n.offset,o.offset,l.offset)}),a.p),f.indices=l.slice(0,f.matrix.numberOfRows());var Z,w=[],y=(0,r.Z)(f.indices);try{for(y.s();!(Z=y.n()).done;){var b=Z.value;w.push(t[0][b])}}catch(x){y.e(x)}finally{y.f()}f.names=w}catch(E){throw i.gd(f.matrix),E}finally{i.gd(n),i.gd(o),i.gd(l);for(var g=0,_=c;g<_.length;g++){var k=_[g];i.gd(k)}}return f}},6199:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});n(6635),n(4812);function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.copy,i=void 0===r||r,a=n.largest,s=void 0===a||a;return i&&(e=e.slice()),e instanceof Array?e.sort((function(e,t){return e-t})):e.sort(),0==e.length?Number.NaN:s?e[Math.max(0,e.length-t)]:e[Math.min(t,e.length)-1]}},2494:function(e,t,n){"use strict";n.d(t,{eu:function(){return b}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(6635),l=n(7108),c=n(5159),f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakMap,y=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,a.Z)(this,Z,{writable:!0,value:void 0}),(0,a.Z)(this,w,{writable:!0,value:void 0}),(0,u.Z)(this,h,n),(0,u.Z)(this,f,t),(0,u.Z)(this,d,i),(0,u.Z)(this,v,i),(0,u.Z)(this,m,i),(0,u.Z)(this,p,i),(0,u.Z)(this,Z,i),(0,u.Z)(this,w,i)}return(0,i.Z)(e,[{key:"numberOfCells",value:function(){return(0,s.Z)(this,h).num_obs()}},{key:"numberOfClusters",value:function(){return(0,s.Z)(this,h).num_clusters()}},{key:"setIterations",value:function(e){(0,s.Z)(this,Z)||(0,u.Z)(this,Z,!0),(0,s.Z)(this,h).set_iterations(e)}},{key:"setStatus",value:function(e){(0,s.Z)(this,w)||(0,u.Z)(this,w,!0),(0,s.Z)(this,h).set_status(e)}},{key:"clusters",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return o.Hw(a,r,(0,s.Z)(this,d),(function(){(0,u.Z)(e,d,!0)}),(function(t){return o.Yj((0,s.Z)(e,h).clusters(),t)}),"clusters")}},{key:"clusterSizes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return o.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return o.Yj((0,s.Z)(e,h).cluster_sizes(),t)}),"clusterSizes")}},{key:"withinClusterSumSquares",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return o.Hw(a,r,(0,s.Z)(this,p),(function(){(0,u.Z)(e,p,!0)}),(function(t){return o.Yj((0,s.Z)(e,h).wcss(),t)}))}},{key:"clusterCenters",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return o.Hw(a,r,(0,s.Z)(this,m),(function(){(0,u.Z)(e,m,!0)}),(function(t){return o.Yj((0,s.Z)(e,h).centers(),t)}))}},{key:"iterations",value:function(){return(0,s.Z)(this,Z)?(0,s.Z)(this,h).iterations():null}},{key:"status",value:function(){return(0,s.Z)(this,w)?(0,s.Z)(this,h).status():null}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(l.A((0,s.Z)(this,f)),(0,u.Z)(this,h,null))}}]),e}();function b(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.numberOfDims,s=void 0===a?null:a,u=i.numberOfCells,f=void 0===u?null:u,h=i.initMethod,d=void 0===h?"pca-part":h,v=i.initSeed,m=void 0===v?5768:v,p=i.initPCASizeAdjust,Z=void 0===p?1:p,w=i.numberOfThreads,b=void 0===w?null:w,g=o.mV(b);try{var _;if(e instanceof c.RY){s=e.numberOfPCs(),f=e.numberOfCells();var k=e.principalComponents({copy:!1});_=k.byteOffset}else{if(null===s||null===f)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((n=o.de(e,"Float64WasmArray")).length!=s*f)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");_=n.offset}r=l.R((function(e){return e.cluster_kmeans(_,s,f,t,d,m,Z,g)}),y)}catch(x){throw o.gd(r),x}finally{o.gd(n)}return r}},9273:function(e,t,n){"use strict";n.d(t,{ZI:function(){return D},bD:function(){return p}});var r=n(101),i=n(3889),a=n(5671),s=n(3144),u=n(2346),o=n(8916),l=n(2793),c=n(6635),f=n(7108),h=n(7067),d=new WeakMap,v=new WeakMap,m=function(){function e(t,n){(0,a.Z)(this,e),(0,u.Z)(this,d,{writable:!0,value:void 0}),(0,u.Z)(this,v,{writable:!0,value:void 0}),(0,l.Z)(this,d,t),(0,l.Z)(this,v,n)}return(0,s.Z)(e,[{key:"free",value:function(){null!==(0,o.Z)(this,v)&&(f.A((0,o.Z)(this,d)),(0,l.Z)(this,v,null))}},{key:"graph",get:function(){return(0,o.Z)(this,v)}}]),e}();function p(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.scheme,a=void 0===i?"rank":i,s=r.neighbors,u=void 0===s?10:s,o=r.numberOfThreads,l=void 0===o?null:o,d=c.mV(l);c.c2("scheme",a,["rank","number","jaccard"]);try{var v;e instanceof h.qv?v=e:(n=(0,h.wf)(e,u,{numberOfThreads:d}),v=n),t=f.R((function(e){return e.build_snn_graph(v.results,a,d)}),m)}catch(p){throw c.gd(t),p}finally{c.gd(n)}return t}var Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakSet,k=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,a.Z)(this,e),(0,r.Z)(this,_),(0,u.Z)(this,Z,{writable:!0,value:void 0}),(0,u.Z)(this,w,{writable:!0,value:void 0}),(0,u.Z)(this,y,{writable:!0,value:void 0}),(0,u.Z)(this,b,{writable:!0,value:void 0}),(0,u.Z)(this,g,{writable:!0,value:void 0}),(0,l.Z)(this,Z,t),(0,l.Z)(this,w,n),(0,l.Z)(this,y,i),(0,l.Z)(this,b,c.oH(this.numberOfLevels(),i)),(0,l.Z)(this,g,c.oH(this.numberOfLevels(),i))}return(0,s.Z)(e,[{key:"best",value:function(){return(0,o.Z)(this,y)?(0,o.Z)(this,w).best():null}},{key:"setBest",value:function(e){(0,o.Z)(this,y)||(0,l.Z)(this,y,!0),(0,o.Z)(this,w).set_best(e)}},{key:"numberOfLevels",value:function(){return(0,o.Z)(this,w).number()}},{key:"modularity",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).level,t=void 0===e?null:e;return t=(0,i.Z)(this,_,x).call(this,t),(0,o.Z)(this,b)[t]?(0,o.Z)(this,w).modularity(t):null}},{key:"setModularity",value:function(e,t){(0,o.Z)(this,b)[e]||((0,o.Z)(this,b)[e]=!0),(0,o.Z)(this,w).set_modularity(e,t)}},{key:"membership",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.level,r=void 0===n?null:n,a=t.copy,s=void 0===a||a,u=t.fillable,l=void 0!==u&&u;return r=(0,i.Z)(this,_,x).call(this,r),c.Hw(l,s,(0,o.Z)(this,g)[r],(function(){(0,o.Z)(e,g)[r]=!0}),(function(t){return c.Yj((0,o.Z)(e,w).membership(r),t)}))}},{key:"free",value:function(){null!==(0,o.Z)(this,w)&&(f.A((0,o.Z)(this,Z)),(0,l.Z)(this,w,null))}}]),e}();function x(e){if(null===e&&null==(e=this.best()))throw new Error("'best' has not yet been set via 'setBest'");return e}var E=new WeakMap,O=new WeakMap,C=new WeakMap,M=new WeakMap,R=new WeakMap,N=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if((0,a.Z)(this,e),(0,u.Z)(this,E,{writable:!0,value:void 0}),(0,u.Z)(this,O,{writable:!0,value:void 0}),(0,u.Z)(this,C,{writable:!0,value:void 0}),(0,u.Z)(this,M,{writable:!0,value:void 0}),(0,u.Z)(this,R,{writable:!0,value:void 0}),(0,l.Z)(this,E,t),(0,l.Z)(this,O,n),(0,l.Z)(this,C,r),(0,l.Z)(this,R,r),!r){var i=this.numberOfMergeSteps()+1;(0,l.Z)(this,M,{which:c.oH(i,!1),remaining:i})}}return(0,s.Z)(e,[{key:"numberOfMergeSteps",value:function(){return(0,o.Z)(this,O).num_merge_steps()}},{key:"modularity",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).at,t=void 0===e?null:e;if(null===t){if(!(0,o.Z)(this,C))return null;t=-1}else if(!(0,o.Z)(this,C)&&!(0,o.Z)(this,M)[t])return null;return(0,o.Z)(this,O).modularity(t)}},{key:"setModularity",value:function(e,t){(0,o.Z)(this,C)||((0,o.Z)(this,M).which[e]=!0,(0,o.Z)(this,M).remaining--,0==(0,o.Z)(this,M).remaining&&(0,l.Z)(this,C,!0)),(0,o.Z)(this,O).set_modularity(e,t)}},{key:"membership",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return c.Hw(a,r,(0,o.Z)(this,R),(function(){(0,l.Z)(e,R,!0)}),(function(t){return c.Yj((0,o.Z)(e,O).membership(),t)}))}},{key:"free",value:function(){null!==(0,o.Z)(this,O)&&(f.A((0,o.Z)(this,E)),(0,l.Z)(this,O,null))}}]),e}(),S=new WeakMap,A=new WeakMap,W=new WeakMap,j=new WeakMap,I=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,a.Z)(this,e),(0,u.Z)(this,S,{writable:!0,value:void 0}),(0,u.Z)(this,A,{writable:!0,value:void 0}),(0,u.Z)(this,W,{writable:!0,value:void 0}),(0,u.Z)(this,j,{writable:!0,value:void 0}),(0,l.Z)(this,S,t),(0,l.Z)(this,A,n),(0,l.Z)(this,W,r),(0,l.Z)(this,j,r)}return(0,s.Z)(e,[{key:"modularity",value:function(){return(0,o.Z)(this,W)?(0,o.Z)(this,A).modularity():null}},{key:"setModularity",value:function(e){(0,o.Z)(this,W)||(0,l.Z)(this,W,!0),(0,o.Z)(this,A).set_modularity(e)}},{key:"membership",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return c.Hw(a,r,(0,o.Z)(this,j),(function(){(0,l.Z)(e,j,!0)}),(function(t){return c.Yj((0,o.Z)(e,A).membership(),t)}))}},{key:"free",value:function(){null!==(0,o.Z)(this,A)&&(f.A((0,o.Z)(this,S)),(0,l.Z)(this,A,null))}}]),e}();function D(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.method,i=void 0===r?"multilevel":r,a=n.multiLevelResolution,s=void 0===a?1:a,u=n.leidenResolution,o=void 0===u?1:u,l=n.leidenModularityObjective,h=void 0!==l&&l,d=n.walktrapSteps,v=void 0===d?4:d;try{if("multilevel"==i)t=f.R((function(t){return t.cluster_snn_graph_multilevel(e.graph,s)}),k);else if("walktrap"==i)t=f.R((function(t){return t.cluster_snn_graph_walktrap(e.graph,v)}),N);else{if("leiden"!=i)throw new Error("unknown method '"+i+"'");t=f.R((function(t){return t.cluster_snn_graph_leiden(e.graph,o,h)}),I)}}catch(m){throw c.gd(t),m}return t}},4292:function(e,t,n){"use strict";n.d(t,{Yh:function(){return a},fd:function(){return s}});var r=n(6650),i=n(6635);function a(e){return function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.asWasmArray,u=void 0===s||s,o=a.buffer,l=void 0===o?null:o,c=a.action,f=void 0===c?"error":c,h=a.placeholder,d=void 0===h?-1:h,v=[];if("warn"==f){var m=!1;n=function(){m||(console.warn("replacing invalid values with the placeholder index '"+String(d)+"'"),m=!0)}}else if("none"==f)n=function(){};else{if("error"!=f)throw new Error("unknown action '"+f+"' for handling invalid entries");n=function(){throw new Error("detected invalid value (e.g., null, NaN) in 'x'")}}try{if(null==l)l=t=u?i.Wf(e.length):new Int32Array(e.length);else{if(l.length!==e.length)throw new Error("'buffer' should have length equal to that of 'x'");u=l instanceof r.do}for(var p=u?l.array():l,Z=new Map,w=0;w<e.length;w++){var y=e[w];if(null==y||"number"==typeof y&&!Number.isFinite(y))n(),p[w]=d;else{var b=Z.get(y);if("undefined"==typeof b){var g=v.length;Z.set(y,g),v.push(y),p[w]=g}else p[w]=b}}}catch(_){throw i.gd(t),_}return{ids:l,levels:v}}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}function s(e){e instanceof r.PQ&&(e=e.array());var t=new Set(e),n=Array.from(t).sort(),i={};return n.forEach((function(e,t){i[e]=t})),e.forEach((function(t,n){e[n]=i[t]})),n}},8420:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var r=n(7108),i=n(6635);function a(e,t){var n,a;try{if((n=i.de(t,"Uint8WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'filters' must be equal to number of columns in 'x'");var s=n.offset;a=r.R((function(t){return t.filter_cells(e.matrix,s,!1)}),e.constructor)}catch(u){throw i.gd(a),u}finally{i.gd(n)}return a}},7067:function(e,t,n){"use strict";n.d(t,{Fu:function(){return v},qv:function(){return Z},wf:function(){return w}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(6635),l=n(7108),c=n(5159),f=new WeakMap,h=new WeakMap,d=function(){function e(t,n){(0,r.Z)(this,e),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,u.Z)(this,f,t),(0,u.Z)(this,h,n)}return(0,i.Z)(e,[{key:"numberOfCells",value:function(){return(0,s.Z)(this,h).num_obs()}},{key:"numberOfDims",value:function(){return(0,s.Z)(this,h).num_dim()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(l.A((0,s.Z)(this,f)),(0,u.Z)(this,h,null))}},{key:"index",get:function(){return(0,s.Z)(this,h)}}]),e}();function v(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.numberOfDims,a=void 0===i?null:i,s=r.numberOfCells,u=void 0===s?null:s,f=r.approximate,h=void 0===f||f;try{var v;if(e instanceof c.RY){a=e.numberOfPCs(),u=e.numberOfCells();var m=e.principalComponents({copy:!1});v=m.byteOffset}else{if(null===a||null===u)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((t=o.de(e,"Float64WasmArray")).length!=a*u)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");v=t.offset}n=l.R((function(e){return e.build_neighbor_index(v,a,u,h)}),d)}catch(p){throw o.gd(n),p}finally{o.gd(t)}return n}var m=new WeakMap,p=new WeakMap,Z=function(){function e(t,n){(0,r.Z)(this,e),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,m,t),(0,u.Z)(this,p,n)}return(0,i.Z)(e,[{key:"size",value:function(){return(0,s.Z)(this,p).size()}},{key:"numberOfCells",value:function(){return(0,s.Z)(this,p).num_obs()}},{key:"results",get:function(){return(0,s.Z)(this,p)}},{key:"serialize",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.runs,u=void 0===a?null:a,l=i.indices,c=void 0===l?null:l,f=i.distances,h=void 0===f?null:f,d=(null===u)+(null===c)+(null===h);if(3!=d&&0!=d)throw new Error("either all or none of 'runs', 'indices' and 'distances' can be 'null'");if(3===d)try{t=o.Wf(this.numberOfCells());var v=this.size();n=o.Wf(v),r=o.RJ(v),(0,s.Z)(this,p).serialize(t.offset,n.offset,r.offset),e={runs:t.slice(),indices:n.slice(),distances:r.slice()}}finally{o.gd(t),o.gd(n),o.gd(r)}else(0,s.Z)(this,p).serialize(u.offset,c.offset,h.offset),e={runs:u.array(),indices:c.array(),distances:h.array()};return e}},{key:"free",value:function(){null!==(0,s.Z)(this,p)&&(l.A((0,s.Z)(this,m)),(0,u.Z)(this,p,null))}}],[{key:"unserialize",value:function(t,n,r){var i,a,s,u;try{a=o.de(t,"Int32WasmArray"),s=o.de(n,"Int32WasmArray"),u=o.de(r,"Float64WasmArray"),i=l.R((function(e){return new e.NeighborResults(t.length,a.offset,s.offset,u.offset)}),e)}catch(c){throw o.gd(i),c}finally{o.gd(a),o.gd(s),o.gd(u)}return i}}]),e}();function w(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).numberOfThreads,r=void 0===n?null:n,i=o.mV(r);return l.R((function(n){return n.find_nearest_neighbors(e.index,t,i)}),Z)}},9283:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});var r=n(8782),i=n(6635),a=(n(2306),n(6650));function s(e,t){var n,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=u.center,l=void 0===o||o,c=u.buffer,f=void 0===c?null:c,h=u.priorCount,d=void 0===h?10:h,v=u.reference,m=void 0===v?null:v,p=u.numberOfThreads,Z=void 0===p?null:p,w=i.mV(Z);try{if(f instanceof a.lt){if(f.length!==e.numberOfColumns())throw new Error("length of 'buffer' must be equal to the number of columns in 'x'")}else n=i.RJ(e.numberOfColumns()),f=n;s=i.de(t,"Int32WasmArray"),null==m&&(m=-1),r.RE((function(t){return t.grouped_size_factors(e.matrix,s.offset,l,d,m,f.offset,w)}))}catch(y){throw i.gd(n),y}finally{i.gd(s)}return f}},2284:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r=n(7762);function i(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).forceTaxonomy,n=void 0!==t&&t,i=e.length,a=Math.ceil(i/2),s=function(e){return e.confidence/=i,e};e=new Set(e);var u=0,o=0,l=0,c=0,f=0,h=0,d=0,v=0,m=0,p=0,Z=0,w=0,y=n?"9606":"human",b=n?"10090":"mouse",g=[],_=0;if(e.forEach((function(e){e&&e.match(/^ENS[A-Z]*G[0-9]{11}$/)&&_++})),_){e.forEach((function(e){e&&(e.startsWith("ENSG")?u++:e.startsWith("ENSMUSG")?o++:e.startsWith("ENSRNOG")?c++:e.startsWith("ENSMFAG")?f++:e.startsWith("ENSDARG")?d++:e.startsWith("ENSPTRG")&&v++)})),g.push({species:y,type:"ensembl",confidence:u}),g.push({species:b,type:"ensembl",confidence:o}),g.push({species:"10116",type:"ensembl",confidence:c}),g.push({species:"9541",type:"ensembl",confidence:f}),g.push({species:"7955",type:"ensembl",confidence:d}),g.push({species:"9598",type:"ensembl",confidence:v});var k,x=(0,r.Z)(g);try{for(x.s();!(k=x.n()).done;){var E=k.value;if(E.confidence>=a)return s(E)}}catch(j){x.e(j)}finally{x.f()}}e.forEach((function(e){e&&e.match(/^[A-Z][^a-z]+$/)&&!e.match(/^ENS[A-Z]+[0-9]{11}/)&&m++}));var O={species:y,type:"symbol",confidence:m};if(O.confidence>=a)return s(O);g.push(O),e.forEach((function(e){e&&e.match(/^[A-Z][^A-Z]+$/)&&p++}));var C={species:b,type:"symbol",confidence:p};if(C.confidence>=a)return s(C);g.push(C),e.forEach((function(e){e&&e.match(/^WBGene[0-9]+$/)&&l++}));var M={species:"6239",type:"ensembl",confidence:l};if(M.confidence>=a)return s(M);g.push(M),e.forEach((function(e){e&&e.match(/^FBgn[0-9]+$/)&&h++}));var R={species:"7227",type:"ensembl",confidence:h};if(R.confidence>=a)return s(R);g.push(R),e.forEach((function(e){e&&e.match(/^[a-z]{3,}-[0-9]+$/)&&Z++}));var N={species:"6239",type:"symbol",confidence:Z};if(N.confidence>=a)return s(N);g.push(N),e.forEach((function(e){e&&e.match(/^[a-z]{3,}[0-9a-z]+$/)&&w++}));var S={species:"7955",type:"symbol",confidence:w};if(S.confidence>=a)return s(S);g.push(S);for(var A=g[0],W=1;W<g.length;W++)g[W].confidence>A.confidence&&(A=g[W]);return s(A)}},5538:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(6635),i=n(8782);function a(e,t,n,a){var s,u,o,l,c,f,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=h.numberOfThreads,v=void 0===d?null:d,m=h.assumeSorted,p=void 0!==m&&m,Z=r.mV(v),w=null,y=function(e,t,n){if(null!==n&&e.length!==n)throw new Error("array inputs must have the same length (failing for '"+t+"')");return e.length};"number"==typeof e?e=[e]:w=y(e,"markersInSet",w),"number"==typeof t?t=[t]:w=y(t,"numberOfMarkers",w),"number"==typeof n?n=[n]:w=y(n,"featureSetSize",w),"number"==typeof a?a=[a]:w=y(a,"numberOfFeatures",w),null==w&&(w=1);try{s=r.de(e,"Int32WasmArray"),u=r.de(t,"Int32WasmArray"),o=r.de(n,"Int32WasmArray"),l=r.de(a,"Int32WasmArray"),f=r.RJ(w),i.RE((function(e){return e.hypergeometric_test(w,1!=s.length,s.offset,1!=o.length,o.offset,1!=u.length,u.offset,1!=l.length,l.offset,p,f.offset,Z)})),c=f.slice()}finally{r.gd(s),r.gd(u),r.gd(o),r.gd(l),r.gd(f)}return c}},8311:function(e,t,n){"use strict";n.d(t,{Bp:function(){return d},EF:function(){return c},N6:function(){return f},_3:function(){return u},gP:function(){return h},us:function(){return l}});var r=n(7108),i=n(8782),a=n(6635),s=n(2306);function u(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=i.compressed,l=void 0===u?null:u,c=i.layered,f=void 0===c||c,h=null;try{l=o(l),"string"!==typeof e?(t=a.de(e,"Uint8WasmArray"),n=r.R((function(e){return e.read_matrix_market_from_buffer(t.offset,t.length,l,f)}),s.p)):n=r.R((function(t){return t.read_matrix_market_from_file(e,l,f)}),s.p),n.isReorganized()&&(h=n.identities(),n.wipeIdentities())}catch(d){throw a.gd(n),d}finally{a.gd(t)}return{matrix:n,row_ids:h}}function o(e){return null===e?-1:e?1:0}function l(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).compressed,r=void 0===n?null:n,s=a.RJ(3),u={};try{r=o(r),"string"!==typeof e?(t=a.de(e,"Uint8WasmArray"),i.RE((function(e){return e.read_matrix_market_header_from_buffer(t.offset,t.length,r,s.offset)}))):i.RE((function(t){return t.read_matrix_market_header_from_file(e,r,s.offset)}));var l=s.array();u.rows=l[0],u.columns=l[1],u.lines=l[2]}finally{a.gd(t),a.gd(s)}return u}function c(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=i.forceInteger,o=void 0===u||u,l=i.layered,c=void 0===l||l,f=null;try{(n=r.R((function(n){return n.read_hdf5_matrix(e,t,o,c)}),s.p)).isReorganized()&&(f=n.identities(),n.wipeIdentities())}catch(h){throw a.gd(n),h}return{matrix:n,row_ids:f}}function f(e,t){var n={},r=a.Wf(5);try{i.RE((function(n){return n.extract_hdf5_matrix_details(e,t,r.offset)}));var s=r.array();s[0]>0?n.format="dense":s[1]>0?n.format="csc":n.format="csr",n.rows=s[2],n.columns=s[3],n.integer=s[4]>0}finally{r.free()}return n}function h(e,t,n){var i,u,o=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).forceInteger,l=void 0!==o&&o;try{i=a.de(n,null),u=r.R((function(n){return n.initialize_dense_matrix(e,t,i.offset,i.constructor.className.replace("Wasm",""),l)}),s.p)}catch(c){throw a.gd(u),c}finally{a.gd(i)}return u}function d(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.consume,u=void 0!==i&&i,o=n.forceInteger,l=void 0===o||o,c=n.layered,f=void 0===c||c,h=null;try{(t=r.R((function(t){return t.initialize_sparse_matrix_from_rds(e.object.$$.ptr,l,f,u)}),s.p)).isReorganized()&&(h=t.identities(),t.wipeIdentities())}catch(d){throw a.gd(t),d}return{matrix:t,row_ids:h}}},6807:function(e,t,n){"use strict";n.d(t,{H:function(){return a},R:function(){return s}});var r=n(6635),i=n(8782);function a(e,t,n){var i,a;try{var s=0,u=!1;if(null!==t){if((i=r.de(t,"Int32WasmArray")).length!=e.numberOfCells())throw new Error("'block' must be of length equal to the number of cells in 'metrics'");u=!0,s=i.offset}a=n(e,u,s)}catch(o){throw r.gd(a),o}finally{r.gd(i)}return a}function s(e,t,n,a){var s,u,o;try{var l,c=0,f=!1;if(null!==n){if((s=r.de(n,"Int32WasmArray")).length!=t.numberOfCells())throw new Error("'block' must be of length equal to the number of cells in 'metrics'");f=!0,c=s.offset}if(null==a)u=r.TS(t.numberOfCells()),l=u.offset;else{if(a.length!=t.numberOfCells())throw new Error("'buffer' must be of length equal to the number of cells in 'metrics'");l=a.offset}i.RE((function(n){return e.filter(t.results.$$.ptr,f,c,l)})),o=null==a?u.slice():a.array()}catch(h){throw r.gd(o),h}finally{r.gd(s),r.gd(u)}return o}},6078:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});n(8782);var r=n(6635);n(6650);function i(e,t,n){var i,a,s=[];try{var u=0,o=0;if(null!=t){u=t.length,o=(a=r.GF(u)).offset;for(var l=a.array(),c=0;c<u;c++){var f=r.de(t[c],"Uint8WasmArray");if(f.length!=e.numberOfRows())throw new Error("length of each array in 'subsets' should be equal to the matrix rows");s.push(f),l[c]=BigInt(f.offset)}}i=n(e.matrix,u,o)}catch(m){throw r.gd(i),m}finally{r.gd(a);for(var h=0,d=s;h<d.length;h++){var v=d[h];r.gd(v)}}return i}},6774:function(e,t,n){"use strict";n.d(t,{C:function(){return s},b:function(){return a}});var r=n(7762),i=n(6635);function a(e,t){var n,i=new TextDecoder,a=[],s=0,u=(0,r.Z)(t);try{for(u.s();!(n=u.n()).done;){var o=n.value,l=e.slice(s,s+o);a.push(i.decode(l)),s+=o}}catch(c){u.e(c)}finally{u.f()}return a}function s(e){var t,n,a,s=(0,r.Z)(e);try{for(s.s();!(a=s.n()).done;){if("string"!=typeof a.value)throw new Error("all entries of 'x' should be strings for a string HDF5 dataset")}}catch(h){s.e(h)}finally{s.f()}try{var u=(n=i.Wf(e.length)).array(),o=0,l=new TextEncoder,c=new Array(e.length);e.forEach((function(e,t){var n=l.encode(e);u[t]=n.length,c[t]=n,o+=n.length}));var f=(t=i.TS(o)).array();o=0,c.forEach((function(e){f.set(e,o),o+=e.length}))}catch(d){throw i.gd(t),i.gd(n),d}return[n,t]}},3779:function(e,t,n){"use strict";n.d(t,{Os:function(){return F},Qj:function(){return j},St:function(){return k},pG:function(){return N},tY:function(){return Z}});var r=n(7762),i=n(5671),a=n(3144),s=n(2346),u=n(8916),o=n(2793),l=n(7108),c=(n(8782),n(6635)),f=n(2306),h=n(6650),d=n(8311),v=new WeakMap,m=new WeakMap,p=function(){function e(t,n){(0,i.Z)(this,e),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,o.Z)(this,v,t),(0,o.Z)(this,m,n)}return(0,a.Z)(e,[{key:"reference",get:function(){return(0,u.Z)(this,m)}},{key:"numberOfSamples",value:function(){return(0,u.Z)(this,m).num_samples()}},{key:"numberOfFeatures",value:function(){return(0,u.Z)(this,m).num_features()}},{key:"numberOfLabels",value:function(){return(0,u.Z)(this,m).num_labels()}},{key:"free",value:function(){null!==(0,u.Z)(this,m)&&(l.A((0,u.Z)(this,v)),(0,o.Z)(this,m,null))}}]),e}();function Z(e,t,n){var r,i,a,s;try{i=c.de(e,"Uint8WasmArray"),a=c.de(t,"Uint8WasmArray"),s=c.de(n,"Uint8WasmArray"),r=l.R((function(e){return e.load_singlepp_reference(s.offset,s.length,a.offset,a.length,i.offset,i.length)}),p)}catch(u){throw c.gd(r),u}finally{c.gd(i),c.gd(a),c.gd(s)}return r}var w=new WeakMap,y=new WeakMap,b=function(){function e(t,n){(0,i.Z)(this,e),(0,s.Z)(this,w,{writable:!0,value:void 0}),(0,s.Z)(this,y,{writable:!0,value:void 0}),(0,o.Z)(this,w,t),(0,o.Z)(this,y,n)}return(0,a.Z)(e,[{key:"reference",get:function(){return(0,u.Z)(this,y)}},{key:"sharedFeatures",value:function(){return(0,u.Z)(this,y).shared_features()}},{key:"free",value:function(){null!==(0,u.Z)(this,y)&&(l.A((0,u.Z)(this,w)),(0,o.Z)(this,y,null))}}]),e}();function g(e,t){for(var n=new Map,r=0;r<e.length;r++){var i=e[r];null!==i&&(n.has(i)||n.set(i,r)),t[r]=r}return{contents:n,counter:e.length}}function _(e,t,n){for(var i=new Set,a=function(e,r){var a=t.contents.get(e);return"undefined"!==typeof a&&!i.has(a)&&(n[r]=a,i.add(a),!0)},s=t.counter,u=0;u<e.length;u++){var o=e[u],l=!1;if(null!==o)if(o instanceof Array){var c,f=(0,r.Z)(o);try{for(f.s();!(c=f.n()).done;){if(a(c.value,u)){l=!0;break}}}catch(h){f.e(h)}finally{f.f()}}else l=a(o,u);l||(n[u]=s,++s)}}function k(e,t,n){var r,i,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=s.top,o=void 0===u?20:u,f=s.numberOfThreads,h=void 0===f?null:f,d=c.mV(h);try{var v=e.length;if(r=c.Wf(v),i=c.Wf(t.numberOfFeatures()),n.length!=i.length)throw new Error("length of 'referenceFeatures' should be equal to the number of features in 'reference'");_(n,g(e,r.array()),i.array()),(a=l.R((function(e){return e.build_singlepp_reference(v,r.offset,t.reference,i.offset,o,d)}),b)).expectedNumberOfFeatures=v}catch(m){throw c.gd(a),m}finally{c.gd(r),c.gd(i)}return a}var x=new WeakMap,E=new WeakMap,O=new WeakMap,C=new WeakMap,M=function(){function e(t,n){(0,i.Z)(this,e),(0,s.Z)(this,x,{writable:!0,value:void 0}),(0,s.Z)(this,E,{writable:!0,value:void 0}),(0,s.Z)(this,O,{writable:!0,value:void 0}),(0,s.Z)(this,C,{writable:!0,value:void 0}),(0,o.Z)(this,x,t),(0,o.Z)(this,E,n)}return(0,a.Z)(e,[{key:"numberOfLabels",value:function(){return(0,u.Z)(this,E).num_labels()}},{key:"numberOfCells",value:function(){return(0,u.Z)(this,E).num_samples()}},{key:"predictedLabels",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj((0,u.Z)(this,E).get_best(),t)}},{key:"scoresForCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.copy,r=void 0===n||n,i=t.buffer,a=void 0===i?null:i;if(null==a)return"undefined"==typeof(0,u.Z)(this,O)&&(0,o.Z)(this,O,c.RJ((0,u.Z)(this,E).num_labels())),(0,u.Z)(this,E).get_scores_for_sample(e,(0,u.Z)(this,O).offset),c.Yj((0,u.Z)(this,O).array(),r);if(a.length!==(0,u.Z)(this,E).num_labels())throw new Error("length of 'buffer' should equal the number of labels");return(0,u.Z)(this,E).get_scores_for_sample(e,a.offset),a}},{key:"scoresForLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.copy,r=void 0===n||n,i=t.buffer,a=void 0===i?null:i;if(null==a)return"undefined"==typeof(0,u.Z)(this,C)&&(0,o.Z)(this,C,c.RJ((0,u.Z)(this,E).num_samples())),(0,u.Z)(this,E).get_scores_for_label(e,(0,u.Z)(this,C).offset),c.Yj((0,u.Z)(this,C).array(),r);if(a.length!==(0,u.Z)(this,E).num_samples())throw new Error("length of 'buffer' should equal the number of cells");return(0,u.Z)(this,E).get_scores_for_label(e,a.offset),c.Yj((0,u.Z)(this,C).array(),r)}},{key:"fineTuningDelta",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj((0,u.Z)(this,E).get_delta(),t)}},{key:"free",value:function(){null!==(0,u.Z)(this,E)&&(l.A((0,u.Z)(this,x)),(0,o.Z)(this,E,null),c.gd((0,u.Z)(this,C)),c.gd((0,u.Z)(this,O)))}}]),e}();function R(e,t,n,r,i,a){var s,u=null;try{var o;if(e instanceof f.p)o=e.matrix;else{if(!(e instanceof h.lt))throw new Error("unknown type for 'x'");o=(s=d.gP(n,r,e,{forceInteger:!1})).matrix}if(o.nrow()!=t)throw new Error("number of rows in 'x' should be equal to length of 'features' used to build '"+a+"'");u=i(o)}finally{c.gd(undefined),c.gd(s)}return u}function N(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.numberOfFeatures,i=void 0===r?null:r,a=n.numberOfCells,s=void 0===a?null:a,u=n.quantile,o=void 0===u?.8:u,f=n.numberOfThreads,h=void 0===f?null:f,d=c.mV(h);return R(e,t.expectedNumberOfFeatures,i,s,(function(e,n){return l.R((function(n){return n.run_singlepp(e,t.reference,o,d)}),M)}),"reference")}var S=new WeakMap,A=new WeakMap,W=function(){function e(t,n){(0,i.Z)(this,e),(0,s.Z)(this,S,{writable:!0,value:void 0}),(0,s.Z)(this,A,{writable:!0,value:void 0}),(0,o.Z)(this,S,t),(0,o.Z)(this,A,n)}return(0,a.Z)(e,[{key:"integrated",get:function(){return(0,u.Z)(this,A)}},{key:"numberOfReferences",value:function(){return(0,u.Z)(this,A).num_references()}},{key:"free",value:function(){null!==(0,u.Z)(this,A)&&(l.A((0,u.Z)(this,S)),(0,o.Z)(this,A,null))}}]),e}();function j(e,t,n,r){var i,a,s,u,o,f=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:{}).numberOfThreads,h=void 0===f?null:f,d=c.mV(h),v=t.length;if(n.length!=v)throw new Error("'loaded' and 'referenceFeatures' should be of the same length");if(r.length!=v)throw new Error("'loaded' and 'built' should be of the same length");for(var m=0;m<v;m++)if(t[m].numberOfFeatures()!=n[m].length)throw new Error("length of each 'referenceFeatures' should be equal to the number of features in the corresponding 'loaded'");var p=new Array(v);try{i=c.Wf(e.length);var Z=g(e,i.array()),w=(a=c.GF(v)).array();for(m=0;m<v;m++)w[m]=BigInt(t[m].reference.$$.ptr);var y=(s=c.GF(v)).array();for(m=0;m<v;m++){var b=n[m];p[m]=c.Wf(b.length),_(b,Z,p[m].array()),y[m]=BigInt(p[m].offset)}var k=(u=c.GF(v)).array();for(m=0;m<v;m++)k[m]=BigInt(r[m].reference.$$.ptr);(o=l.R((function(t){return t.integrate_singlepp_references(e.length,i.offset,v,a.offset,s.offset,u.offset,d)}),W)).expectedNumberOfFeatures=e.length}catch(C){throw c.gd(o),C}finally{c.gd(i),c.gd(a),c.gd(u),c.gd(s);for(var x=0,E=p;x<E.length;x++){var O=E[x];c.gd(O)}}return o}var I=new WeakMap,D=function(){function e(t){(0,i.Z)(this,e),(0,s.Z)(this,I,{writable:!0,value:void 0}),(0,o.Z)(this,I,t)}return(0,a.Z)(e,[{key:"numberOfReferences",value:function(){return(0,u.Z)(this,I).numberOfLabels()}},{key:"numberOfCells",value:function(){return(0,u.Z)(this,I).numberOfCells()}},{key:"predictedReferences",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj((0,u.Z)(this,I).predictedLabels(),t)}},{key:"scoresForCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.copy,r=void 0===n||n,i=t.buffer,a=void 0===i?null:i;return(0,u.Z)(this,I).scoresForCell(e,{copy:r,buffer:a})}},{key:"scoresForReference",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.copy,r=void 0===n||n,i=t.buffer,a=void 0===i?null:i;return(0,u.Z)(this,I).scoresForLabel(e,{copy:r,buffer:a})}},{key:"fineTuningDelta",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj((0,u.Z)(this,I).fineTuningDelta(),t)}},{key:"free",value:function(){null!==(0,u.Z)(this,I)&&((0,u.Z)(this,I).free(),(0,o.Z)(this,I,null))}}]),e}();function F(e,t,n){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.numberOfFeatures,u=void 0===s?null:s,o=a.numberOfCells,h=void 0===o?null:o,d=a.quantile,v=void 0===d?.8:d,m=a.numberOfThreads,p=void 0===m?null:m,Z=n.numberOfReferences();if(t.length!=Z)throw new Error("length of 'assigned' should be equal to the number of references in 'integrated'");var w=new Array(Z),y=c.mV(p);try{for(var b=(i=c.GF(Z)).array(),g=0;g<t.length;g++){var _=t[g];_ instanceof M&&(_=_.predictedLabels({copy:"view"}));var k=!1;if(e instanceof f.p?_.length!=e.numberOfColumns()&&(k=!0):_.length!=h&&(k=!0),k)throw new Error("length of each element in 'assigned' should be equal to number of columns in 'x'");w[g]=c.de(_,"Int32WasmArray"),b[g]=BigInt(w[g].offset)}r=R(e,n.expectedNumberOfFeatures,u,h,(function(e,t){return l.R((function(t){return t.integrate_singlepp(e,b.offset,n.integrated,v,y)}),M)}),"integrated")}finally{c.gd(i);for(var x=0,E=w;x<E.length;x++){var O=E[x];c.gd(O)}}return new D(r)}},1184:function(e,t,n){"use strict";n.d(t,{g:function(){return u},v:function(){return o}});var r=n(7108),i=n(6635),a=n(6650),s=n(8782);function u(e){var t,n,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=s.sizeFactors,o=void 0===u?null:u,l=s.center,c=void 0===l||l,f=s.block,h=void 0===f?null:f,d=s.allowZeros,v=void 0!==d&&d;try{var m=0,p=!1;if(null!==o){if((t=i.de(o,"Float64WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'sizeFactors' must be equal to number of columns in 'x'");m=t.offset,p=!0}var Z=0,w=!1;if(null!==h){if((n=i.de(h,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");w=!0,Z=n.offset}a=r.R((function(t){return t.log_norm_counts(e.matrix,p,m,w,Z,c,v)}),e.constructor)}catch(y){throw i.gd(a),y}finally{i.gd(t),i.gd(n)}return a}function o(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=r.block,o=void 0===u?null:u,l=r.buffer,c=void 0===l?null:l;try{null===c&&(t=i.RJ(e.length),c=t),c!==e&&c.set(e instanceof a.PQ?e.array():e);var f=0,h=!1;if(null!==o){if((n=i.de(o,"Int32WasmArray")).length!=c.length)throw new Error("'block' must be of length equal to that of 'sizeFactors'");h=!0,f=n.offset}s.RE((function(e){return e.center_size_factors(c.length,c.offset,h,f)}))}catch(d){throw i.gd(t),d}finally{i.gd(n)}return c}},5696:function(e,t,n){"use strict";n.d(t,{F:function(){return s}});var r=n(6635),i=n(5159),a=n(8782);function s(e,t){var n,s,u,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=o.buffer,c=void 0===l?null:l,f=o.numberOfDims,h=void 0===f?null:f,d=o.numberOfCells,v=void 0===d?null:d,m=o.k,p=void 0===m?15:m,Z=o.numberOfMADs,w=void 0===Z?3:Z,y=o.robustIterations,b=void 0===y?2:y,g=o.robustTrim,_=void 0===g?.25:g,k=o.referencePolicy,x=void 0===k?"max-rss":k,E=o.approximate,O=void 0===E||E,C=o.numberOfThreads,M=void 0===C?null:C,R=r.mV(M);try{if(e instanceof i.RY)h=e.numberOfPCs(),v=e.numberOfCells(),e=e.principalComponents({copy:"view"});else{if(null===h||null===v||h*v!==e.length)throw new Error("length of 'x' must be equal to the product of 'numberOfDims' and 'numberOfCells'");s=r.de(e,"Float64WasmArray"),e=s}if(null==c)n=r.RJ(v*h),c=n;else if(c.length!==e.length)throw new Error("length of 'buffer' must be equal to the product of the number of dimensions and cells");if((u=r.de(t,"Int32WasmArray")).length!=v)throw new Error("'block' must be of length equal to the number of cells in 'x'");a.RE((function(t){return t.mnn_correct(h,v,e.offset,u.offset,c.offset,p,w,b,_,x,O,R)}))}catch(N){throw r.gd(n),N}finally{r.gd(s)}return c}},4812:function(e,t,n){"use strict";n.d(t,{rY:function(){return g}});var r=n(5671),i=n(3144),a=n(101),s=n(2346),u=n(3889),o=n(8916),l=n(2793),c=n(7108),f=n(6635),h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakSet,y=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,w),(0,s.Z)(this,h,{writable:!0,value:void 0}),(0,s.Z)(this,d,{writable:!0,value:void 0}),(0,s.Z)(this,v,{writable:!0,value:void 0}),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),(0,l.Z)(this,h,t),(0,l.Z)(this,d,n),(0,l.Z)(this,v,f.oH(this.numberOfBlocks()+1,i)),(0,l.Z)(this,m,f.oH(this.numberOfBlocks()+1,i)),(0,l.Z)(this,p,f.oH(this.numberOfBlocks()+1,i)),(0,l.Z)(this,Z,f.oH(this.numberOfBlocks()+1,i))}return(0,i.Z)(e,[{key:"means",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,n=void 0===t?null:t,r=e.copy,i=void 0===r||r,a=e.fillable,s=void 0!==a&&a;return(0,u.Z)(this,w,b).call(this,n,i,s,(0,o.Z)(this,v),"means")}},{key:"variances",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,n=void 0===t?null:t,r=e.copy,i=void 0===r||r,a=e.fillable,s=void 0!==a&&a;return(0,u.Z)(this,w,b).call(this,n,i,s,(0,o.Z)(this,m),"variances")}},{key:"fitted",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,n=void 0===t?null:t,r=e.copy,i=void 0===r||r,a=e.fillable,s=void 0!==a&&a;return(0,u.Z)(this,w,b).call(this,n,i,s,(0,o.Z)(this,p),"fitted")}},{key:"residuals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.block,n=void 0===t?null:t,r=e.copy,i=void 0===r||r,a=e.fillable,s=void 0!==a&&a;return(0,u.Z)(this,w,b).call(this,n,i,s,(0,o.Z)(this,Z),"residuals")}},{key:"numberOfBlocks",value:function(){return(0,o.Z)(this,d).num_blocks()}},{key:"free",value:function(){null!==(0,o.Z)(this,d)&&(c.A((0,o.Z)(this,h)),(0,l.Z)(this,d,null))}}]),e}();function b(e,t,n,r,i){var a=this,s=e;if(null==e){var u=this.numberOfBlocks();s=u>1?u:0,e=-1}return f.Hw(n,t,r[s],(function(){r[s]=!0}),(function(t){return f.Yj((0,o.Z)(a,d)[i](e),t)}))}function g(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.block,a=void 0===i?null:i,s=r.span,u=void 0===s?.3:s,o=r.numberOfThreads,l=void 0===o?null:o,h=f.mV(l);try{var d=0,v=!1;if(null!==a){if((t=f.de(a,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");v=!0,d=t.offset}n=c.R((function(t){return t.model_gene_var(e.matrix,v,d,u,h)}),y)}catch(m){throw f.gd(n),m}finally{f.gd(t)}return n}},9206:function(e,t,n){"use strict";n.d(t,{dH:function(){return Z},yf:function(){return p}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=n(6078),f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,f,t),(0,u.Z)(this,h,n),(0,u.Z)(this,d,i),(0,u.Z)(this,v,i),(0,u.Z)(this,m,l.oH(this.numberOfSubsets(),i))}return(0,i.Z)(e,[{key:"results",get:function(){return(0,s.Z)(this,h)}},{key:"sums",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,d),(function(){(0,u.Z)(e,d,!0)}),(function(t){return l.Yj((0,s.Z)(e,h).sums(),t)}))}},{key:"detected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,h).detected(),t)}))}},{key:"subsetTotals",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copy,i=void 0===r||r,a=n.fillable,u=void 0!==a&&a;return l.Hw(u,i,(0,s.Z)(this,m)[e],(function(){(0,s.Z)(t,m)[e]=!0}),(function(n){return l.Yj((0,s.Z)(t,h).subset_totals(e),n)}))}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,h).num_subsets()}},{key:"numberOfCells",value:function(){return(0,s.Z)(this,h).num_cells()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(o.A((0,s.Z)(this,f)),(0,u.Z)(this,h,null))}}]),e}();function Z(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).numberOfThreads,r=void 0===n?null:n,i=l.mV(r);return c.$(e,t,(function(e,t,n){return o.R((function(r){return r.per_cell_adt_qc_metrics(e,t,n,i)}),p)}))}},2945:function(e,t,n){"use strict";n.d(t,{J4:function(){return Z},UY:function(){return p}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=new WeakMap,f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,c,t),(0,u.Z)(this,f,n),(0,u.Z)(this,h,i),(0,u.Z)(this,d,i),(0,u.Z)(this,v,i),(0,u.Z)(this,m,i)}return(0,i.Z)(e,[{key:"results",get:function(){return(0,s.Z)(this,f)}},{key:"sums",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,h),(function(){(0,u.Z)(e,h,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).sums(),t)}))}},{key:"detected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,d),(function(){(0,u.Z)(e,d,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).detected(),t)}),"detected")}},{key:"maxProportions",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).max_proportion(),t)}))}},{key:"maxIndex",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,m),(function(){(0,u.Z)(e,m,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).max_index(),t)}),"maxIndex")}},{key:"numberOfCells",value:function(){return(0,s.Z)(this,f).num_cells()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(o.A((0,s.Z)(this,c)),(0,u.Z)(this,f,null))}}]),e}();function Z(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).numberOfThreads,n=void 0===t?null:t,r=l.mV(n);return o.R((function(t){return t.per_cell_crispr_qc_metrics(e.matrix,r)}),p)}},5448:function(e,t,n){"use strict";n.d(t,{eD:function(){return p},wj:function(){return Z}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=n(6078),f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,f,t),(0,u.Z)(this,h,n),(0,u.Z)(this,d,i),(0,u.Z)(this,v,i),(0,u.Z)(this,m,l.oH(this.numberOfSubsets(),i))}return(0,i.Z)(e,[{key:"results",get:function(){return(0,s.Z)(this,h)}},{key:"sums",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,d),(function(){(0,u.Z)(e,d,!0)}),(function(t){return l.Yj((0,s.Z)(e,h).sums(),t)}))}},{key:"detected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,h).detected(),t)}))}},{key:"subsetProportions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copy,i=void 0===r||r,a=n.fillable,u=void 0!==a&&a;return l.Hw(u,i,(0,s.Z)(this,m)[e],(function(){(0,s.Z)(t,m)[e]=!0}),(function(n){return l.Yj((0,s.Z)(t,h).subset_proportions(e),n)}))}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,h).num_subsets()}},{key:"numberOfCells",value:function(){return(0,s.Z)(this,h).num_cells()}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(o.A((0,s.Z)(this,f)),(0,u.Z)(this,h,null))}}]),e}();function Z(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).numberOfThreads,r=void 0===n?null:n,i=l.mV(r);return c.$(e,t,(function(e,t,n){return o.R((function(r){return r.per_cell_rna_qc_metrics(e,t,n,i)}),p)}))}},6974:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var r=n(2494),i=n(1184),a=n(9283),s=n(5159),u=n(6635);function o(e){var t,n,o,l,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=c.numberOfClusters,h=void 0===f?20:f,d=c.numberOfPCs,v=void 0===d?25:d,m=c.totals,p=void 0===m?null:m,Z=c.block,w=void 0===Z?null:Z,y=c.buffer,b=void 0===y?null:y,g=c.numberOfThreads,_=void 0===g?null:g;try{t=(0,i.g)(e,{sizeFactors:p,block:w}),n=(0,s.dO)(t,{numberOfPCs:Math.min(t.numberOfRows()-1,v),numberOfThreads:_,block:w,blockMethod:"weight"})}finally{u.gd(t)}try{o=(0,r.eu)(n,h,{numberOfThreads:_})}finally{u.gd(n)}try{if(null===b)b=l=u.RJ(e.numberOfColumns());else if(b.length!==e.numberOfColumns())throw new Error("length of 'buffer' should be equal to the number of columns in 'x'");(0,a.S)(e,o.clusters({copy:"view"}),{buffer:b,numberOfThreads:_})}catch(k){throw u.gd(l),k}finally{u.gd(o)}return b}},6663:function(e,t,n){"use strict";n.d(t,{BA:function(){return g},D6:function(){return p},II:function(){return y},SV:function(){return b},p$:function(){return C},qu:function(){return m}});var r=n(2346),i=n(8916),a=n(2793),s=n(136),u=n(9388),o=n(5671),l=n(3144),c=n(6635),f=n(8782),h=n(7108),d=n(6774),v=function(){function e(t,n,r){(0,o.Z)(this,e),this.id=t,this.object=n,this.parent=r}return(0,l.Z)(e,[{key:"type",value:function(){return this.object.type()}},{key:"free",value:function(){null!==this.object&&(h.A(this.id),this.object=null)}}]),e}(),m=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"length",value:function(){return this.object.size()}},{key:"attributeNames",value:function(){var e=this;return f.RE((function(t){e.object.fill_attribute_names();var n=e.object.attribute_names_buffer(),r=e.object.attribute_names_length();return d.b(n,r)}))}},{key:"findAttribute",value:function(e){var t=this;return f.RE((function(n){return t.object.find_attribute(e)}))}},{key:"attribute",value:function(e){var t=this;return k("number"==typeof e?function(n){return t.object.load_attribute_by_index(e)}:function(n){return t.object.load_attribute_by_name(e)},this.parent)}}]),n}(v),p=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"values",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj(this.object.numeric_vector(),t)}}]),n}(m),Z=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"values",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj(this.object.numeric_vector(),t)}}]),n}(m),w=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"values",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).copy,t=void 0===e||e;return c.Yj(this.object.numeric_vector(),t)}}]),n}(m),y=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"values",value:function(){var e=this;return f.RE((function(t){e.object.fill_string_vector();var n=e.object.string_vector_buffer(),r=e.object.string_vector_length();return d.b(n,r)}))}}]),n}(m),b=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"load",value:function(e){var t=this;return k((function(n){return t.object.load_list_element(e)}),this.parent)}}]),n}(m),g=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n,[{key:"className",value:function(){var e=this;return f.RE((function(t){return e.object.class_name()}))}},{key:"packageName",value:function(){var e=this;return f.RE((function(t){return e.object.package_name()}))}},{key:"attributeNames",value:function(){var e=this;return f.RE((function(t){e.object.fill_attribute_names();var n=e.object.attribute_names_buffer(),r=e.object.attribute_names_length();return d.b(n,r)}))}},{key:"findAttribute",value:function(e){var t=this;return f.RE((function(n){return t.object.find_attribute(e)}))}},{key:"attribute",value:function(e){var t=this;return k("number"==typeof e?function(n){return t.object.load_attribute_by_index(e)}:function(n){return t.object.load_attribute_by_name(e)},this.parent)}}]),n}(v),_=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e,r,i){return(0,o.Z)(this,n),t.call(this,e,r,i)}return(0,l.Z)(n)}(m);function k(e,t){var n,r=f.RE(e),i=null;try{i=r.type()}catch(a){throw r.delete(),a}return n="integer"==i?p:"double"==i?w:"boolean"==i?Z:"string"==i?y:"vector"==i?b:"S4"==i?g:"null"==i?_:v,h.R((function(e){return r}),n,t)}var x=new WeakMap,E=new WeakMap,O=function(){function e(t,n){(0,o.Z)(this,e),(0,r.Z)(this,x,{writable:!0,value:void 0}),(0,r.Z)(this,E,{writable:!0,value:void 0}),(0,a.Z)(this,x,t),(0,a.Z)(this,E,n)}return(0,l.Z)(e,[{key:"formatVersion",value:function(){return(0,i.Z)(this,E).format_version()}},{key:"writerVersion",value:function(){var e=(0,i.Z)(this,E).writer_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}},{key:"readerVersion",value:function(){var e=(0,i.Z)(this,E).reader_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}},{key:"value",value:function(){var e=this;return k((function(t){return(0,i.Z)(e,E).load()}),this)}},{key:"free",value:function(){null!==(0,i.Z)(this,E)&&(h.A((0,i.Z)(this,x)),(0,a.Z)(this,E,null))}}]),e}();function C(e){var t,n;try{"string"==typeof e?n=h.R((function(t){return t.parse_rds_from_file(e)}),O):(t=c.de(e,"Uint8WasmArray"),n=h.R((function(e){return e.parse_rds_from_buffer(t.offset,t.length)}),O))}finally{c.gd(t)}return n}},5159:function(e,t,n){"use strict";n.d(t,{RY:function(){return m},dO:function(){return p}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=new WeakMap,f=new WeakMap,h=new WeakMap,d=new WeakMap,v=new WeakMap,m=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,c,{writable:!0,value:void 0}),(0,a.Z)(this,f,{writable:!0,value:void 0}),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,u.Z)(this,c,t),(0,u.Z)(this,f,n),(0,u.Z)(this,h,i),(0,u.Z)(this,d,i),(0,u.Z)(this,v,i)}return(0,i.Z)(e,[{key:"principalComponents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,h),(function(){(0,u.Z)(e,h,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).pcs(),t)}))}},{key:"setTotalVariance",value:function(e){(0,s.Z)(this,v)||(0,u.Z)(this,v,!0),(0,s.Z)(this,f).set_total_variance(e)}},{key:"varianceExplained",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,d),(function(){(0,u.Z)(e,d,!0)}),(function(t){return l.Yj((0,s.Z)(e,f).variance_explained(),t)}))}},{key:"totalVariance",value:function(){return(0,s.Z)(this,v)?(0,s.Z)(this,f).total_variance():null}},{key:"numberOfPCs",value:function(){return(0,s.Z)(this,f).num_pcs()}},{key:"numberOfCells",value:function(){return this.principalComponents({copy:!1}).length/this.numberOfPCs()}},{key:"free",value:function(){null!==(0,s.Z)(this,f)&&(o.A((0,s.Z)(this,c)),(0,u.Z)(this,f,null))}}]),e}();function p(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.features,s=void 0===a?null:a,u=i.numberOfPCs,c=void 0===u?25:u,f=i.scale,h=void 0!==f&&f,d=i.block,v=void 0===d?null:d,p=i.blockMethod,Z=void 0===p?"regress":p,w=i.numberOfThreads,y=void 0===w?null:w;l.c2("blockMethod",Z,["none","regress","weight"]);var b=l.mV(y);try{var g=!1,_=0;if(null!==s){if((t=l.de(s,"Uint8WasmArray")).length!=e.numberOfRows())throw new Error("length of 'features' should be equal to number of rows in 'x'");g=!0,_=t.offset}if(c=Math.min(c,e.numberOfRows()-1,e.numberOfColumns()-1),null===v||"none"==Z)r=o.R((function(t){return t.run_pca(e.matrix,c,g,_,h,b)}),m);else{if((n=l.de(v,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'block' should be equal to the number of columns in 'x'");if("regress"==Z)r=o.R((function(t){return t.run_blocked_pca(e.matrix,c,g,_,h,n.offset,b)}),m);else{if("weight"!=Z)throw new Error("unknown value '"+Z+"' for 'blockMethod='");r=o.R((function(t){return t.run_multibatch_pca(e.matrix,c,g,_,h,n.offset,b)}),m)}}}catch(k){throw l.gd(r),k}finally{l.gd(t),l.gd(n)}return r}},4181:function(e,t,n){"use strict";n.d(t,{Tk:function(){return i}});n(6635);var r=n(8782);n(7108),n(7067);function i(e){return r.RE((function(t){return t.perplexity_to_k(e)}))}},5319:function(e,t,n){"use strict";n(6635),n(8782),n(7108),n(7067)},2732:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var r=n(8782),i=n(6635);n(7067);function a(e,t){var n,a,s,u,o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=l.neighbors,f=void 0===c?20:c,h=l.indices,d=void 0===h?null:h,v=l.buffer,m=void 0===v?null:v,p=l.approximate,Z=void 0===p||p,w=l.weights,y=void 0===w?null:w,b=l.numberOfThreads,g=void 0===b?null:b,_=e.length,k=i.mV(g);try{for(var x=(n=i.GF(_)).array(),E=0;E<_;E++)x[E]=BigInt(e[E].offset);var O=0,C=!1;if(null!==y){if(C=!0,(u=i.de(y,"Float64WasmArray")).length!=_)throw new Error("length of 'weights' should be equal to the number of embeddings");O=u.offset}var M=function(e){var n=e*t;if(null===m)o=i.RJ(n),m=o;else if(n!==m.length)throw new Error("length of 'buffer' should be equal to the product of 'numberOfCells' and the total number of dimensions")};if(null!==d){if(_!==d.length)throw new Error("'indices' and 'embeddings' should have the same length");var R=(a=i.GF(_)).array(),N=0;for(E=0;E<_;E++){var S=d[E];if(t!=S.numberOfCells())throw new Error("each element of 'indices' should have the same number of cells as 'numberOfCells'");if(e[E].length!=S.numberOfCells()*S.numberOfDims())throw new Error("length of arrays in 'embeddings' should equal the length of arrays used to build 'indices'");R[E]=BigInt(d[E].index.$$.ptr),N+=d[E].numberOfDims()}M(N),r.RE((function(e){return e.scale_by_neighbors_indices(t,_,n.offset,a.offset,m.offset,f,C,O,k)}))}else{var A=(s=i.Wf(_)).array(),W=0;for(E=0;E<_;E++){var j=e[E].length;if(A[E]=Math.floor(j/t),t*A[E]!==j)throw new Error("length of arrays in 'embeddings' should be a multiple of 'numberOfCells'");W+=A[E]}M(W),r.RE((function(e){return e.scale_by_neighbors_matrices(t,_,s.offset,n.offset,m.offset,f,C,O,Z,k)}))}}catch(F){throw i.gd(o),F}finally{for(var I=0,D=[];I<D.length;I++){D[I].free()}i.gd(n),i.gd(a),i.gd(u),i.gd(s)}return m}},7039:function(e,t,n){"use strict";n.d(t,{B:function(){return a}});n(7108);var r=n(8782),i=n(6635);n(6650);function a(e,t){var n,a,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=u.block,l=void 0===o?null:o,c=u.scale,f=void 0!==c&&c,h=u.numberOfThreads,d=void 0===h?null:h,v={},m=i.mV(d);try{if(t.length!==e.numberOfRows())throw new Error("Uint8Array 'features' must be of length equal to the number of rows in 'x'");a=i.de(t,"Uint8WasmArray");var p=0,Z=!1;if(null!==l){if((s=i.de(l,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");Z=!0,p=s.offset}n=r.RE((function(t){return t.score_feature_set(e.matrix,a.offset,Z,p,f,m)})),v.weights=n.weights().slice(),v.scores=n.scores().slice()}finally{i.gd(s),i.gd(a),n&&n.delete()}return v}},9249:function(e,t,n){"use strict";n.d(t,{OV:function(){return x},y5:function(){return O}});var r=n(5671),i=n(3144),a=n(101),s=n(2346),u=n(3889),o=n(8916),l=n(2793),c=n(7108),f=n(8782),h=n(6635);function d(e,t,n,r,i,a){return h.Hw(n,r,i.filled||i.details[e][t]||!1,(function(){i.details[e][t]=!0}),a)}function v(e){if("number"==typeof e)return e;var t;switch(e){case"minimum":t=0;break;case"mean":t=1;break;case"median":t=2;break;case"maximum":t=3;break;case"min-rank":t=4;break;default:throw new Error("unknown summary type '"+e+"'")}return t}var m=new WeakMap,p=new WeakMap,Z=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakSet,x=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,k),(0,s.Z)(this,m,{writable:!0,value:void 0}),(0,s.Z)(this,p,{writable:!0,value:void 0}),(0,s.Z)(this,Z,{writable:!0,value:void 0}),(0,s.Z)(this,w,{writable:!0,value:void 0}),(0,s.Z)(this,y,{writable:!0,value:void 0}),(0,s.Z)(this,b,{writable:!0,value:void 0}),(0,s.Z)(this,g,{writable:!0,value:void 0}),(0,s.Z)(this,_,{writable:!0,value:void 0}),(0,l.Z)(this,m,t),(0,l.Z)(this,p,n);var u=this.numberOfGroups(),o=this.numberOfBlocks();function c(e){var t={filled:e};if(!e){t.details=new Array(u);for(var n=0;n<u;n++)t.details[n]=h.oH(o+1,e)}return t}function f(e){var t={filled:e};if(!e){t.details=new Array(u);for(var n=0;n<u;n++)t.details[n]={}}return t}(0,l.Z)(this,Z,c(i)),(0,l.Z)(this,w,c(i)),(0,l.Z)(this,y,f(i)),(0,l.Z)(this,b,f(i)),(0,l.Z)(this,g,f(i)),(0,l.Z)(this,_,f(i))}return(0,i.Z)(e,[{key:"numberOfBlocks",value:function(){return(0,o.Z)(this,p).num_blocks()}},{key:"numberOfGroups",value:function(){return(0,o.Z)(this,p).num_groups()}},{key:"means",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.block,r=void 0===n?null:n,i=t.copy,a=void 0===i||i,s=t.fillable,l=void 0!==s&&s;return(0,u.Z)(this,k,E).call(this,e,r,a,l,(0,o.Z)(this,Z),"means")}},{key:"detected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.block,r=void 0===n?null:n,i=t.copy,a=void 0===i||i,s=t.fillable,l=void 0!==s&&s;return(0,u.Z)(this,k,E).call(this,e,r,a,l,(0,o.Z)(this,w),"detected")}},{key:"cohen",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.summary,i=void 0===r?"mean":r,a=n.copy,s=void 0===a||a,u=n.fillable,l=void 0!==u&&u;return i=v(i),d(e,i,l,s,(0,o.Z)(this,y),(function(n){return h.Yj(f.RE((function(n){return(0,o.Z)(t,p).cohen(e,i)})),n)}))}},{key:"auc",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.summary,i=void 0===r?"mean":r,a=n.copy,s=void 0===a||a,u=n.fillable,l=void 0!==u&&u;return i=v(i),d(e,i,l,s,(0,o.Z)(this,g),(function(n){return h.Yj(f.RE((function(n){return(0,o.Z)(t,p).auc(e,i)})),n)}))}},{key:"lfc",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.summary,i=void 0===r?"mean":r,a=n.copy,s=void 0===a||a,u=n.fillable,l=void 0!==u&&u;return i=v(i),d(e,i,l,s,(0,o.Z)(this,b),(function(n){return h.Yj(f.RE((function(n){return(0,o.Z)(t,p).lfc(e,i)})),n)}))}},{key:"deltaDetected",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.summary,i=void 0===r?"mean":r,a=n.copy,s=void 0===a||a,u=n.fillable,l=void 0!==u&&u;return i=v(i),d(e,i,l,s,(0,o.Z)(this,_),(function(n){return h.Yj(f.RE((function(n){return(0,o.Z)(t,p).delta_detected(e,i)})),n)}))}},{key:"free",value:function(){null!==(0,o.Z)(this,p)&&(c.A((0,o.Z)(this,m)),(0,l.Z)(this,p,null))}}]),e}();function E(e,t,n,r,i,a){var s=this,u=t;if(null==t){var l=this.numberOfBlocks();u=l>1?l:0,t=-1}return h.Hw(r,n,i.filled||i.details[e][u]||!1,(function(){i.details[e][u]=!0}),(function(n){return h.Yj((0,o.Z)(s,p)[a](e,t),n)}))}function O(e,t){var n,r,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.block,u=void 0===s?null:s,o=a.numberOfThreads,l=void 0===o?null:o,f=a.lfcThreshold,d=void 0===f?0:f,v=a.computeAuc,m=void 0===v||v,p=a.computeMedian,Z=void 0!==p&&p,w=a.computeMaximum,y=void 0!==w&&w,b=h.mV(l);try{if((i=h.de(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'groups' should be equal to number of columns in 'x'");var g=0,_=!1;if(null!==u){if((r=h.de(u,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");_=!0,g=r.offset}n=c.R((function(t){return t.score_markers(e.matrix,i.offset,_,g,d,m,Z,y,b)}),x)}catch(k){throw h.gd(n),k}finally{h.gd(r),h.gd(i)}return n}},1196:function(e,t,n){"use strict";n.d(t,{ZW:function(){return u},vc:function(){return o}});var r=n(6635),i=n(8782),a=n(4021);function s(e,t){var n,a,s,u=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,o=void 0!==u&&u;try{o?a=e:(n=e.clone(),a=n),s=r.de(t,"Int32WasmArray"),i.RE((function(e){return e.row_subset(a.matrix,s.offset,s.length)}))}catch(l){throw r.gd(n),l}finally{r.gd(s)}return a}function u(e,t){var n,a,s,u=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).inPlace,o=void 0!==u&&u;try{o?a=e:(n=e.clone(),a=n),s=r.de(t,"Int32WasmArray"),i.RE((function(e){return e.column_subset(a.matrix,s.offset,s.length)}))}catch(l){throw r.gd(n),l}finally{r.gd(s)}return a}function o(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.singleNull,u=void 0!==i&&i,o=r.createMultiMatrix,l=void 0!==o&&o,c={},f=Object.keys(t);if(1==f.length){var h=t[f[0]],d=h.length==e.numberOfRows();if(d)for(var v=0;v<h.length;v++)if(v!=h[v]){d=!1;break}if(d)return u?null:(c[f[0]]=e.clone(),c)}try{for(var m=0,p=f;m<p.length;m++){var Z=p[m];c[Z]=s(e,t[Z])}l&&(n=new a.V({store:c}))}catch(b){for(var w=0,y=Object.values(c);w<y.length;w++){y[w].free()}throw b}return l?n:c}},6757:function(e,t,n){"use strict";n.d(t,{nO:function(){return Z}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=n(6807),f=n(9206),h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,u.Z)(this,d,t),(0,u.Z)(this,h,n),(0,u.Z)(this,v,i),(0,u.Z)(this,m,l.oH(this.numberOfSubsets(),i))}return(0,i.Z)(e,[{key:"thresholdsDetected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,h).thresholds_detected(),t)}))}},{key:"thresholdsSubsetTotals",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copy,i=void 0===r||r,a=n.fillable,u=void 0!==a&&a;return l.Hw(u,i,(0,s.Z)(this,m)[e],(function(){(0,s.Z)(t,m)[e]=!0}),(function(n){return l.Yj((0,s.Z)(t,h).thresholds_subset_totals(e),n)}))}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,h).num_subsets()}},{key:"numberOfBlocks",value:function(){return(0,s.Z)(this,h).num_blocks()}},{key:"filter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.block,r=void 0===n?null:n,i=t.buffer,a=void 0===i?null:i;if(!(e instanceof f.yf))throw new Error("'metrics' should be a PerCellAdtQcMetricsResults object");return c.R((0,s.Z)(this,h),e,r,a)}},{key:"free",value:function(){null!==(0,s.Z)(this,h)&&(o.A((0,s.Z)(this,d)),(0,u.Z)(this,h,null))}}]),e}();function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.numberOfMADs,r=void 0===n?3:n,i=t.minDetectedDrop,a=void 0===i?.1:i,s=t.block,u=void 0===s?null:s;if(!(e instanceof f.yf))throw new Error("'metrics' should be a PerCellAdtQcMetricsResults object");return c.H(e,u,(function(e,t,n){return o.R((function(i){return i.suggest_adt_qc_filters(e.results.$$.ptr,t,n,r,a)}),p)}))}},4609:function(e,t,n){"use strict";n.d(t,{XU:function(){return p}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=n(6807),f=n(2945),h=new WeakMap,d=new WeakMap,v=new WeakMap,m=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,u.Z)(this,h,t),(0,u.Z)(this,d,n),(0,u.Z)(this,v,i)}return(0,i.Z)(e,[{key:"thresholdsMaxCount",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,d).thresholds_max_count(),t)}))}},{key:"numberOfBlocks",value:function(){return(0,s.Z)(this,d).num_blocks()}},{key:"filter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.block,r=void 0===n?null:n,i=t.buffer,a=void 0===i?null:i;if(!(e instanceof f.UY))throw new Error("'metrics' should be a PerCellCrisprQcMetricsResults object");return c.R((0,s.Z)(this,d),e,r,a)}},{key:"free",value:function(){null!==(0,s.Z)(this,d)&&(o.A((0,s.Z)(this,h)),(0,u.Z)(this,d,null))}}]),e}();function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.numberOfMADs,r=void 0===n?3:n,i=t.block,a=void 0===i?null:i;if(!(e instanceof f.UY))throw new Error("'metrics' should be a PerCellCrisprQcMetricsResults object");return c.H(e,a,(function(e,t,n){return o.R((function(i){return i.suggest_crispr_qc_filters(e.results.$$.ptr,t,n,r)}),m)}))}},7339:function(e,t,n){"use strict";n.d(t,{Lw:function(){return w}});var r=n(5671),i=n(3144),a=n(2346),s=n(8916),u=n(2793),o=n(7108),l=n(6635),c=n(6807),f=n(5448),h=new WeakMap,d=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,Z=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,r.Z)(this,e),(0,a.Z)(this,h,{writable:!0,value:void 0}),(0,a.Z)(this,d,{writable:!0,value:void 0}),(0,a.Z)(this,v,{writable:!0,value:void 0}),(0,a.Z)(this,m,{writable:!0,value:void 0}),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,h,t),(0,u.Z)(this,d,n),(0,u.Z)(this,v,i),(0,u.Z)(this,m,i),(0,u.Z)(this,p,l.oH(this.numberOfSubsets(),i))}return(0,i.Z)(e,[{key:"thresholdsSums",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,v),(function(){(0,u.Z)(e,v,!0)}),(function(t){return l.Yj((0,s.Z)(e,d).thresholds_sums(),t)}))}},{key:"thresholdsDetected",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.copy,r=void 0===n||n,i=t.fillable,a=void 0!==i&&i;return l.Hw(a,r,(0,s.Z)(this,m),(function(){(0,u.Z)(e,m,!0)}),(function(t){return l.Yj((0,s.Z)(e,d).thresholds_detected(),t)}))}},{key:"thresholdsSubsetProportions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copy,i=void 0===r||r,a=n.fillable,u=void 0!==a&&a;return l.Hw(u,i,(0,s.Z)(this,p)[e],(function(){(0,s.Z)(t,p)[e]=!0}),(function(n){return l.Yj((0,s.Z)(t,d).thresholds_proportions(e),n)}))}},{key:"numberOfSubsets",value:function(){return(0,s.Z)(this,d).num_subsets()}},{key:"numberOfBlocks",value:function(){return(0,s.Z)(this,d).num_blocks()}},{key:"filter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.block,r=void 0===n?null:n,i=t.buffer,a=void 0===i?null:i;if(!(e instanceof f.eD))throw new Error("'metrics' should be a PerCellRnaQcMetricsResults object");return c.R((0,s.Z)(this,d),e,r,a)}},{key:"free",value:function(){null!==(0,s.Z)(this,d)&&(o.A((0,s.Z)(this,h)),(0,u.Z)(this,d,null))}}]),e}();function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.numberOfMADs,r=void 0===n?3:n,i=t.block,a=void 0===i?null:i;if(!(e instanceof f.eD))throw new Error("'metrics' should be a PerCellRnaQcMetricsResults object");return c.H(e,a,(function(e,t,n){return o.R((function(i){return i.suggest_rna_qc_filters(e.results.$$.ptr,t,n,r)}),Z)}))}},6635:function(e,t,n){"use strict";n.d(t,{GF:function(){return u},Hw:function(){return m},RJ:function(){return o},TS:function(){return a},Wf:function(){return s},Yj:function(){return h},c2:function(){return d},de:function(){return l},gd:function(){return f},mV:function(){return c},oH:function(){return v}});var r=n(8782),i=n(6650);function a(e){return i.TS((0,r.Fx)(),e)}function s(e){return i.Wf((0,r.Fx)(),e)}function u(e){return i.GF((0,r.Fx)(),e)}function o(e){return i.RJ((0,r.Fx)(),e)}function l(e,t){if(e instanceof i.PQ){if(null!==t&&t!=e.constructor.className)throw new Error("expected '"+t+"', got '"+e.constructor.className+"'");return e.space===(0,r.Fx)()?null===e.owner?e.view():e:e.clone((0,r.Fx)())}return null!==t?i.Zv((0,r.Fx)(),e,i.rr(t)):i.Zv((0,r.Fx)(),e)}function c(e){return null==e?(0,r.TT)():e}function f(e){if("undefined"!=typeof e&&null!=e)return e.free()}function h(e,t){if("view"===t){if(e.buffer!==(0,r.f3)())throw new Error('cannot use copy = "view" for non-Wasm TypedArrays');var n=e.constructor.name.replace("Array","WasmArray");return i.dt((0,r.Fx)(),e.length,e.byteOffset,i.rr(n))}return t?e.slice():e}function d(e,t,n){if(-1==n.indexOf(t))throw new Error("'"+e+"=' should be one of '"+n.join("', '")+"'")}function v(e,t){var n=new Array(e);return n.fill(t),n}function m(e,t,n,r,i){if(!n){if(!e)return null;r(),t&&(t=!1)}return i(t)}},8782:function(e,t,n){"use strict";n.d(t,{Fx:function(){return d},RE:function(){return f},TT:function(){return c},f3:function(){return h},j2:function(){return o}});var r=n(4165),i=n(5861),a=n(8308),s=n(6650),u=(n(5941),{});function o(){return l.apply(this,arguments)}function l(){return l=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i,o,l,c,f=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=f.length>0&&void 0!==f[0]?f[0]:{}).numberOfThreads,i=void 0===n?4:n,o=t.localFile,l=void 0!==o&&o,!("module"in u)){e.next=3;break}return e.abrupt("return",!1);case 3:return c={scran_custom_nthreads:i},l&&(c.locateFile=function(e){return"file:///home/runner/work/kana/kana/node_modules/scran.js/browser/wasm.js".substring(7)+"/../wasm/"+e}),e.next=7,(0,a.default)(c);case 7:return u.module=e.sent,u.space=(0,s.z2)(u.module),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function c(){return u.module.scran_custom_nthreads}function f(e){if(!("module"in u))throw new Error("Wasm module needs to be initialized via 'initialize()'");var t;try{t=e(u.module)}catch(n){throw"number"==typeof n?new Error(u.module.get_error_message(n)):n}return t}function h(){if(!("module"in u))throw new Error("Wasm module needs to be initialized via 'initialize()'");return u.module.wasmMemory.buffer}function d(){return u.space}},6701:function(e,t,n){"use strict";n.d(t,{GF:function(){return o},RJ:function(){return l},TS:function(){return s},Wf:function(){return u},ih:function(){return a}});var r=n(2813),i=n(8383);function a(e,t,n){return(0,r.TK)(e,t,n)}function s(e,t){return a(e,t,i.yh)}function u(e,t){return a(e,t,i.do)}function o(e,t){return a(e,t,i.g1)}function l(e,t){return a(e,t,i.lt)}},8383:function(e,t,n){"use strict";n.d(t,{do:function(){return m},g1:function(){return p},lt:function(){return y},rr:function(){return g},yh:function(){return c}});var r=n(5671),i=n(3144),a=n(136),s=n(9388),u=n(4942),o=n(2813),l=n(2905),c=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Uint8Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(c,"className","Uint8WasmArray"),(0,u.Z)(c,"valueSize",1);var f=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Int8Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(f,"className","Int8WasmArray"),(0,u.Z)(f,"valueSize",1);var h=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Uint16Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(h,"className","Uint16WasmArray"),(0,u.Z)(h,"valueSize",2);var d=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Int16Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(d,"className","Int16WasmArray"),(0,u.Z)(d,"valueSize",2);var v=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Uint32Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(v,"className","Uint32WasmArray"),(0,u.Z)(v,"valueSize",4);var m=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Int32Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(m,"className","Int32WasmArray"),(0,u.Z)(m,"valueSize",4);var p=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new BigUint64Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(p,"className","BigUint64WasmArray"),(0,u.Z)(p,"valueSize",8);var Z=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new BigInt64Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(Z,"className","BigInt64WasmArray"),(0,u.Z)(Z,"valueSize",8);var w=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Float32Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(w,"className","Float32WasmArray"),(0,u.Z)(w,"valueSize",4);var y=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"array",value:function(){return new Float64Array((0,o.f3)(this.space),this.offset,this.length)}}]),n}(l.P);(0,u.Z)(y,"className","Float64WasmArray"),(0,u.Z)(y,"valueSize",8);var b={Uint8WasmArray:c,Int8WasmArray:f,Uint16WasmArray:h,Int16WasmArray:d,Uint32WasmArray:v,Int32WasmArray:m,BigUint64WasmArray:p,BigInt64WasmArray:Z,Float32WasmArray:w,Float64WasmArray:y};function g(e){if(!(e in b))throw new Error("unknown WasmArray class '"+e+"'");return b[e]}},6650:function(e,t,n){"use strict";n.d(t,{GF:function(){return a.GF},PQ:function(){return r.P},RJ:function(){return a.RJ},TS:function(){return a.TS},Wf:function(){return a.Wf},Zv:function(){return s.Zv},do:function(){return i.do},dt:function(){return u.dt},lt:function(){return i.lt},n6:function(){return o.n6},rr:function(){return i.rr},yh:function(){return i.yh},z2:function(){return l.z2}});var r=n(2905),i=n(8383),a=n(6701),s=n(4163),u=n(736),o=(n(6021),n(4342)),l=n(2813)},4342:function(e,t,n){"use strict";n.d(t,{n6:function(){return i}});var r=n(6701);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.filter,a=void 0===i?null:i,s=n.buffer,u=void 0===s?null:s,o=function(e,t,n,r){if(null===t)return e.forEach((function(e){if(e<0||e>=n)throw new Error("'subset' contains out-of-range indices for '"+r+"'")})),e.length;if(e.length!=n)throw new Error("'subset' and '"+r+"' should have the same length");var i=0;return e.forEach((function(e){i+=0!=e})),t?e.length-i:i}(t,a,e.length,"x");if(null==u)u=(0,r.ih)(e.space,o,e.constructor);else if(u.length!==o)throw new Error("length of 'buffer' is not consistent with 'subset'");var l=u.array();return function(e,t,n,r){if(null==t)e.forEach((function(e,t){r[t]=n[e]}));else if(t){var i=0;e.forEach((function(e,t){0==e&&(r[i]=n[t],i++)}))}else{var a=0;e.forEach((function(e,t){0!==e&&(r[a]=n[t],a++)}))}}(t,a,e.array(),l),u}},736:function(e,t,n){"use strict";n.d(t,{dt:function(){return r}});n(8383);function r(e,t,n,r){return new r(e,-1,t,n,{})}}}]);
//# sourceMappingURL=830.b268cfd2.chunk.js.map