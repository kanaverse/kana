/*! For license information please see 705.8c5fde0b.chunk.js.LICENSE.txt */
(self.webpackChunkkana=self.webpackChunkkana||[]).push([[705],{5766:function(e,t){var r,n,s;n=[],r=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},r=!t.document&&!!t.postMessage,n=t.IS_PAPA_WORKER||!1,s={},i=0,a={parse:function(r,n){var l=(n=n||{}).dynamicTyping||!1;if(v(l)&&(n.dynamicTypingFunction=l,l={}),n.dynamicTyping=l,n.transform=!!v(n.transform)&&n.transform,n.worker&&a.WORKERS_SUPPORTED){var o=function(){if(!a.WORKERS_SUPPORTED)return!1;var r,n,l=(r=t.URL||t.webkitURL||null,n=e.toString(),a.BLOB_URL||(a.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",n,")();"],{type:"text/javascript"})))),o=new t.Worker(l);return o.onmessage=p,o.id=i++,s[o.id]=o}();return o.userStep=n.step,o.userChunk=n.chunk,o.userComplete=n.complete,o.userError=n.error,n.step=v(n.step),n.chunk=v(n.chunk),n.complete=v(n.complete),n.error=v(n.error),delete n.worker,void o.postMessage({input:r,config:n,workerId:o.id})}var d=null;return a.NODE_STREAM_INPUT,"string"==typeof r?(r=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(r),d=n.download?new h(n):new c(n)):!0===r.readable&&v(r.read)&&v(r.on)?d=new f(n):(t.File&&r instanceof File||r instanceof Object)&&(d=new u(n)),d.stream(r)},unparse:function(e,t){var r=!1,n=!0,s=",",i="\r\n",l='"',o=l+l,h=!1,u=null,c=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(s=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(h=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(l=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(o=t.escapeChar+l),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(c=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var f=new RegExp(m(l),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,h);if("object"==typeof e[0])return d(u||Object.keys(e[0]),e,h)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||u),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],h);throw new Error("Unable to serialize unrecognized input");function d(e,t,r){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var l=Array.isArray(e)&&0<e.length,o=!Array.isArray(t[0]);if(l&&n){for(var h=0;h<e.length;h++)0<h&&(a+=s),a+=A(e[h],h);0<t.length&&(a+=i)}for(var u=0;u<t.length;u++){var c=l?e.length:t[u].length,f=!1,d=l?0===Object.keys(t[u]).length:0===t[u].length;if(r&&!l&&(f="greedy"===r?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===r&&l){for(var m=[],p=0;p<c;p++){var _=o?e[p]:p;m.push(t[u][_])}f=""===m.join("").trim()}if(!f){for(var w=0;w<c;w++){0<w&&!d&&(a+=s);var g=l&&o?e[w]:w;a+=A(t[u][g],w)}u<t.length-1&&(!r||0<c&&!d)&&(a+=i)}}return a}function A(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var n=!1;c&&"string"==typeof e&&c.test(e)&&(e="'"+e,n=!0);var i=e.toString().replace(f,o);return(n=n||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(i,a.BAD_DELIMITERS)||-1<i.indexOf(s)||" "===i.charAt(0)||" "===i.charAt(i.length-1))?l+i+l:i}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=A,a.ParserHandle=d,a.NetworkStreamer=h,a.FileStreamer=u,a.StringStreamer=c,a.ReadableStreamStreamer=f,t.jQuery){var l=t.jQuery;l.fn.parse=function(e){var r=e.config||{},n=[];return this.each((function(e){if("INPUT"!==l(this).prop("tagName").toUpperCase()||"file"!==l(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var s=0;s<this.files.length;s++)n.push({file:this.files[s],inputElem:this,instanceConfig:l.extend({},r)})})),s(),this;function s(){if(0!==n.length){var t,r,s,o,h=n[0];if(v(e.before)){var u=e.before(h.file,h.inputElem);if("object"==typeof u){if("abort"===u.action)return t="AbortError",r=h.file,s=h.inputElem,o=u.reason,void(v(e.error)&&e.error({name:t},r,s,o));if("skip"===u.action)return void i();"object"==typeof u.config&&(h.instanceConfig=l.extend(h.instanceConfig,u.config))}else if("skip"===u)return void i()}var c=h.instanceConfig.complete;h.instanceConfig.complete=function(e){v(c)&&c(e,h.file,h.inputElem),i()},a.parse(h.file,h.instanceConfig)}else v(e.complete)&&e.complete()}function i(){n.splice(0,1),s()}}}function o(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=g(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new d(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,r){if(this.isFirstChunk&&v(this._config.beforeFirstChunk)){var s=this._config.beforeFirstChunk(e);void 0!==s&&(e=s)}this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+e;this._partialLine="";var l=this._handle.parse(i,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var o=l.meta.cursor;this._finished||(this._partialLine=i.substring(o-this._baseIndex),this._baseIndex=o),l&&l.data&&(this._rowCount+=l.data.length);var h=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)t.postMessage({results:l,workerId:a.WORKER_ID,finished:h});else if(v(this._config.chunk)&&!r){if(this._config.chunk(l,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);l=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(l.data),this._completeResults.errors=this._completeResults.errors.concat(l.errors),this._completeResults.meta=l.meta),this._completed||!h||!v(this._config.complete)||l&&l.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),h||l&&l.meta.paused||this._nextChunk(),l}this._halted=!0},this._sendError=function(e){v(this._config.error)?this._config.error(e):n&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function h(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),o.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var n in e)t.setRequestHeader(n,e[n])}if(this._config.chunkSize){var s=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+s)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function u(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),o.call(this,e);var n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var s=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,s)}var i=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function c(e){var t;o.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function f(e){o.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){o.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){o.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=b((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=b((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=b((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function d(e){var t,r,n,s=Math.pow(2,53),i=-s,l=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,o=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,h=this,u=0,c=0,f=!1,d=!1,p=[],_={data:[],errors:[],meta:{}};if(v(e.step)){var w=e.step;e.step=function(t){if(_=t,k())y();else{if(y(),0===_.data.length)return;u+=t.data.length,e.preview&&u>e.preview?r.abort():(_.data=_.data[0],w(_,h))}}}function b(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function y(){return _&&n&&(E("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(_.data=_.data.filter((function(e){return!b(e)}))),k()&&function(){if(_)if(Array.isArray(_.data[0])){for(var t=0;k()&&t<_.data.length;t++)_.data[t].forEach(r);_.data.splice(0,1)}else _.data.forEach(r);function r(t,r){v(e.transformHeader)&&(t=e.transformHeader(t,r)),p.push(t)}}(),function(){if(!_||!e.header&&!e.dynamicTyping&&!e.transform)return _;function t(t,r){var n,s=e.header?{}:[];for(n=0;n<t.length;n++){var i=n,a=t[n];e.header&&(i=n>=p.length?"__parsed_extra":p[n]),e.transform&&(a=e.transform(a,i)),a=x(i,a),"__parsed_extra"===i?(s[i]=s[i]||[],s[i].push(a)):s[i]=a}return e.header&&(n>p.length?E("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+n,c+r):n<p.length&&E("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+n,c+r)),s}var r=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(t),r=_.data.length):_.data=t(_.data,0),e.header&&_.meta&&(_.meta.fields=p),c+=r,_}()}function k(){return e.header&&0===p.length}function x(t,r){return n=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(l.test(e)){var t=parseFloat(e);if(i<t&&t<s)return!0}return!1}(r)?parseFloat(r):o.test(r)?new Date(r):""===r?null:r):r;var n}function E(e,t,r,n){var s={type:e,code:t,message:r};void 0!==n&&(s.row=n),_.errors.push(s)}this.parse=function(s,i,l){var o=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(m(t)+"([^]*?)"+m(t),"gm"),n=(e=e.replace(r,"")).split("\r"),s=e.split("\n"),i=1<s.length&&s[0].length<n[0].length;if(1===n.length||i)return"\n";for(var a=0,l=0;l<n.length;l++)"\n"===n[l][0]&&a++;return a>=n.length/2?"\r\n":"\r"}(s,o)),n=!1,e.delimiter)v(e.delimiter)&&(e.delimiter=e.delimiter(s),_.meta.delimiter=e.delimiter);else{var h=function(t,r,n,s,i){var l,o,h,u;i=i||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var c=0;c<i.length;c++){var f=i[c],d=0,m=0,p=0;h=void 0;for(var _=new A({comments:s,delimiter:f,newline:r,preview:10}).parse(t),w=0;w<_.data.length;w++)if(n&&b(_.data[w]))p++;else{var g=_.data[w].length;m+=g,void 0!==h?0<g&&(d+=Math.abs(g-h),h=g):h=g}0<_.data.length&&(m/=_.data.length-p),(void 0===o||d<=o)&&(void 0===u||u<m)&&1.99<m&&(o=d,l=f,u=m)}return{successful:!!(e.delimiter=l),bestDelimiter:l}}(s,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);h.successful?e.delimiter=h.bestDelimiter:(n=!0,e.delimiter=a.DefaultDelimiter),_.meta.delimiter=e.delimiter}var u=g(e);return e.preview&&e.header&&u.preview++,t=s,r=new A(u),_=r.parse(t,i,l),y(),f?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,r.abort(),t=v(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){h.streamer._halted?(f=!1,h.streamer.parseChunk(t,!0)):setTimeout(h.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,r.abort(),_.meta.aborted=!0,v(e.complete)&&e.complete(_),t=""}}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(e){var t,r=(e=e||{}).delimiter,n=e.newline,s=e.comments,i=e.step,l=e.preview,o=e.fastMode,h=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(h=e.escapeChar),("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=","),s===r)throw new Error("Comment character same as delimiter");!0===s?s="#":("string"!=typeof s||-1<a.BAD_DELIMITERS.indexOf(s))&&(s=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var u=0,c=!1;this.parse=function(a,f,d){if("string"!=typeof a)throw new Error("Input must be a string");var A=a.length,p=r.length,_=n.length,w=s.length,g=v(i),b=[],y=[],k=[],x=u=0;if(!a)return G();if(e.header&&!f){var E=a.split(n)[0].split(r),C=[],O={},M=!1;for(var R in E){var N=E[R];v(e.transformHeader)&&(N=e.transformHeader(N,R));var S=N,W=O[N]||0;for(0<W&&(M=!0,S=N+"_"+W),O[N]=W+1;C.includes(S);)S=S+"_"+W;C.push(S)}if(M){var I=a.split(n);I[0]=C.join(r),a=I.join(n)}}if(o||!1!==o&&-1===a.indexOf(t)){for(var P=a.split(n),D=0;D<P.length;D++){if(k=P[D],u+=k.length,D!==P.length-1)u+=n.length;else if(d)return G();if(!s||k.substring(0,w)!==s){if(g){if(b=[],U(k.split(r)),K(),c)return G()}else U(k.split(r));if(l&&l<=D)return b=b.slice(0,l),G(!0)}}return G()}for(var T=a.indexOf(r,u),z=a.indexOf(n,u),j=new RegExp(m(h)+m(t),"g"),F=a.indexOf(t,u);;)if(a[u]!==t)if(s&&0===k.length&&a.substring(u,u+w)===s){if(-1===z)return G();u=z+_,z=a.indexOf(n,u),T=a.indexOf(r,u)}else if(-1!==T&&(T<z||-1===z))k.push(a.substring(u,T)),u=T+p,T=a.indexOf(r,u);else{if(-1===z)break;if(k.push(a.substring(u,z)),V(z+_),g&&(K(),c))return G();if(l&&b.length>=l)return G(!0)}else for(F=u,u++;;){if(-1===(F=a.indexOf(t,F+1)))return d||y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:u}),$();if(F===A-1)return $(a.substring(u,F).replace(j,t));if(t!==h||a[F+1]!==h){if(t===h||0===F||a[F-1]!==h){-1!==T&&T<F+1&&(T=a.indexOf(r,F+1)),-1!==z&&z<F+1&&(z=a.indexOf(n,F+1));var q=B(-1===z?T:Math.min(T,z));if(a.substr(F+1+q,p)===r){k.push(a.substring(u,F).replace(j,t)),a[u=F+1+q+p]!==t&&(F=a.indexOf(t,u)),T=a.indexOf(r,u),z=a.indexOf(n,u);break}var L=B(z);if(a.substring(F+1+L,F+1+L+_)===n){if(k.push(a.substring(u,F).replace(j,t)),V(F+1+L+_),T=a.indexOf(r,u),F=a.indexOf(t,u),g&&(K(),c))return G();if(l&&b.length>=l)return G(!0);break}y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:u}),F++}}else F++}return $();function U(e){b.push(e),x=u}function B(e){var t=0;if(-1!==e){var r=a.substring(F+1,e);r&&""===r.trim()&&(t=r.length)}return t}function $(e){return d||(void 0===e&&(e=a.substring(u)),k.push(e),u=A,U(k),g&&K()),G()}function V(e){u=e,U(k),k=[],z=a.indexOf(n,u)}function G(e){return{data:b,errors:y,meta:{delimiter:r,linebreak:n,aborted:c,truncated:!!e,cursor:x+(f||0)}}}function K(){i(G()),b=[],y=[]}},this.abort=function(){c=!0},this.getCharIndex=function(){return u}}function p(e){var t=e.data,r=s[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){n=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(v(r.userStep)){for(var a=0;a<t.results.data.length&&(r.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},i),!n);a++);delete t.results}else v(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!n&&_(t.workerId,t.results)}function _(e,t){var r=s[e];v(r.userComplete)&&r.userComplete(t),r.terminate(),delete s[e]}function w(){throw new Error("Not implemented.")}function g(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=g(e[r]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function v(e){return"function"==typeof e}return n&&(t.onmessage=function(e){var r=e.data;if(void 0===a.WORKER_ID&&r&&(a.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var n=a.parse(r.input,r.config);n&&t.postMessage({workerId:a.WORKER_ID,results:n,finished:!0})}}),(h.prototype=Object.create(o.prototype)).constructor=h,(u.prototype=Object.create(o.prototype)).constructor=u,(c.prototype=Object.create(c.prototype)).constructor=c,(f.prototype=Object.create(o.prototype)).constructor=f,a},void 0===(s="function"===typeof r?r.apply(t,n):r)||(e.exports=s)},4080:function(e,t,r){e=r.nmd(e),function(r,n){var s=function(){var e=null,t={};A();var r=[],n=function(t){if(void 0!==(t=t||{}).seed&&null!==t.seed&&t.seed===parseInt(t.seed,10))e=t.seed;else if("string"===typeof t.seed)e=g(t.seed);else{if(void 0!==t.seed&&null!==t.seed)throw new TypeError("The seed value must be an integer or string");e=null}var o,h;if(null!==t.count&&void 0!==t.count){for(var u=t.count,c=[],f=0;f<t.count;f++)r.push(!1);for(t.count=null;u>c.length;){var d=n(t);null!==e&&(t.seed=e),c.push(d)}return t.count=u,c}return l([o=s(t),h=i(o,t),a(o,h,t)],t)};function s(e){if(r.length>0){var t=f(i=b(e.hue)),n=(i[1]-i[0])/r.length,s=parseInt((t-i[0])/n);return!0===r[s]?s=(s+2)%r.length:r[s]=!0,(t=f(i=[(i[0]+s*n)%359,(i[0]+(s+1)*n)%359]))<0&&(t=360+t),t}var i;return(t=f(i=h(e.hue)))<0&&(t=360+t),t}function i(e,t){if("monochrome"===t.hue)return 0;if("random"===t.luminosity)return f([0,100]);var r=u(e),n=r[0],s=r[1];switch(t.luminosity){case"bright":n=55;break;case"dark":n=s-10;break;case"light":s=55}return f([n,s])}function a(e,t,r){var n=o(e,t),s=100;switch(r.luminosity){case"dark":s=n+20;break;case"light":n=(s+n)/2;break;case"random":n=0,s=100}return f([n,s])}function l(e,t){switch(t.format){case"hsvArray":return e;case"hslArray":return w(e);case"hsl":var r=w(e);return"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)";case"hsla":var n=w(e),s=t.alpha||Math.random();return"hsla("+n[0]+", "+n[1]+"%, "+n[2]+"%, "+s+")";case"rgbArray":return p(e);case"rgb":return"rgb("+p(e).join(", ")+")";case"rgba":var i=p(e);s=t.alpha||Math.random();return"rgba("+i.join(", ")+", "+s+")";default:return d(e)}}function o(e,t){for(var r=c(e).lowerBounds,n=0;n<r.length-1;n++){var s=r[n][0],i=r[n][1],a=r[n+1][0],l=r[n+1][1];if(t>=s&&t<=a){var o=(l-i)/(a-s);return o*t+(i-o*s)}}return 0}function h(e){if("number"===typeof parseInt(e)){var r=parseInt(e);if(r<360&&r>0)return[r,r]}if("string"===typeof e)if(t[e]){var n=t[e];if(n.hueRange)return n.hueRange}else if(e.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var s=_(e)[0];return[s,s]}return[0,360]}function u(e){return c(e).saturationRange}function c(e){for(var r in e>=334&&e<=360&&(e-=360),t){var n=t[r];if(n.hueRange&&e>=n.hueRange[0]&&e<=n.hueRange[1])return t[r]}return"Color not found"}function f(t){if(null===e){var r=.618033988749895,n=Math.random();return n+=r,n%=1,Math.floor(t[0]+n*(t[1]+1-t[0]))}var s=t[1]||1,i=t[0]||0,a=(e=(9301*e+49297)%233280)/233280;return Math.floor(i+a*(s-i))}function d(e){var t=p(e);function r(e){var t=e.toString(16);return 1==t.length?"0"+t:t}return"#"+r(t[0])+r(t[1])+r(t[2])}function m(e,r,n){var s=n[0][0],i=n[n.length-1][0],a=n[n.length-1][1],l=n[0][1];t[e]={hueRange:r,lowerBounds:n,saturationRange:[s,i],brightnessRange:[a,l]}}function A(){m("monochrome",null,[[0,0],[100,0]]),m("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),m("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),m("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),m("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),m("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),m("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),m("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function p(e){var t=e[0];0===t&&(t=1),360===t&&(t=359),t/=360;var r=e[1]/100,n=e[2]/100,s=Math.floor(6*t),i=6*t-s,a=n*(1-r),l=n*(1-i*r),o=n*(1-(1-i)*r),h=256,u=256,c=256;switch(s){case 0:h=n,u=o,c=a;break;case 1:h=l,u=n,c=a;break;case 2:h=a,u=n,c=o;break;case 3:h=a,u=l,c=n;break;case 4:h=o,u=a,c=n;break;case 5:h=n,u=a,c=l}return[Math.floor(255*h),Math.floor(255*u),Math.floor(255*c)]}function _(e){e=3===(e=e.replace(/^#/,"")).length?e.replace(/(.)/g,"$1$1"):e;var t=parseInt(e.substr(0,2),16)/255,r=parseInt(e.substr(2,2),16)/255,n=parseInt(e.substr(4,2),16)/255,s=Math.max(t,r,n),i=s-Math.min(t,r,n),a=s?i/s:0;switch(s){case t:return[(r-n)/i%6*60||0,a,s];case r:return[60*((n-t)/i+2)||0,a,s];case n:return[60*((t-r)/i+4)||0,a,s]}}function w(e){var t=e[0],r=e[1]/100,n=e[2]/100,s=(2-r)*n;return[t,Math.round(r*n/(s<1?s:2-s)*1e4)/100,s/2*100]}function g(e){for(var t=0,r=0;r!==e.length&&!(t>=Number.MAX_SAFE_INTEGER);r++)t+=e.charCodeAt(r);return t}function b(e){if(isNaN(e)){if("string"===typeof e)if(t[e]){var r=t[e];if(r.hueRange)return r.hueRange}else if(e.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){return c(_(e)[0]).hueRange}}else{var n=parseInt(e);if(n<360&&n>0)return c(e).hueRange}return[0,360]}return n}();e&&e.exports&&(t=e.exports=s),t.randomColor=s}()},9757:(e,t,r)=>{"use strict";r.d(t,{h:()=>E});var n,s=r(9790),i=r(5149),a=r(6562),l=r(8458),o=r(4558),h=r(7990),u=r(3619),c=r(1522);function f(e,t){return t?u.UC(e):e}const d="https://experimenthub.bioconductor.org/fetch",m={"zeisel-brain":{counts:"2596",coldata:"2598",rowdata:"2597"},"segerstolpe-pancreas":{counts:"2591",coldata:"2593",rowdata:"2592"},"nestorowa-hsc":{counts:"2710",ncol:1920},"aztekin-tail":{counts:"3124",coldata:"3125"},"wu-kidney":{counts:"3594",coldata:"3595"},"zilionis-mouse-lung":{counts:"3478",coldata:"3479"}};function A(e,t,r){if(!(e instanceof h.ac))throw new Error("expected an S4 object");for(const[n,s]of Object.entries(t))if(e.className()==n&&e.packageName()==s)return;throw new Error("object is not a "+r+" or one of its recognized subclasses")}function p(e,t){let r=function(e){let t,r,n=e.findAttribute("names");if(n<0)return null;try{t=e.attribute(n),r=t.values()}catch(s){throw new Error("failed to load listData names; "+s.message)}finally{h.t9(t)}if(r.length!=e.length())throw new Error("expected names to have same length as listData");return r}(e);if(null==r)throw new Error("expected the listData list to be named");let n={};for(var s=0;s<e.length();s++){let i;try{if(i=e.load(s),i instanceof h.pv&&!(i instanceof h.G1)){let e=i.values();n[r[s]]=e,t.nrow=e.length}}finally{h.t9(i)}}t.columns=n}function _(e){let t,r={};if("S4"==e.type()){let t;A(e,{DFrame:"S4Vectors",DataFrame:"S4Vectors"},"DFrame");try{if(t=e.attribute("listData"),!(t instanceof h.G1))throw new Error("listData slot should be a generic list");p(t,r)}catch(n){throw new Error("failed to retrieve data from DataFrame's listData; "+n.message)}finally{h.t9(t)}}else{if("vector"!=e.type())throw new Error("expected a data.frame or DataFrame instance");p(e,r)}try{let n=e.findAttribute("rownames");n>=0&&(t=e.attribute(n),t instanceof h.Kn&&(r.row_names=t.values(),r.nrow=r.row_names.length))}catch(n){throw new Error("failed to retrieve row names from DataFrame; "+n.message)}finally{h.t9(t)}if(!("nrow"in r)){let t;try{if(t=e.attribute("nrows"),!(t instanceof h.X7))throw new Error("expected an integer vector as the 'nrows' slot");let n=t.values();if(1!=n.length)throw new Error("expected an integer vector of length 1 as the 'nrows' slot");r.nrow=n[0]}catch(n){throw new Error("failed to retrieve nrows from DataFrame; "+n.message)}finally{h.t9(t)}}return r}var w=new WeakMap,g=new WeakMap,b=new WeakMap,v=new WeakMap,y=new WeakMap,k=new WeakMap,x=new WeakSet;class E{static setDownloadFun(e){let t=N._;return N._=e,t}static availableDatasets(){return Object.keys(m)}constructor(e){if((0,s.A)(this,x),(0,i.A)(this,w,void 0),(0,i.A)(this,g,void 0),(0,i.A)(this,b,void 0),(0,i.A)(this,v,void 0),(0,i.A)(this,y,void 0),(0,i.A)(this,k,void 0),(0,o.A)(w,this,e),!((0,l.A)(w,this)in m))throw new Error("unrecognized identifier '"+(0,l.A)(w,this)+"' for ExperimentHub-based datasets");(0,o.A)(k,this,E.defaults()),this.clear()}static defaults(){return{primaryRnaFeatureIdColumn:0}}options(){return{...(0,l.A)(k,this)}}setOptions(e){for(const[t,r]of Object.entries(e))(0,l.A)(k,this)[t]=r}static format(){return"ExperimentHub"}clear(){h.t9((0,l.A)(v,this)),h.t9((0,l.A)(y,this)),(0,o.A)(v,this,null),(0,o.A)(y,this,null),(0,o.A)(g,this,null),(0,o.A)(b,this,null)}abbreviate(){return{id:(0,l.A)(w,this),options:this.options()}}async summary(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,a.A)(x,this,O).call(this),await(0,a.A)(x,this,M).call(this);let t={cells:f((0,l.A)(b,this),e)},r=f((0,l.A)(g,this),e);return t.modality_features={RNA:r},e||this.clear(),t}async previewPrimaryIds(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,a.A)(x,this,O).call(this);let t=(0,a.A)(x,this,R).call(this,(0,l.A)(g,this));return e||this.clear(),t}async load(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,a.A)(x,this,O).call(this),await(0,a.A)(x,this,M).call(this),await(0,a.A)(x,this,C).call(this);let t={cells:f((0,l.A)(b,this),e)};m[(0,l.A)(w,this)];try{t.matrix=new h.P_;let r=h.LX((0,l.A)(v,this),{consume:!e});t.matrix.add("RNA",r.matrix),t.row_ids={RNA:r.row_ids};let n=u.$9((0,l.A)(g,this),r.row_ids);t.features={RNA:n}}catch(r){throw h.t9(t.matrix),r}return t.primary_ids=(0,a.A)(x,this,R).call(this,t.features.RNA),e||this.clear(),t}serialize(){let e=(new TextEncoder).encode((0,l.A)(w,this));return{files:[{type:"id",file:new c.VM(e,{name:"id"})}],options:this.options()}}static unserialize(e,t){let r={};for(const n of e){const e=new TextDecoder;r[n.type]=e.decode(n.file.buffer())}if(!("id"in r))throw new Error("expected a file of type 'id' when unserializing ExperimentHub dataset");return new E(r.id,t)}}async function C(){if(null!==(0,l.A)(v,this))return;let e=m[(0,l.A)(w,this)],t=await N._.call(n,d+"/"+e.counts);try{(0,o.A)(y,this,h.O0(t)),(0,o.A)(v,this,(0,l.A)(y,this).value())}catch(r){throw h.t9((0,l.A)(v,this)),h.t9((0,l.A)(y,this)),r}}async function O(){if(null!==(0,l.A)(g,this))return;let e=m[(0,l.A)(w,this)];if("rowdata"in e){let t,r,s=await N._.call(n,d+"/"+e.rowdata);try{t=h.O0(s),r=t.value();let e=_(r),n=e.row_names,i={};n&&(i.id=n);for(const[t,r]of Object.entries(e.columns))t.match(/^sym/)&&(i[t]=r);if(0==Object.keys(i).length)throw new Error("no acceptable feature identifiers found in the rowData DataFrame");(0,o.A)(g,this,new u.CP(i))}finally{h.t9(r),h.t9(t)}return}await(0,a.A)(x,this,C).call(this);let t=function(e){let t,r,n,s;if("S4"==e.type()?(A(e,{dgCMatrix:"Matrix",dgTMatrix:"Matrix"},"Matrix"),t=e.findAttribute("Dimnames")):t=e.findAttribute("dimnames"),t<0)throw new Error("count matrix does not have dimnames");try{if(r=e.attribute(t),"vector"!=r.type()&&2!=r.size())throw new Error("dimnames of the count matrix should be a list of length 2");if(n=r.load(0),"string"!=n.type())throw new Error("expected a character vector in the first dimnames");s=n.values()}finally{h.t9(r),h.t9(n)}return s}((0,l.A)(v,this));(0,o.A)(g,this,new u.CP({id:t}))}async function M(){if(null!==(0,l.A)(b,this))return;let e=m[(0,l.A)(w,this)];if("coldata"in e){let t,r,s,i=await N._.call(n,d+"/"+e.coldata);try{t=h.O0(i),r=t.value(),s=_(r)}finally{h.t9(r),h.t9(t)}(0,o.A)(b,this,new u.CP(s.columns,{numberOfRows:s.nrow}))}else(0,o.A)(b,this,new u.CP({},{numberOfRows:e.ncol}))}function R(e){let t=(0,l.A)(k,this).primaryRnaFeatureIdColumn;return"string"==typeof t&&e.hasColumn(t)||"number"==typeof t&&t<e.numberOfColumns()?{RNA:e.column(t)}:{RNA:e.rowNames()}}n=E;var N={_:async e=>{let t=await fetch(e);if(!t.ok)throw new Error("failed to fetch content at "+e+" ("+t.status+")");return new Uint8Array(await t.arrayBuffer())}};Error;c.nP},3807:(e,t,r)=>{"use strict";r(9713),r(7990)},3409:(e,t,r)=>{"use strict";r(7990)},9713:(e,t,r)=>{"use strict";r(3409),r(7990),r(932)},8142:(e,t,r)=>{"use strict";r.d(t,{F:()=>b});var n=r(9790),s=r(5149),i=r(6562),a=r(4558),l=r(8458),o=r(7990),h=r(3619),u=r(6164),c=r(6774),f=r(4736),d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakSet;class b{constructor(e){(0,n.A)(this,g),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),(0,s.A)(this,w,void 0),e instanceof u.V?(0,a.A)(d,this,e):(0,a.A)(d,this,new u.V(e)),(0,a.A)(w,this,b.defaults()),this.clear()}static defaults(){return{featureTypeRnaName:"Gene Expression",featureTypeAdtName:"Antibody Capture",featureTypeCrisprName:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:0,primaryAdtFeatureIdColumn:0,primaryCrisprFeatureIdColumn:0}}options(){return{...(0,l.A)(w,this)}}setOptions(e){for(const[t,r]of Object.entries(e))(0,l.A)(w,this)[t]=r}clear(){"function"==typeof(0,l.A)(A,this)&&(0,l.A)(A,this).call(this),(0,a.A)(A,this,null),(0,a.A)(m,this,null),(0,a.A)(p,this,null),(0,a.A)(_,this,null)}static format(){return"10X"}abbreviate(){return(0,i.A)(g,this,v).call(this,(e=>({name:e.name(),size:e.size()})))}summary(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.A)(g,this,k).call(this),(0,i.A)(g,this,x).call(this);let t={modality_features:f.Ku((0,l.A)(p,this),"type"),cells:(0,l.A)(_,this)};return e||this.clear(),t}previewPrimaryIds(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.A)(g,this,k).call(this);let t=f.eZ((0,l.A)(p,this),"type",(0,i.A)(g,this,E).call(this),"RNA",(0,i.A)(g,this,C).call(this));return e||this.clear(),t}load(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.A)(g,this,k).call(this),(0,i.A)(g,this,x).call(this);let t=o.nU((0,l.A)(m,this),"matrix"),r=f.nu(t,(0,l.A)(p,this),"type",(0,i.A)(g,this,E).call(this),"RNA");return r.cells=(0,l.A)(_,this),r.primary_ids=f.gu(r.features,(0,i.A)(g,this,C).call(this)),e||this.clear(),r}serialize(){return(0,i.A)(g,this,v).call(this,(e=>e))}static async unserialize(e,t){if(1!=e.length||"h5"!=e[0].type)throw new Error("expected exactly one file of type 'h5' for 10X HDF5 unserialization");let r=new b(e[0].file);return r.setOptions(r),r}}function v(e){return{files:[{type:"h5",file:e((0,l.A)(d,this))}],options:this.options()}}function y(){if(null!==(0,l.A)(m,this))return;let e=o.He((0,l.A)(d,this).content());(0,a.A)(m,this,e.path),(0,a.A)(A,this,e.flush)}function k(){if(null!==(0,l.A)(p,this))return;(0,i.A)(g,this,y).call(this);let e=new o.CE((0,l.A)(m,this));if(!("matrix"in e.children)||"Group"!=e.children.matrix)throw new Error("expected a 'matrix' group at the top level of the file");let t=e.open("matrix");if(!("features"in t.children)||"Group"!=t.children.features)throw new Error("expected a 'matrix/features' group containing the feature annotation");let r=t.open("features"),n=c.DK(r,"id");if(null==n)throw new Error("expected a 'matrix/features/id' string dataset containing the feature IDs");let s=new h.CP({id:n}),u=c.DK(r,"name");null!==u&&s.$setColumn("name",u);let f=c.DK(r,"feature_type");null!==f&&s.$setColumn("type",f),(0,a.A)(p,this,s)}function x(){if(null!==(0,l.A)(_,this))return;(0,i.A)(g,this,y).call(this);let e=o.c3((0,l.A)(m,this),"matrix");(0,a.A)(_,this,new h.CP({},{numberOfRows:e.columns}))}function E(){return{RNA:(0,l.A)(w,this).featureTypeRnaName,ADT:(0,l.A)(w,this).featureTypeAdtName,CRISPR:(0,l.A)(w,this).featureTypeCrisprName}}function C(){return{RNA:(0,l.A)(w,this).primaryRnaFeatureIdColumn,ADT:(0,l.A)(w,this).primaryAdtFeatureIdColumn,CRISPR:(0,l.A)(w,this).primaryCrisprFeatureIdColumn}}},3279:(e,t,r)=>{"use strict";r.d(t,{ab:()=>U,nP:()=>N});var n=r(9790),s=r(6562),i=r(5149),a=r(8458),l=r(4558),o=r(7990),h=r(3619),u=r(6774),c=r(4736),f=r(6164);async function d(e,t){"string"==typeof e&&(e=await t.metadata(e));let r,n,s=await t.file(e.path),i=null;if(e.$schema.startsWith("csv_data_frame/")){let t=await u.N9(s,{delim:","});r=t.shift(),n=new Array(r.length);for(var a=0;a<n.length;a++){let e=[];for(const r of t)e.push(r[a]);n[a]=e}e.data_frame.row_names&&(i=n.shift(),r.shift());for(a=0;a<n.length;a++){let t=e.data_frame.columns[a].type;"integer"==t?n[a]=new Int32Array(n[a]):"number"==t?n[a]=new Float64Array(n[a]):"boolean"==t&&(n[a]=n[a].map((e=>"true"==e)))}}else{if(!e.$schema.startsWith("hdf5_data_frame/"))throw new Error("unknown data_frame schema type '"+e.$schema+"'");{let t=o.He(s);try{let s=new o.CE(t.path).open(e.hdf5_data_frame.group);r=s.open("column_names",{load:!0}).values,e.data_frame.row_names&&(i=s.open("row_names",{load:!0}).values),n=[];let l=s.open("data");for(a=0;a<r.length;a++){if(!(String(a)in l.children)){n.push(null);continue}let t=l.open(String(a),{load:!0}),r=t.values,s=e.data_frame.columns[a];if("integer"==s)(r instanceof Float64Array||r instanceof Float32Array)&&(r=new Int32Array(r));else if("number"==s)r instanceof Float64Array||r instanceof Float32Array||(r=new Float64Array(r));else if("boolean"==s){let e=new Array(r.length);for(a=0;a<r.length;a++)-2147483648==r[a]?e[a]=null:e[a]=0!=r[a];r=e}else if(("string"==s||"date"==s)&&"missing-value-placeholder"in t.attributes){let e=t.readAttribute("missing-value-placeholder").values[0];for(a=0;a<r.length;a++)r[a]==e&&(r[a]=null)}n.push(r)}}finally{t.flush()}}}let l={},c=[];for(a=0;a<n.length;a++)if("other"===e.data_frame.columns[a].type){let n=await t.metadata(e.data_frame.columns[a].resource.path);try{l[r[a]]=await d(n,t),c.push(r[a])}catch(f){console.warn(f)}}else l[r[a]]=n[a],c.push(r[a]);return new h.CP(l,{columnOrder:c,rowNames:i,numberOfRows:e.data_frame.dimensions[0]})}const m="";async function A(e,t){let r=async e=>{if("row_data"in e.summarized_experiment){let r=e.summarized_experiment.row_data.resource.path;return await d(r,t)}return new h.CP({},{numberOfRows:e.summarized_experiment.dimensions[0]})},n=await t.metadata(e),s={};if(s[m]=await r(n),"single_cell_experiment"in n)for(const a of n.single_cell_experiment.alternative_experiments)try{let e=await t.metadata(a.resource.path);s[a.name]=await r(e)}catch(i){console.warn("failed to extract features for alternative Experiment '"+a.name+"'; "+i.message)}return s}async function p(e,t){let r=e=>{let t=[];for(const r of e.summarized_experiment.assays)t.push(r.name);return t},n=await t.metadata(e),s={};if(s[m]=r(n),"single_cell_experiment"in n)for(const a of n.single_cell_experiment.alternative_experiments)try{let e=await t.metadata(a.resource.path);s[a.name]=r(e)}catch(i){console.warn("failed to extract features for alternative Experiment '"+a.name+"'; "+i.message)}return s}async function _(e,t,r,n){if("string"==typeof t){var s=0;for(const r of e.summarized_experiment.assays){if(r.name==t){t=s;break}s++}if(s==e.summarized_experiment.assays.length)throw new Error("assay '"+t+"' not found")}else if(t>=e.summarized_experiment.assays.length)throw new Error("assay "+String(t)+" out of range");return w(e.summarized_experiment.assays[t].resource.path,r,n)}async function w(e,t,r){let n,s=await t.metadata(e),i=await t.file(s.path),a=s.$schema,l=a.startsWith("hdf5_dense_array/"),h=a.startsWith("hdf5_sparse_matrix/");if(l||h){let e=h?s.hdf5_sparse_matrix.group:s.hdf5_dense_array.dataset,t=o.He(i);try{n=o.nU(t.path,e,{forceInteger:r})}finally{t.flush()}}else{if(!s.$schema.startsWith("hdf5_delayed_array/"))throw new Error("array schema '"+s.$schema+"' is currently not supported");{let e=o.He(i);try{let r=new o.CE(e.path).open(s.hdf5_delayed_array.group);if(n=await async function(e,t){if("operation"!==e.readAttribute("delayed_type").values[0])return null;if("unary arithmetic"!==e.readAttribute("delayed_operation").values[0])return null;if(Math.abs(e.open("value",{load:!0}).values[0]-Math.log(2))>1e-8)return null;if("/"!==e.open("method",{load:!0}).values[0])return null;if("right"!==e.open("side",{load:!0}).values[0])return null;let r=e.open("seed");if("operation"!==r.readAttribute("delayed_type").values[0])return null;if("unary math"!==r.readAttribute("delayed_operation").values[0])return null;if("log1p"!==r.open("method",{load:!0}).values[0])return null;let n=r.open("seed");if("operation"!==n.readAttribute("delayed_type").values[0])return null;if("unary arithmetic"!==n.readAttribute("delayed_operation").values[0])return null;if("/"!==n.open("method",{load:!0}).values[0])return null;if("right"!==n.open("side",{load:!0}).values[0])return null;if(1!==n.open("along",{load:!0}).values[0])return null;let s=n.open("value",{load:!0}).values,i=n.open("seed");if("array"!==i.readAttribute("delayed_type").values[0])return null;if("custom alabaster local array"!==i.readAttribute("delayed_array").values[0])return null;let a,l=i.open("path",{load:!0}).values[0],h={};try{a=await w(l,t,!1),h.matrix=o.bS(a.matrix,{sizeFactors:s,center:!1}),h.row_ids=a.row_ids}finally{o.t9(a.matrix)}return h}(r,t),null==n)throw new Error("currently only supporting bakana-generated log-counts for delayed arrays")}finally{e.flush()}}}return n}async function g(e,t){let r=await t.metadata(e);if(!r.$schema.startsWith("json_simple_list/"))throw new Error("currently only support JSON-formatted lists in the 'other_data'");let n=await t.file(r.path),s=new f.V(n,{name:"list.json"}),i=u.Mz(s.buffer(),{compression:"gzip"==r.json_simple_list.compression?"gz":"none"});return b(JSON.parse(i))}function b(e){if(!("type"in e))throw new Error("non-standard JSON object for 'json_simple_list' schema");if("number"==e.type){if(e.values instanceof Array){let t=new Float64Array(e.values.length);return e.values.forEach(((e,r)=>{t[r]=null===e?Number.NaN:e})),t}return null==e.values?Number.NaN:e.values}if("integer"==e.type){if(e.values instanceof Array){let t=new Int32Array(e.values.length);return e.values.forEach(((e,r)=>{t[r]=null===e?-2147483648:e})),t}return e.values}if("boolean"==e.type||"string"==e.type)return e.values;if("list"==e.type){if("names"in e){let r={};for(var t=0;t<e.values.length;t++)r[e.names[t]]=b(e.values[t]);return r}{let r=[];for(t=0;t<e.values.length;t++)r.push(b(e.values[t]));return r}}return"nothing"==e.type||console.warn("JSON simple list containing type '"+e.type+"' is not yet supported"),null}var v=new WeakMap,y=new WeakMap;class k{constructor(e){(0,i.A)(this,v,void 0),(0,i.A)(this,y,void 0),(0,l.A)(v,this,e),(0,l.A)(y,this,{})}clear(){(0,l.A)(y,this,{}),"clear"in(0,a.A)(v,this)&&(0,a.A)(v,this).clear()}async metadata(e){if(e in(0,a.A)(y,this))return(0,a.A)(y,this)[e];{let t=await(0,a.A)(v,this).metadata(e);return(0,a.A)(y,this)[e]=t,t}}file(e){return(0,a.A)(v,this).file(e)}}var x=new WeakMap,E=new WeakMap,C=new WeakMap,O=new WeakMap,M=new WeakMap,R=new WeakSet;class N{constructor(e,t){(0,n.A)(this,R),(0,i.A)(this,x,void 0),(0,i.A)(this,E,void 0),(0,i.A)(this,C,void 0),(0,i.A)(this,O,void 0),(0,i.A)(this,M,void 0),(0,l.A)(x,this,e),(0,l.A)(E,this,new k(t)),(0,l.A)(M,this,N.defaults()),(0,s.A)(R,this,S).call(this)}static defaults(){return{rnaCountAssay:0,adtCountAssay:0,crisprCountAssay:0,rnaExperiment:"",adtExperiment:"Antibody Capture",crisprExperiment:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:null,primaryAdtFeatureIdColumn:null,primaryCrisprFeatureIdColumn:null}}options(){return{...(0,a.A)(M,this)}}setOptions(e){for(const[t,r]of Object.entries(e))(0,a.A)(M,this)[t]=r}clear(){(0,s.A)(R,this,S).call(this),(0,a.A)(E,this).clear()}async summary(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,s.A)(R,this,W).call(this),await(0,s.A)(R,this,I).call(this);let t={modality_features:(0,a.A)(C,this),cells:(0,a.A)(O,this),modality_assay_names:await p((0,a.A)(x,this),(0,a.A)(E,this))};return e||this.clear(),t}async previewPrimaryIds(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,s.A)(R,this,W).call(this);let t={RNA:(0,a.A)(M,this).rnaExperiment,ADT:(0,a.A)(M,this).adtExperiment,CRISPR:(0,a.A)(M,this).crisprExperiment},r=c.q((0,a.A)(C,this),t,(0,s.A)(R,this,P).call(this));return e||this.clear(),r}async load(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,s.A)(R,this,W).call(this),await(0,s.A)(R,this,I).call(this);let t={matrix:new o.P_,features:{},cells:(0,a.A)(O,this)},r={RNA:{exp:(0,a.A)(M,this).rnaExperiment,assay:(0,a.A)(M,this).rnaCountAssay},ADT:{exp:(0,a.A)(M,this).adtExperiment,assay:(0,a.A)(M,this).adtCountAssay},CRISPR:{exp:(0,a.A)(M,this).crisprExperiment,assay:(0,a.A)(M,this).crisprCountAssay}},n=await(0,a.A)(E,this).metadata((0,a.A)(x,this)),i={},l=[];if("single_cell_experiment"in n){l=n.single_cell_experiment.alternative_experiments;for(const e of l)i[e.name]=e.resource.path}try{for(const[e,s]of Object.entries(r)){if(null===s.exp)continue;let r=null,o=s.exp;if("string"==typeof s.exp)if(""===s.exp)r=n;else{if(!(s.exp in i))continue;r=await(0,a.A)(E,this).metadata(i[s.exp])}else{if(s.exp>=l.length)continue;o=l[s.exp].name,r=await(0,a.A)(E,this).metadata(l[s.exp].resource.path)}let u=await _(r,s.assay,(0,a.A)(E,this),!0);t.matrix.add(e,u.matrix),t.features[e]=h.$9((0,a.A)(C,this)[o],u.row_ids)}t.primary_ids=c.gu(t.features,(0,s.A)(R,this,P).call(this))}catch(u){throw o.t9(t.matrix),u}return e||this.clear(),t}}function S(){(0,l.A)(C,this,null),(0,l.A)(O,this,null)}async function W(){null===(0,a.A)(C,this)&&(0,l.A)(C,this,await A((0,a.A)(x,this),(0,a.A)(E,this)))}async function I(){if(null!==(0,a.A)(O,this))return;let e=(await(0,a.A)(E,this).metadata((0,a.A)(x,this))).summarized_experiment.column_data.resource.path;(0,l.A)(O,this,await d(e,(0,a.A)(E,this)))}function P(){return{RNA:(0,a.A)(M,this).primaryRnaFeatureIdColumn,ADT:(0,a.A)(M,this).primaryAdtFeatureIdColumn,CRISPR:(0,a.A)(M,this).primaryCrisprFeatureIdColumn}}var D=new WeakMap,T=new WeakMap,z=new WeakMap,j=new WeakMap,F=new WeakMap,q=new WeakMap,L=new WeakSet;class U{constructor(e,t){(0,n.A)(this,L),(0,i.A)(this,D,void 0),(0,i.A)(this,T,void 0),(0,i.A)(this,z,void 0),(0,i.A)(this,j,void 0),(0,i.A)(this,F,void 0),(0,i.A)(this,q,void 0),(0,l.A)(D,this,e),(0,l.A)(T,this,new k(t)),(0,l.A)(q,this,U.defaults()),(0,s.A)(L,this,B).call(this)}static defaults(){return{primaryAssay:0,isPrimaryNormalized:!0,reducedDimensionNames:null}}options(){return{...(0,a.A)(q,this)}}setOptions(e){for(const[t,r]of Object.entries(e))(0,a.A)(q,this)[t]=h.UC(r)}clear(){(0,s.A)(L,this,B).call(this),(0,a.A)(T,this).clear()}async summary(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,s.A)(L,this,$).call(this),await(0,s.A)(L,this,V).call(this),await(0,s.A)(L,this,G).call(this);let t={modality_features:(0,a.A)(z,this),cells:(0,a.A)(j,this),modality_assay_names:await p((0,a.A)(D,this),(0,a.A)(T,this)),reduced_dimension_names:[],other_metadata:(0,a.A)(F,this)},r=await(0,a.A)(T,this).metadata((0,a.A)(D,this));if("single_cell_experiment"in r){let e=r.single_cell_experiment.reduced_dimensions;await(0,s.A)(L,this,K).call(this,e,t.reduced_dimension_names)}return e||this.clear(),t}async load(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,s.A)(L,this,$).call(this),await(0,s.A)(L,this,V).call(this),await(0,s.A)(L,this,G).call(this);let t=await(0,a.A)(T,this).metadata((0,a.A)(D,this)),r={matrix:new o.P_,features:{},cells:(0,a.A)(j,this),reduced_dimensions:{},other_metadata:(0,a.A)(F,this)};{let e=(0,a.A)(q,this).reducedDimensionNames,i=t.single_cell_experiment.reduced_dimensions;if(null==e&&(e=[],await(0,s.A)(L,this,K).call(this,i,e)),e.length>0){let t={};for(const e of i)t[e.name]=e.resource.path;for(const s of e){let e=await(0,a.A)(T,this).metadata(t[s]),i=e.array.dimensions,l=await(0,a.A)(T,this).file(e.path),h=o.He(l),u=[];try{let t=new o.CE(h.path).open(e.hdf5_dense_array.dataset,{load:!0}).values;for(var n=0;n<i[1];n++)u.push(t.slice(n*i[0],(n+1)*i[0]))}finally{h.flush()}r.reduced_dimensions[s]=u}}}{let e={};if("single_cell_experiment"in t)for(const r of t.single_cell_experiment.alternative_experiments)e[r.name]=r.resource.path;try{for(const[n,s]of Object.entries((0,a.A)(z,this))){let s=(0,a.A)(q,this).primaryAssay;if("object"==typeof s){if(!(n in s))continue;s=s[n]}let i,l=(0,a.A)(q,this).isPrimaryNormalized;"object"==typeof l&&(l=!(n in l)||l[n]),i=""===n?t:await(0,a.A)(T,this).metadata(e[n]);let u=await _(i,s,(0,a.A)(T,this),!l);if(r.matrix.add(n,u.matrix),!l){let e=o.bS(u.matrix,{allowZeros:!0});r.matrix.add(n,e)}null!==u.row_ids?r.features[n]=h.$9((0,a.A)(z,this)[n],u.row_ids):r.features[n]=(0,a.A)(z,this)[n]}}catch(i){throw o.t9(r.matrix),i}}return e||this.clear(),r}}function B(){(0,l.A)(z,this,null),(0,l.A)(j,this,null),(0,l.A)(F,this,null)}async function $(){null===(0,a.A)(z,this)&&(0,l.A)(z,this,await A((0,a.A)(D,this),(0,a.A)(T,this)))}async function V(){if(null!==(0,a.A)(j,this))return;let e=(await(0,a.A)(T,this).metadata((0,a.A)(D,this))).summarized_experiment.column_data.resource.path;(0,l.A)(j,this,await d(e,(0,a.A)(T,this)))}async function G(){if(null!==(0,a.A)(F,this))return;let e=await(0,a.A)(T,this).metadata((0,a.A)(D,this));if("other_data"in e.summarized_experiment){let t=e.summarized_experiment.other_data.resource.path;(0,l.A)(F,this,await g(t,(0,a.A)(T,this)))}else(0,l.A)(F,this,{})}async function K(e,t){for(const r of e){let e=await(0,a.A)(T,this).metadata(r.resource.path);e.$schema.startsWith("hdf5_dense_array/")&&2==e.array.dimensions.length&&t.push(r.name)}}},6164:(e,t,r)=>{"use strict";r.d(t,{V:()=>u});var n=r(5149),s=r(8458),i=r(4558),a=new WeakMap,l=new WeakMap,o=new WeakMap,h=new WeakMap;class u{constructor(e){let{name:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,n.A)(this,a,void 0),(0,n.A)(this,l,void 0),(0,n.A)(this,o,void 0),(0,n.A)(this,h,void 0),e instanceof File)(0,i.A)(a,this,"file"),(0,i.A)(o,this,e),null===t&&(t=e.name),(0,i.A)(h,this,t);else{if(!(e instanceof Uint8Array))throw new Error("unknown type '"+typeof e+"' for SimpleFile constructor");if((0,i.A)(a,this,"buffer"),(0,i.A)(l,this,e),null===t)throw new Error("'name' must be provided for Uint8Array inputs in SimpleFile constructor");(0,i.A)(h,this,t)}}buffer(){let{copy:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("file"==(0,s.A)(a,this)){let e=(new FileReaderSync).readAsArrayBuffer((0,s.A)(o,this));return new Uint8Array(e)}return e?(0,s.A)(l,this).slice():(0,s.A)(l,this)}size(){return"file"==(0,s.A)(a,this)?(0,s.A)(o,this).size:(0,s.A)(l,this).length}name(){return(0,s.A)(h,this)}content(){let{copy:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffer({copy:e})}}},2814:(e,t,r)=>{"use strict";r.d(t,{f:()=>v});var n=r(9790),s=r(5149),i=r(6562),a=r(4558),l=r(8458),o=r(7990),h=r(3619),u=r(6164),c=r(6774),f=r(4736),d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakSet;class v{constructor(e,t,r){let{featureTypeRnaName:i="Gene Expression",featureTypeAdtName:l="Antibody Capture",featureTypeCrisprName:o="CRISPR Guide Capture",primaryRnaFeatureIdColumn:h=0,primaryAdtFeatureIdColumn:c=0,primaryCrisprFeatureIdColumn:f=0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,n.A)(this,b),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),(0,s.A)(this,w,void 0),(0,s.A)(this,g,void 0),e instanceof u.V?(0,a.A)(d,this,e):(0,a.A)(d,this,new u.V(e)),t instanceof u.V||null==t?(0,a.A)(m,this,t):(0,a.A)(m,this,new u.V(t)),r instanceof u.V||null==r?(0,a.A)(A,this,r):(0,a.A)(A,this,new u.V(r)),(0,a.A)(g,this,v.defaults()),this.clear()}static defaults(){return{featureTypeRnaName:"Gene Expression",featureTypeAdtName:"Antibody Capture",featureTypeCrisprName:"CRISPR Guide Capture",primaryRnaFeatureIdColumn:0,primaryAdtFeatureIdColumn:0,primaryCrisprFeatureIdColumn:0}}options(){return{...(0,l.A)(g,this)}}setOptions(e){for(const[t,r]of Object.entries(e))(0,l.A)(g,this)[t]=r}clear(){(0,a.A)(p,this,null),(0,a.A)(_,this,null),(0,a.A)(w,this,null)}static format(){return"MatrixMarket"}abbreviate(e){return(0,i.A)(b,this,y).call(this,(e=>({name:e.name(),size:e.size()})))}async summary(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,i.A)(b,this,x).call(this),await(0,i.A)(b,this,E).call(this);let t={modality_features:f.Ku((0,l.A)(_,this),"type"),cells:(0,l.A)(w,this)};return e||this.clear(),t}async previewPrimaryIds(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,i.A)(b,this,x).call(this);let t=f.eZ((0,l.A)(_,this),"type",(0,i.A)(b,this,C).call(this),"RNA",(0,i.A)(b,this,O).call(this));return e||this.clear(),t}async load(){let{cache:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await(0,i.A)(b,this,x).call(this),await(0,i.A)(b,this,E).call(this);var t=(0,l.A)(d,this).name().endsWith(".gz");let r=o.pn((0,l.A)(d,this).content(),{compressed:t}),n=f.nu(r,(0,l.A)(_,this),"type",(0,i.A)(b,this,C).call(this),"RNA");return n.cells=(0,l.A)(w,this),n.primary_ids=f.gu(n.features,(0,i.A)(b,this,O).call(this)),e||this.clear(),n}async serialize(){return(0,i.A)(b,this,y).call(this,(e=>e))}static async unserialize(e,t){let r={};for(const a of e){if(a.type in r)throw new Error("duplicate file of type '"+a.type+"' detected during MatrixMarket unserialization");r[a.type]=a.file}if(!("mtx"in r))throw new Error("expected file of type 'mtx' for during MatrixMarket unserialization");let n=null;"genes"in r&&(n=r.genes);let s=null;"annotations"in r&&(s=r.annotations);let i=new v(r.mtx,n,s);return i.setOptions(t),i}}function y(e){let t=[{type:"mtx",file:e((0,l.A)(d,this))}];return null!==(0,l.A)(m,this)&&t.push({type:"genes",file:e((0,l.A)(m,this))}),null!==(0,l.A)(A,this)&&t.push({type:"annotations",file:e((0,l.A)(A,this))}),{files:t,options:this.options()}}function k(){if(null!==(0,l.A)(p,this))return;var e=(0,l.A)(d,this).name().endsWith(".gz");let t=o.M_((0,l.A)(d,this).content(),{compressed:e});(0,a.A)(p,this,[t.rows,t.columns])}async function x(){if(null!==(0,l.A)(_,this))return;(0,i.A)(b,this,k).call(this);let e=(0,l.A)(p,this)[0];if(null==(0,l.A)(m,this))return void(0,a.A)(_,this,new h.CP({},{numberOfRows:e}));let t=(0,l.A)(m,this).name();var r=t.endsWith(".gz");let n=await c.N9((0,l.A)(m,this).content(),{compression:r?"gz":"none"});if(n.length==e+1){let e={};return n.shift().forEach(((t,r)=>{e[t]=n.map((e=>e[r]))})),void(0,a.A)(_,this,e)}if(n.length!==e)throw new Error("number of matrix rows is not equal to the number of rows in '"+t+"'");var s=[],o=[];n.forEach((e=>{s.push(e[0]),o.push(e[1])}));let u=new h.CP({},{numberOfRows:e});if(u.$setColumn("id",s),u.$setColumn("name",o),n[0].length>2){let e=[];n.forEach((t=>{e.push(t[2])})),u.$setColumn("type",e)}(0,a.A)(_,this,u)}async function E(){if(null!==(0,l.A)(w,this))return;if((0,i.A)(b,this,k).call(this),null==(0,l.A)(A,this))return void(0,a.A)(w,this,new h.CP({},{numberOfRows:(0,l.A)(p,this)[1]}));let e=(0,l.A)(A,this).name();var t=e.endsWith(".gz");let r,n=await c.N9((0,l.A)(A,this).content(),{compression:t?"gz":"none"}),s=(0,l.A)(p,this)[1]-n.length;if(0==s)r=n[0];else{if(-1!=s)throw new Error("number of matrix columns is not equal to the number of rows in '"+e+"'");r=n.shift()}let o={};r.forEach(((e,t)=>{o[e]=n.map((e=>e[t]))}));for(const[i,a]of Object.entries(o)){let e=c.px(a);null!==e&&(o[i]=e)}(0,a.A)(w,this,new h.CP(o))}function C(){return{RNA:(0,l.A)(g,this).featureTypeRnaName,ADT:(0,l.A)(g,this).featureTypeAdtName,CRISPR:(0,l.A)(g,this).featureTypeCrisprName}}function O(){return{RNA:(0,l.A)(g,this).primaryRnaFeatureIdColumn,ADT:(0,l.A)(g,this).primaryAdtFeatureIdColumn,CRISPR:(0,l.A)(g,this).primaryCrisprFeatureIdColumn}}},3204:(e,t,r)=>{"use strict";function n(e,t,r,n,s){s("no support for file paths in the browser context")}function s(e,t){throw new Error("no support for file paths in the browser context")}r.d(t,{T:()=>n,s:()=>s})},6774:(e,t,r)=>{"use strict";r.d(t,{DK:()=>l,Mz:()=>u,N9:()=>m,hp:()=>o,px:()=>A,we:()=>d});var n=r(932),s=r(5766),i=r(3204),a=r(6164);function l(e,t){if(!(t in e.children))return null;if("DataSet"!==e.children[t])return null;let r=e.open(t);return"String"!==r.type?null:r.load()}function o(e){let{limit:t=50}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof Array){let r=Array.from(new Set(e));r.sort();let n=!1;return r.length>t&&(r=r.slice(0,t),n=!0),{type:"categorical",values:r,truncated:n}}{let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.forEach((e=>{e<t&&(t=e),e>r&&(r=e)})),{type:"continuous",min:t,max:r}}}function h(e,t){if(null!==t)return t;let r;return r=e instanceof Uint8Array?e:i.s(e,3),r.length>=3&&31==r[0]&&139==r[1]&&8==r[2]?"gz":"none"}function u(e){let{compression:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=h(e,t);let r="gz"===t?n.Aq(e):e;return(new TextDecoder).decode(r)}function c(e,t){let r=0;for(const s of e)r+=s.length;let n=new Uint8Array(r);r=0;for(const s of e)n.set(s,r),r+=s.length;return t.decode(n)}async function f(e,t,r,s){"string"==typeof e||e instanceof Uint8Array||(e=e instanceof a.V?e.content():new a.V(e,{name:"dummy"}).content()),"gz"!=h(e,t)?"string"!=typeof e?s(e):await new Promise(((t,n)=>i.T(e,r,s,t,n))):await new Promise(((t,a)=>{let l=new n.EL({chunkSize:r});l.onData=s,l.onEnd=e=>{e?a("gzip decompression failed; "+l.msg):t(null)},"string"==typeof e?i.T(e,r,(e=>l.push(e)),null,a):l.push(e)}))}async function d(e){let{compression:t=null,chunkSize:r=65536}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new TextDecoder;let s=[],i=[];return await f(e,t,r,(e=>{let t=0;for(var r=0;r<e.length;r++)if(10==e[r]){let a=e.subarray(t,r);s.length?(s.push(a),i.push(c(s,n)),s=[]):i.push(n.decode(a)),t=r+1}t!=e.length&&s.push(e.slice(t))})),s.length&&i.push(c(s,n)),i}async function m(e){let{compression:t=null,delim:r="\t",chunkSize:n=1048576}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new TextDecoder;let a=[],l=e=>{let t=s.parse(e,{delimiter:r});if(t.meta.aborted){let e="failed to parse delimited file";for(const r of t.errors)e+="; "+r.message;throw new Error(e)}for(const r of t.data)a.push(r)},o=[],h=0;if(await f(e,t,n,(e=>{let t=0;for(var r=0;r<e.length;r++)if(10==e[r]&&r-t+h>=n){let n=e.subarray(t,r);o.length?(o.push(n),l(c(o,i)),o=[]):l(i.decode(n)),t=r+1,h=0}t!=e.length&&(o.push(e.slice(t)),h+=e.length-t)})),o.length){let e=c(o,i);l(e),"\n"==e[e.length-1]&&a.pop()}return a}function A(e){let t=new Float64Array(e.length);for(const[r,n]of Object.entries(e)){let e=Number(n),s=parseFloat(n);if(isNaN(e)||isNaN(s))if(""===n||"NA"===n||"na"==n||"NaN"==n||"nan"==n)t[r]=NaN;else if("Inf"==n||"inf"==n)t[r]=Number.POSITIVE_INFINITY;else{if("-Inf"!=n&&"-inf"!=n)return null;t[r]=Number.NEGATIVE_INFINITY}else t[r]=e}return t}},4736:(e,t,r)=>{"use strict";r.d(t,{Ku:()=>a,eZ:()=>h,gu:()=>f,nu:()=>u,q:()=>d});var n=r(7990),s=r(3619);function i(e,t){let r={};return r[t]=e,r}function a(e,t){if(e.hasColumn(t)){let r=s.zJ(e.column(t)),n=e.removeColumn(t);return s.JP(n,r)}return i(e,"")}function l(e,t){let r={};for(const[n,s]of Object.entries(t))null!==s&&s in e&&(r[n]=e[s]);return r}function o(e,t,r){let n=s.zJ(e.column(t));return null===r?n:l(n,r)}function h(e,t,r,n,i){if(null!==t&&e.hasColumn(t)){let n=o(e,t,r);for(const[t,r]of Object.entries(n)){let a=c(t,e,i);n[t]=s.$9(a,r)}return n}let a=function(e,t){let r=null,n=!1;for(const[s,i]of Object.entries(e))null!==i&&(null!==r&&(n=!0),r=s);return null===r||n?t:r}(r,n),l={};return l[a]=c(a,e,i),l}function u(e,t,r,a,l){let h={matrix:new n.P_};try{let u,c=e.matrix;if(h.matrix.add("",c),u=null!==e.row_ids?s.$9(t,e.row_ids):s.UC(t,{deepCopy:!1}),null!==r&&u.hasColumn(r)){let e=o(u,r,a),t=Object.keys(e),i=function(e,t){if(e.length!=t)return!1;for(var r=0;r<t;r++)if(r!==e[r])return!1;return!0}(t[0],c.numberOfRows());if(t.length>1||!i){let t=new n.P_({store:n.aN(c,e)});n.t9(h.matrix),h.matrix=t}else h.matrix.rename("",t[0]);delete u[r],h.features=s.JP(u,e)}else h.matrix.rename("",l),h.features=i(u,l)}catch(u){throw n.t9(h.matrix),u}return h}function c(e,t,r){if(!(e in r))throw new Error("modality '"+e+"' has no primary key identifier");let n=r[e];return"string"==typeof n&&t.hasColumn(n)||"number"==typeof n&&n<t.numberOfColumns()?t.column(n):t.rowNames()}function f(e,t){let r={};for(const[n,s]of Object.entries(e))r[n]=c(n,s,t);return r}function d(e,t,r){return f(l(e,t),r)}},4642:(e,t,r)=>{"use strict";function n(){return new Worker(new URL(r.p+r.u(433),r.b),{type:void 0})}function s(){return new Worker(new URL(r.p+r.u(343),r.b),{type:void 0})}r.d(t,{H:()=>n,I:()=>s})},3819:(e,t,r)=>{"use strict";r.d(t,{Kj:()=>g,P4:()=>d});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(1065),c=r(5817),f=r(4201);const d="adt_normalization";var m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakSet;class g{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,w),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),!(e instanceof c.DY))throw new Error("'qc' should be a AdtQualityControlState object");if((0,l.A)(m,this,e),!(t instanceof f._J))throw new Error("'filter' should be a CellFilteringState object");(0,l.A)(A,this,t),(0,l.A)(p,this,null===r?{}:r),(0,l.A)(_,this,null===i?{}:i),this.changed=!1}free(){h.xr((0,a.A)(_,this).matrix),h.xr((0,a.A)(_,this).total_buffer),h.xr((0,a.A)(_,this).sf_buffer),h.xr((0,a.A)(_,this).centered_sf_buffer)}valid(){return(0,a.A)(A,this).fetchFilteredMatrix().has("ADT")}fetchNormalizedMatrix(){return"matrix"in(0,a.A)(_,this)||(0,i.A)(w,this,b).call(this),(0,a.A)(_,this).matrix}fetchSizeFactors(){let e;return(0,a.A)(_,this).sf_buffer&&(e=h.RK((0,a.A)(_,this).sf_buffer.length,"Float64Array",(0,a.A)(_,this),"centered_sf_buffer"),o.D0((0,a.A)(_,this).sf_buffer,{buffer:e,block:(0,a.A)(A,this).fetchFilteredBlock()})),e}fetchParameters(){return{...(0,a.A)(p,this)}}compute(e){const{num_pcs:t,num_clusters:r}=e;let n=!0;if("remove_bias"in e&&(n=e.remove_bias),this.changed=!1,((0,a.A)(m,this).changed||(0,a.A)(A,this).changed||n!==(0,a.A)(p,this).remove_bias||n&&(t!==(0,a.A)(p,this).num_pcs||r!=(0,a.A)(p,this).num_clusters))&&this.valid()){var s=(0,a.A)(A,this).fetchFilteredMatrix().get("ADT");let e=u.L((0,a.A)(m,this),(0,a.A)(A,this),s,(0,a.A)(_,this),"total_buffer");var l=(0,a.A)(A,this).fetchFilteredBlock(),c=h.RK(s.numberOfColumns(),"Float64Array",(0,a.A)(_,this),"sf_buffer");n?o.Gh(s,{totals:e,block:l,buffer:c,numberOfPCs:t,numberOfClusters:r}):o.D0(e,{buffer:c,block:l}),this.changed=!0}(0,a.A)(p,this).remove_bias=n,(0,a.A)(p,this).num_pcs=t,(0,a.A)(p,this).num_clusters=r,this.changed&&this.valid()&&(0,i.A)(w,this,b).call(this)}static defaults(){return{remove_bias:!0,num_pcs:25,num_clusters:20}}}function b(){var e=(0,a.A)(A,this).fetchFilteredMatrix().get("ADT"),t=(0,a.A)(A,this).fetchFilteredBlock(),r=(0,a.A)(_,this).sf_buffer;if(r.length!=e.numberOfColumns())throw new Error("length of size factor vector should equal number of columns after QC");h.xr((0,a.A)(_,this).matrix),(0,a.A)(_,this).matrix=o.bS(e,{sizeFactors:r,block:t,allowZeros:!0})}},9894:(e,t,r)=>{"use strict";r.d(t,{P4:()=>u,dS:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(4201),h=r(3819);const u="adt_pca";var c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap;class A{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),!(e instanceof o._J))throw new Error("'filter' should be a CellFilteringState object");if((0,i.A)(c,this,e),!(t instanceof h.Kj))throw new Error("'norm' should be a AdtNormalizationState object");(0,i.A)(f,this,t),(0,i.A)(m,this,null===r?{}:r),(0,i.A)(d,this,null===s?{}:s),this.changed=!1}free(){l.xr((0,s.A)(d,this).pcs)}valid(){return(0,s.A)(f,this).valid()}fetchPCs(){return(0,s.A)(d,this).pcs}fetchParameters(){return{...(0,s.A)(m,this)}}compute(e){let{num_pcs:t,block_method:r}=e;if(this.changed=!1,(0,s.A)(f,this).changed||t!==(0,s.A)(m,this).num_pcs||r!==(0,s.A)(m,this).block_method){if(this.valid()){let e=(0,s.A)(c,this).fetchFilteredBlock();var n=(0,s.A)(f,this).fetchNormalizedMatrix();l.xr((0,s.A)(d,this).pcs),(0,s.A)(d,this).pcs=a.CN(n,{numberOfPCs:t,block:e,blockMethod:r}),this.changed=!0}(0,s.A)(m,this).num_pcs=t,(0,s.A)(m,this).block_method=r}}static defaults(){return{num_pcs:20,block_method:"none"}}}},5817:(e,t,r)=>{"use strict";r.d(t,{DY:()=>d,P4:()=>h});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(2697);const h="adt_quality_control";var u=new WeakMap,c=new WeakMap,f=new WeakMap;class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),!(e instanceof o.Xj))throw new Error("'inputs' should be a State object from './inputs.js'");(0,i.A)(u,this,e),(0,i.A)(f,this,null===t?{}:t),(0,i.A)(c,this,null===r?{}:r),this.changed=!1}free(){l.xr((0,s.A)(c,this).metrics),l.xr((0,s.A)(c,this).filters),l.xr((0,s.A)(c,this).metrics_buffer),l.xr((0,s.A)(c,this).discard_buffer)}valid(){return(0,s.A)(u,this).fetchCountMatrix().has("ADT")}fetchParameters(){return{...(0,s.A)(f,this)}}fetchFilters(){return(0,s.A)(c,this).filters}fetchDiscards(){return(0,s.A)(c,this).discard_buffer}fetchMetrics(){return(0,s.A)(c,this).metrics}static defaults(){return{automatic:!0,tag_id_column:null,igg_prefix:"IgG",nmads:3,min_detected_drop:.1}}static configureFeatureParameters(e,t){let r=t=>{let r=0;return t.forEach((t=>{t.toLowerCase().startsWith(e)&&r++})),r},n=null,s=0,i=t.rowNames();null!==i&&(s=r(i));for(const a of t.columnNames()){let e=r(t.column(a));e>s&&(n=a,s=e)}return n}compute(e){let t,r,{igg_prefix:n,nmads:i,min_detected_drop:o}=e;if(this.changed=!1,"automatic"in e?(t=e.automatic,r=e.tag_id_column):(t=!0,r=null),(0,s.A)(u,this).changed||t!==(0,s.A)(f,this).automatic||n!==(0,s.A)(f,this).igg_prefix||!t&&r!==(0,s.A)(f,this).tag_id_column)if(l.xr((0,s.A)(c,this).metrics),this.valid()){var h=(0,s.A)(u,this).fetchFeatureAnnotations().ADT,m=l.RK(h.numberOfRows(),"Uint8Array",(0,s.A)(c,this),"metrics_buffer");if(m.fill(0),null!==n){var A=n.toLowerCase();let e=r;t&&(e=d.configureFeatureParameters(A,h));let s=null==e?h.rowNames():h.column(e);if(null!==s){var p=m.array();s.forEach(((e,t)=>{e.toLowerCase().startsWith(A)&&(p[t]=1)}))}}var _=(0,s.A)(u,this).fetchCountMatrix().get("ADT");(0,s.A)(c,this).metrics=a.A_(_,[m]),this.changed=!0}else delete(0,s.A)(c,this).metrics;if((0,s.A)(f,this).automatic=t,(0,s.A)(f,this).tag_id_column=r,(0,s.A)(f,this).igg_prefix=n,this.changed||i!==(0,s.A)(f,this).nmads||o!==(0,s.A)(f,this).min_detected_drop){if(l.xr((0,s.A)(c,this).filters),this.valid()){let e=(0,s.A)(u,this).fetchBlock();(0,s.A)(c,this).filters=a.RJ((0,s.A)(c,this).metrics,{numberOfMADs:i,minDetectedDrop:o,block:e});var w=l.RK((0,s.A)(c,this).metrics.numberOfCells(),"Uint8Array",(0,s.A)(c,this),"discard_buffer");(0,s.A)(c,this).filters.filter((0,s.A)(c,this).metrics,{block:e,buffer:w}),this.changed=!0}else delete(0,s.A)(c,this).filters;(0,s.A)(f,this).nmads=i,(0,s.A)(f,this).min_detected_drop=o}}}},6629:(e,t,r)=>{"use strict";r.d(t,{P4:()=>u,aA:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(4201),h=r(4468);const u="batch_correction";var c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap;class A{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),!(e instanceof o._J))throw new Error("'filter' should be a CellFilteringState object");if((0,i.A)(c,this,e),!(t instanceof h.TP))throw new Error("'pca' should be a CombineEmbeddingsState object");(0,i.A)(f,this,t),(0,i.A)(d,this,null===r?{}:r),(0,i.A)(m,this,null===s?{}:s),this.changed=!1}free(){l.xr((0,s.A)(m,this).corrected)}fetchCorrected(){return(0,s.A)(m,this).corrected}fetchNumberOfCells(){return(0,s.A)(f,this).fetchNumberOfCells()}fetchNumberOfDimensions(){return(0,s.A)(f,this).fetchNumberOfDimensions()}fetchParameters(){return{...(0,s.A)(d,this)}}compute(e){let{method:t,num_neighbors:r,approximate:n}=e;this.changed=!1,((0,s.A)(c,this).changed||(0,s.A)(f,this).changed)&&(this.changed=!0);let i=(0,s.A)(c,this).fetchFilteredBlock(),o="mnn"==t&&null!==i;if((this.changed||t!==(0,s.A)(d,this).method||r!==(0,s.A)(d,this).num_neighbors||n!==(0,s.A)(d,this).approximate)&&o){let e=(0,s.A)(f,this).fetchCombined(),t=l.RK(e.length,"Float64Array",(0,s.A)(m,this),"corrected");a.sU(e,i,{k:r,buffer:t,numberOfCells:(0,s.A)(f,this).fetchNumberOfCells(),numberOfDims:(0,s.A)(f,this).fetchNumberOfDimensions(),approximate:n}),this.changed=!0}this.changed&&(o||(l.xr((0,s.A)(m,this).corrected),(0,s.A)(m,this).corrected=(0,s.A)(f,this).fetchCombined().view())),(0,s.A)(d,this).method=t,(0,s.A)(d,this).num_neighbors=r,(0,s.A)(d,this).approximate=n}static defaults(){return{method:"mnn",num_neighbors:15,approximate:!0}}}},4201:(e,t,r)=>{"use strict";r.d(t,{P4:()=>m,_J:()=>v});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(1653),c=r(5817),f=r(4935),d=r(2697);const m="cell_filtering";function A(e,t){let r=h.Rj(e),n=[];for(const s of r)t[s]&&n.push(e[s]);return n}var p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakSet;class v{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,b),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),(0,s.A)(this,w,void 0),(0,s.A)(this,g,void 0),!(e instanceof d.Xj))throw new Error("'inputs' should be an InputsState object");if((0,l.A)(p,this,e),!(t.RNA instanceof u.Zx))throw new Error("'qc_states.RNA' should be a RnaQualityControlState object");if(!(t.ADT instanceof c.DY))throw new Error("'qc_states.ADT' should be a AdtQualityControlState object");if(!(t.CRISPR instanceof f.dq))throw new Error("'qc_states.CRISPR' should be a CrisprQualityControlState object");(0,l.A)(_,this,t),(0,l.A)(g,this,null===r?{}:r),(0,l.A)(w,this,null===i?{}:i),this.changed=!1}free(){h.xr((0,a.A)(w,this).block_buffer),h.xr((0,a.A)(w,this).discard_buffer),h.xr((0,a.A)(w,this).matrix)}fetchFilteredMatrix(){return"matrix"in(0,a.A)(w,this)||(0,i.A)(b,this,y).call(this),(0,a.A)(w,this).matrix}fetchFilteredBlock(){return"block_buffer"in(0,a.A)(w,this)||(0,i.A)(b,this,k).call(this),(0,a.A)(w,this).block_buffer}fetchDiscards(){return"discard_buffer"in(0,a.A)(w,this)?(0,a.A)(w,this).discard_buffer:null}fetchParameters(){return{...(0,a.A)(g,this)}}compute(e){let{use_rna:t,use_adt:r,use_crispr:n}=e;this.changed=!1,(0,a.A)(p,this).changed&&(this.changed=!0),(0,a.A)(g,this).use_rna===t&&(0,a.A)(g,this).use_adt===r&&(0,a.A)(g,this).use_crispr===n||((0,a.A)(g,this).use_rna=t,(0,a.A)(g,this).use_adt=r,(0,a.A)(g,this).use_crispr=n,this.changed=!0);let s=A((0,a.A)(_,this),{RNA:t,ADT:r,CRISPR:n});if(!this.changed)for(const i of s)if(i.changed){this.changed=!0;break}if(this.changed){if(s.length>0){let e=s[0].fetchDiscards();if(s.length>1){let t=h.RK(e.length,"Uint8Array",(0,a.A)(w,this),"discard_buffer");t.fill(0);let r=t.array();for(const e of s)e.fetchDiscards().forEach(((e,t)=>{r[t]|=e}))}else h.xr((0,a.A)(w,this).discard_buffer),(0,a.A)(w,this).discard_buffer=e.view()}else h.xr((0,a.A)(w,this).discard_buffer),delete(0,a.A)(w,this).discard_buffer;(0,i.A)(b,this,y).call(this),(0,i.A)(b,this,k).call(this)}}static defaults(){return{use_rna:!0,use_adt:!0,use_crispr:!0}}applyFilter(e){if((0,a.A)(p,this).fetchCountMatrix().numberOfColumns()!=e.length)throw new Error("length of 'x' should be equal to the number of cells in the unfiltered dataset");if("discard_buffer"in(0,a.A)(w,this)){let t=(0,a.A)(w,this).discard_buffer.array();return e.filter(((e,r)=>!t[r]))}return e.slice()}undoFilter(e){let t=this.fetchFilteredMatrix().numberOfColumns();for(const n of e)if(n<0||n>=t)throw new Error("entries of 'indices' should be less than the number of cells in the filtered dataset");if(!("discard_buffer"in(0,a.A)(w,this)))return;let r=[];(0,a.A)(w,this).discard_buffer.forEach(((e,t)=>{0==e&&r.push(t)})),e.forEach(((t,n)=>{e[n]=r[t]}))}}function y(){h.xr((0,a.A)(w,this).matrix),(0,a.A)(w,this).matrix=new o.P_;let e=(0,a.A)(p,this).fetchCountMatrix();for(const t of e.available()){let r,n=e.get(t);r="discard_buffer"in(0,a.A)(w,this)?o.Oi(n,(0,a.A)(w,this).discard_buffer):n.clone(),(0,a.A)(w,this).matrix.add(t,r)}}function k(){h.xr((0,a.A)(w,this).block_buffer);let e=(0,a.A)(p,this).fetchBlock();if(null!==e)if("discard_buffer"in(0,a.A)(w,this)){let t=this.fetchFilteredMatrix().numberOfColumns(),r=h.RK(t,"Int32Array",(0,a.A)(w,this),"block_buffer");o.c5(e,(0,a.A)(w,this).discard_buffer,{buffer:r})}else(0,a.A)(w,this).block_buffer=e.view();else(0,a.A)(w,this).block_buffer=null}},6302:(e,t,r)=>{"use strict";r.d(t,{j:()=>f});var n=r(5149),s=r(8458),i=r(4558),a=(r(7990),r(1276),r(945)),l=r(1040),o=new WeakMap,h=new WeakMap,u=new WeakMap,c=new WeakMap;class f{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,o,void 0),(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),!(e instanceof a.$V))throw new Error("'snn' should be a State object from './snn_graph_cluster.js'");if((0,i.A)(o,this,e),!(t instanceof l.d))throw new Error("'kmeans' should be a State object from './kmeans_cluster.js'");(0,i.A)(h,this,t),(0,i.A)(u,this,null===r?{}:r),(0,i.A)(c,this,null===s?{}:s),this.changed=!1}free(){}fetchClusters(){return"snn_graph"==(0,s.A)(u,this).method?(0,s.A)(o,this).fetchClusters():"kmeans"==(0,s.A)(u,this).method?(0,s.A)(h,this).fetchClusters():void 0}fetchParameters(){return{...(0,s.A)(u,this)}}compute(e){let{method:t}=e;this.changed=!0,t==(0,s.A)(u,this).method&&("snn_graph"==t?(0,s.A)(o,this).changed||(this.changed=!1):"kmeans"==t&&((0,s.A)(h,this).changed||(this.changed=!1))),(0,s.A)(u,this).method=t}}},4468:(e,t,r)=>{"use strict";r.d(t,{P4:()=>c,TP:()=>p});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(8042),h=r(9894),u=r(1520);const c="combine_embeddings";function f(e,t){let r=l.Rj(e),n=[];for(const s of r)t[s]>0&&n.push(s);return n}var d=new WeakMap,m=new WeakMap,A=new WeakMap;class p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),(0,n.A)(this,A,void 0),!(e.RNA instanceof o.NO))throw new Error("'pca_states.RNA' should be an RnaPcaState object");if(!(e.ADT instanceof h.dS))throw new Error("'pca_states.ADT' should be an AdtPcaState object");if(!(e.CRISPR instanceof u.v2))throw new Error("'pca_states.CRISPR' should be an CrisprPcaState object");(0,i.A)(d,this,e),(0,i.A)(m,this,null===t?{}:t),(0,i.A)(A,this,null===r?{}:r),this.changed=!1}free(){l.xr((0,s.A)(A,this).combined_buffer)}fetchCombined(){return(0,s.A)(A,this).combined_buffer}fetchNumberOfCells(){return(0,s.A)(A,this).num_cells}fetchNumberOfDimensions(){return(0,s.A)(A,this).total_dims}fetchParameters(){return{...(0,s.A)(m,this)}}static defaults(){return{rna_weight:1,adt_weight:1,crispr_weight:0,approximate:!0}}static createPcsView(e,t){l.xr(e.combined_buffer),e.combined_buffer=t.principalComponents({copy:"view"}).view(),e.num_cells=t.numberOfCells(),e.total_dims=t.numberOfPCs()}compute(e){let{rna_weight:t,adt_weight:r,crispr_weight:n,approximate:i}=e;this.changed=!1;for(const a of Object.values((0,s.A)(d,this)))if(a.changed){this.changed=!0;break}if(i!==(0,s.A)(m,this).approximate&&((0,s.A)(m,this).approximate=i,this.changed=!0),t===(0,s.A)(m,this).rna_weight&&r===(0,s.A)(m,this).adt_weight&&n===(0,s.A)(m,this).crispr_weight||((0,s.A)(m,this).rna_weight=t,(0,s.A)(m,this).adt_weight=r,(0,s.A)(m,this).crispr_weight=n,this.changed=!0),this.changed){const e={RNA:t,ADT:r,CRISPR:n};let o=f((0,s.A)(d,this),e);if(o.length>1){let t=o.map((t=>e[t])),r=[],n=0,h=null;for(const e of o){let t=(0,s.A)(d,this)[e].fetchPCs();if(r.push(t.principalComponents({copy:"view"})),null==h)h=t.numberOfCells();else if(h!==t.numberOfCells())throw new Error("number of cells should be consistent across all embeddings");n+=t.numberOfPCs()}let u=l.RK(h*n,"Float64Array",(0,s.A)(A,this),"combined_buffer");a.Ls(r,h,{buffer:u,weights:t,approximate:i}),(0,s.A)(A,this).num_cells=h,(0,s.A)(A,this).total_dims=n}else{let e=(0,s.A)(d,this)[o[0]].fetchPCs();this.constructor.createPcsView((0,s.A)(A,this),e)}}}}},8833:(e,t,r)=>{"use strict";r.d(t,{P4:()=>d,SG:()=>g});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(1065),c=r(4935),f=r(4201);const d="crispr_normalization";var m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakSet;class g{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,w),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),!(e instanceof c.dq))throw new Error("'qc' should be a CrisprQualityControlState object");if((0,l.A)(m,this,e),!(t instanceof f._J))throw new Error("'filter' should be a CellFilteringState object");(0,l.A)(A,this,t),(0,l.A)(p,this,null===r?{}:r),(0,l.A)(_,this,null===i?{}:i),this.changed=!1}free(){h.xr((0,a.A)(_,this).matrix),h.xr((0,a.A)(_,this).total_buffer),h.xr((0,a.A)(_,this).centered_buffer)}valid(){return(0,a.A)(A,this).fetchFilteredMatrix().has("CRISPR")}fetchNormalizedMatrix(){return"matrix"in(0,a.A)(_,this)||(0,i.A)(w,this,b).call(this),(0,a.A)(_,this).matrix}fetchSizeFactors(){let e;return(0,a.A)(_,this).sum_buffer&&(e=h.RK((0,a.A)(_,this).sum_buffer.length,"Float64Array",(0,a.A)(_,this),"centered_buffer"),o.D0((0,a.A)(_,this).sum_buffer,{buffer:e,block:(0,a.A)(A,this).fetchFilteredBlock()})),e}fetchParameters(){return{...(0,a.A)(p,this)}}compute(e){this.changed=!1,((0,a.A)(m,this).changed||(0,a.A)(A,this).changed)&&this.valid()&&((0,i.A)(w,this,b).call(this),this.changed=!0)}static defaults(){return{}}serialize(e){let t=e.createGroup(d);t.createGroup("parameters"),t.createGroup("results")}}function b(){var e=(0,a.A)(A,this).fetchFilteredMatrix().get("CRISPR");let t=u.L((0,a.A)(m,this),(0,a.A)(A,this),e,(0,a.A)(_,this),"sum_buffer");var r=(0,a.A)(A,this).fetchFilteredBlock();h.xr((0,a.A)(_,this).matrix),(0,a.A)(_,this).matrix=o.bS(e,{sizeFactors:t,block:r,allowZeros:!0})}},1520:(e,t,r)=>{"use strict";r.d(t,{P4:()=>u,v2:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(4201),h=r(8833);const u="crispr_pca";var c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap;class A{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),!(e instanceof o._J))throw new Error("'filter' should be a CellFilteringState object");if((0,i.A)(c,this,e),!(t instanceof h.SG))throw new Error("'norm' should be a CrisprNormalizationState object");(0,i.A)(f,this,t),(0,i.A)(m,this,null===r?{}:r),(0,i.A)(d,this,null===s?{}:s),this.changed=!1}free(){l.xr((0,s.A)(d,this).pcs)}valid(){return(0,s.A)(f,this).valid()}fetchPCs(){return(0,s.A)(d,this).pcs}fetchParameters(){return{...(0,s.A)(m,this)}}compute(e){let{num_pcs:t,block_method:r}=e;if(this.changed=!1,(0,s.A)(f,this).changed||t!==(0,s.A)(m,this).num_pcs||r!==(0,s.A)(m,this).block_method){if(this.valid()){let e=(0,s.A)(c,this).fetchFilteredBlock();var n=(0,s.A)(f,this).fetchNormalizedMatrix();l.xr((0,s.A)(d,this).pcs),(0,s.A)(d,this).pcs=a.CN(n,{numberOfPCs:t,block:e,blockMethod:r}),this.changed=!0}(0,s.A)(m,this).num_pcs=t,(0,s.A)(m,this).block_method=r}}static defaults(){return{num_pcs:20,block_method:"none"}}}},4935:(e,t,r)=>{"use strict";r.d(t,{P4:()=>h,dq:()=>d});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(2697);const h="crispr_quality_control";var u=new WeakMap,c=new WeakMap,f=new WeakMap;class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),!(e instanceof o.Xj))throw new Error("'inputs' should be a State object from './inputs.js'");(0,i.A)(u,this,e),(0,i.A)(f,this,null===t?{}:t),(0,i.A)(c,this,null===r?{}:r),this.changed=!1}free(){l.xr((0,s.A)(c,this).metrics),l.xr((0,s.A)(c,this).filters),l.xr((0,s.A)(c,this).metrics_buffer),l.xr((0,s.A)(c,this).discard_buffer)}valid(){return(0,s.A)(u,this).fetchCountMatrix().has("CRISPR")}fetchParameters(){return{...(0,s.A)(f,this)}}fetchFilters(){return(0,s.A)(c,this).filters}fetchDiscards(){return(0,s.A)(c,this).discard_buffer}fetchMetrics(){return(0,s.A)(c,this).metrics}static defaults(){return{nmads:3}}compute(e){let{nmads:t}=e;if(this.changed=!1,(0,s.A)(u,this).changed)if(l.xr((0,s.A)(c,this).metrics),this.valid()){var r=(0,s.A)(u,this).fetchCountMatrix().get("CRISPR");(0,s.A)(c,this).metrics=a.OO(r),this.changed=!0}else delete(0,s.A)(c,this).metrics;if(this.changed||t!==(0,s.A)(f,this).nmads){if(l.xr((0,s.A)(c,this).filters),this.valid()){let e=(0,s.A)(u,this).fetchBlock();(0,s.A)(c,this).filters=a.fh((0,s.A)(c,this).metrics,{numberOfMADs:t,block:e});var n=l.RK((0,s.A)(c,this).metrics.numberOfCells(),"Uint8Array",(0,s.A)(c,this),"discard_buffer");(0,s.A)(c,this).filters.filter((0,s.A)(c,this).metrics,{block:e,buffer:n}),this.changed=!0}else delete(0,s.A)(c,this).filters;(0,s.A)(f,this).nmads=t}}}},5305:(e,t,r)=>{"use strict";r.d(t,{G:()=>m});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(4201),h=r(6292),u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap;class m{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),!(e instanceof o._J))throw new Error("'filter' should be a CellFilteringState object");if((0,i.A)(u,this,e),!(t instanceof h.Aw))throw new Error("'norm' should be an RnaNormalizationState object");(0,i.A)(c,this,t),(0,i.A)(d,this,null===r?{}:r),(0,i.A)(f,this,null===s?{}:s),this.changed=!1}free(){l.xr((0,s.A)(f,this).matrix)}valid(){return(0,s.A)(c,this).valid()}fetchResults(){return(0,s.A)(f,this).results}fetchSortedResiduals(){return(0,s.A)(f,this).sorted_residuals}fetchParameters(){return{...(0,s.A)(d,this)}}compute(e){let{span:t}=e;if(this.changed=!1,(0,s.A)(c,this).changed||t!=(0,s.A)(d,this).span){if(l.xr((0,s.A)(f,this).results),this.valid()){let e=(0,s.A)(c,this).fetchNormalizedMatrix(),r=(0,s.A)(u,this).fetchFilteredBlock();(0,s.A)(f,this).results=a.ag(e,{span:t,block:r}),(0,s.A)(f,this).sorted_residuals=(0,s.A)(f,this).results.residuals().slice(),(0,s.A)(f,this).sorted_residuals.sort(),this.changed=!0}(0,s.A)(d,this).span=t}}}},1040:(e,t,r)=>{"use strict";r.d(t,{d:()=>A});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(6629),c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakSet;class A{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,m),(0,s.A)(this,c,void 0),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),!(e instanceof u.aA))throw new Error("'correct' should be a BatchCorrectionState object");(0,l.A)(c,this,e),(0,l.A)(f,this,null===t?{}:t),(0,l.A)(d,this,null===r?{}:r),this.changed=!1}free(){h.xr((0,a.A)(d,this).raw)}fetchClusters(){if((0,i.A)(m,this,p).call(this))return(0,a.A)(d,this).raw.clusters({copy:"view"});throw new Error("cannot fetch k-means clusters from an invalid state")}fetchParameters(){return{...(0,a.A)(f,this)}}compute(e,t){let{k:r}=t;if(this.changed=!1,(0,a.A)(c,this).changed||r!=(0,a.A)(f,this).k||!(0,i.A)(m,this,p).call(this)&&e){if(h.xr((0,a.A)(d,this).raw),e){var n=(0,a.A)(c,this).fetchCorrected();(0,a.A)(d,this).raw=o.aI(n,r,{numberOfDims:(0,a.A)(c,this).fetchNumberOfDimensions(),numberOfCells:(0,a.A)(c,this).fetchNumberOfCells(),initMethod:"pca-part"})}else delete(0,a.A)(d,this).raw;(0,a.A)(f,this).k=r,this.changed=!0}}}function p(){return"raw"in(0,a.A)(d,this)}},7465:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>N,P4:()=>m,Rr:()=>y});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(3983),h=r(4201),u=r(6302),c=r(6292),f=r(3819),d=r(8833);const m="marker_detection";function A(e){for(const t of Object.values(e.raw))l.xr(t);e.raw={},o.T9(e.versus),delete e.versus}function p(e,t,r,n){let{cache:s={},block:i=null,lfc_threshold:a=0,compute_auc:l=!0}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},h=o.Ni(e,t,s),u=h.left_small?0:1,c=h.left_small?1:0;if(h.run){let s=[],f=[],d=!1,m=!1;if(n.forEach(((r,n)=>{r==e?(s.push(u),f.push(n),d=!0):r==t&&(s.push(c),f.push(n),m=!0)})),!d||!m)throw new Error("non-zero entries should be present for both requested clusters in versus mode");o.gK(r,s,i,f,h.cached,a,l)}return{results:h.cached,left:u,right:c}}var _=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakMap,v=new WeakMap;class y{constructor(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,n.A)(this,_,void 0),(0,n.A)(this,w,void 0),(0,n.A)(this,g,void 0),(0,n.A)(this,b,void 0),(0,n.A)(this,v,void 0),!(e instanceof h._J))throw new Error("'filter' should be a State object from './cell_filtering.js'");if((0,i.A)(_,this,e),!(t.RNA instanceof c.Aw))throw new Error("'norm_states.RNA' should be an RnaNormalizationState object");if(!(t.ADT instanceof f.Kj))throw new Error("'norm_states.ADT' should be an AdtNormalizationState object");if(!(t.CRISPR instanceof d.SG))throw new Error("'norm_states.CRISPR' should be an CrisprNormalizationState object");if((0,i.A)(w,this,t),!(r instanceof u.j))throw new Error("'choice' should be a State object from './choose_clustering.js'");(0,i.A)(g,this,r),(0,i.A)(b,this,null===s?{}:s),(0,i.A)(v,this,null===a?{raw:{}}:a),this.changed=!1}free(){A((0,s.A)(v,this))}fetchResults(){return(0,s.A)(v,this).raw}fetchParameters(){return{...(0,s.A)(b,this)}}compute(e){let{lfc_threshold:t,compute_auc:r}=e;this.changed=!1;let n=t!==(0,s.A)(b,this).lfc_threshold||r!==(0,s.A)(b,this).compute_auc;for(const[o,c]of Object.entries((0,s.A)(w,this)))if(c.valid()&&((0,s.A)(g,this).changed||c.changed||n)){var i=c.fetchNormalizedMatrix(),h=(0,s.A)(g,this).fetchClusters(),u=(0,s.A)(_,this).fetchFilteredBlock();l.xr((0,s.A)(v,this).raw[o]),(0,s.A)(v,this).raw[o]=a.Kq(i,h,{block:u,lfcThreshold:t,computeAuc:r}),this.changed=!0}(0,s.A)(b,this).lfc_threshold=t,(0,s.A)(b,this).compute_auc=r,this.changed&&o.T9((0,s.A)(v,this).versus)}static defaults(){return{lfc_threshold:0,compute_auc:!0}}static computeVersusCustom(e,t,r,n){let{cache:s={},block:i=null,lfc_threshold:a=0,compute_auc:l=!0}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return computeVersus(e,t,r,n,{cache:s,block:i,lfc_threshold:a,compute_auc:l})}computeVersus(e,t){var r=(0,s.A)(g,this).fetchClusters(),n=(0,s.A)(_,this).fetchFilteredBlock();let i=new a.P_;for(const[a,l]of Object.entries((0,s.A)(w,this)))l.valid()&&i.add(a,l.fetchNormalizedMatrix());return"versus"in(0,s.A)(v,this)||((0,s.A)(v,this).versus={}),p(e,t,i,r,{cache:(0,s.A)(v,this).versus,block:n,lfc_threshold:(0,s.A)(b,this).lfc_threshold,compute_auc:(0,s.A)(b,this).compute_auc})}}var k=new WeakMap,x=new WeakMap,E=new WeakMap,C=new WeakMap,O=new WeakMap,M=new WeakMap,R=new WeakMap;class N{constructor(e,t){let{block:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,n.A)(this,k,void 0),(0,n.A)(this,x,void 0),(0,n.A)(this,E,void 0),(0,n.A)(this,C,void 0),(0,n.A)(this,O,void 0),(0,n.A)(this,M,void 0),(0,n.A)(this,R,void 0);let s=t.length;for(const n of e.available()){if(e.get(n).numberOfColumns()!=s)throw new Error("all matrices in 'normalized' should have the same number of columns as the length of 'groups'")}if(null!==r&&r.length!=s)throw new Error("'block' should have the same length as 'groups' if not null");let o=[t];null!==r&&o.push(r);let h,u=l.wW(o);if(null!==u.retain){h=new a.P_;let t=a.kl(u.retain.length);try{t.set(u.retain);for(const r of e.available())h.add(r,a._r(e.get(r),t))}catch(c){throw h.free(),c}finally{a.t9(t)}}else h=e.clone();(0,i.A)(k,this,h),(0,i.A)(x,this,u.arrays[0].ids),(0,i.A)(E,this,u.arrays[0].levels),null!==r?((0,i.A)(C,this,u.arrays[1].ids),(0,i.A)(O,this,u.arrays[1].levels)):((0,i.A)(C,this,null),(0,i.A)(O,this,null)),(0,i.A)(M,this,{raw:{},init:!0}),(0,i.A)(R,this,y.defaults()),this.changed=!1}free(){a.t9((0,s.A)(x,this)),a.t9((0,s.A)(C,this)),a.t9((0,s.A)(k,this)),A((0,s.A)(M,this))}fetchResults(){return(0,s.A)(M,this).raw}fetchParameters(){return{...(0,s.A)(R,this)}}fetchGroupLevels(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.A)(E,this);return e?t.slice():t}fetchBlockLevels(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.A)(O,this);return e?t.slice():t}_peekMatrices(){return(0,s.A)(k,this)}_peekGroups(){return(0,s.A)(x,this)}_peekBlock(){return(0,s.A)(C,this)}setParameters(e){(0,s.A)(R,this).lfc_threshold===e.lfc_threshold&&(0,s.A)(R,this).compute_auc===e.compute_auc||A((0,s.A)(M,this)),(0,i.A)(R,this,{...e})}computeAll(){let{lfc_threshold:e,compute_auc:t}=(0,s.A)(R,this);for(const n of(0,s.A)(k,this).available()){var r=(0,s.A)(k,this).get(n);l.xr((0,s.A)(M,this).raw[n]),(0,s.A)(M,this).raw[n]=a.Kq(r,(0,s.A)(x,this),{block:(0,s.A)(C,this),lfcThreshold:e,computeAuc:t})}}computeVersus(e,t){return"versus"in(0,s.A)(M,this)||((0,s.A)(M,this).versus={}),p(e,t,(0,s.A)(k,this),(0,s.A)(x,this),{cache:(0,s.A)(M,this).versus,block:(0,s.A)(C,this),lfc_threshold:(0,s.A)(R,this).lfc_threshold,compute_auc:(0,s.A)(R,this).compute_auc})}}},5869:(e,t,r)=>{"use strict";r.d(t,{P4:()=>c,YU:()=>p});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(6629);const c="neighbor_index";var f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakSet;class p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,A),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),!(e instanceof u.aA))throw new Error("'correct' should be a BatchCorrectionState object");(0,l.A)(f,this,e),(0,l.A)(d,this,null===t?{}:t),(0,l.A)(m,this,null===r?{}:r),this.changed=!1}free(){h.xr((0,a.A)(m,this).raw)}fetchIndex(){return"raw"in(0,a.A)(m,this)||(0,i.A)(A,this,_).call(this,(0,a.A)(d,this).approximate),(0,a.A)(m,this).raw}fetchParameters(){return{...(0,a.A)(d,this)}}static defaults(){return{approximate:!0}}compute(e){let{approximate:t}=e;this.changed=!1,((0,a.A)(f,this).changed||t!=(0,a.A)(d,this).approximate)&&(h.xr((0,a.A)(m,this).raw),(0,i.A)(A,this,_).call(this,t),(0,a.A)(d,this).approximate=t,this.changed=!0)}}function _(e){(0,a.A)(m,this).raw=o.$q((0,a.A)(f,this).fetchCorrected(),{approximate:e,numberOfDims:(0,a.A)(f,this).fetchNumberOfDimensions(),numberOfCells:(0,a.A)(f,this).fetchNumberOfCells()})}},6292:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>g,P4:()=>d});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(1065),c=r(1653),f=r(4201);const d="rna_normalization";var m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakSet;class g{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((0,n.A)(this,w),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),!(e instanceof c.Zx))throw new Error("'qc' should be a RnaQualityControlState object");if((0,l.A)(m,this,e),!(t instanceof f._J))throw new Error("'filter' should be a CellFilteringState object");(0,l.A)(A,this,t),(0,l.A)(p,this,null===r?{}:r),(0,l.A)(_,this,null===i?{}:i),this.changed=!1}free(){h.xr((0,a.A)(_,this).matrix),h.xr((0,a.A)(_,this).sum_buffer)}valid(){return(0,a.A)(A,this).fetchFilteredMatrix().has("RNA")}fetchNormalizedMatrix(){return"matrix"in(0,a.A)(_,this)||(0,i.A)(w,this,b).call(this),(0,a.A)(_,this).matrix}fetchSizeFactors(){let e;return(0,a.A)(_,this).sum_buffer&&(e=h.RK((0,a.A)(_,this).sum_buffer.length,"Float64Array",(0,a.A)(_,this),"centered_buffer"),o.D0((0,a.A)(_,this).sum_buffer,{buffer:e,block:(0,a.A)(A,this).fetchFilteredBlock()})),e}fetchParameters(){return{...(0,a.A)(p,this)}}compute(e){this.changed=!1,((0,a.A)(m,this).changed||(0,a.A)(A,this).changed)&&this.valid()&&(this.changed=!0),this.changed&&(0,i.A)(w,this,b).call(this)}static defaults(){return{}}}function b(){var e=(0,a.A)(A,this).fetchFilteredMatrix().get("RNA");let t=u.L((0,a.A)(m,this),(0,a.A)(A,this),e,(0,a.A)(_,this),"sum_buffer");var r=(0,a.A)(A,this).fetchFilteredBlock();h.xr((0,a.A)(_,this).matrix),(0,a.A)(_,this).matrix=o.bS(e,{sizeFactors:t,block:r,allowZeros:!0})}},8042:(e,t,r)=>{"use strict";r.d(t,{NO:()=>_,P4:()=>c});var n=r(5149),s=r(8458),i=r(4558),a=r(7990),l=r(1276),o=r(4201),h=r(6292),u=r(5305);const c="rna_pca";var f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap;class _{constructor(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),(0,n.A)(this,A,void 0),(0,n.A)(this,p,void 0),!(e instanceof o._J))throw new Error("'filter' should be a CellFilteringState object");if((0,i.A)(f,this,e),!(t instanceof h.Aw))throw new Error("'norm' should be an RnaNormalizationState object");if((0,i.A)(d,this,t),!(r instanceof u.G))throw new Error("'feat' should be a FeatureSelectionState object");(0,i.A)(m,this,r),(0,i.A)(p,this,null===s?{}:s),(0,i.A)(A,this,null===a?{}:a),this.changed=!1}free(){l.xr((0,s.A)(A,this).hvg_buffer),l.xr((0,s.A)(A,this).pcs)}valid(){return(0,s.A)(d,this).valid()}fetchPCs(){return(0,s.A)(A,this).pcs}fetchParameters(){return{...(0,s.A)(p,this)}}compute(e){let{num_hvgs:t,num_pcs:r,block_method:n}=e;if(this.changed=!1,((0,s.A)(m,this).changed||t!==(0,s.A)(p,this).num_hvgs)&&(this.valid()&&(w(t,(0,s.A)(m,this),(0,s.A)(A,this)),this.changed=!0),(0,s.A)(p,this).num_hvgs=t),this.changed||(0,s.A)(d,this).changed||r!==(0,s.A)(p,this).num_pcs||n!==(0,s.A)(p,this).block_method){if(l.xr((0,s.A)(A,this).pcs),this.valid()){let e=(0,s.A)(A,this).hvg_buffer,t=(0,s.A)(f,this).fetchFilteredBlock();var i=(0,s.A)(d,this).fetchNormalizedMatrix();(0,s.A)(A,this).pcs=a.CN(i,{features:e,numberOfPCs:r,block:t,blockMethod:n}),this.changed=!0}(0,s.A)(p,this).num_pcs=r,(0,s.A)(p,this).block_method=n}}static defaults(){return{num_hvgs:2e3,num_pcs:20,block_method:"none"}}}function w(e,t,r){var n=t.fetchSortedResiduals(),s=l.RK(n.length,"Uint8Array",r,"hvg_buffer");if(e<n.length){var i=n[n.length-e],a=t.fetchResults().residuals({copy:!1});s.array().forEach(((e,t,r)=>{r[t]=a[t]>=i}))}else s.fill(1);return s}},1653:(e,t,r)=>{"use strict";r.d(t,{P4:()=>A,Zx:()=>v});var n,s=r(9790),i=r(4467),a=r(5149),l=r(6562),o=r(8458),h=r(4558),u=r(7990),c=r(3619),f=r(1276),d=r(2697),m=r(141);const A="rna_quality_control";var p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakSet;class v{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,s.A)(this,b),(0,a.A)(this,p,void 0),(0,a.A)(this,_,void 0),(0,a.A)(this,w,void 0),(0,a.A)(this,g,void 0),!(e instanceof d.Xj))throw new Error("'inputs' should be an InputsState object");(0,h.A)(p,this,e),(0,h.A)(w,this,null===t?{}:t),(0,h.A)(_,this,null===r?{}:r),(0,h.A)(g,this,!1),this.changed=!1}free(){f.xr((0,o.A)(_,this).metrics),f.xr((0,o.A)(_,this).filters),f.xr((0,o.A)(_,this).metrics_buffer),f.xr((0,o.A)(_,this).discard_buffer)}valid(){return(0,o.A)(p,this).fetchCountMatrix().has("RNA")}fetchParameters(){let e={...(0,o.A)(w,this)};return e.species=c.UC(e.species),e}fetchDiscards(){return(0,o.A)(_,this).discard_buffer}fetchFilters(){return(0,o.A)(_,this).filters}fetchMetrics(){return(0,o.A)(_,this).metrics}static defaults(){return{automatic:!0,gene_id_column:null,use_reference_mito:!0,species:[],gene_id_type:"ENSEMBL",mito_prefix:"mt-",nmads:3}}static configureFeatureParameters(e,t){let r=null,n={type:"symbol",species:"human",confidence:0};if("row_names"in t){let r=t.row_names;r.confidence>n.confidence&&(e||"symbol"==r.type)&&(n=r)}for(const[s,i]of Object.entries(t.columns))i.confidence>n.confidence&&(e||"symbol"==i.type)&&(n=i,r=s);return{gene_id_column:r,species:[n.species],gene_id_type:n.type.toUpperCase()}}static flush(){k._={}}static setDownload(e){let t=x._;return x._=e,t}async compute(e){let t,r,n,s,i,{mito_prefix:a,nmads:h}=e;if("use_reference_mito"in e)t=e.automatic,r=e.use_reference_mito,n=e.gene_id_column,s=e.species,i=e.gene_id_type;else{t=!0,r=e.use_mito_default;let a=v.defaults();n=a.gene_id_column,s=a.species,i=a.gene_id_type}if(this.changed=!1,(0,o.A)(p,this).changed||t!==(0,o.A)(w,this).automatic||r!==(0,o.A)(w,this).use_reference_mito||!t&&(n!==(0,o.A)(w,this).gene_id_column||!r&&a!==(0,o.A)(w,this).mito_prefix||r&&(f.PG(s,(0,o.A)(w,this).species)||i!==(0,o.A)(w,this).gene_id_type)))if(f.xr((0,o.A)(_,this).metrics),this.valid()){let e=n,h=s,c=i;if(t){let t=(0,o.A)(p,this).guessRnaFeatureTypes(),n=v.configureFeatureParameters(r,t);e=n.gene_id_column,h=n.species,c=n.gene_id_type}var d=(0,o.A)(p,this).fetchFeatureAnnotations().RNA;let w=null==e?d.rowNames():d.column(e);var m=f.RK(d.numberOfRows(),"Uint8Array",(0,o.A)(_,this),"metrics_buffer");if(m.fill(0),null!==w)if(r){let e=await(0,l.A)(b,this,y).call(this,h,c);var A=m.array();w.forEach(((t,r)=>{e.has(t)&&(A[r]=1)}))}else if(null!==a){var g=a.toLowerCase();A=m.array();w.forEach(((e,t)=>{e.toLowerCase().startsWith(g)&&(A[t]=1)}))}var k=(0,o.A)(p,this).fetchCountMatrix().get("RNA");(0,o.A)(_,this).metrics=u.Kc(k,[m]),this.changed=!0}else delete(0,o.A)(_,this).metrics;if((0,o.A)(w,this).automatic=t,(0,o.A)(w,this).gene_id_column=n,(0,o.A)(w,this).use_reference_mito=r,(0,o.A)(w,this).species=c.UC(s),(0,o.A)(w,this).gene_id_type=i,(0,o.A)(w,this).mito_prefix=a,this.changed||h!==(0,o.A)(w,this).nmads){if(f.xr((0,o.A)(_,this).filters),this.valid()){let e=(0,o.A)(p,this).fetchBlock();(0,o.A)(_,this).filters=u.DA((0,o.A)(_,this).metrics,{numberOfMADs:h,block:e});var x=f.RK((0,o.A)(_,this).metrics.numberOfCells(),"Uint8Array",(0,o.A)(_,this),"discard_buffer");(0,o.A)(_,this).filters.filter((0,o.A)(_,this).metrics,{block:e,buffer:x}),this.changed=!0}else delete(0,o.A)(_,this).filters;(0,o.A)(w,this).nmads=h}}}async function y(e,t){let r=new Set,s=k._;for(const i of e){let e=i+"-mito-"+t.toLowerCase()+".txt.gz";if(!(e in s)){let t=await x._.call(n,"https://github.com/kanaverse/kana-special-features/releases/download/v1.0.0/"+e),r=await m.we(t,{compression:"gz"});s[e]=r}s[e].forEach((e=>{r.add(e)}))}return r}n=v,(0,i.A)(v,"mitochondriaSpecies",["9606","10090","6239","10116","9541","7227","7955","9598"]);var k={_:{}},x={_:f.WR}},945:(e,t,r)=>{"use strict";r.d(t,{$V:()=>p,P4:()=>c});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(1276),u=r(5869);const c="snn_graph_cluster";var f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakSet;class p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,A),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),!(e instanceof u.YU))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,l.A)(f,this,e),(0,l.A)(d,this,null===t?{}:t),(0,l.A)(m,this,null===r?{}:r),this.changed=!1}free(){h.xr((0,a.A)(m,this).neighbors),h.xr((0,a.A)(m,this).graph),h.xr((0,a.A)(m,this).clusters)}fetchClusters(){if((0,i.A)(A,this,_).call(this))return(0,a.A)(m,this).clusters.membership({copy:"view"});throw"cannot fetch SNN clusters from an invalid state"}fetchParameters(){return{...(0,a.A)(d,this)}}static defaults(){return{k:10,scheme:"rank",algorithm:"multilevel",multilevel_resolution:1,leiden_resolution:1,walktrap_steps:4}}compute(e,t){let{k:r,scheme:n,algorithm:s,multilevel_resolution:l,leiden_resolution:o,walktrap_steps:u}=t;this.changed=!1,((0,a.A)(f,this).changed||r!==(0,a.A)(d,this).k)&&(h.xr((0,a.A)(m,this).neighbors),e?(0,i.A)(A,this,w).call(this,r):delete(0,a.A)(m,this).neighbors,(0,a.A)(d,this).k=r,this.changed=!0),(this.changed||n!==(0,a.A)(d,this).scheme)&&(h.xr((0,a.A)(m,this).graph),e?(0,i.A)(A,this,g).call(this,n):delete(0,a.A)(m,this).graph,(0,a.A)(d,this).scheme=n,this.changed=!0),(this.changed||s!==(0,a.A)(d,this).algorithm||l!==(0,a.A)(d,this).multilevel_resolution||o!==(0,a.A)(d,this).leiden_resolution||u!==(0,a.A)(d,this).walktrap_steps||!(0,i.A)(A,this,_).call(this)&&e)&&(h.xr((0,a.A)(m,this).clusters),e?(0,i.A)(A,this,b).call(this,s,l,o,u):delete(0,a.A)(m,this).clusters,(0,a.A)(d,this).algorithm=s,(0,a.A)(d,this).multilevel_resolution=l,(0,a.A)(d,this).leiden_resolution=o,(0,a.A)(d,this).walktrap_steps=u,this.changed=!0)}}function _(){return"clusters"in(0,a.A)(m,this)}function w(e){(0,a.A)(m,this).neighbors=o.jw((0,a.A)(f,this).fetchIndex(),e)}function g(e){"neighbors"in(0,a.A)(m,this)||(0,i.A)(A,this,w).call(this,(0,a.A)(d,this).k),(0,a.A)(m,this).graph=o._c((0,a.A)(m,this).neighbors,{scheme:e})}function b(e,t,r,n){"graph"in(0,a.A)(m,this)||(0,i.A)(A,this,g).call(this,(0,a.A)(d,this).scheme),(0,a.A)(m,this).clusters=o.Ye((0,a.A)(m,this).graph,{method:e,multiLevelResolution:t,leidenResolution:r,leidenModularityObjective:!0,walktrapSteps:n})}},928:(e,t,r)=>{"use strict";r.d(t,{s:()=>g});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(7990),h=r(9692),u=(r(1276),r(5869)),c=r(4642),f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakSet;class g{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,w),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),!(e instanceof u.YU))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,l.A)(f,this,e),(0,l.A)(d,this,null===t?{}:t),(0,l.A)(m,this,r),this.changed=!1;let i=c.H(),{worker_id:a,ready:o}=h.RS(i,h.Cr);(0,l.A)(A,this,a),(0,l.A)(p,this,o),(0,l.A)(_,this,null)}ready(){return(0,a.A)(p,this)}free(){return h.DI((0,a.A)(A,this))}fetchParameters(){return{...(0,a.A)(d,this)}}async fetchResults(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!==(0,a.A)(m,this)){let t={x:(0,a.A)(m,this).x,y:(0,a.A)(m,this).y};return e&&(t.x=t.x.slice(),t.y=t.y.slice()),t.iterations=(0,a.A)(d,this).iterations,t}return await(0,a.A)(_,this),h.UE((0,a.A)(A,this),{cmd:"FETCH"})}compute(e){let{perplexity:t,iterations:r,animate:n}=e,s=!(0,a.A)(f,this).changed&&t===(0,a.A)(d,this).perplexity;return s&&r==(0,a.A)(d,this).iterations?(this.changed=!1,new Promise((e=>e(null)))):(null!==(0,a.A)(m,this)&&(s=!1,(0,l.A)(m,this,null)),(0,i.A)(w,this,b).call(this,t,r,n,!s),(0,a.A)(d,this).perplexity=t,(0,a.A)(d,this).iterations=r,(0,a.A)(d,this).animate=n,this.changed=!0,(0,a.A)(_,this))}animate(){return null!==(0,a.A)(m,this)?((0,l.A)(m,this,null),(0,i.A)(w,this,b).call(this,(0,a.A)(d,this).perplexity,(0,a.A)(d,this).iterations,!0,!0),(0,a.A)(_,this).then((e=>({type:"tsne_rerun",data:{status:"SUCCESS"}})))):h.UE((0,a.A)(A,this),{cmd:"RERUN"})}}function b(e,t,r,n){var s=null;if(n){var i=o.rj(e);s=h.h_((0,a.A)(f,this),i)}let u={perplexity:e,iterations:t,animate:r};(0,l.A)(_,this,h.n$((0,a.A)(A,this),u,s))}},3571:(e,t,r)=>{"use strict";r.d(t,{B:()=>w});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=(r(7990),r(9692)),h=(r(1276),r(5869)),u=r(4642),c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakSet;class w{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if((0,n.A)(this,_),(0,s.A)(this,c,void 0),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),!(e instanceof h.YU))throw new Error("'index' should be a State object from './neighbor_index.js'");(0,l.A)(c,this,e),(0,l.A)(f,this,null===t?{}:t),(0,l.A)(d,this,r),this.changed=!1;let i=u.I(),{worker_id:a,ready:w}=o.RS(i,o.Cr);(0,l.A)(m,this,a),(0,l.A)(A,this,w),(0,l.A)(p,this,null)}ready(){return(0,a.A)(A,this)}free(){return o.DI((0,a.A)(m,this))}async fetchResults(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!==(0,a.A)(d,this)){let t={x:(0,a.A)(d,this).x,y:(0,a.A)(d,this).y};return e&&(t.x=t.x.slice(),t.y=t.y.slice()),t.iterations=(0,a.A)(f,this).num_epochs,t}return await(0,a.A)(p,this),o.UE((0,a.A)(m,this),{cmd:"FETCH"})}fetchParameters(){return{...(0,a.A)(f,this)}}compute(e){let{num_neighbors:t,num_epochs:r,min_dist:n,animate:s}=e,o=!(0,a.A)(c,this).changed&&(0,a.A)(f,this).num_neighbors===t;return o&&r===(0,a.A)(f,this).num_epochs&&n===(0,a.A)(f,this).min_dist?(this.changed=!1,new Promise((e=>e(null)))):(null!==(0,a.A)(d,this)&&(o=!1,(0,l.A)(d,this,null)),(0,i.A)(_,this,g).call(this,t,r,n,s,!o),(0,a.A)(f,this).num_neighbors=t,(0,a.A)(f,this).num_epochs=r,(0,a.A)(f,this).min_dist=n,(0,a.A)(f,this).animate=s,this.changed=!0,(0,a.A)(p,this))}animate(){return null!==(0,a.A)(d,this)?((0,l.A)(d,this,null),(0,i.A)(_,this,g).call(this,(0,a.A)(f,this).num_neighbors,(0,a.A)(f,this).num_epochs,(0,a.A)(f,this).min_dist,!0,!0),(0,a.A)(p,this).then((e=>({type:"umap_rerun",data:{status:"SUCCESS"}})))):o.UE((0,a.A)(m,this),{cmd:"RERUN"})}}function g(e,t,r,n,s){var i=null;s&&(i=o.h_((0,a.A)(c,this),e));let h={num_neighbors:e,num_epochs:t,min_dist:r,animate:n};(0,l.A)(p,this,o.n$((0,a.A)(m,this),h,i))}},1559:(e,t,r)=>{"use strict";function n(e,t){e.onmessage=t}function s(e,t,r){e.postMessage(t,r)}function i(e){e.terminate()}r.d(t,{Qw:()=>i,_z:()=>s,rq:()=>n})},1276:(e,t,r)=>{"use strict";r.d(t,{O_:()=>h,PG:()=>a,RA:()=>c,RK:()=>l,Rj:()=>o,WR:()=>u,wW:()=>f,xr:()=>s});var n=r(7990);function s(e){n.t9(e)}function i(e,t,r,n){if(!r&&(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw new Error("parameters cannot contain ArrayBuffers or their views");if(!n&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new Error("parameters cannot contain ArrayBuffers or their views")}function a(e,t){if(typeof e!=typeof t)return i(e,t,!1,!1),!0;if("object"!=typeof e)return e!=t;let r=null===e,n=null===t;if(r!==n)return i(e,t,r,n),!0;if(r)return!1;let s=e instanceof Array,l=t instanceof Array;if(s!=l)return i(e,t,s,l),!0;if(s){if(e.length!=t.length)return!0;for(var o=0;o<e.length;o++)if(a(e[o],t[o]))return!0;return!1}i(e,t,!1,!1);let h=Object.keys(e),u=Object.keys(t);if(h.length!=u.length)return!0;h.sort(),u.sort();for(o=0;o<h.length;o++)if(h[o]!=u[o])return!0;for(const i of h)if(a(e[i],t[i]))return!0;return!1}function l(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"buffer";var i=!0;if(s in r){var a=r[s];a.size!=e||a.constructor.className!=t||null!==a.owner?a.free():i=!1}if(i)switch(t){case"Uint8Array":r[s]=n.eg(e);break;case"Int32Array":r[s]=n.kl(e);break;case"Float64Array":r[s]=n.k3(e);break;default:throw"allocating '"+t+"' not yet supported"}return r[s]}function o(e,t){let r=[];for(const[n,s]of Object.entries(e))s.valid()&&r.push(n);if(0==r.length)throw new Error("expected at least one valid upstream "+t+" state");return r}function h(e,t){if(null!==t)for(const n of e)if(n<0||n>=t)throw new Error("subset indices are out of range");for(var r=1;r<e.length;r++)if(e[r]<=e[r-1])throw new Error("subset indices must be sorted and unique")}async function u(e){let t=await fetch(e);if(!t.ok)throw new Error("failed to fetch content at "+e+"("+t.status+")");return new Uint8Array(await t.arrayBuffer())}function c(e){let t={columns:{}},r=e.rowNames();null!==r&&(t.row_names=n.xS(r,{forceTaxonomy:!0}));for(const s of e.columnNames()){e.column(s)instanceof Array&&(t.columns[s]=n.xS(e.column(s),{forceTaxonomy:!0}))}return t}function f(e){let t=e[0].length,r={arrays:[],retain:null},s=new Uint8Array(t);s.fill(0);for(const o of e){let e=n.GO(o,{action:"none",placeholder:-1});r.arrays.push(e),e.ids.forEach(((e,t)=>{-1==e&&(s[t]=1)}))}let i=0;if(s.forEach((e=>{i+=e})),0==i)return r;let a=new Int32Array(t-i);{let e=0;for(var l=0;l<t;l++)0==s[l]&&(a[e]=l,e++)}r.retain=a;for(l=0;l<r.arrays.length;l++){let e=r.arrays[l],t=n.cR(e.ids,a),s=n.zi(t).map((t=>e.levels[t]));n.t9(e.ids),e.ids=t,e.levels=s}return r}},3983:(e,t,r)=>{"use strict";r.d(t,{Ni:()=>a,T9:()=>l,at:()=>i,eW:()=>s,gK:()=>o});var n=r(7990);const s={min:0,mean:1,min_rank:4};function i(e,t,r){var n;r&&void 0!==r||(r="cohen-min-rank");{let i,a=!1,l=1;if(r.match(/-min$/)?l=0:r.match(/-min-rank$/)&&(a=!0,l=4),r.match(/^cohen-/))i=e.cohen(t,{summary:l,copy:!1});else if(r.match(/^auc-/))i=e.auc(t,{summary:l,copy:!1});else if(r.match(/^lfc-/))i=e.lfc(t,{summary:l,copy:!1});else{if(!r.match(/^delta-d-/))throw"unknown rank type '"+r+"'";i=e.deltaDetected(t,{summary:l,copy:!1})}n=new Int32Array(i.length);for(var s=0;s<n.length;s++)n[s]=s;a?n.sort(((e,t)=>i[e]-i[t])):n.sort(((e,t)=>i[t]-i[e]))}var i=function(e){for(var t=new Float64Array(e.length),r=0;r<n.length;r++)t[r]=e[n[r]];return t},a=i(e.detected(t,{copy:!1})),l=i(e.means(t,{copy:!1})),o=i(e.lfc(t,{summary:1,copy:!1})),h=i(e.deltaDetected(t,{summary:1,copy:!1}));return{ordering:n,means:l,detected:a,lfc:o,delta_detected:h}}function a(e,t,r){let n=e<t,s=n?t:e;s in r||(r[s]={});let i=r[s],a=n?e:t,l=!(a in i);return l&&(i[a]={}),{cached:i[a],run:l,left_small:n}}function l(e){if(e){for(const t of Object.values(e))for(const e of Object.values(t))for(const t of Object.values(e))n.t9(t);for(const t of Object.keys(e))delete e[t]}}function o(e,t,r,s,i,a,l){let o=null;null!==r&&(o=n.cR(r,s),n.zi(o));for(const h of e.available()){let r,u=e.get(h);try{r=n._r(u,s),i[h]=n.Kq(r,t,{block:o,lfcThreshold:a,computeAuc:l})}finally{n.t9(r)}}}},1065:(e,t,r)=>{"use strict";r.d(t,{L:()=>s});var n=r(1276);function s(e,t,r,s,i){let a=n.RK(r.numberOfColumns(),"Float64Array",s,i),l=t.fetchDiscards(),o=e.fetchMetrics().sums({copy:!1});if(null==l)a.set(o);else{let e=a.array();var h=0;if(l.forEach(((t,r)=>{if(!t){if(h==a.length)throw new Error("normalization and filtering are not in sync");e[h]=o[r],h++}})),h!==a.length)throw new Error("normalization and filtering are not in sync")}return a}},6662:(e,t,r)=>{"use strict";r.d(t,{$9:()=>a,C7:()=>d,IV:()=>c,JP:()=>h,St:()=>m,UC:()=>o,Uf:()=>f,cI:()=>l,eQ:()=>u,pi:()=>i});var n=r(9358),s=r(903);function i(e){if("_bioconductor_LENGTH"in e)return e._bioconductor_LENGTH();if(!n.Xj(e))throw new Error("no method for 'LENGTH' in '"+e.constructor.name+"' instance");return e.length}function a(e,t){let{allowView:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("_bioconductor_SLICE"in e){let n=new e.constructor;return e._bioconductor_SLICE(n,t,{allowView:r}),n}if(!n.Xj(e))throw new Error("no method for 'SLICE' in '"+e.constructor.name+"' instance");if(t.constructor==Object)return r&&ArrayBuffer.isView(e)?e.subarray(t.start,t.end):e.slice(t.start,t.end);{let r=new e.constructor(t.length);return t.forEach(((t,n)=>{r[n]=e[t]})),r}}function l(e){let t=e[0];if("_bioconductor_COMBINE"in t){let r=new t.constructor;return t._bioconductor_COMBINE(r,e),r}if(!n.Xj(t))throw new Error("no method for 'COMBINE' in '"+t.constructor.name+"' instance");let r=0,s=t.constructor;for(const l of e)r+=l.length,s=n.Qx(s,l.constructor);let i=new s(r),a=0;for(const n of e)"set"in i?(i.set(n,a),a+=n.length):n.forEach((e=>{i[a]=e,a++}));return i}function o(e){let{deepCopy:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof Object){let r={deepCopy:t};if("_bioconductor_CLONE"in e){let t=new e.constructor;return e._bioconductor_CLONE(t,r),t}if(n.Xj(e))return e.constructor==Array?e.map((e=>o(e,r))):t?e.slice():e.subarray();if(e.constructor==Object){if(t){let t={};for(const[r,n]of Object.entries(e))t[r]=o(n);return t}return{...e}}if(e.constructor==Map){let r=new Map;for(const[n,s]of e)r.set(n,t?o(s):s);return r}if(e.constructor==Set){let r=new Set;for(const n of e)r.add(t?o(n):n);return r}throw new Error("unknown CLONE operation for instance of class '"+e.constructor.name+"'")}return e}function h(e,t){if(t.constructor!=Object&&(t=s.z(t)),"_bioconductor_SPLIT"in e)return e._bioconductor_SPLIT(t);let r={};for(const[n,s]of Object.entries(t))r[n]=a(e,s);return r}function u(e){if(!("_bioconductor_NUMBER_OF_ROWS"in e))throw new Error("no 'NUMBER_OF_ROWS' method available for '"+e.constructor.name+"' instance");return e._bioconductor_NUMBER_OF_ROWS()}function c(e){if(!("_bioconductor_NUMBER_OF_COLUMNS"in e))throw new Error("no 'NUMBER_OF_COLUMNS' method available for '"+e.constructor.name+"' instance");return e._bioconductor_NUMBER_OF_COLUMNS()}function f(e,t,r){let{allowView:n=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!("_bioconductor_SLICE_2D"in e))throw new Error("no 'SLICE_2D' method available for '"+e.constructor.name+"' instance");let s=new e.constructor;return e._bioconductor_SLICE_2D(s,t,r,{allowView:n}),s}function d(e){let t=e[0];if(!("_bioconductor_COMBINE_ROWS"in t))throw new Error("no 'COMBINE_ROWS' method available for '"+t.constructor.name+"' instance");let r=new t.constructor;return t._bioconductor_COMBINE_ROWS(r,e),r}function m(e){let t=e[0];if(!("_bioconductor_COMBINE_COLUMNS"in t))throw new Error("no 'COMBINE_COLUMNS' method available for '"+t.constructor.name+"' instance");let r=new t.constructor;return t._bioconductor_COMBINE_COLUMNS(r,e),r}},1995:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(1430),s=r(9358);class i{constructor(e){0!=arguments.length&&(this._metadata=s.k4(e))}metadata(){return this._metadata}setMetadata(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.z(this,t);return r._metadata=s.k4(e),r}$setMetadata(e){return this.setMetadata(e,{inPlace:!0})}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;e._metadata=n.k(this._metadata,r)}}},2294:(e,t,r)=>{"use strict";r.d(t,{C:()=>h,I:()=>u});var n=r(4467),s=r(6662),i=r(9358),a=r(1430),l=r(1995),o=r(9462);class h extends l.N{constructor(e){let{numberOfRows:t=null,rowNames:r=null,columnOrder:n=null,metadata:a={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0!=arguments.length){super(a),this._numberOfRows=t,this._rowNames=r;try{this._columns=new o.w(e,n)}catch(l){throw new Error("failed to initialize columns for this "+this.constructor.className+"; "+l.message,{cause:l})}for(const e of this._columns.names()){let t=s.pi(this._columns.entry(e));if(null==this._numberOfRows)this._numberOfRows=t;else if(t!=this._numberOfRows)throw new Error("expected all arrays in 'columns' to have equal length")}null!=r&&(null==this._numberOfRows&&(this._numberOfRows=r.length),i.Gl(r,"'rowNames'",this._numberOfRows,"'numberOfRows' or the length of arrays in 'columns'")),null==this._numberOfRows&&(this._numberOfRows=0)}else super()}rowNames(){return this._rowNames}columnNames(){return this._columns.names()}hasColumn(e){return this._columns.has(e)}numberOfRows(){return this._numberOfRows}numberOfColumns(){return this._columns.numberOfEntries()}column(e){return this._columns.entry(e)}removeColumn(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.z(this,t);return r._columns=this._columns.delete(e,{inPlace:t}),r}$removeColumn(e){return this.removeColumn(e,{inPlace:!0})}setColumn(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(s.pi(t)!=this._numberOfRows)throw new Error("expected 'value' to have the same length as the number of rows in 'x'");let n=a.z(this,r);return n._columns=this._columns.set(e,t,{inPlace:r}),n}$setColumn(e,t){return this.setColumn(e,t,{inPlace:!0})}setColumnNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.z(this,t);return r._columns=r._columns.setNames(e,{inPlace:t}),r}$setColumnNames(e){return this.setColumnNames(e,{inPlace:!0})}setRowNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&i.Gl(e,"replacement 'names'",this._numberOfRows,"'numberOfRows()'");let r=a.z(this,t);return r._rowNames=e,r}$setRowNames(e){return this.setRowNames(e,{inPlace:!0})}sliceColumns(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.z(this,t);return r._columns=this._columns.slice(e,{inPlace:t}),r}$sliceColumns(e){return this.sliceColumns(e,{inPlace:!0})}_bioconductor_LENGTH(){return this.numberOfRows()}_bioconductor_SLICE(e,t,r){let n,{allowView:i=!1}=r,a={allowView:i},l=this._columns.apply((e=>s.$9(e,t,a))),o=null==this._rowNames?null:s.$9(this._rowNames,t,a);n=t.constructor==Object?t.end-t.start:t.length,e._rowNames=o,e._columns=l,e._numberOfRows=n,e._metadata=this._metadata}_bioconductor_COMBINE(e,t){let r=o.w.parallelCombine(t.map((e=>e._columns)),s.cI),n=[],a=[];for(const s of t)n.push(s.rowNames()),a.push(s.numberOfRows());let l=i.cz(a),h=i.qR(n,a,l);e._rowNames=h,e._columns=r,e._numberOfRows=l,e._metadata=this._metadata}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._columns=a.k(this._columns,r),e._rowNames=a.k(this._rowNames,r),e._numberOfRows=this._numberOfRows}}function u(e){let t=new Set,r=[];for(const s of e){let e=s.columnNames();for(const n of e)t.has(n)||(t.add(n),r.push(n))}let n=[];for(const i of e){let e=new Array(i.numberOfRows());e.fill(null);let t=s.UC(i,{deepCopy:!1});for(const n of r)i.hasColumn(n)||t.$setColumn(n,e);t._columns=t._columns.reorder(r),n.push(t)}return s.cI(n)}(0,n.A)(h,"className","DataFrame")},4793:(e,t,r)=>{"use strict";var n=r(9790),s=r(4467),i=r(6562),a=r(1430),l=new WeakSet;function o(e,t,r,n,s){if(s){let t=e*r,s=t+r;return n?this._values.subarray(t,s):this._values.slice(t,s)}{let n=new this._values.constructor(r),s=e;for(var i=0;i<r;i++)n[i]=this._values[s],s+=t;return n}}function h(e,t,r,n,s){if(n){let t=e*r;this._values.set(s,t)}else{new this._values.constructor(r);let n=e;for(var i=0;i<r;i++)this._values[n]=s[i],n+=t}}function u(e,t,r,n,s,a,o,h,u,f){if(t)for(var d=0;d<n;d++)(0,i.A)(l,this,c).call(this,s,a,o,h,u,f,d,d);else if(r)for(d=e.start;d<e.end;d++)(0,i.A)(l,this,c).call(this,s,a,o,h,u,f,d,d-e.start);else for(var m=0;m<e.length;m++)(0,i.A)(l,this,c).call(this,s,a,o,h,u,f,e[m],m)}function c(e,t,r,n,s,i,a,l){let o=a*n,h=l*s;if(t){let e=this._values.subarray(o,o+n);i.set(e,h)}else if(r)for(var u=e.start;u<e.end;u++)i[h+u-e.start]=this._values[o+u];else for(var c=0;c<e.length;c++)i[h+c]=this._values[o+e[c]]}(0,s.A)(class{constructor(e,t,r){let{columnMajor:s=!0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((0,n.A)(this,l),0!=arguments.length&&(this._numberOfRows=e,this._numberOfColumns=t,this._values=r,this._columnMajor=s,e*t!=r.length))throw new Error("length of 'values' should be equal to the product of 'dimensions'")}numberOfRows(){return this._numberOfRows}numberOfColumns(){return this._numberOfColumns}isColumnMajor(){return this._columnMajor}values(){return this._values}row(e){let{allowView:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.A)(l,this,o).call(this,e,this._numberOfRows,this._numberOfColumns,t,!this._columnMajor)}column(e){let{allowView:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.A)(l,this,o).call(this,e,this._numberOfColumns,this._numberOfRows,t,this._columnMajor)}setValues(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.length!==this._values.length)throw new Error("replacement 'values' should have length equal to 'values()'");let r=a.z(this,t);return r._values=e,r}$setValues(e){return this.setValues(e,{inPlace:!0})}setRow(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.length!==this._numberOfColumns)throw new Error("replacement row should have length equal to 'numberOfColumns()'");let n=a.z(this,r);return r||(n._values=n._values.slice()),(0,i.A)(l,n,h).call(n,e,n._numberOfRows,n._numberOfColumns,!n._columnMajor,t),n}$setRow(e,t){return this.setRow(e,t,{inPlace:!0})}setColumn(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.length!==this._numberOfRows)throw new Error("replacement column should have length equal to 'numberOfRows()'");let n=a.z(this,r);return r||(n._values=n._values.slice()),(0,i.A)(l,n,h).call(n,e,n._numberOfColumns,n._numberOfRows,n._columnMajor,t),n}$setColumn(e,t){return this.setColumn(e,t,{inPlace:!0})}_bioconductor_NUMBER_OF_ROWS(){return this.numberOfRows()}_bioconductor_NUMBER_OF_COLUMNS(){return this.numberOfColumns()}_bioconductor_SLICE_2D(e,t,r,n){let{}=n,s=null===t,a=!s&&t.constructor==Object,o=s?this._numberOfRows:a?t.end-t.start:t.length;e._numberOfRows=o;let h=null===r,c=!h&&r.constructor==Object,f=h?this._numberOfColumns:c?r.end-r.start:r.length;e._numberOfColumns=f;let d=new this._values.constructor(o*f);e._values=d,this._columnMajor?(0,i.A)(l,this,u).call(this,r,h,c,this._numberOfColumns,t,s,a,this._numberOfRows,o,d):(0,i.A)(l,this,u).call(this,t,s,a,this._numberOfRows,r,h,c,this._numberOfColumns,f,d),e._columnMajor=this._columnMajor}_combiner(e,t,r,n,s){let i=t(e[0]),a=r(e[0]);for(var l=1;l<e.length;l++){if(r(e[l])!==a)throw new Error("all objects must have the same number of "+s);i+=t(e[l])}let o=n(e[0]),h=new e[0]._values.constructor(i*a);if(o){let r=0;for(l=0;l<e.length;l++){let s=e[l],i=t(s),o=r*a;if(n(s))h.set(s._values,o);else for(var u=0;u<a;u++){let e=u*i,t=o+u;for(var c=0;c<i;c++)h[t+c*a]=s._values[e+c]}r+=i}}else{let r=0;for(l=0;l<e.length;l++){let s=e[l],o=t(s);if(n(s))for(c=0;c<o;c++){let e=c*a,t=r+c;for(u=0;u<a;u++)h[t+u*i]=s._values[e+u]}else for(var u=0;u<a;u++){let e=u*o,t=s._values.subarray(e,e+o);h.set(t,r+u*i)}r+=o}}return{num_primary:i,num_secondary:a,values:h,primary_major:o}}_bioconductor_COMBINE_ROWS(e,t){let r=this._combiner(t,(e=>e._numberOfRows),(e=>e._numberOfColumns),(e=>!e._columnMajor),"columns");e._numberOfRows=r.num_primary,e._numberOfColumns=r.num_secondary,e._values=r.values,e._columnMajor=!r.primary_major}_bioconductor_COMBINE_COLUMNS(e,t){let r=this._combiner(t,(e=>e._numberOfColumns),(e=>e._numberOfRows),(e=>e._columnMajor),"rows");e._numberOfColumns=r.num_primary,e._numberOfRows=r.num_secondary,e._values=r.values,e._columnMajor=r.primary_major}_bioconductor_CLONE(e){let{deepCopy:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e._values=t?this._values.slice():this._values,e._numberOfRows=this._numberOfRows,e._numberOfColumns=this._numberOfColumns,e._columnMajor=this._columnMajor}},"name","DenseMatrix")},3968:(e,t,r)=>{"use strict";r.d(t,{q:()=>h});var n=r(6662),s=r(9358),i=r(1430),a=r(5570),l=r(7804),o=r(2276);class h extends l.M{constructor(e,t){let{strand:r=null,names:i=null,elementMetadata:a=null,metadata:l={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0==arguments.length)return void super();super(e.length,{names:i,elementMetadata:a,metadata:l}),s.tj(e,"seqnames"),this._seqnames=e;let o=e.length;if(o!==n.pi(t))throw s.I9("'ranges'","'seqnames'");if(this._ranges=t,null!==r){if(o!==r.length)throw s.I9("'strand'","'seqnames'");r=u.call(h,r),c.call(h,r)}else r=new Int8Array(o),r.fill(0);this._strand=r}start(){return this._ranges.start()}end(){return this._ranges.end()}width(){return this._ranges.width()}seqnames(){return this._seqnames}ranges(){return this._ranges}strand(){return this._strand}setSeqnames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.Gl(e,"replacement 'seqnames'",n.pi(this),"'LENGTH(<GRanges>)'");let r=i.z(this,t);return r._seqnames=e,r}$setSeqnames(e){return this.setSeqnames(e,{inPlace:!0})}setRanges(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof a.q))throw new Error("'ranges' should be an IRanges object");if(n.pi(e)!==n.pi(this._ranges))throw s.I9("replacement 'ranges'","'LENGTH(<GRanges>)'");let r=i.z(this,t);return r._ranges=e,r}$setRanges(e){return this.setRanges(e,{inPlace:!0})}setStrand(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._strand.length!==e.length)throw s.I9("'strand'","'seqnames'");e=u.call(h,e),c.call(h,e);let r=i.z(this,t);return r._strand=e,r}$setStrand(e){return this.setStrand(e,{inPlace:!0})}buildOverlapIndex(){let{restrictToSeqnames:e=null,restrictToStrand:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=s.gh(n.pi(this)),i=n.JP(r,this._seqnames),a=this.start(),l=this.end();null!==e&&e instanceof Array&&(e=new Set(e)),null!==t&&t instanceof Array&&(t=new Set(t));for(const s of Object.keys(i)){if(null!==e&&!e.has(s)){delete i[s];continue}let r=i[s],h=n.$9(this._strand,r),u=n.JP(r,h);for(const e of Object.keys(u)){if(null!==t&&!t.has(Number(e))){delete u[e];continue}let r=u[e];u[e]=o.Q0(a,l,{slice:r})}i[s]=u}return new f(i)}_bioconductor_LENGTH(){return this._seqnames.length}_bioconductor_SLICE(e,t,r){let{allowView:s=!1}=r;super._bioconductor_SLICE(e,t,{allowView:s}),e._seqnames=n.$9(this._seqnames,t,{allowView:s}),e._ranges=n.$9(this._ranges,t,{allowView:s}),e._strand=n.$9(this._strand,t,{allowView:s})}_bioconductor_COMBINE(e,t){super._bioconductor_COMBINE(e,t);let r=[],s=[],i=[];for(const n of t)r.push(n._seqnames),s.push(n._ranges),i.push(n._strand);e._seqnames=n.cI(r),e._ranges=n.cI(s),e._strand=n.cI(i)}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._seqnames=i.k(this._seqnames,r),e._ranges=i.k(this._ranges,r),e._strand=i.k(this._strand,r)}static empty(){return new h([],a.q.empty())}}function u(e){return e instanceof Int8Array?e:new Int8Array(e)}function c(e){for(const t of e)if(t<-1||t>1)throw new Error("'strand' must be -1, 0 or 1")}class f{constructor(e){this._index=e}overlap(e){let{ignoreStrand:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.pi(e),s=new Array(r),i=e.start(),a=e.end();for(var l=0;l<r;l++){s[l]=[];let r=s[l],n=e._seqnames[l];if(!(n in this._index))continue;let h,u=this._index[n],c=e._strand[l];if(t||0==c)h=Object.keys(u);else{let e=String(c);if(!(e in u))continue;h=[e]}let f=i[l],d=a[l];for(const e of h){o.ql(f,d,u[e]).forEach((e=>r.push(e)))}}return s}}},8686:(e,t,r)=>{"use strict";r.d(t,{q:()=>A});var n=r(9790),s=r(5149),i=r(4558),a=r(8458),l=r(6562),o=r(7804),h=r(3968),u=r(9358),c=r(1430),f=r(6662),d=new WeakMap,m=new WeakSet;class A extends o.M{constructor(e){let{rangeLengths:t=null,names:r=null,elementMetadata:i=null,metadata:a={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0==arguments.length)return super(),(0,n.A)(this,m),void(0,s.A)(this,d,null);if(e.constructor==Array){super(e.length,{names:r,elementMetadata:i,metadata:a}),(0,n.A)(this,m),(0,s.A)(this,d,null),t=new Int32Array(e.length);for(var l=0;l<t.length;l++){if(!(e[l]instanceof h.q))throw new Error("'ranges' must either be a 'GRanges' or an array of 'GRanges'");t[l]=f.pi(e[l])}e=f.cI(e)}else{if(!(e instanceof h.q))throw new Error("'ranges' must either be a 'GRanges' or an array of 'GRanges'");if(null==t)throw new Error("'rangeLengths' must be specified when 'ranges' is a 'GRanges'");super(t.length,{names:r,elementMetadata:i,metadata:a}),(0,n.A)(this,m),(0,s.A)(this,d,null),t=u.YH(t),u.N_(t)}this._ranges=e,this._rangeLengths=t;let o=p.call(A,t);if(this._rangeStarts=o.starts,o.total!==f.pi(e))throw new Error("sum of 'rangeLengths' must be equal to the length of 'ranges'")}ranges(){return(0,l.A)(m,this,_).call(this),this._ranges}rangeStarts(){return(0,l.A)(m,this,_).call(this),this._rangeStarts}rangeLengths(){return(0,l.A)(m,this,_).call(this),this._rangeLengths}group(e){let{allowView:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,l.A)(m,this,_).call(this);let r=this._rangeStarts[e];return f.$9(this._ranges,{start:r,end:r+this._rangeLengths[e]},{allowView:t})}numberOfGroups(){return this._rangeStarts.length}setRanges(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.q))throw new Error("'ranges' must be a 'GRanges'");if((0,l.A)(m,this,_).call(this),f.pi(e)!==f.pi(this._ranges))throw u.I9("'ranges'","number of ranges");let r=c.z(this,t);return r._ranges=e,r}$setRanges(e){return this.setRanges(e,{inPlace:!0})}setGroup(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=c.z(this,r);null===(0,a.A)(d,n)?(0,i.A)(d,n,[]):r||(0,i.A)(d,n,(0,a.A)(d,n).slice()),r||(n._rangeStarts=n._rangeStarts.slice(),n._rangeLengths=n._rangeLengths.slice());let s=(0,a.A)(d,n).length;return(0,a.A)(d,n).push([e,s,t]),n}$setGroup(e,t){return this.setGroup(e,t,{inPlace:!0})}buildOverlapIndex(){let{restrictToSeqnames:e=null,restrictToStrand:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.A)(m,this,_).call(this),new w(this._ranges.buildOverlapIndex({restrictToSeqnames:e,restrictToStrand:t}),f.pi(this._ranges),this._rangeStarts,this._rangeLengths)}_bioconductor_LENGTH(){return this._rangeStarts.length}_bioconductor_SLICE(e,t){let{allowView:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super._bioconductor_SLICE(e,t,{allowView:r}),(0,l.A)(m,this,_).call(this),e._rangeLengths=f.$9(this._rangeLengths,t,{allowView:r});let n=p.call(A,e._rangeLengths);if(e._rangeStarts=n.starts,t.constructor==Object){let s=this._rangeStarts[t.start];e._ranges=f.$9(this._ranges,{start:s,end:s+n.total},{allowView:r})}else{let i=new Int32Array(n.total),a=0;for(const e of t){let t=this._rangeStarts[e],r=t+this._rangeLengths[e];for(var s=t;s<r;s++)i[a]=s,a++}e._ranges=f.$9(this._ranges,i,{allowView:r})}}_bioconductor_COMBINE(e,t){super._bioconductor_COMBINE(e,t);for(const n of t)(0,l.A)(m,n,_).call(n);e._rangeLengths=f.cI(t.map((e=>e.rangeLengths())));let r=p.call(A,e._rangeLengths);e._rangeStarts=r.starts,e._ranges=f.cI(t.map((e=>e._ranges)))}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),(0,i.A)(d,e,c.k((0,a.A)(d,this),r)),e._rangeLengths=c.k(this._rangeLengths,r),e._rangeStarts=c.k(this._rangeStarts,r),e._ranges=c.k(this._ranges,r)}static empty(e){let t=new Int32Array(e);return t.fill(0),new A(h.q.empty(),{rangeLengths:t})}}function p(e){let t=new Int32Array(e.length),r=0;for(var n=0;n<e.length;n++)t[n]=r,r+=e[n];return{starts:t,total:r}}function _(){let e=(0,a.A)(d,this);if(null===e)return;e.sort(((e,t)=>{let r=e[0]-t[0];return 0===r?e[1]-t[1]:r}));let t=0,r=0,n=0,s=[],l=this.numberOfGroups();for(var o=0;o<l;o++){if(t<e.length&&o==e[t][0]){let r,i=this._rangeStarts[o];n<i&&s.push(f.$9(this._ranges,{start:n,end:i})),n=i+this._rangeLengths[o];do{r=e[t][2],t++}while(t<e.length&&o==e[t][0]);s.push(r),this._rangeLengths[o]=f.pi(r)}this._rangeStarts[o]=r,r+=this._rangeLengths[o]}let h=f.pi(this._ranges);n<h&&s.push(f.$9(this._ranges,{start:n,end:h}));try{this._ranges=f.cI(s)}catch(u){throw new Error("failed to combine staged '$setGroup' operations; "+u.message)}(0,i.A)(d,this,null)}class w{constructor(e,t,r,n){this._index=e,this._rangeStarts=r,this._rangeLengths=n;let s=new Int32Array(t);for(var i=0;i<r.length;i++){let e=r[i],t=e+n[i];for(var a=e;a<t;a++)s[a]=i}this._reverseMapping=s}overlap(e){let{ignoreStrand:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Array(this._rangeStarts.length),n=this._reverseMapping;if(e instanceof A){let t=this._index.overlap(e._ranges);for(var s=0;s<e._rangeStarts.length;s++){let a=e._rangeStarts[s],l=a+e._rangeLengths[s],o=new Set;for(var i=a;i<l;i++)t[i].forEach((e=>o.add(n[e])));r[s]=Array.from(o)}}else{let t=this._index.overlap(e);for(s=0;s<t.length;s++){let e=new Set;t[s].forEach((t=>e.add(n[t]))),r[s]=Array.from(e)}}return r}}},5570:(e,t,r)=>{"use strict";r.d(t,{q:()=>h});var n=r(4467),s=r(6662),i=r(9358),a=r(1430),l=(r(2294),r(7804)),o=r(2276);class h extends l.M{constructor(e,t){let{names:r=null,elementMetadata:n=null,metadata:s={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0!=arguments.length){if(super(e.length,{names:r,elementMetadata:n,metadata:s}),this._start=i.YH(e),i.N_(this._start,"start"),this._width=i.YH(t),i.N_(this._width,"width"),this._start.length!==this._width.length)throw new Error("'start' and 'width' should have the same length")}else super()}start(){return this._start}end(){return this._start.map(((e,t)=>e+this._width[t]))}width(){return this._width}setStart(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.YH(e);if(r.length!==s.pi(this))throw new Error("'start' should be replaced by array of the same length");i.N_(r,"start");let n=a.z(this,t);return n._start=r,n}$setStart(e){return this.setStart(e,{inPlace:!0})}setWidth(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.YH(e);if(r.length!==s.pi(this))throw new Error("'width' should be replaced by array of the same length");i.N_(r,"width");let n=a.z(this,t);return n._width=r,n}$setWidth(e){return this.setWidth(e,{inPlace:!0})}buildOverlapIndex(){let e=o.Q0(this._start,this.end());return new u(e)}_bioconductor_LENGTH(){return this._start.length}_bioconductor_SLICE(e,t,r){let{allowView:n=!1}=r;super._bioconductor_SLICE(e,t,{allowView:n}),e._start=s.$9(this._start,t,{allowView:n}),e._width=s.$9(this._width,t,{allowView:n})}_bioconductor_COMBINE(e,t){super._bioconductor_COMBINE(e,t);let r=[],n=[];for(const s of t)r.push(s._start),n.push(s._width);e._start=s.cI(r),e._width=s.cI(n)}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._start=a.k(this._start,r),e._width=a.k(this._width,r)}static empty(){return new h(new Int32Array,new Int32Array)}}(0,n.A)(h,"className","IRanges");class u{constructor(e){this._tree=e}overlap(e){let t=s.pi(e),r=new Array(t);for(var n=0;n<t;n++)r[n]=o.ql(e._start[n],e._start[n]+e._width[n],this._tree);return r}}},9462:(e,t,r)=>{"use strict";r.d(t,{w:()=>u});var n=r(9790),s=r(4467),i=r(6562),a=r(9358),l=r(1430),o=r(6662),h=new WeakSet;class u{constructor(e,t){if((0,n.A)(this,h),0==arguments.length)return;e=a.k4(e);let r=Array.from(e.keys());if(null!==t){a.Gl(t,"'order'",r.length,"the length of 'entries'");let e=t.slice().sort();if(r.sort(),!a.BI(e,r))throw new Error("values of 'order' should be the same as the keys of 'entries'")}else t=r;this._entries=e,this._order=t}names(){return this._order}numberOfEntries(){return this._order.length}entry(e){if("string"==typeof e){if(!this._entries.has(e))throw new Error("no entry '"+e+"' present in this "+this.constructor.className);return this._entries.get(e)}return(0,i.A)(h,this,c).call(this,e),this._entries.get(this._order[e])}has(e){return this._entries.has(e)}delete(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);if(t||(r._order=r._order.slice(),r._entries=new Map(r._entries)),"string"==typeof e){let t=r._order.indexOf(e);if(t<0)throw new Error("no entry '"+e+"' present in this "+this.constructor.className);r._order.splice(t,1),r._entries.delete(e)}else{(0,i.A)(h,this,c).call(this,e);let t=r._order[e];r._order.splice(e,1),r._entries.delete(t)}return r}set(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=l.z(this,r);return r||(n._entries=new Map(n._entries)),"string"==typeof e?(n._entries.has(e)||(r||(n._order=n._order.slice()),n._order.push(e)),n._entries.set(e,t)):((0,i.A)(h,this,c).call(this,e),n._entries.set(n._order[e],t)),n}setNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.Gl(e,"replacement 'names'",this._order.length,"length of 'names()'");let r=new Map;for(var n=0;n<e.length;n++){if(r.has(e[n]))throw new Error("detected duplicate value '"+e[n]+"' in replacement 'names'");r.set(e[n],this._entries.get(this._order[n]))}let s=l.z(this,t);return s._entries=r,s._order=e,s}slice(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Map,n=[];for(var s of e){if("string"!=typeof s&&((0,i.A)(h,this,c).call(this,s),s=this._order[s]),r.has(s))throw new Error("duplicate entries detected in slice request");if(!this._entries.has(s))throw new Error("slice contains missing entry '"+s+"' ");r.set(s,this._entries.get(s)),n.push(s)}let a=l.z(this,t);return a._entries=r,a._order=n,a}reorder(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.length!==this._order.length)throw a.I9("reordered indices","the number of existing entries");let r=[];for(var n of e){if("string"!=typeof n&&((0,i.A)(h,this,c).call(this,n),n=this._order[n]),!this._entries.has(n))throw new Error("missing entry '"+n+"' among the reordered indices");r.push(n)}let s=l.z(this,t);return s._order=r,s}_bioconductor_CLONE(e){let{deepCopy:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e._entries=t?o.UC(this._entries):this._entries,e._order=t?o.UC(this._order):this._order}apply(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t?this._entries:new Map;for(const[n,s]of this._entries)r.set(n,e(s));return t?this:new u(r,this._order)}static parallelCombine(e,t){let r=e[0]._order;for(var n=1;n<e.length;n++)if(!a.BI(r,e[n]._order))throw new Error("detected differences in names between first object and object "+String(n)+" to be combined");let s=new Map;for(const i of r){let r=e.map((e=>e._entries.get(i)));s.set(i,t(r))}return new u(s,r)}}function c(e){if(e<0||e>=this._order.length)throw new Error(" index '"+String(e)+"' out of range for this "+this.constructor.className)}(0,s.A)(u,"className","InternalList")},6508:(e,t,r)=>{"use strict";r.d(t,{e:()=>f});var n=r(9790),s=r(6562),i=r(6662),a=r(3968),l=r(8686),o=r(8675),h=r(9358),u=r(1430),c=new WeakSet;class f extends o.H{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0==arguments.length)return super(),void(0,n.A)(this,c);super(e,r),(0,n.A)(this,c),null===t?t=l.q.empty(this.numberOfRows()):(0,s.A)(c,this,d).call(this,t),this._rowRanges=t}rowRanges(){return this._rowRanges}setRowRanges(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.A)(c,this,d).call(this,e);let r=u.z(this,t);return r._rowRanges=e,r}$setRowRanges(e){return this.setRowRanges(e,{inPlace:!0})}_bioconductor_SLICE_2D(e,t,r,n){let{allowView:s=!1}=n;super._bioconductor_SLICE_2D(e,t,r,{allowView:s}),e._rowRanges=null!==t?i.$9(this._rowRanges,t):this._rowRanges}_bioconductor_COMBINE_ROWS(e,t){super._bioconductor_COMBINE_ROWS(e,t);let r=[],n=!1,s=!1;for(var h=0;h<t.length;h++){let e=t[h];if(e instanceof f){let t=e._rowRanges;t instanceof l.q&&(s=!0),r.push(t)}else{if(!(e instanceof o.H))throw new Error("objects to be combined must be SummarizedExperiments (failing for object "+String(h)+")");n=!0,r.push(null)}}if(n||s)for(h=0;h<r.length;h++){let e=r[h];if(e instanceof a.q){let t=new Int32Array(i.pi(e));t.fill(1);let n={rangeLengths:t,names:e.names(),elementMetadata:e.elementMetadata(),metadata:e.metadata()};null!==n.names&&(e=e.setNames(null)),(n.elementMetadata.metadata().size>0||n.elementMetadata.numberOfColumns()>0)&&(e=e.setElementMetadata(null)),n.metadata.size>0&&(e=e.setMetadata(new Map)),r[h]=new l.q(e,n)}else null===e&&(r[h]=l.q.empty(t[h].numberOfRows()))}e._rowRanges=i.cI(r)}_bioconductor_COMBINE_COLUMNS(e,t){super._bioconductor_COMBINE_COLUMNS(e,t),e._rowRanges=t[0]._rowRanges}_bioconductor_CLONE(e,t){let{deepCopy:r}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._rowRanges=u.k(this._rowRanges,r)}}function d(e){if(!(e instanceof a.q)&&!(e instanceof l.q))throw new Error("'rowRanges' should be a 'GRanges' or 'GroupedGRanges' instance");if(i.pi(e)!==this._rowData.numberOfRows())throw h.I9("'rowRanges'","the number of rows")}},2952:(e,t,r)=>{"use strict";var n=r(4467),s=r(6662),i=r(6508),a=r(8675),l=r(1430),o=r(9462);class h extends i.e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0==arguments.length)return void super();let{reducedDimensions:r={},reducedDimensionOrder:n=null,alternativeExperiments:i={},alternativeExperimentOrder:l=null,rowRanges:h=null}=t;super(e,h,t);let u=this.numberOfColumns();try{this._reducedDimensions=new o.w(r,n)}catch(c){throw new Error("failed to initialize reduced dimension list for this "+this.constructor.className+"; "+c.message,{cause:c})}for(const a of this._reducedDimensions.names()){let e=this._reducedDimensions.entry(a);if(s.eQ(e)!==u)throw new Error("number of rows for reduced dimension '"+a+"' is not equal to number of columns for this "+this.constructor.className)}try{this._alternativeExperiments=new o.w(i,l)}catch(c){throw new Error("failed to initialize alternative experiment list for this "+this.constructor.className+"; "+c.message,{cause:c})}for(const s of this._alternativeExperiments.names()){let e=this._alternativeExperiments.entry(s);if(!(e instanceof a.H))throw new Error("alternative experiment '"+s+"' is not a SummarizedExperiment");if(e.numberOfColumns(e)!==u)throw new Error("number of columns for alternative experiment '"+s+"' is not equal to number of columns for this "+this.constructor.className)}}reducedDimensionNames(){return this._reducedDimensions.names()}reducedDimension(e){let t;try{t=this._reducedDimensions.entry(e)}catch(r){throw new Error("failed to retrieve the specified reduced dimension from this "+this.constructor.className+"; "+r.message,{cause:r})}return t}alternativeExperimentNames(){return this._alternativeExperiments.names()}alternativeExperiment(e){let t;try{t=this._alternativeExperiments.entry(e)}catch(r){throw new Error("failed to retrieve the specified alternative experiment from this "+this.constructor.className+"; "+r.message,{cause:r})}return t}removeReducedDimension(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._reducedDimensions=r._reducedDimensions.delete(e,{inPlace:t})}catch(n){throw new Error("failed to remove the specified reduced dimension from this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$removeReducedDimension(e){return this.removeReducedDimension(e,{inPlace:!0})}setReducedDimension(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(s.eQ(t)!=this.numberOfColumns())throw new Error("number of rows of 'value' should be the same as the number of columns of this SingleCellExperiment");let n=l.z(this,r);return n._reducedDimensions=n._reducedDimensions.set(e,t,{inPlace:r}),n}$setReducedDimension(e,t){return this.setReducedDimension(e,t,{inPlace:!0})}setReducedDimensionNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._reducedDimensions=r._reducedDimensions.setNames(e,{inPlace:t})}catch(n){throw new Error("failed to set the reduced dimension names for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$setReducedDimensionNames(e){return this.setReducedDimensionNames(e,{inPlace:!0})}sliceReducedDimensions(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._reducedDimensions=this._reducedDimensions.slice(e,{inPlace:t})}catch(n){throw new Error("failed to slice the reduced dimensions for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$sliceReducedDimensions(e){return this.sliceReducedDimensions(e,{inPlace:!0})}removeAlternativeExperiment(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._alternativeExperiments=r._alternativeExperiments.delete(e,{inPlace:t})}catch(n){throw new Error("failed to remove the specified alternative experiment from this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$removeAlternativeExperiment(e){return this.removeAlternativeExperiment(e,{inPlace:!0})}setAlternativeExperiment(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(t instanceof a.H)||s.IV(t)!=this.numberOfColumns())throw new Error("'value' should be a SummarizedExperiment with the same number of columns as this SingleCellExperiment");let n=l.z(this,r);return n._alternativeExperiments=n._alternativeExperiments.set(e,t,{inPlace:r}),n}$setAlternativeExperiment(e,t){return this.setAlternativeExperiment(e,t,{inPlace:!0})}setAlternativeExperimentNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._alternativeExperiments=r._alternativeExperiments.setNames(e,{inPlace:t})}catch(n){throw new Error("failed to set the alternative experiment names for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$setAlternativeExperimentNames(e){return this.setAlternativeExperimentNames(e,{inPlace:!0})}sliceAlternativeExperiments(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.z(this,t);try{r._alternativeExperiments=this._alternativeExperiments.slice(e,{inPlace:t})}catch(n){throw new Error("failed to slice the alternative experiments for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$sliceAlternativeExperiments(e){return this.sliceAlternativeExperiments(e,{inPlace:!0})}_bioconductor_SLICE_2D(e,t,r,n){let{allowView:i=!1}=n;super._bioconductor_SLICE_2D(e,t,r,{allowView:i}),null!==r?(e._reducedDimensions=this._reducedDimensions.apply((e=>s.Uf(e,r,null,{allowView:i}))),e._alternativeExperiments=this._alternativeExperiments.apply((e=>s.Uf(e,null,r,{allowView:i})))):(e._reducedDimensions=this._reducedDimensions,e._alternativeExperiments=this._alternativeExperiments)}_bioconductor_COMBINE_ROWS(e,t){super._bioconductor_COMBINE_ROWS(e,t),e._reducedDimensions=this._reducedDimensions,e._alternativeExperiments=this._alternativeExperiments}_bioconductor_COMBINE_COLUMNS(e,t){super._bioconductor_COMBINE_COLUMNS(e,t);try{e._reducedDimensions=o.w.parallelCombine(t.map((e=>e._reducedDimensions)),s.C7)}catch(r){throw new Error("failed to combine reduced dimensions for "+this.constructor.className+" objects; "+r.message,{cause:r})}try{e._alternativeExperiments=o.w.parallelCombine(t.map((e=>e._alternativeExperiments)),s.St)}catch(r){throw new Error("failed to combine alternative experiments for "+this.constructor.className+" objects; "+r.message,{cause:r})}}_bioconductor_CLONE(e,t){let{deepCopy:r}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._reducedDimensions=l.k(this._reducedDimensions,r),e._alternativeExperiments=l.k(this._alternativeExperiments,r)}}(0,n.A)(h,"className","SingleCellExperiment")},8675:(e,t,r)=>{"use strict";r.d(t,{H:()=>u});var n=r(4467),s=r(6662),i=r(1995),a=r(2294),l=r(9358),o=r(1430),h=r(9462);class u extends i.N{constructor(e){let{assayOrder:t=null,rowData:r=null,columnData:n=null,rowNames:i=null,columnNames:o=null,metadata:u={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0==arguments.length)return void super();super(u);try{this._assays=new h.w(e,t)}catch(d){throw new Error("failed to initialize assay list for this SummarizedExperiment; "+d.message,{cause:d})}let c=null,f=null;for(const a of this._assays.names()){let e=this._assays.entry(a),t=s.eQ(e),r=s.IV(e);if(null==c)c=t,f=r;else if(c!==t||f!==r)throw new Error("expected all assays in 'assays' to have the same number of rows and columns")}if(null===r){if(null==c)throw new Error("'rowData' must be specified if 'assays' is empty");r=new a.C({},{numberOfRows:c})}else if(null!==c&&c!==s.pi(r))throw new Error("'rowData' should be equal to the number of rows in each 'assays'");if(this._rowData=r,null===n){if(null==f)throw new Error("'columnData' must be specified if 'assays' is empty");n=new a.C({},{numberOfRows:f})}else if(null!==f&&f!==s.pi(n))throw new Error("'columnData' should be equal to the number of columns in each 'assays'");this._columnData=n,null!=i&&l.Gl(i,"'rowNames'",this._rowData.numberOfRows(),"the number of rows in each 'assays'"),this._rowNames=i,null!=o&&l.Gl(o,"'columnNames'",this._columnData.numberOfRows(),"the number of columns in each 'assays'"),this._columnNames=o}assayNames(){return this._assays.names()}numberOfAssays(){return this._assays.numberOfEntries()}assay(e){let t;try{t=this._assays.entry(e)}catch(r){throw new Error("failed to retrieve the specified assay from this "+this.constructor.className+"; "+r.message,{cause:r})}return t}rowData(){return this._rowData}numberOfRows(){return this._rowData.numberOfRows()}rowNames(){return this._rowNames}columnData(){return this._columnData}numberOfColumns(){return this._columnData.numberOfRows()}columnNames(){return this._columnNames}removeAssay(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.z(this,t);try{r._assays=r._assays.delete(e,{inPlace:t})}catch(n){throw new Error("failed to remove assay "+("string"==typeof e?"'"+e+"'":String(e))+" from this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$removeAssay(e){return this.removeAssay(e,{inPlace:!0})}setAssay(e,t){let{inPlace:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(s.eQ(t)!==this.numberOfRows()||s.IV(t)!==this.numberOfColumns())throw new Error("expected 'value' to have the same dimensions as this 'SummarizedExperiment'");let n=o.z(this,r);return n._assays=n._assays.set(e,t,{inPlace:r}),n}$setAssay(e,t){return this.setAssay(e,t,{inPlace:!0})}setAssayNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.z(this,t);try{r._assays=r._assays.setNames(e,{inPlace:t})}catch(n){throw new Error("failed to set the assay names for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$setAssayNames(e){return this.setAssayNames(e,{inPlace:!0})}sliceAssays(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.z(this,t);try{r._assays=this._assays.slice(e,{inPlace:t})}catch(n){throw new Error("failed to slice the assays for this "+this.constructor.className+"; "+n.message,{cause:n})}return r}$sliceAssays(e){return this.sliceAssays(e,{inPlace:!0})}setRowData(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof a.C))throw new Error("'value' should be a DataFrame");if(e.numberOfRows()!==this.numberOfRows())throw new Error("expected 'value' to have the same number of rows as this 'SummarizedExperiment'");let r=o.z(this,t);return r._rowData=e,r}$setRowData(e){return this.setRowData(e,{inPlace:!0})}setColumnData(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof a.C))throw new Error("'value' should be a DataFrame");if(e.numberOfRows()!==this.numberOfColumns())throw new Error("expected 'value' to have the same number of rows as the number of columns of this 'SummarizedExperiment'");let r=o.z(this,t);return r._columnData=e,r}$setColumnData(e){return this.setColumnData(e,{inPlace:!0})}setRowNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!==e&&l.Gl(e,"replacement 'names'",this.numberOfRows(),"'numberOfRows()'");let r=o.z(this,t);return r._rowNames=e,r}$setRowNames(e){return this.setRowNames(e,{inPlace:!0})}setColumnNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!==e&&l.Gl(e,"replacement 'names'",this.numberOfColumns(),"'numberOfColumns()'");let r=o.z(this,t);return r._columnNames=e,r}$setColumnNames(e){return this.setColumnNames(e,{inPlace:!0})}_bioconductor_NUMBER_OF_ROWS(){return this.numberOfRows()}_bioconductor_NUMBER_OF_COLUMNS(){return this.numberOfColumns()}_bioconductor_SLICE_2D(e,t,r,n){let{allowView:i=!1}=n;e._assays=this._assays.apply((e=>s.Uf(e,t,r,{allowView:i}))),null!==t?(e._rowData=s.$9(this._rowData,t,{allowView:i}),e._rowNames=null==this._rowNames?null:s.$9(this._rowNames,t,{allowView:i})):(e._rowData=this._rowData,e._rowNames=this._rowNames),null!==r?(e._columnData=s.$9(this._columnData,r,{allowView:i}),e._columnNames=null==this._columnNames?null:s.$9(this._columnNames,r,{allowView:i})):(e._columnData=this._columnData,e._columnNames=this._columnNames),e._metadata=this._metadata}_bioconductor_COMBINE_ROWS(e,t){e._assays=h.w.parallelCombine(t.map((e=>e._assays)),s.C7);let r=t.map((e=>e._rowData));e._rowData=s.cI(r);let n=t.map((e=>e._rowNames)),i=t.map((e=>e.numberOfRows()));e._rowNames=l.qR(n,i),e._columnData=this._columnData,e._columnNames=this._columnNames,e._metadata=this._metadata}_bioconductor_COMBINE_COLUMNS(e,t){e._assays=h.w.parallelCombine(t.map((e=>e._assays)),s.St);let r=t.map((e=>e._columnData));e._columnData=s.cI(r);let n=t.map((e=>e._columnNames)),i=t.map((e=>e.numberOfColumns()));e._columnNames=l.qR(n,i),e._rowData=this._rowData,e._rowNames=this._rowNames,e._metadata=this._metadata}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._assays=o.k(this._assays,r),e._rowData=o.k(this._rowData,r),e._rowNames=o.k(this._rowNames,r),e._columnData=o.k(this._columnData,r),e._columnNames=o.k(this._columnNames,r)}}(0,n.A)(u,"className","SummarizedExperiment")},7804:(e,t,r)=>{"use strict";r.d(t,{M:()=>h});var n=r(6662),s=r(9358),i=r(1430),a=r(2294),l=r(1995);function o(e,t,r){if(null!==e){if(!(e instanceof a.C))throw new Error("'elementMetadata' should be a DataFrame");if(n.pi(e)!==t)throw new Error("'elementMetadata' should have the same number of rows as 'LENGTH(<"+r+">)'")}else e=new a.C({},{numberOfRows:t});return e}class h extends l.N{constructor(e){let{names:t=null,elementMetadata:r=null,metadata:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};0!=arguments.length?(super(n),this._elementMetadata=o(r,e,this.constructor.className),null!==t&&s.Gl(t,"'names'",e,"'LENGTH(<"+this.constructor.className+">)'"),this._names=t):super()}elementMetadata(){return this._elementMetadata}names(){return this._names}setElementMetadata(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.z(this,t);return r._elementMetadata=o(e,n.pi(r),r.constructor.className),r}$setElementMetadata(e){return this.setElementMetadata(e,{inPlace:!0})}setNames(e){let{inPlace:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!==e&&s.Gl(e,"replacement 'names'",n.pi(this),"'LENGTH(<"+this.constructor.className+">)'");let r=i.z(this,t);return r._names=e,r}$setNames(e){return this.setNames(e,{inPlace:!0})}_bioconductor_SLICE(e,t,r){let{allowView:s=!1}=r;e._elementMetadata=n.$9(this._elementMetadata,t,{allowView:s}),e._names=null===this._names?null:n.$9(this._names,t,{allowView:s}),e._metadata=this._metadata}_bioconductor_COMBINE(e,t){let r=[],i=[],a=[];for(const s of t)r.push(s._elementMetadata),i.push(s._names),a.push(n.pi(s));e._elementMetadata=n.cI(r),e._names=s.qR(i,a)}_bioconductor_CLONE(e,t){let{deepCopy:r=!0}=t;super._bioconductor_CLONE(e,{deepCopy:r}),e._elementMetadata=i.k(this._elementMetadata,r),e._names=i.k(this._names,r)}}},1430:(e,t,r)=>{"use strict";r.d(t,{k:()=>i,z:()=>s});var n=r(6662);function s(e,t){return t?e:n.UC(e,{deepCopy:!1})}function i(e,t){return t?n.UC(e):e}},3619:(e,t,r)=>{"use strict";r.d(t,{$9:()=>s.$9,CP:()=>n.C,I4:()=>n.I,JP:()=>s.JP,UC:()=>s.UC,cI:()=>s.cI,zJ:()=>i.z});var n=r(2294),s=(r(5570),r(3968),r(8686),r(4793),r(8675),r(6508),r(2952),r(6662)),i=r(903)},903:(e,t,r)=>{"use strict";function n(e){let t={};return e.forEach(((e,r)=>{e in t||(t[e]=[]),t[e].push(r)})),t}r.d(t,{z:()=>n})},2276:(e,t,r)=>{"use strict";r.d(t,{Q0:()=>s,ql:()=>l});var n=r(9358);function s(e,t){let{slice:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{rank2position:s,startRanks:l,endRanks:o}=function(e,t){let{slice:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=null==r?e.length:r.length,i=new Int32Array(2*s),a=new Uint8Array(2*s),l=new Int32Array(2*s);{let n=0,h=r=>{let s=2*n,o=s+1;i[s]=e[r],i[o]=t[r],a[s]=1,a[o]=0,l[s]=n,l[o]=n,n++};if(null===r)for(var o=0;o<s;o++)h(o);else for(const e of r)h(e)}let h=n.gh(i.length);h.sort(((e,t)=>i[e]-i[t]));let u=[],c=new Int32Array(s),f=new Int32Array(s),d=null;for(const n of h){let e=i[n],t=l[n];e!==d&&(u.push(e),d=e),a[n]?c[t]=u.length-1:f[t]=u.length-1}return{rank2position:u,startRanks:c,endRanks:f}}(e,t,{slice:r}),h=[i(0,s.length)];if(null===r)for(var u=0;u<l.length;u++)a(l[u],o[u],u,h,0);else for(u=0;u<l.length;u++)a(l[u],o[u],r[u],h,0);let c=s.length>0?s[s.length-1]+1:1;s.push(c);for(const n of h){n.left_bound=s[n.left_bound],n.right_bound=s[n.right_bound],n.center=s[n.center];let r=n.overlaps.slice().sort(((t,r)=>e[t]-e[r])),i=n.overlaps.sort(((e,r)=>t[r]-t[e]));n.overlaps={start:r.map((t=>[e[t],t])),end:i.map((e=>[t[e],e]))}}return h}function i(e,t){return{left_bound:e,right_bound:t,center:e+Math.floor((t-e)/2),left_node:null,right_node:null,overlaps:[]}}function a(e,t,r,n,s){let l=n[s];e>l.center?(null===l.right_node&&(l.right_node=n.length,n.push(i(l.center,l.right_bound))),a(e,t,r,n,l.right_node)):t<l.center||t==l.center&&t>e?(null===l.left_node&&(l.left_node=n.length,n.push(i(l.left_bound,l.center))),a(e,t,r,n,l.left_node)):l.overlaps.push(r)}function l(e,t,r){let n=[];return e>r.right_bound||t<r.left_bound||t==r.left_bound&&t>e||o(e,t,r,0,n),n}function o(e,t,r,n,s){let i=r[n];if(e>i.center){for(const t of i.overlaps.end){if(!(t[0]>e))break;s.push(t[1])}null!==i.right_node&&o(e,t,r,i.right_node,s)}else if(t<i.center||t==i.center&&t>e){for(const r of i.overlaps.start){if(!(r[0]<t||r[0]==t&&e==t))break;s.push(r[1])}null!==i.left_node&&o(e,t,r,i.left_node,s)}else{for(const e of i.overlaps.start)s.push(e[1]);t>i.center&&null!==i.right_node&&o(e,t,r,i.right_node,s),e<i.center&&null!==i.left_node&&o(e,t,r,i.left_node,s)}}},9358:(e,t,r)=>{"use strict";function n(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function s(e){return e.constructor==Array||ArrayBuffer.isView(e)}function i(e,t){return e==t?e:e==Array||t==Array||e==BigInt64Array||t==BigInt64Array||e==BigUint64Array||t==BigUint64Array?Array:Float64Array}function a(e,t){return new Error(e+" should have length equal to "+t)}function l(e,t){for(const r of e)if("string"!==typeof r)throw new Error(t+" array should only contain strings")}function o(e,t,r,n){if(l(e,t),e.length!=r)throw a(t+" array",n)}function h(e){let t=0;return e.forEach((e=>{t+=e})),t}function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!0;for(var s=0;s<e.length;s++)null!==e[s]&&(n=!1);if(n)return null;null===r&&(r=h(t));let i=new Array(r),a=0;for(s=0;s<e.length;s++){let r=e[s];null===r?(i.fill("",a,a+t[s]),a+=t[s]):r.forEach((e=>{i[a]=e,a++}))}return i}function c(e){let t=new Int32Array(e);for(var r=0;r<e;r++)t[r]=r;return t}function f(e){return e instanceof Int32Array?e:new Int32Array(e)}function d(e,t){for(const r of e)if(r<0)throw new Error("detected a negative entry in '"+t+"'")}function m(e){if(e.constructor==Object){let t=new Map;for(const[r,n]of Object.entries(e))t.set(r,n);return t}if(!(e instanceof Map))throw new Error("'x' should be either an object or Map");return e}r.d(t,{BI:()=>n,Gl:()=>o,I9:()=>a,N_:()=>d,Qx:()=>i,Xj:()=>s,YH:()=>f,cz:()=>h,gh:()=>c,k4:()=>m,qR:()=>u,tj:()=>l})},9318:(e,t,r)=>{"use strict";r.d(t,{h:()=>i});var n=r(6535),s=new Map;async function i(e){let{download:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.get(e);if("undefined"!==typeof r)return r;if(!t)return null;r=[],s.set(e,r);var i=await(0,n.$c)(e+"_collections.tsv.gz");if(!i.ok)throw new Error("failed to fetch collection information for species '"+e+"'");for(var a=(0,n.lq)(await i.arrayBuffer()),l=0,o=0;o<a.length;o++){var h=a[o].split("\t"),u=Number(h[5]);r.push({title:h[0],description:h[1],species:h[2],maintainer:h[3],source:h[4],start:l,size:u}),l+=u}return r}},4106:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});var n=r(6535),s=new Map;async function i(e){let{types:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==t&&(t=["symbol","entrez","ensembl"]);let r=s.get(e);"undefined"==typeof r&&(r=new Map,s.set(e,r));let i=new Map,a=[],l=[];for(const s of t){let t=r.get(s);"undefined"==typeof t?(a.push((0,n.nz)(e+"_"+s+".tsv.gz")),l.push(s)):i.set(s,t)}if(a.length>0){let e=await Promise.all(a);for(var o=0;o<e.length;o++){let t=e[o];if(!t.ok)throw"failed to fetch symbol information for genes";var h=await t.arrayBuffer();let s=(0,n.lq)(h),a=[];for(const e of s)""==e?a.push([]):a.push(e.split("\t"));let u=l[o];r.set(u,a),i.set(u,a)}}return i}},4378:(e,t,r)=>{"use strict";r.d(t,{x:()=>a});var n=r(6535),s=r(9318),i=new Map;async function a(e){let{download:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.get(e);if("undefined"!==typeof r)return r;if(!t)return null;r=[],i.set(e,r);var[a,l]=await Promise.all([(0,n.$c)(e+"_sets.tsv.gz"),(0,s.h)(e)]);if(!a.ok)throw new Error("failed to fetch set information for species '"+e+"'");for(var o=(0,n.lq)(await a.arrayBuffer()),h=0;h<o.length;h++){var u=o[h].split("\t");r.push({name:u[0],description:u[1],size:Number(u[2])})}let c=0;for(h=0;h<l.length;h++){let e=l[h].size;for(var f=0;f<e;f++)r[f+c].collection=h,r[f+c].number=f;c+=e}return r}},8996:(e,t,r)=>{"use strict";r(6535);new Map},3705:(e,t,r)=>{"use strict";r.d(t,{i:()=>i});var n=r(6535);const s=new Map;async function i(e){let{download:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.get(e);if("undefined"!==typeof r)return r;if(!t)return null;let i=await n.$c(e+"_set2gene.tsv.gz");if(!i.ok)throw new Error("failed to fetch full set-to-gene information for species '"+e+"'");let a=n.lq(await i.arrayBuffer()).map(n.RI);return s.set(e,a),a}},2983:(e,t,r)=>{"use strict";r(6535),r(3705);new Map,new Map},7823:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var n=r(6535);const s=new Map;async function i(e){let{download:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.get(e);if("undefined"!==typeof r)return r;if(!t)return null;let i=await n.$c(e+"_gene2set.tsv.gz");if(!i.ok)throw new Error("failed to fetch full gene-to-set information for species '"+e+"'");let a=n.lq(await i.arrayBuffer()).map(n.RI);return s.set(e,a),a}},2777:(e,t,r)=>{"use strict";r(6535),r(7823);new Map,new Map},1482:(e,t,r)=>{"use strict";r(6535),r(9318);new Map,new Map,new Map,new Map},2152:(e,t,r)=>{"use strict";r(6535),r(4378),r(1482);new Map,new Map,new Map,new Map,new Map,new Map},3726:(e,t,r)=>{"use strict";r.d(t,{B:()=>a});var n=r(4106),s=new Map,i=new Map;async function a(e,t){let{lowerCase:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r?i:s,l=a.get(e);"undefined"===typeof l&&(l=new Map,a.set(e,l));let o=l.get(t);if("undefined"===typeof o){o=new Map,l.set(t,o);let s=(await(0,n.W)(e,{types:[t]})).get(t);for(var h=0;h<s.length;h++)for(let e of s[h]){r&&(e=e.toLowerCase());let t=o.get(e);"undefined"!==typeof t?t.add(h):o.set(e,new Set([h]))}for(const[e,t]of o)o.set(e,Array.from(t))}return o}},3668:(e,t,r)=>{"use strict";function n(e,t){let r=new Map;for(var n=0;n<e.length;n++)for(const t of e[n]){let e=r.get(t);"undefined"==typeof e&&(e=new Set,r.set(t,e)),e.add(n)}for(const[i,a]of r)r[i]=new Uint32Array(a);let s=new Array(t.length);for(n=0;n<t.length;n++){let e=new Set;for(const s of t[n]){let t=r.get(s);if("undefined"!==typeof t)for(const r of t)e.add(r)}s[n]=new Uint32Array(e).sort()}return s}r.d(t,{b:()=>n})},1642:(e,t,r)=>{"use strict";function n(e,t){let r=new Array(e.length);for(var n=0;n<e.length;n++){let s=new Set;for(const r of e[n])for(const e of t[r])s.add(e);r[n]=new Uint32Array(s).sort()}return r}r.d(t,{z:()=>n})},3825:(e,t,r)=>{"use strict";r(6535);new Map,new Map,new Map;new Map,new Map,new Map},7778:(e,t,r)=>{"use strict";r.d(t,{P:()=>h});var n=r(5149),s=r(8458),i=r(4558),a=r(7031),l=new WeakMap,o=new WeakMap;class h{constructor(){let{store:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.A)(this,l,void 0),(0,n.A)(this,o,void 0),(0,i.A)(l,this,e),(0,i.A)(o,this,null);let t=Object.keys(e);if(t.length)for(var r=0;r<t.length;r++){let n=e[t[r]];if(0==r)(0,i.A)(o,this,n.numberOfColumns());else if(n.numberOfColumns()!=(0,s.A)(o,this))throw new Error("all matrices should have the same number of columns")}}numberOfColumns(){return(0,s.A)(o,this)}available(){return Object.keys((0,s.A)(l,this))}has(e){return e in(0,s.A)(l,this)}get(e){return(0,s.A)(l,this)[e]}add(e,t){if(null===(0,s.A)(o,this))(0,i.A)(o,this,t.numberOfColumns());else if(t.numberOfColumns()!=(0,s.A)(o,this))throw new Error("all matrices should have the same number of columns");if(e in(0,s.A)(l,this)){let t=(0,s.A)(l,this)[e];a.t9(t)}(0,s.A)(l,this)[e]=t}remove(e){a.t9((0,s.A)(l,this)[e]),delete(0,s.A)(l,this)[e],0==Object.keys((0,s.A)(l,this)).length&&(0,i.A)(o,this,null)}clone(){let e=new h;try{for(const[t,r]of Object.entries((0,s.A)(l,this)))e.add(t,r.clone())}catch(t){throw e.free(),t}return e}rename(e,t){e!==t&&(t in(0,s.A)(l,this)&&a.t9((0,s.A)(l,this)[t]),(0,s.A)(l,this)[t]=(0,s.A)(l,this)[e],delete(0,s.A)(l,this)[e])}free(){for(const[e,t]of Object.entries((0,s.A)(l,this)))a.t9(t)}}},3128:(e,t,r)=>{"use strict";r.d(t,{T:()=>c});var n=r(5149),s=r(8458),i=r(4558),a=r(7031),l=r(2322),o=r(9165),h=new WeakMap,u=new WeakMap;class c{constructor(e,t){(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,i.A)(h,this,e),(0,i.A)(u,this,t)}static createDenseMatrix(e,t,r){let{columnMajor:n=!0,copy:s=!0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!(r instanceof o.WI))throw new Error("'contents' should be a Float64WasmArray");if(r.length!=e*t)throw new Error("length of 'contents' should equal the product of 'rows' and 'columns'");return l.T((i=>new i.NumericMatrix(e,t,r.offset,n,s)),c)}clone(){return l.T((e=>(0,s.A)(u,this).clone()),c)}get matrix(){return(0,s.A)(u,this)}numberOfRows(){return(0,s.A)(u,this).nrow()}numberOfColumns(){return(0,s.A)(u,this).ncol()}row(e){let{buffer:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=t)return(0,s.A)(u,this).row(e,t.offset),t.array();var r;t=a.k3((0,s.A)(u,this).ncol());try{(0,s.A)(u,this).row(e,t.offset),r=t.slice()}finally{t.free()}return r}column(e){let{buffer:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=t)return(0,s.A)(u,this).column(e,t.offset),t.array();var r;t=a.k3((0,s.A)(u,this).nrow());try{(0,s.A)(u,this).column(e,t.offset),r=t.slice()}finally{t.free()}return r}free(){null!==(0,s.A)(u,this)&&(l._((0,s.A)(h,this)),(0,i.A)(u,this,null))}isSparse(){return(0,s.A)(u,this).sparse()}isReorganized(){return(0,s.A)(u,this).reorganized()}identities(){let{buffer:e=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=e)return(0,s.A)(u,this).identities(e.offset),e.array();var t;e=a.kl((0,s.A)(u,this).nrow());try{(0,s.A)(u,this).identities(e.offset),t=e.slice()}finally{e.free()}return t}wipeIdentities(){(0,s.A)(u,this).wipe_identities()}}},5399:(e,t,r)=>{"use strict";r.d(t,{F:()=>s,M:()=>i});var n=r(34);function s(e,t){let r;do{r=e+String(Number(new Date))+"_"+String(Math.round(1e4*Math.random()))+t}while(n.P8(r));return r}function i(e){throw new Error("cannot access the file system in a browser context")}},9723:(e,t,r)=>{"use strict";r.d(t,{Q:()=>c});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=(r(3128),new WeakMap),h=new WeakMap;class u{constructor(e,t){(0,n.A)(this,o,void 0),(0,n.A)(this,h,void 0),(0,i.A)(o,this,e),(0,i.A)(h,this,t)}numberOfGroups(){return(0,s.A)(h,this).num_groups()}numberOfGenes(){return(0,s.A)(h,this).num_genes()}sums(e){let{copy:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null!==e?(0,s.A)(h,this).group_sums(e):(0,s.A)(h,this).all_sums();return l.xf(r,t)}detected(e){let{copy:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null!==e?(0,s.A)(h,this).group_detected(e):(0,s.A)(h,this).all_detected();return l.xf(r,t)}free(){null!==(0,s.A)(h,this)&&(a._((0,s.A)(o,this)),(0,i.A)(h,this,null))}}function c(e,t){let{average:r=!1,numberOfThreads:n=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s,i;let o=l.J2(n);try{if((s=l.c(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'groups' should be equal to number of columns in 'x'");i=a.T((t=>t.aggregate_across_cells(e.matrix,s.offset,r,o)),u)}catch(h){throw l.t9(i),h}finally{l.t9(s)}return i}},3911:(e,t,r)=>{"use strict";r.d(t,{Wv:()=>a,c5:()=>o,cR:()=>l,zi:()=>h});var n=r(7031),s=r(9165),i=r(6077);function a(e){let t,{buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=0;e.forEach((e=>{s+=e}));try{if(null==r)t=n.kl(s),r=t;else if(r.length!==s)throw new Error("'buffer' should have length equal to sum of 'ncells'");let a=r.array(),l=0;for(var i=0;i<e.length;i++){let t=l;l+=e[i],a.fill(i,t,l)}}catch(a){throw n.t9(t),a}return r}function l(e,t){let{filter:r=null,buffer:n=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.CY(e,t,{filter:r,buffer:n})}function o(e,t){let{buffer:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(e,t,{buffer:r,filter:!0})}function h(e){return i.VW(e)}},5784:(e,t,r)=>{"use strict";r.d(t,{RZ:()=>l});var n=r(7031),s=r(3128),i=r(2322);function a(e){let t=n.u0(e.length),r=t.array();for(var s=0;s<e.length;s++)r[s]=BigInt(e[s].matrix.$$.ptr);return t}function l(e,t){let r,l,o,h=[],u={};try{if(t.length!==e.length)throw new Error("length of 'names' should be equal to length of 'x'");let f={},d=[];for(var c=0;c<t.length;c++){if(e[c].numberOfRows()!==t[c].length)throw new Error("length of each 'names' must equal number of rows of its corresponding 'x'");t[c].forEach((e=>{e in f||(f[e]=d.length,d.push(e))}))}l=n.u0(e.length);{let e=l.array();for(c=0;c<t.length;c++){let r=t[c],s=n.kl(r.length),i=s.array();r.forEach(((e,t)=>{i[t]=f[e]})),h.push(s),e[c]=BigInt(s.offset)}}r=a(e),o=n.kl(e[0].numberOfRows()),u.matrix=i.T((t=>t.cbind_with_rownames(e.length,r.offset,l.offset,o.offset)),s.T),u.indices=o.slice(0,u.matrix.numberOfRows());let m=[];for(const e of u.indices)m.push(t[0][e]);u.names=m}catch(f){throw n.t9(u.matrix),f}finally{n.t9(r),n.t9(l),n.t9(o);for(const e of h)n.t9(e)}return u}},1101:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});r(7031),r(693);function n(e,t){let{copy:r=!0,largest:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r&&(e=e.slice()),e instanceof Array?e.sort(((e,t)=>e-t)):e.sort(),0==e.length?Number.NaN:n?e[Math.max(0,e.length-t)]:e[Math.min(t,e.length)-1]}},6869:(e,t,r)=>{"use strict";r.d(t,{aI:()=>w});var n=r(5149),s=r(8458),i=r(4558),a=r(7031),l=r(2322),o=r(4047),h=new WeakMap,u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap;class _{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),(0,n.A)(this,A,void 0),(0,n.A)(this,p,void 0),(0,i.A)(u,this,t),(0,i.A)(h,this,e),(0,i.A)(c,this,r),(0,i.A)(f,this,r),(0,i.A)(d,this,r),(0,i.A)(m,this,r),(0,i.A)(A,this,r),(0,i.A)(p,this,r)}numberOfCells(){return(0,s.A)(u,this).num_obs()}numberOfClusters(){return(0,s.A)(u,this).num_clusters()}setIterations(e){(0,s.A)(A,this)||(0,i.A)(A,this,!0),(0,s.A)(u,this).set_iterations(e)}setStatus(e){(0,s.A)(p,this)||(0,i.A)(p,this,!0),(0,s.A)(u,this).set_status(e)}clusters(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.Vq(t,e,(0,s.A)(c,this),(()=>{(0,i.A)(c,this,!0)}),(e=>a.xf((0,s.A)(u,this).clusters(),e)),"clusters")}clusterSizes(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>a.xf((0,s.A)(u,this).cluster_sizes(),e)),"clusterSizes")}withinClusterSumSquares(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.Vq(t,e,(0,s.A)(m,this),(()=>{(0,i.A)(m,this,!0)}),(e=>a.xf((0,s.A)(u,this).wcss(),e)))}clusterCenters(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.Vq(t,e,(0,s.A)(d,this),(()=>{(0,i.A)(d,this,!0)}),(e=>a.xf((0,s.A)(u,this).centers(),e)))}iterations(){return(0,s.A)(A,this)?(0,s.A)(u,this).iterations():null}status(){return(0,s.A)(p,this)?(0,s.A)(u,this).status():null}free(){null!==(0,s.A)(u,this)&&(l._((0,s.A)(h,this)),(0,i.A)(u,this,null))}}function w(e,t){let{numberOfDims:r=null,numberOfCells:n=null,initMethod:s="pca-part",initSeed:i=5768,initPCASizeAdjust:h=1,numberOfThreads:u=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var c,f;let d=a.J2(u);try{let u;if(e instanceof o.WC){r=e.numberOfPCs(),n=e.numberOfCells();let t=e.principalComponents({copy:!1});u=t.byteOffset}else{if(null===r||null===n)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((c=a.c(e,"Float64WasmArray")).length!=r*n)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");u=c.offset}f=l.T((e=>e.cluster_kmeans(u,r,n,t,s,i,h,d)),_)}catch(m){throw a.t9(f),m}finally{a.t9(c)}return f}},4011:(e,t,r)=>{"use strict";r.d(t,{Ye:()=>P,_c:()=>m});var n=r(9790),s=r(6562),i=r(5149),a=r(8458),l=r(4558),o=r(7031),h=r(2322),u=r(4718),c=new WeakMap,f=new WeakMap;class d{constructor(e,t){(0,i.A)(this,c,void 0),(0,i.A)(this,f,void 0),(0,l.A)(c,this,e),(0,l.A)(f,this,t)}free(){null!==(0,a.A)(f,this)&&(h._((0,a.A)(c,this)),(0,l.A)(f,this,null))}get graph(){return(0,a.A)(f,this)}}function m(e){let{scheme:t="rank",neighbors:r=10,numberOfThreads:n=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;let a=o.J2(n);o._g("scheme",t,["rank","number","jaccard"]);try{let n;e instanceof u.ny?n=e:(i=(0,u.jw)(e,r,{numberOfThreads:a}),n=i),s=h.T((e=>e.build_snn_graph(n.results,t,a)),d)}catch(l){throw o.t9(s),l}finally{o.t9(i)}return s}var A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakSet;class v{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,b),(0,i.A)(this,A,void 0),(0,i.A)(this,p,void 0),(0,i.A)(this,_,void 0),(0,i.A)(this,w,void 0),(0,i.A)(this,g,void 0),(0,l.A)(A,this,e),(0,l.A)(p,this,t),(0,l.A)(_,this,r),(0,l.A)(w,this,o.F(this.numberOfLevels(),r)),(0,l.A)(g,this,o.F(this.numberOfLevels(),r))}best(){return(0,a.A)(_,this)?(0,a.A)(p,this).best():null}setBest(e){(0,a.A)(_,this)||(0,l.A)(_,this,!0),(0,a.A)(p,this).set_best(e)}numberOfLevels(){return(0,a.A)(p,this).number()}modularity(){let{level:e=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=(0,s.A)(b,this,y).call(this,e),(0,a.A)(w,this)[e]?(0,a.A)(p,this).modularity(e):null}setModularity(e,t){(0,a.A)(w,this)[e]||((0,a.A)(w,this)[e]=!0),(0,a.A)(p,this).set_modularity(e,t)}membership(){let{level:e=null,copy:t=!0,fillable:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=(0,s.A)(b,this,y).call(this,e),o.Vq(r,t,(0,a.A)(g,this)[e],(()=>{(0,a.A)(g,this)[e]=!0}),(t=>o.xf((0,a.A)(p,this).membership(e),t)))}free(){null!==(0,a.A)(p,this)&&(h._((0,a.A)(A,this)),(0,l.A)(p,this,null))}}function y(e){if(null===e&&null==(e=this.best()))throw new Error("'best' has not yet been set via 'setBest'");return e}var k=new WeakMap,x=new WeakMap,E=new WeakMap,C=new WeakMap,O=new WeakMap;class M{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if((0,i.A)(this,k,void 0),(0,i.A)(this,x,void 0),(0,i.A)(this,E,void 0),(0,i.A)(this,C,void 0),(0,i.A)(this,O,void 0),(0,l.A)(k,this,e),(0,l.A)(x,this,t),(0,l.A)(E,this,r),(0,l.A)(O,this,r),!r){let e=this.numberOfMergeSteps()+1;(0,l.A)(C,this,{which:o.F(e,!1),remaining:e})}}numberOfMergeSteps(){return(0,a.A)(x,this).num_merge_steps()}modularity(){let{at:e=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null===e){if(!(0,a.A)(E,this))return null;e=-1}else if(!(0,a.A)(E,this)&&!(0,a.A)(C,this)[e])return null;return(0,a.A)(x,this).modularity(e)}setModularity(e,t){(0,a.A)(E,this)||((0,a.A)(C,this).which[e]=!0,(0,a.A)(C,this).remaining--,0==(0,a.A)(C,this).remaining&&(0,l.A)(E,this,!0)),(0,a.A)(x,this).set_modularity(e,t)}membership(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.Vq(t,e,(0,a.A)(O,this),(()=>{(0,l.A)(O,this,!0)}),(e=>o.xf((0,a.A)(x,this).membership(),e)))}free(){null!==(0,a.A)(x,this)&&(h._((0,a.A)(k,this)),(0,l.A)(x,this,null))}}var R=new WeakMap,N=new WeakMap,S=new WeakMap,W=new WeakMap;class I{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,i.A)(this,R,void 0),(0,i.A)(this,N,void 0),(0,i.A)(this,S,void 0),(0,i.A)(this,W,void 0),(0,l.A)(R,this,e),(0,l.A)(N,this,t),(0,l.A)(S,this,r),(0,l.A)(W,this,r)}modularity(){return(0,a.A)(S,this)?(0,a.A)(N,this).modularity():null}setModularity(e){(0,a.A)(S,this)||(0,l.A)(S,this,!0),(0,a.A)(N,this).set_modularity(e)}membership(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.Vq(t,e,(0,a.A)(W,this),(()=>{(0,l.A)(W,this,!0)}),(e=>o.xf((0,a.A)(N,this).membership(),e)))}free(){null!==(0,a.A)(N,this)&&(h._((0,a.A)(R,this)),(0,l.A)(N,this,null))}}function P(e){let{method:t="multilevel",multiLevelResolution:r=1,leidenResolution:n=1,leidenModularityObjective:s=!1,walktrapSteps:i=4}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;try{if("multilevel"==t)a=h.T((t=>t.cluster_snn_graph_multilevel(e.graph,r)),v);else if("walktrap"==t)a=h.T((t=>t.cluster_snn_graph_walktrap(e.graph,i)),M);else{if("leiden"!=t)throw new Error("unknown method '"+t+"'");a=h.T((t=>t.cluster_snn_graph_leiden(e.graph,n,s)),I)}}catch(l){throw o.t9(a),l}return a}},6077:(e,t,r)=>{"use strict";r.d(t,{GO:()=>a,K$:()=>i,VW:()=>l});var n=r(9165),s=r(7031);function i(e){let t,r,{asWasmArray:i=!0,buffer:a=null,levels:l=null,action:h="error",placeholder:u=-1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("warn"==h){let e=!1;r=()=>{e||(console.warn("replacing invalid values with the placeholder index '"+String(u)+"'"),e=!0)}}else if("none"==h)r=()=>{};else{if("error"!=h)throw new Error("unknown action '"+h+"' for handling invalid entries");r=()=>{throw new Error("detected invalid value (e.g., null, NaN) in 'x'")}}try{if(null==a)t=i?s.kl(e.length):new Int32Array(e.length),a=t;else{if(a.length!==e.length)throw new Error("'buffer' should have length equal to that of 'x'");i=a instanceof n.Os}let h=i?a.array():a,d=new Map;if(null==l){l=[];for(var c=0;c<e.length;c++){let t=e[c];if(null==t||"number"==typeof t&&!Number.isFinite(t)){r(),h[c]=u;continue}let n=d.get(t);if("undefined"==typeof n){let e=l.length;d.set(t,e),l.push(t),h[c]=e}else h[c]=n}if(l.every((e=>"string"==typeof e))){let e=l.slice();l.sort(),o({ids:a,levels:e},l)}else if(l.every((e=>"number"==typeof e))){let e=l.slice();l.sort(((e,t)=>e-t)),o({ids:a,levels:e},l)}}else{for(var f=0;f<l.length;f++)d.set(l[f],f);for(c=0;c<e.length;c++){let t=e[c],n=d.get(t);"undefined"==typeof n?(r(),h[c]=u):h[c]=n}}}catch(d){throw t instanceof n.Kr&&s.t9(t),d}return{ids:a,levels:l}}function a(e){return i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}function l(e){e instanceof n.Kr&&(e=e.array());let t=new Set(e),r=Array.from(t).sort(),s={};return r.forEach(((e,t)=>{s[e]=t})),e.forEach(((t,r)=>{e[r]=s[t]})),r}function o(e,t){let r,{action:s="error",placeholder:i=-1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new Map;for(var l=0;l<t.length;l++)a.set(t[l],l);if("warn"==s){let e=!1;r=()=>{e||(console.warn("replacing missing levels with the placeholder index '"+String(i)+"'"),e=!0)}}else if("none"==s)r=()=>{};else{if("error"!=s)throw new Error("unknown action '"+s+"' for handling missing levels");r=()=>{throw new Error("detected level in 'x.levels' that is missing from 'newLevels'")}}let o=e.levels,h=new Array(o.length);for(l=0;l<o.length;l++){let e=a.get(o[l]);"undefined"==typeof e?(r(),h[l]=i):h[l]=e}e.levels=t;let u=e.ids;u instanceof n.Kr&&(u=u.array()),u.forEach(((e,t)=>{e!==i&&(u[t]=h[e])}))}},6497:(e,t,r)=>{"use strict";r.d(t,{O:()=>i});var n=r(2322),s=r(7031);function i(e,t){var r,i;try{if((r=s.c(t,"Uint8WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'filters' must be equal to number of columns in 'x'");var a=r.offset;i=n.T((t=>t.filter_cells(e.matrix,a,!1)),e.constructor)}catch(l){throw s.t9(i),l}finally{s.t9(r)}return i}},4718:(e,t,r)=>{"use strict";r.d(t,{$q:()=>f,jw:()=>p,ny:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(7031),l=r(2322),o=r(4047),h=new WeakMap,u=new WeakMap;class c{constructor(e,t){(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,i.A)(h,this,e),(0,i.A)(u,this,t)}numberOfCells(){return(0,s.A)(u,this).num_obs()}numberOfDims(){return(0,s.A)(u,this).num_dim()}free(){null!==(0,s.A)(u,this)&&(l._((0,s.A)(h,this)),(0,i.A)(u,this,null))}get index(){return(0,s.A)(u,this)}}function f(e){let{numberOfDims:t=null,numberOfCells:r=null,approximate:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;try{let h;if(e instanceof o.WC){t=e.numberOfPCs(),r=e.numberOfCells();let n=e.principalComponents({copy:!1});h=n.byteOffset}else{if(null===t||null===r)throw new Error("'numberOfDims' and 'numberOfCells' must be specified when 'x' is an Array");if((s=a.c(e,"Float64WasmArray")).length!=t*r)throw new Error("length of 'x' must be the product of 'numberOfDims' and 'numberOfCells'");h=s.offset}i=l.T((e=>e.build_neighbor_index(h,t,r,n)),c)}catch(h){throw a.t9(i),h}finally{a.t9(s)}return i}var d=new WeakMap,m=new WeakMap;class A{constructor(e,t){(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),(0,i.A)(d,this,e),(0,i.A)(m,this,t)}size(){return(0,s.A)(m,this).size()}numberOfCells(){return(0,s.A)(m,this).num_obs()}get results(){return(0,s.A)(m,this)}serialize(){let{runs:e=null,indices:t=null,distances:r=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n,i,l,o,h=(null===e)+(null===t)+(null===r);if(3!=h&&0!=h)throw new Error("either all or none of 'runs', 'indices' and 'distances' can be 'null'");if(3===h)try{i=a.kl(this.numberOfCells());let e=this.size();l=a.kl(e),o=a.k3(e),(0,s.A)(m,this).serialize(i.offset,l.offset,o.offset),n={runs:i.slice(),indices:l.slice(),distances:o.slice()}}finally{a.t9(i),a.t9(l),a.t9(o)}else(0,s.A)(m,this).serialize(e.offset,t.offset,r.offset),n={runs:e.array(),indices:t.array(),distances:r.array()};return n}static unserialize(e,t,r){var n,s,i,o;try{s=a.c(e,"Int32WasmArray"),i=a.c(t,"Int32WasmArray"),o=a.c(r,"Float64WasmArray"),n=l.T((t=>new t.NeighborResults(e.length,s.offset,i.offset,o.offset)),A)}catch(h){throw a.t9(n),h}finally{a.t9(s),a.t9(i),a.t9(o)}return n}free(){null!==(0,s.A)(m,this)&&(l._((0,s.A)(d,this)),(0,i.A)(m,this,null))}}function p(e,t){let{numberOfThreads:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.J2(r);return l.T((r=>r.find_nearest_neighbors(e.index,t,n)),A)}},4833:(e,t,r)=>{"use strict";r.d(t,{O:()=>a});var n=r(6524),s=r(7031),i=(r(3128),r(9165));function a(e,t){let{center:r=!0,buffer:a=null,priorCount:l=10,reference:o=null,numberOfThreads:h=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var u,c;let f=s.J2(h);try{if(a instanceof i.WI){if(a.length!==e.numberOfColumns())throw new Error("length of 'buffer' must be equal to the number of columns in 'x'")}else u=s.k3(e.numberOfColumns()),a=u;c=s.c(t,"Int32WasmArray"),null==o&&(o=-1),n.T1((t=>t.grouped_size_factors(e.matrix,c.offset,r,l,o,a.offset,f)))}catch(d){throw s.t9(u),d}finally{s.t9(c)}return a}},288:(e,t,r)=>{"use strict";function n(e){let{forceTaxonomy:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.length,n=Math.ceil(r/2),s=e=>(e.confidence/=r,e),i=new Set;for(const x of e)"string"==typeof x&&i.add(x);let a=0,l=0,o=0,h=0,u=0,c=0,f=0,d=0,m=0,A=0,p=0,_=0,w=t?"9606":"human",g=t?"10090":"mouse",b=[],v=0;for(const x of i)x&&x.match(/^ENS[A-Z]*G[0-9]{11}$/)&&v++;if(v){for(const e of i)e&&(e.startsWith("ENSG")?a++:e.startsWith("ENSMUSG")?l++:e.startsWith("ENSRNOG")?h++:e.startsWith("ENSMFAG")?u++:e.startsWith("ENSDARG")?f++:e.startsWith("ENSPTRG")&&d++);b.push({species:w,type:"ensembl",confidence:a}),b.push({species:g,type:"ensembl",confidence:l}),b.push({species:"10116",type:"ensembl",confidence:h}),b.push({species:"9541",type:"ensembl",confidence:u}),b.push({species:"7955",type:"ensembl",confidence:f}),b.push({species:"9598",type:"ensembl",confidence:d});for(const e of b)if(e.confidence>=n)return s(e)}for(const x of i)!x||!x.match(/^[A-Z][^a-z]+$/)||x.match(/^ENS[A-Z]+[0-9]{11}/)||x.match(/^OTT.{4}[0-9]{11}/)||x.match(/^MGI:[0-9]+/)||m++;{let e={species:w,type:"symbol",confidence:m};if(e.confidence>=n)return s(e);b.push(e)}for(const x of i)x&&x.match(/^[A-Z][^A-Z]+$/)&&A++;{let e={species:g,type:"symbol",confidence:A};if(e.confidence>=n)return s(e);b.push(e)}for(const x of i)x&&x.match(/^WBGene[0-9]+$/)&&o++;{let e={species:"6239",type:"ensembl",confidence:o};if(e.confidence>=n)return s(e);b.push(e)}for(const x of i)x&&x.match(/^FBgn[0-9]+$/)&&c++;{let e={species:"7227",type:"ensembl",confidence:c};if(e.confidence>=n)return s(e);b.push(e)}for(const x of i)x&&x.match(/^[a-z]{3,}-[0-9]+$/)&&p++;{let e={species:"6239",type:"symbol",confidence:p};if(e.confidence>=n)return s(e);b.push(e)}for(const x of i)x&&x.match(/^[a-z]{3,}[0-9a-z]+$/)&&_++;{let e={species:"7955",type:"symbol",confidence:_};if(e.confidence>=n)return s(e);b.push(e)}let y=b[0];for(var k=1;k<b.length;k++)b[k].confidence>y.confidence&&(y=b[k]);return s(y)}r.d(t,{x:()=>n})},7579:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i});var n=r(7031),s=r(6524);function i(e,t,r,i){let a,l,o,h,u,c,{numberOfThreads:f=null,assumeSorted:d=!1}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},m=n.J2(f),A=null,p=(e,t,r)=>{if(null!==r&&e.length!==r)throw new Error("array inputs must have the same length (failing for '"+t+"')");return e.length};"number"==typeof e?e=[e]:A=p(e,"markersInSet",A),"number"==typeof t?t=[t]:A=p(t,"numberOfMarkers",A),"number"==typeof r?r=[r]:A=p(r,"featureSetSize",A),"number"==typeof i?i=[i]:A=p(i,"numberOfFeatures",A),null==A&&(A=1);try{a=n.c(e,"Int32WasmArray"),l=n.c(t,"Int32WasmArray"),o=n.c(r,"Int32WasmArray"),h=n.c(i,"Int32WasmArray"),c=n.k3(A),s.T1((e=>e.hypergeometric_test(A,1!=a.length,a.offset,1!=o.length,o.offset,1!=l.length,l.offset,1!=h.length,h.offset,d,c.offset,m))),u=c.slice()}finally{n.t9(a),n.t9(l),n.t9(o),n.t9(h),n.t9(c)}return u}},5243:(e,t,r)=>{"use strict";r.d(t,{LX:()=>d,M_:()=>h,VZ:()=>f,c3:()=>c,nU:()=>u,pn:()=>l});var n=r(2322),s=r(6524),i=r(7031),a=r(3128);function l(e){let{compressed:t=null,layered:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,l,h=null;try{t=o(t),"string"!==typeof e?(s=i.c(e,"Uint8WasmArray"),l=n.T((e=>e.read_matrix_market_from_buffer(s.offset,s.length,t,r)),a.T)):l=n.T((n=>n.read_matrix_market_from_file(e,t,r)),a.T),l.isReorganized()&&(h=l.identities(),l.wipeIdentities())}catch(u){throw i.t9(l),u}finally{i.t9(s)}return{matrix:l,row_ids:h}}function o(e){return null===e?-1:e?1:0}function h(e){let{compressed:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,n=i.k3(3);let a={};try{t=o(t),"string"!==typeof e?(r=i.c(e,"Uint8WasmArray"),s.T1((e=>e.read_matrix_market_header_from_buffer(r.offset,r.length,t,n.offset)))):s.T1((r=>r.read_matrix_market_header_from_file(e,t,n.offset)));let l=n.array();a.rows=l[0],a.columns=l[1],a.lines=l[2]}finally{i.t9(r),i.t9(n)}return a}function u(e,t){let{forceInteger:r=!0,layered:s=!0,subsetRow:l=null,subsetColumn:o=null,cacheSize:h=1e8}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var u,c=null;let f,d;try{let m=null!==l,A=0,p=0;m&&(f=i.c(l,"Int32WasmArray"),A=f.offset,p=f.length);let _=null!==o,w=0,g=0;_&&(d=i.c(o,"Int32WasmArray"),w=d.offset,g=d.length),(u=n.T((n=>n.read_hdf5_matrix(e,t,r,s,m,A,p,_,w,g,h)),a.T)).isReorganized()&&(c=u.identities(),u.wipeIdentities())}catch(m){throw i.t9(u),m}finally{i.t9(f),i.t9(d)}return{matrix:u,row_ids:c}}function c(e,t){let r={},n=i.kl(5);try{s.T1((r=>r.extract_hdf5_matrix_details(e,t,n.offset)));let i=n.array();i[0]>0?r.format="dense":i[1]>0?r.format="csc":r.format="csr",r.rows=i[2],r.columns=i[3],r.integer=i[4]>0}finally{n.free()}return r}function f(e,t,r){let{forceInteger:s=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var l,o;try{l=i.c(r,null),o=n.T((r=>r.initialize_dense_matrix(e,t,l.offset,l.constructor.className.replace("Wasm",""),s)),a.T)}catch(h){throw i.t9(o),h}finally{i.t9(l)}return o}function d(e){let{consume:t=!1,forceInteger:r=!0,layered:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var l,o=null;try{(l=n.T((n=>n.initialize_sparse_matrix_from_rds(e.object.$$.ptr,r,s,t)),a.T)).isReorganized()&&(o=l.identities(),l.wipeIdentities())}catch(h){throw i.t9(l),h}return{matrix:l,row_ids:o}}},8229:(e,t,r)=>{"use strict";r.d(t,{$:()=>a,U:()=>i});var n=r(7031),s=r(6524);function i(e,t,r){var s,i;try{var a=0,l=!1;if(null!==t){if((s=n.c(t,"Int32WasmArray")).length!=e.numberOfCells())throw new Error("'block' must be of length equal to the number of cells in 'metrics'");l=!0,a=s.offset}i=r(e,l,a)}catch(o){throw n.t9(i),o}finally{n.t9(s)}return i}function a(e,t,r,i){var a,l,o;try{var h=0,u=!1;if(null!==r){if((a=n.c(r,"Int32WasmArray")).length!=t.numberOfCells())throw new Error("'block' must be of length equal to the number of cells in 'metrics'");u=!0,h=a.offset}let c;if(null==i)l=n.eg(t.numberOfCells()),c=l.offset;else{if(i.length!=t.numberOfCells())throw new Error("'buffer' must be of length equal to the number of cells in 'metrics'");c=i.offset}s.T1((r=>e.filter(t.results.$$.ptr,u,h,c))),o=null==i?l.slice():i.array()}catch(c){throw n.t9(o),c}finally{n.t9(a),n.t9(l)}return o}},5707:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});r(6524);var n=r(7031);r(9165);function s(e,t,r){var s,i,a=[];try{let o=0,h=0;if(null!=t){o=t.length,h=(i=n.u0(o)).offset;let r=i.array();for(var l=0;l<o;l++){let s=n.c(t[l],"Uint8WasmArray");if(s.length!=e.numberOfRows())throw new Error("length of each array in 'subsets' should be equal to the matrix rows");a.push(s),r[l]=BigInt(s.offset)}}s=r(e.matrix,o,h)}catch(o){throw n.t9(s),o}finally{n.t9(i);for(const e of a)n.t9(e)}return s}},3607:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>O,PK:()=>P,R_:()=>S,i9:()=>m,xs:()=>b});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=(r(6524),r(7031)),o=r(3128),h=r(9165),u=r(5243),c=new WeakMap,f=new WeakMap;class d{constructor(e,t){(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,i.A)(c,this,e),(0,i.A)(f,this,t)}get reference(){return(0,s.A)(f,this)}numberOfSamples(){return(0,s.A)(f,this).num_samples()}numberOfFeatures(){return(0,s.A)(f,this).num_features()}numberOfLabels(){return(0,s.A)(f,this).num_labels()}free(){null!==(0,s.A)(f,this)&&(a._((0,s.A)(c,this)),(0,i.A)(f,this,null))}}function m(e,t,r){var n,s,i,o;try{s=l.c(e,"Uint8WasmArray"),i=l.c(t,"Uint8WasmArray"),o=l.c(r,"Uint8WasmArray"),n=a.T((e=>e.load_singlepp_reference(o.offset,o.length,i.offset,i.length,s.offset,s.length)),d)}catch(h){throw l.t9(n),h}finally{l.t9(s),l.t9(i),l.t9(o)}return n}var A=new WeakMap,p=new WeakMap;class _{constructor(e,t){(0,n.A)(this,A,void 0),(0,n.A)(this,p,void 0),(0,i.A)(A,this,e),(0,i.A)(p,this,t)}get reference(){return(0,s.A)(p,this)}sharedFeatures(){return(0,s.A)(p,this).shared_features()}free(){null!==(0,s.A)(p,this)&&(a._((0,s.A)(A,this)),(0,i.A)(p,this,null))}}function w(e,t){let r=new Map;for(var n=0;n<e.length;n++){let s=e[n];null!==s&&(r.has(s)||r.set(s,n)),t[n]=n}return{contents:r,counter:e.length}}function g(e,t,r){let n=new Set,s=(e,s)=>{let i=t.contents.get(e);return"undefined"!==typeof i&&!n.has(i)&&(r[s]=i,n.add(i),!0)},i=t.counter;for(var a=0;a<e.length;a++){let t=e[a],n=!1;if(null!==t)if(t instanceof Array){for(const e of t)if(s(e,a)){n=!0;break}}else n=s(t,a);n||(r[a]=i,++i)}}function b(e,t,r){let{top:n=20,numberOfThreads:s=null}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i,o,h;let u=l.J2(s);try{var c=e.length;if(i=l.kl(c),o=l.kl(t.numberOfFeatures()),r.length!=o.length)throw new Error("length of 'referenceFeatures' should be equal to the number of features in 'reference'");g(r,w(e,i.array()),o.array()),(h=a.T((e=>e.build_singlepp_reference(c,i.offset,t.reference,o.offset,n,u)),_)).expectedNumberOfFeatures=c}catch(f){throw l.t9(h),f}finally{l.t9(i),l.t9(o)}return h}var v=new WeakMap,y=new WeakMap,k=new WeakMap,x=new WeakMap;class E{constructor(e,t){(0,n.A)(this,v,void 0),(0,n.A)(this,y,void 0),(0,n.A)(this,k,void 0),(0,n.A)(this,x,void 0),(0,i.A)(v,this,e),(0,i.A)(y,this,t)}numberOfLabels(){return(0,s.A)(y,this).num_labels()}numberOfCells(){return(0,s.A)(y,this).num_samples()}predictedLabels(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.xf((0,s.A)(y,this).get_best(),e)}scoresForCell(e){let{copy:t=!0,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==r)return"undefined"==typeof(0,s.A)(k,this)&&(0,i.A)(k,this,l.k3((0,s.A)(y,this).num_labels())),(0,s.A)(y,this).get_scores_for_sample(e,(0,s.A)(k,this).offset),l.xf((0,s.A)(k,this).array(),t);if(r.length!==(0,s.A)(y,this).num_labels())throw new Error("length of 'buffer' should equal the number of labels");return(0,s.A)(y,this).get_scores_for_sample(e,r.offset),r}scoresForLabel(e){let{copy:t=!0,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==r)return"undefined"==typeof(0,s.A)(x,this)&&(0,i.A)(x,this,l.k3((0,s.A)(y,this).num_samples())),(0,s.A)(y,this).get_scores_for_label(e,(0,s.A)(x,this).offset),l.xf((0,s.A)(x,this).array(),t);if(r.length!==(0,s.A)(y,this).num_samples())throw new Error("length of 'buffer' should equal the number of cells");return(0,s.A)(y,this).get_scores_for_label(e,r.offset),l.xf((0,s.A)(x,this).array(),t)}fineTuningDelta(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.xf((0,s.A)(y,this).get_delta(),e)}free(){null!==(0,s.A)(y,this)&&(a._((0,s.A)(v,this)),(0,i.A)(y,this,null),l.t9((0,s.A)(x,this)),l.t9((0,s.A)(k,this)))}}function C(e,t,r,n,s,i){var a,c=null;try{let l;if(e instanceof o.T)l=e.matrix;else{if(!(e instanceof h.WI))throw new Error("unknown type for 'x'");l=(a=u.VZ(r,n,e,{forceInteger:!1})).matrix}if(l.nrow()!=t)throw new Error("number of rows in 'x' should be equal to length of 'features' used to build '"+i+"'");c=s(l)}finally{l.t9(undefined),l.t9(a)}return c}function O(e,t){let{numberOfFeatures:r=null,numberOfCells:n=null,quantile:s=.8,numberOfThreads:i=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=l.J2(i);return C(e,t.expectedNumberOfFeatures,r,n,((e,r)=>a.T((r=>r.run_singlepp(e,t.reference,s,o)),E)),"reference")}var M=new WeakMap,R=new WeakMap;class N{constructor(e,t){(0,n.A)(this,M,void 0),(0,n.A)(this,R,void 0),(0,i.A)(M,this,e),(0,i.A)(R,this,t)}get integrated(){return(0,s.A)(R,this)}numberOfReferences(){return(0,s.A)(R,this).num_references()}free(){null!==(0,s.A)(R,this)&&(a._((0,s.A)(M,this)),(0,i.A)(R,this,null))}}function S(e,t,r,n){let s,i,o,h,u,{numberOfThreads:c=null}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},f=l.J2(c),d=t.length;if(r.length!=d)throw new Error("'loaded' and 'referenceFeatures' should be of the same length");if(n.length!=d)throw new Error("'loaded' and 'built' should be of the same length");for(var m=0;m<d;m++)if(t[m].numberOfFeatures()!=r[m].length)throw new Error("length of each 'referenceFeatures' should be equal to the number of features in the corresponding 'loaded'");let A=new Array(d);try{s=l.kl(e.length);let c=w(e,s.array());i=l.u0(d);let p=i.array();for(m=0;m<d;m++)p[m]=BigInt(t[m].reference.$$.ptr);o=l.u0(d);let _=o.array();for(m=0;m<d;m++){let e=r[m];A[m]=l.kl(e.length),g(e,c,A[m].array()),_[m]=BigInt(A[m].offset)}h=l.u0(d);let b=h.array();for(m=0;m<d;m++)b[m]=BigInt(n[m].reference.$$.ptr);u=a.T((t=>t.integrate_singlepp_references(e.length,s.offset,d,i.offset,o.offset,h.offset,f)),N),u.expectedNumberOfFeatures=e.length}catch(p){throw l.t9(u),p}finally{l.t9(s),l.t9(i),l.t9(h),l.t9(o);for(const e of A)l.t9(e)}return u}var W=new WeakMap;class I{constructor(e){(0,n.A)(this,W,void 0),(0,i.A)(W,this,e)}numberOfReferences(){return(0,s.A)(W,this).numberOfLabels()}numberOfCells(){return(0,s.A)(W,this).numberOfCells()}predictedReferences(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.xf((0,s.A)(W,this).predictedLabels(),e)}scoresForCell(e){let{copy:t=!0,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.A)(W,this).scoresForCell(e,{copy:t,buffer:r})}scoresForReference(e){let{copy:t=!0,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.A)(W,this).scoresForLabel(e,{copy:t,buffer:r})}fineTuningDelta(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.xf((0,s.A)(W,this).fineTuningDelta(),e)}free(){null!==(0,s.A)(W,this)&&((0,s.A)(W,this).free(),(0,i.A)(W,this,null))}}function P(e,t,r){let n,s,{numberOfFeatures:i=null,numberOfCells:h=null,quantile:u=.8,numberOfThreads:c=null}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},f=r.numberOfReferences();if(t.length!=f)throw new Error("length of 'assigned' should be equal to the number of references in 'integrated'");let d=new Array(f),m=l.J2(c);try{s=l.u0(f);let c=s.array();for(var A=0;A<t.length;A++){let r=t[A];r instanceof E&&(r=r.predictedLabels({copy:"view"}));let n=!1;if(e instanceof o.T?r.length!=e.numberOfColumns()&&(n=!0):r.length!=h&&(n=!0),n)throw new Error("length of each element in 'assigned' should be equal to number of columns in 'x'");d[A]=l.c(r,"Int32WasmArray"),c[A]=BigInt(d[A].offset)}let p=(e,t)=>a.T((t=>t.integrate_singlepp(e,c.offset,r.integrated,u,m)),E);n=C(e,r.expectedNumberOfFeatures,i,h,p,"integrated")}finally{l.t9(s);for(const e of d)l.t9(e)}return new I(n)}},1334:(e,t,r)=>{"use strict";r.d(t,{D:()=>o,b:()=>l});var n=r(2322),s=r(7031),i=r(9165),a=r(6524);function l(e){let{sizeFactors:t=null,center:r=!0,block:i=null,allowZeros:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var l,o,h;try{var u=0,c=!1;if(null!==t){if((l=s.c(t,"Float64WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'sizeFactors' must be equal to number of columns in 'x'");u=l.offset,c=!0}var f=0,d=!1;if(null!==i){if((o=s.c(i,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");d=!0,f=o.offset}h=n.T((t=>t.log_norm_counts(e.matrix,c,u,d,f,r,a)),e.constructor)}catch(m){throw s.t9(h),m}finally{s.t9(l),s.t9(o)}return h}function o(e){let t,r,{block:n=null,buffer:l=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{null===l&&(t=s.k3(e.length),l=t),l!==e&&l.set(e instanceof i.Kr?e.array():e);var o=0,h=!1;if(null!==n){if(r=s.c(n,"Int32WasmArray"),r.length!=l.length)throw new Error("'block' must be of length equal to that of 'sizeFactors'");h=!0,o=r.offset}a.T1((e=>e.center_size_factors(l.length,l.offset,h,o)))}catch(u){throw s.t9(t),u}finally{s.t9(r)}return l}},5503:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var n=r(7031),s=r(4047),i=r(6524);function a(e,t){let r,a,l,{buffer:o=null,numberOfDims:h=null,numberOfCells:u=null,k:c=15,numberOfMADs:f=3,robustIterations:d=2,robustTrim:m=.25,referencePolicy:A="max-rss",approximate:p=!0,numberOfThreads:_=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},w=n.J2(_);try{if(e instanceof s.WC)h=e.numberOfPCs(),u=e.numberOfCells(),e=e.principalComponents({copy:"view"});else{if(null===h||null===u||h*u!==e.length)throw new Error("length of 'x' must be equal to the product of 'numberOfDims' and 'numberOfCells'");a=n.c(e,"Float64WasmArray"),e=a}if(null==o)r=n.k3(u*h),o=r;else if(o.length!==e.length)throw new Error("length of 'buffer' must be equal to the product of the number of dimensions and cells");if(l=n.c(t,"Int32WasmArray"),l.length!=u)throw new Error("'block' must be of length equal to the number of cells in 'x'");i.T1((t=>t.mnn_correct(h,u,e.offset,l.offset,o.offset,c,f,d,m,A,p,w)))}catch(g){throw n.t9(r),g}finally{n.t9(a)}return o}},693:(e,t,r)=>{"use strict";r.d(t,{ag:()=>g});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(2322),h=r(7031),u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakSet;class _{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,p),(0,s.A)(this,u,void 0),(0,s.A)(this,c,void 0),(0,s.A)(this,f,void 0),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,l.A)(u,this,e),(0,l.A)(c,this,t),(0,l.A)(f,this,h.F(this.numberOfBlocks()+1,r)),(0,l.A)(d,this,h.F(this.numberOfBlocks()+1,r)),(0,l.A)(m,this,h.F(this.numberOfBlocks()+1,r)),(0,l.A)(A,this,h.F(this.numberOfBlocks()+1,r))}means(){let{block:e=null,copy:t=!0,fillable:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.A)(p,this,w).call(this,e,t,r,(0,a.A)(f,this),"means")}variances(){let{block:e=null,copy:t=!0,fillable:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.A)(p,this,w).call(this,e,t,r,(0,a.A)(d,this),"variances")}fitted(){let{block:e=null,copy:t=!0,fillable:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.A)(p,this,w).call(this,e,t,r,(0,a.A)(m,this),"fitted")}residuals(){let{block:e=null,copy:t=!0,fillable:r=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.A)(p,this,w).call(this,e,t,r,(0,a.A)(A,this),"residuals")}numberOfBlocks(){return(0,a.A)(c,this).num_blocks()}free(){null!==(0,a.A)(c,this)&&(o._((0,a.A)(u,this)),(0,l.A)(c,this,null))}}function w(e,t,r,n,s){let i=e;if(null==e){let t=this.numberOfBlocks();i=t>1?t:0,e=-1}return h.Vq(r,t,n[i],(()=>{n[i]=!0}),(t=>h.xf((0,a.A)(c,this)[s](e),t)))}function g(e){let{block:t=null,span:r=.3,numberOfThreads:n=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;let a=h.J2(n);try{var l=0,u=!1;if(null!==t){if((s=h.c(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");u=!0,l=s.offset}i=o.T((t=>t.model_gene_var(e.matrix,u,l,r,a)),_)}catch(c){throw h.t9(i),c}finally{h.t9(s)}return i}},6617:(e,t,r)=>{"use strict";r.d(t,{iN:()=>m,kT:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=r(5707),h=new WeakMap,u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap;class m{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,i.A)(h,this,e),(0,i.A)(u,this,t),(0,i.A)(c,this,r),(0,i.A)(f,this,r),(0,i.A)(d,this,l.F(this.numberOfSubsets(),r))}get results(){return(0,s.A)(u,this)}sums(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(c,this),(()=>{(0,i.A)(c,this,!0)}),(e=>l.xf((0,s.A)(u,this).sums(),e)))}detected(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(u,this).detected(),e)))}subsetTotals(e){let{copy:t=!0,fillable:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.Vq(r,t,(0,s.A)(d,this)[e],(()=>{(0,s.A)(d,this)[e]=!0}),(t=>l.xf((0,s.A)(u,this).subset_totals(e),t)))}numberOfSubsets(){return(0,s.A)(u,this).num_subsets()}numberOfCells(){return(0,s.A)(u,this).num_cells()}free(){null!==(0,s.A)(u,this)&&(a._((0,s.A)(h,this)),(0,i.A)(u,this,null))}}function A(e,t){let{numberOfThreads:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=l.J2(r);return o.c(e,t,((e,t,r)=>a.T((s=>s.per_cell_adt_qc_metrics(e,t,r,n)),m)))}},3261:(e,t,r)=>{"use strict";r.d(t,{OO:()=>A,YW:()=>m});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=new WeakMap,h=new WeakMap,u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap;class m{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,o,void 0),(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,i.A)(o,this,e),(0,i.A)(h,this,t),(0,i.A)(u,this,r),(0,i.A)(c,this,r),(0,i.A)(f,this,r),(0,i.A)(d,this,r)}get results(){return(0,s.A)(h,this)}sums(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(u,this),(()=>{(0,i.A)(u,this,!0)}),(e=>l.xf((0,s.A)(h,this).sums(),e)))}detected(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(c,this),(()=>{(0,i.A)(c,this,!0)}),(e=>l.xf((0,s.A)(h,this).detected(),e)),"detected")}maxProportions(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(h,this).max_proportion(),e)))}maxIndex(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(d,this),(()=>{(0,i.A)(d,this,!0)}),(e=>l.xf((0,s.A)(h,this).max_index(),e)),"maxIndex")}numberOfCells(){return(0,s.A)(h,this).num_cells()}free(){null!==(0,s.A)(h,this)&&(a._((0,s.A)(o,this)),(0,i.A)(h,this,null))}}function A(e){let{numberOfThreads:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l.J2(t);return a.T((t=>t.per_cell_crispr_qc_metrics(e.matrix,r)),m)}},6273:(e,t,r)=>{"use strict";r.d(t,{Kc:()=>A,U6:()=>m});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=r(5707),h=new WeakMap,u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap;class m{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,i.A)(h,this,e),(0,i.A)(u,this,t),(0,i.A)(c,this,r),(0,i.A)(f,this,r),(0,i.A)(d,this,l.F(this.numberOfSubsets(),r))}get results(){return(0,s.A)(u,this)}sums(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(c,this),(()=>{(0,i.A)(c,this,!0)}),(e=>l.xf((0,s.A)(u,this).sums(),e)))}detected(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(u,this).detected(),e)))}subsetProportions(e){let{copy:t=!0,fillable:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.Vq(r,t,(0,s.A)(d,this)[e],(()=>{(0,s.A)(d,this)[e]=!0}),(t=>l.xf((0,s.A)(u,this).subset_proportions(e),t)))}numberOfSubsets(){return(0,s.A)(u,this).num_subsets()}numberOfCells(){return(0,s.A)(u,this).num_cells()}free(){null!==(0,s.A)(u,this)&&(a._((0,s.A)(h,this)),(0,i.A)(u,this,null))}}function A(e,t){let{numberOfThreads:r=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=l.J2(r);return o.c(e,t,((e,t,r)=>a.T((s=>s.per_cell_rna_qc_metrics(e,t,r,n)),m)))}},2695:(e,t,r)=>{"use strict";r.d(t,{G:()=>o});var n=r(6869),s=r(1334),i=r(4833),a=r(4047),l=r(7031);function o(e){let t,r,o,h,{numberOfClusters:u=20,numberOfPCs:c=25,totals:f=null,block:d=null,buffer:m=null,numberOfThreads:A=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{t=(0,s.b)(e,{sizeFactors:f,block:d}),r=(0,a.CN)(t,{numberOfPCs:Math.min(t.numberOfRows()-1,c),numberOfThreads:A,block:d,blockMethod:"weight"})}finally{l.t9(t)}try{o=(0,n.aI)(r,u,{numberOfThreads:A})}finally{l.t9(r)}try{if(null===m)h=l.k3(e.numberOfColumns()),m=h;else if(m.length!==e.numberOfColumns())throw new Error("length of 'buffer' should be equal to the number of columns in 'x'");(0,i.O)(e,o.clusters({copy:"view"}),{buffer:m,numberOfThreads:A})}catch(p){throw l.t9(h),p}finally{l.t9(o)}return m}},7241:(e,t,r)=>{"use strict";r.d(t,{G1:()=>p,Kn:()=>A,O0:()=>k,X7:()=>f,ac:()=>_,pv:()=>c});var n=r(5149),s=r(8458),i=r(4558),a=r(7031),l=r(6524),o=r(2322),h=r(5660);class u{constructor(e,t,r){this.id=e,this.object=t,this.parent=r}type(){return this.object.type()}free(){null!==this.object&&(o._(this.id),this.object=null)}}class c extends u{constructor(e,t,r){super(e,t,r)}length(){return this.object.size()}attributeNames(){return l.T1((e=>{this.object.fill_attribute_names();let t=this.object.attribute_names_buffer(),r=this.object.attribute_names_length();return h.m(t,r)}))}findAttribute(e){return l.T1((t=>this.object.find_attribute(e)))}attribute(e){return g("number"==typeof e?t=>this.object.load_attribute_by_index(e):t=>this.object.load_attribute_by_name(e),this.parent)}}class f extends c{constructor(e,t,r){super(e,t,r)}values(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.xf(this.object.numeric_vector(),e)}}class d extends c{constructor(e,t,r){super(e,t,r)}values(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.xf(this.object.numeric_vector(),e)}}class m extends c{constructor(e,t,r){super(e,t,r)}values(){let{copy:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.xf(this.object.numeric_vector(),e)}}class A extends c{constructor(e,t,r){super(e,t,r)}values(){return l.T1((e=>{this.object.fill_string_vector();let t=this.object.string_vector_buffer(),r=this.object.string_vector_length();return h.m(t,r)}))}}class p extends c{constructor(e,t,r){super(e,t,r)}load(e){return g((t=>this.object.load_list_element(e)),this.parent)}}class _ extends u{constructor(e,t,r){super(e,t,r)}className(){return l.T1((e=>this.object.class_name()))}packageName(){return l.T1((e=>this.object.package_name()))}attributeNames(){return l.T1((e=>{this.object.fill_attribute_names();let t=this.object.attribute_names_buffer(),r=this.object.attribute_names_length();return h.m(t,r)}))}findAttribute(e){return l.T1((t=>this.object.find_attribute(e)))}attribute(e){return g("number"==typeof e?t=>this.object.load_attribute_by_index(e):t=>this.object.load_attribute_by_name(e),this.parent)}}class w extends c{constructor(e,t,r){super(e,t,r)}}function g(e,t){let r,n=l.T1(e),s=null;try{s=n.type()}catch(i){throw n.delete(),i}return r="integer"==s?f:"double"==s?m:"boolean"==s?d:"string"==s?A:"vector"==s?p:"S4"==s?_:"null"==s?w:u,o.T((e=>n),r,t)}var b=new WeakMap,v=new WeakMap;class y{constructor(e,t){(0,n.A)(this,b,void 0),(0,n.A)(this,v,void 0),(0,i.A)(b,this,e),(0,i.A)(v,this,t)}formatVersion(){return(0,s.A)(v,this).format_version()}writerVersion(){let e=(0,s.A)(v,this).writer_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}readerVersion(){let e=(0,s.A)(v,this).reader_version();return String(e[0])+"."+String(e[1])+"."+String(e[2])}value(){return g((e=>(0,s.A)(v,this).load()),this)}free(){null!==(0,s.A)(v,this)&&(o._((0,s.A)(b,this)),(0,i.A)(v,this,null))}}function k(e){let t,r;try{"string"==typeof e?r=o.T((t=>t.parse_rds_from_file(e)),y):(t=a.c(e,"Uint8WasmArray"),r=o.T((e=>e.parse_rds_from_buffer(t.offset,t.length)),y))}finally{a.t9(t)}return r}},4047:(e,t,r)=>{"use strict";r.d(t,{CN:()=>m,WC:()=>d});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=new WeakMap,h=new WeakMap,u=new WeakMap,c=new WeakMap,f=new WeakMap;class d{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,o,void 0),(0,n.A)(this,h,void 0),(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,i.A)(o,this,e),(0,i.A)(h,this,t),(0,i.A)(u,this,r),(0,i.A)(c,this,r),(0,i.A)(f,this,r)}principalComponents(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(u,this),(()=>{(0,i.A)(u,this,!0)}),(e=>l.xf((0,s.A)(h,this).pcs(),e)))}setTotalVariance(e){(0,s.A)(f,this)||(0,i.A)(f,this,!0),(0,s.A)(h,this).set_total_variance(e)}varianceExplained(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(c,this),(()=>{(0,i.A)(c,this,!0)}),(e=>l.xf((0,s.A)(h,this).variance_explained(),e)))}totalVariance(){return(0,s.A)(f,this)?(0,s.A)(h,this).total_variance():null}numberOfPCs(){return(0,s.A)(h,this).num_pcs()}numberOfCells(){return this.principalComponents({copy:!1}).length/this.numberOfPCs()}free(){null!==(0,s.A)(h,this)&&(a._((0,s.A)(o,this)),(0,i.A)(h,this,null))}}function m(e){let{features:t=null,numberOfPCs:r=25,scale:n=!1,block:s=null,blockMethod:i="regress",numberOfThreads:o=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var h,u,c;l._g("blockMethod",i,["none","regress","weight"]);let f=l.J2(o);try{var m=!1,A=0;if(null!==t){if((h=l.c(t,"Uint8WasmArray")).length!=e.numberOfRows())throw new Error("length of 'features' should be equal to number of rows in 'x'");m=!0,A=h.offset}if(r=Math.min(r,e.numberOfRows()-1,e.numberOfColumns()-1),null===s||"none"==i)c=a.T((t=>t.run_pca(e.matrix,r,m,A,n,f)),d);else{if((u=l.c(s,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'block' should be equal to the number of columns in 'x'");if("regress"==i)c=a.T((t=>t.run_blocked_pca(e.matrix,r,m,A,n,u.offset,f)),d);else{if("weight"!=i)throw new Error("unknown value '"+i+"' for 'blockMethod='");c=a.T((t=>t.run_multibatch_pca(e.matrix,r,m,A,n,u.offset,f)),d)}}}catch(p){throw l.t9(c),p}finally{l.t9(h),l.t9(u)}return c}},7571:(e,t,r)=>{"use strict";r.d(t,{rj:()=>s});r(7031);var n=r(6524);r(2322),r(4718);function s(e){return n.T1((t=>t.perplexity_to_k(e)))}},8652:(e,t,r)=>{"use strict";r(7031),r(6524),r(2322),r(4718)},1602:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});var n=r(6524),s=r(7031);r(4718);function i(e,t){let r,i,a,l,o,{neighbors:h=20,indices:u=null,buffer:c=null,approximate:f=!0,weights:d=null,numberOfThreads:m=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},A=e.length,p=s.J2(m),_=[];try{r=s.u0(A);let m=r.array();for(var w=0;w<A;w++)m[w]=BigInt(e[w].offset);let _=0,g=!1;if(null!==d){if(g=!0,l=s.c(d,"Float64WasmArray"),l.length!=A)throw new Error("length of 'weights' should be equal to the number of embeddings");_=l.offset}let b=e=>{let r=e*t;if(null===c)o=s.k3(r),c=o;else if(r!==c.length)throw new Error("length of 'buffer' should be equal to the product of 'numberOfCells' and the total number of dimensions")};if(null!==u){if(A!==u.length)throw new Error("'indices' and 'embeddings' should have the same length");i=s.u0(A);let a=i.array(),l=0;for(w=0;w<A;w++){let r=u[w];if(t!=r.numberOfCells())throw new Error("each element of 'indices' should have the same number of cells as 'numberOfCells'");if(e[w].length!=r.numberOfCells()*r.numberOfDims())throw new Error("length of arrays in 'embeddings' should equal the length of arrays used to build 'indices'");a[w]=BigInt(u[w].index.$$.ptr),l+=u[w].numberOfDims()}b(l),n.T1((e=>e.scale_by_neighbors_indices(t,A,r.offset,i.offset,c.offset,h,g,_,p)))}else{a=s.kl(A);let i=a.array(),l=0;for(w=0;w<A;w++){let r=e[w].length;if(i[w]=Math.floor(r/t),t*i[w]!==r)throw new Error("length of arrays in 'embeddings' should be a multiple of 'numberOfCells'");l+=i[w]}b(l),n.T1((e=>e.scale_by_neighbors_matrices(t,A,a.offset,r.offset,c.offset,h,g,_,f,p)))}}catch(g){throw s.t9(o),g}finally{for(const e of _)e.free();s.t9(r),s.t9(i),s.t9(l),s.t9(a)}return c}},8926:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});r(2322);var n=r(6524),s=r(7031);r(9165);function i(e,t){let r,i,a,{block:l=null,scale:o=!1,numberOfThreads:h=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u={},c=s.J2(h);try{if(t.length!==e.numberOfRows())throw new Error("Uint8Array 'features' must be of length equal to the number of rows in 'x'");i=s.c(t,"Uint8WasmArray");var f=0,d=!1;if(null!==l){if(a=s.c(l,"Int32WasmArray"),a.length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");d=!0,f=a.offset}r=n.T1((t=>t.score_feature_set(e.matrix,i.offset,d,f,o,c))),u.weights=r.weights().slice(),u.scores=r.scores().slice()}finally{s.t9(a),s.t9(i),r&&r.delete()}return u}},9841:(e,t,r)=>{"use strict";r.d(t,{Cx:()=>y,Kq:()=>x});var n=r(9790),s=r(5149),i=r(6562),a=r(8458),l=r(4558),o=r(2322),h=r(6524),u=r(7031);function c(e,t,r,n,s,i){return u.Vq(r,n,s.filled||s.details[e][t]||!1,(()=>{s.details[e][t]=!0}),i)}function f(e){if("number"==typeof e)return e;let t;switch(e){case"minimum":t=0;break;case"mean":t=1;break;case"median":t=2;break;case"maximum":t=3;break;case"min-rank":t=4;break;default:throw new Error("unknown summary type '"+e+"'")}return t}var d=new WeakMap,m=new WeakMap,A=new WeakMap,p=new WeakMap,_=new WeakMap,w=new WeakMap,g=new WeakMap,b=new WeakMap,v=new WeakSet;class y{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,v),(0,s.A)(this,d,void 0),(0,s.A)(this,m,void 0),(0,s.A)(this,A,void 0),(0,s.A)(this,p,void 0),(0,s.A)(this,_,void 0),(0,s.A)(this,w,void 0),(0,s.A)(this,g,void 0),(0,s.A)(this,b,void 0),(0,l.A)(d,this,e),(0,l.A)(m,this,t);let i=this.numberOfGroups(),a=this.numberOfBlocks();function o(e){let t={filled:e};if(!e){t.details=new Array(i);for(var r=0;r<i;r++)t.details[r]=u.F(a+1,e)}return t}function h(e){let t={filled:e};if(!e){t.details=new Array(i);for(var r=0;r<i;r++)t.details[r]={}}return t}(0,l.A)(A,this,o(r)),(0,l.A)(p,this,o(r)),(0,l.A)(_,this,h(r)),(0,l.A)(w,this,h(r)),(0,l.A)(g,this,h(r)),(0,l.A)(b,this,h(r))}numberOfBlocks(){return(0,a.A)(m,this).num_blocks()}numberOfGroups(){return(0,a.A)(m,this).num_groups()}means(e){let{block:t=null,copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.A)(v,this,k).call(this,e,t,r,n,(0,a.A)(A,this),"means")}detected(e){let{block:t=null,copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.A)(v,this,k).call(this,e,t,r,n,(0,a.A)(p,this),"detected")}cohen(e){let{summary:t="mean",copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=f(t),c(e,t,n,r,(0,a.A)(_,this),(r=>u.xf(h.T1((r=>(0,a.A)(m,this).cohen(e,t))),r)))}auc(e){let{summary:t="mean",copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=f(t),c(e,t,n,r,(0,a.A)(g,this),(r=>u.xf(h.T1((r=>(0,a.A)(m,this).auc(e,t))),r)))}lfc(e){let{summary:t="mean",copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=f(t),c(e,t,n,r,(0,a.A)(w,this),(r=>u.xf(h.T1((r=>(0,a.A)(m,this).lfc(e,t))),r)))}deltaDetected(e){let{summary:t="mean",copy:r=!0,fillable:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=f(t),c(e,t,n,r,(0,a.A)(b,this),(r=>u.xf(h.T1((r=>(0,a.A)(m,this).delta_detected(e,t))),r)))}free(){null!==(0,a.A)(m,this)&&(o._((0,a.A)(d,this)),(0,l.A)(m,this,null))}}function k(e,t,r,n,s,i){let l=t;if(null==t){let e=this.numberOfBlocks();l=e>1?e:0,t=-1}return u.Vq(n,r,s.filled||s.details[e][l]||!1,(()=>{s.details[e][l]=!0}),(r=>u.xf((0,a.A)(m,this)[i](e,t),r)))}function x(e,t){let{block:r=null,numberOfThreads:n=null,lfcThreshold:s=0,computeAuc:i=!0,computeMedian:a=!1,computeMaximum:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var h,c,f;let d=u.J2(n);try{if((f=u.c(t,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("length of 'groups' should be equal to number of columns in 'x'");var m=0,A=!1;if(null!==r){if((c=u.c(r,"Int32WasmArray")).length!=e.numberOfColumns())throw new Error("'block' must be of length equal to the number of columns in 'x'");A=!0,m=c.offset}h=o.T((t=>t.score_markers(e.matrix,f.offset,A,m,s,i,a,l,d)),y)}catch(p){throw u.t9(h),p}finally{u.t9(c),u.t9(f)}return h}},5090:(e,t,r)=>{"use strict";r.d(t,{_r:()=>l,aN:()=>o});var n=r(7031),s=r(6524),i=r(7778);function a(e,t){let r,i,a,{inPlace:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{l?i=e:(r=e.clone(),i=r),a=n.c(t,"Int32WasmArray"),s.T1((e=>e.row_subset(i.matrix,a.offset,a.length)))}catch(o){throw n.t9(r),o}finally{n.t9(a)}return i}function l(e,t){let r,i,a,{inPlace:l=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{l?i=e:(r=e.clone(),i=r),a=n.c(t,"Int32WasmArray"),s.T1((e=>e.column_subset(i.matrix,a.offset,a.length)))}catch(o){throw n.t9(r),o}finally{n.t9(a)}return i}function o(e,t){let r,{singleNull:n=!1,createMultiMatrix:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l={},o=Object.keys(t);if(1==o.length){let r=t[o[0]],s=r.length==e.numberOfRows();if(s)for(var h=0;h<r.length;h++)if(h!=r[h]){s=!1;break}if(s)return n?null:(l[o[0]]=e.clone(),l)}try{for(const r of o)l[r]=a(e,t[r]);s&&(r=new i.P({store:l}))}catch(u){for(const e of Object.values(l))e.free();throw u}return s?r:l}},886:(e,t,r)=>{"use strict";r.d(t,{RJ:()=>A});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=r(8229),h=r(6617),u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap;class m{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,i.A)(c,this,e),(0,i.A)(u,this,t),(0,i.A)(f,this,r),(0,i.A)(d,this,l.F(this.numberOfSubsets(),r))}thresholdsDetected(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(u,this).thresholds_detected(),e)))}thresholdsSubsetTotals(e){let{copy:t=!0,fillable:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.Vq(r,t,(0,s.A)(d,this)[e],(()=>{(0,s.A)(d,this)[e]=!0}),(t=>l.xf((0,s.A)(u,this).thresholds_subset_totals(e),t)))}numberOfSubsets(){return(0,s.A)(u,this).num_subsets()}numberOfBlocks(){return(0,s.A)(u,this).num_blocks()}filter(e){let{block:t=null,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.iN))throw new Error("'metrics' should be a PerCellAdtQcMetricsResults object");return o.$((0,s.A)(u,this),e,t,r)}free(){null!==(0,s.A)(u,this)&&(a._((0,s.A)(c,this)),(0,i.A)(u,this,null))}}function A(e){let{numberOfMADs:t=3,minDetectedDrop:r=.1,block:n=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.iN))throw new Error("'metrics' should be a PerCellAdtQcMetricsResults object");return o.U(e,n,((e,n,s)=>a.T((i=>i.suggest_adt_qc_filters(e.results.$$.ptr,n,s,t,r)),m)))}},988:(e,t,r)=>{"use strict";r.d(t,{fh:()=>m});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=r(8229),h=r(3261),u=new WeakMap,c=new WeakMap,f=new WeakMap;class d{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,i.A)(u,this,e),(0,i.A)(c,this,t),(0,i.A)(f,this,r)}thresholdsMaxCount(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(c,this).thresholds_max_count(),e)))}numberOfBlocks(){return(0,s.A)(c,this).num_blocks()}filter(e){let{block:t=null,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.YW))throw new Error("'metrics' should be a PerCellCrisprQcMetricsResults object");return o.$((0,s.A)(c,this),e,t,r)}free(){null!==(0,s.A)(c,this)&&(a._((0,s.A)(u,this)),(0,i.A)(c,this,null))}}function m(e){let{numberOfMADs:t=3,block:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.YW))throw new Error("'metrics' should be a PerCellCrisprQcMetricsResults object");return o.U(e,r,((e,r,n)=>a.T((s=>s.suggest_crispr_qc_filters(e.results.$$.ptr,r,n,t)),d)))}},6218:(e,t,r)=>{"use strict";r.d(t,{DA:()=>p});var n=r(5149),s=r(8458),i=r(4558),a=r(2322),l=r(7031),o=r(8229),h=r(6273),u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap;class A{constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n.A)(this,u,void 0),(0,n.A)(this,c,void 0),(0,n.A)(this,f,void 0),(0,n.A)(this,d,void 0),(0,n.A)(this,m,void 0),(0,i.A)(u,this,e),(0,i.A)(c,this,t),(0,i.A)(f,this,r),(0,i.A)(d,this,r),(0,i.A)(m,this,l.F(this.numberOfSubsets(),r))}thresholdsSums(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(f,this),(()=>{(0,i.A)(f,this,!0)}),(e=>l.xf((0,s.A)(c,this).thresholds_sums(),e)))}thresholdsDetected(){let{copy:e=!0,fillable:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.Vq(t,e,(0,s.A)(d,this),(()=>{(0,i.A)(d,this,!0)}),(e=>l.xf((0,s.A)(c,this).thresholds_detected(),e)))}thresholdsSubsetProportions(e){let{copy:t=!0,fillable:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.Vq(r,t,(0,s.A)(m,this)[e],(()=>{(0,s.A)(m,this)[e]=!0}),(t=>l.xf((0,s.A)(c,this).thresholds_proportions(e),t)))}numberOfSubsets(){return(0,s.A)(c,this).num_subsets()}numberOfBlocks(){return(0,s.A)(c,this).num_blocks()}filter(e){let{block:t=null,buffer:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.U6))throw new Error("'metrics' should be a PerCellRnaQcMetricsResults object");return o.$((0,s.A)(c,this),e,t,r)}free(){null!==(0,s.A)(c,this)&&(a._((0,s.A)(u,this)),(0,i.A)(c,this,null))}}function p(e){let{numberOfMADs:t=3,block:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e instanceof h.U6))throw new Error("'metrics' should be a PerCellRnaQcMetricsResults object");return o.U(e,r,((e,r,n)=>a.T((s=>s.suggest_rna_qc_filters(e.results.$$.ptr,r,n,t)),A)))}},7031:(e,t,r)=>{"use strict";r.d(t,{F:()=>m,J2:()=>u,Vq:()=>A,_g:()=>d,c:()=>h,eg:()=>i,k3:()=>o,kl:()=>a,t9:()=>c,u0:()=>l,xf:()=>f});var n=r(6524),s=r(9165);function i(e){return s.eg((0,n.wZ)(),e)}function a(e){return s.kl((0,n.wZ)(),e)}function l(e){return s.u0((0,n.wZ)(),e)}function o(e){return s.k3((0,n.wZ)(),e)}function h(e,t){if(e instanceof s.Kr){if(null!==t&&t!=e.constructor.className)throw new Error("expected '"+t+"', got '"+e.constructor.className+"'");return e.space===(0,n.wZ)()?null===e.owner?e.view():e:e.clone((0,n.wZ)())}let r=null;return r=null!==t?s.US((0,n.wZ)(),e,s.Fl(t)):s.US((0,n.wZ)(),e),r}function u(e){return null==e?(0,n._d)():e}function c(e){if("undefined"!=typeof e&&null!=e)return e.free()}function f(e,t){if("view"===t){if(e.buffer!==(0,n.r)())throw new Error('cannot use copy = "view" for non-Wasm TypedArrays');let t=e.constructor.name.replace("Array","WasmArray");return s.Nf((0,n.wZ)(),e.length,e.byteOffset,s.Fl(t))}return t?e.slice():e}function d(e,t,r){if(-1==r.indexOf(t))throw new Error("'"+e+"=' should be one of '"+r.join("', '")+"'")}function m(e,t){let r=new Array(e);return r.fill(t),r}function A(e,t,r,n,s){if(!r){if(!e)return null;n(),t&&(t=!1)}return s(t)}},6524:(e,t,r)=>{"use strict";r.d(t,{T1:()=>o,_d:()=>l,n_:()=>a,r:()=>h,wZ:()=>u});var n=r(8120),s=r(9165);r(703);const i={};async function a(){let{numberOfThreads:e=4,localFile:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("module"in i)return!1;let r={scran_custom_nthreads:e};return t&&(r.locateFile=e=>"file:///home/runner/work/kana/kana/node_modules/scran.js/browser/wasm.js".substring(7)+"/../wasm/"+e),i.module=await(0,n.default)(r),i.space=(0,s.kz)(i.module),!0}function l(){return i.module.scran_custom_nthreads}function o(e){if(!("module"in i))throw new Error("Wasm module needs to be initialized via 'initialize()'");var t;try{t=e(i.module)}catch(r){throw"number"==typeof r?new Error(i.module.get_error_message(r)):r}return t}function h(){if(!("module"in i))throw new Error("Wasm module needs to be initialized via 'initialize()'");return i.module.wasmMemory.buffer}function u(){return i.space}},8301:(e,t,r)=>{"use strict";r.d(t,{OV:()=>i,eg:()=>a,k3:()=>h,kl:()=>l,u0:()=>o});var n=r(4169),s=r(1952);function i(e,t,r){return(0,n.CN)(e,t,r)}function a(e,t){return i(e,t,s._A)}function l(e,t){return i(e,t,s.Os)}function o(e,t){return i(e,t,s.oz)}function h(e,t){return i(e,t,s.WI)}},1952:(e,t,r)=>{"use strict";r.d(t,{Fl:()=>_,Os:()=>c,WI:()=>A,_A:()=>a,oz:()=>f});var n=r(4467),s=r(4169),i=r(536);class a extends i.K{array(){return new Uint8Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(a,"className","Uint8WasmArray"),(0,n.A)(a,"valueSize",1);class l extends i.K{array(){return new Int8Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(l,"className","Int8WasmArray"),(0,n.A)(l,"valueSize",1);class o extends i.K{array(){return new Uint16Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(o,"className","Uint16WasmArray"),(0,n.A)(o,"valueSize",2);class h extends i.K{array(){return new Int16Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(h,"className","Int16WasmArray"),(0,n.A)(h,"valueSize",2);class u extends i.K{array(){return new Uint32Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(u,"className","Uint32WasmArray"),(0,n.A)(u,"valueSize",4);class c extends i.K{array(){return new Int32Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(c,"className","Int32WasmArray"),(0,n.A)(c,"valueSize",4);class f extends i.K{array(){return new BigUint64Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(f,"className","BigUint64WasmArray"),(0,n.A)(f,"valueSize",8);class d extends i.K{array(){return new BigInt64Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(d,"className","BigInt64WasmArray"),(0,n.A)(d,"valueSize",8);class m extends i.K{array(){return new Float32Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(m,"className","Float32WasmArray"),(0,n.A)(m,"valueSize",4);class A extends i.K{array(){return new Float64Array((0,s.r)(this.space),this.offset,this.length)}}(0,n.A)(A,"className","Float64WasmArray"),(0,n.A)(A,"valueSize",8);const p={Uint8WasmArray:a,Int8WasmArray:l,Uint16WasmArray:o,Int16WasmArray:h,Uint32WasmArray:u,Int32WasmArray:c,BigUint64WasmArray:f,BigInt64WasmArray:d,Float32WasmArray:m,Float64WasmArray:A};function _(e){if(!(e in p))throw new Error("unknown WasmArray class '"+e+"'");return p[e]}},9165:(e,t,r)=>{"use strict";r.d(t,{CY:()=>o.CY,Fl:()=>s.Fl,Kr:()=>n.K,Nf:()=>l.Nf,Os:()=>s.Os,US:()=>a.US,WI:()=>s.WI,_A:()=>s._A,eg:()=>i.eg,k3:()=>i.k3,kl:()=>i.kl,kz:()=>h.kz,u0:()=>i.u0});var n=r(536),s=r(1952),i=r(8301),a=r(566),l=r(1964),o=(r(2114),r(219)),h=r(4169)},219:(e,t,r)=>{"use strict";r.d(t,{CY:()=>s});var n=r(8301);function s(e,t){let{filter:r=null,buffer:s=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(e,t,r,n){if(null===t)return e.forEach((e=>{if(e<0||e>=r)throw new Error("'subset' contains out-of-range indices for '"+n+"'")})),e.length;if(e.length!=r)throw new Error("'subset' and '"+n+"' should have the same length");let s=0;return e.forEach((e=>{s+=0!=e})),t?e.length-s:s}(t,r,e.length,"x");if(null==s)s=(0,n.OV)(e.space,i,e.constructor);else if(s.length!==i)throw new Error("length of 'buffer' is not consistent with 'subset'");let a=s.array();return function(e,t,r,n){if(null==t)e.forEach(((e,t)=>{n[t]=r[e]}));else if(t){let t=0;e.forEach(((e,s)=>{0==e&&(n[t]=r[s],t++)}))}else{let t=0;e.forEach(((e,s)=>{0!==e&&(n[t]=r[s],t++)}))}}(t,r,e.array(),a),s}}}]);
//# sourceMappingURL=705.8c5fde0b.chunk.js.map